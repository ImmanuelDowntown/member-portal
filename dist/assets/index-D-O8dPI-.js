function IS(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in t)){const i=Object.getOwnPropertyDescriptor(r,s);i&&Object.defineProperty(t,s,i.get?i:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();function SS(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Iw={exports:{}},Uc={},Sw={exports:{}},xe={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var cl=Symbol.for("react.element"),NS=Symbol.for("react.portal"),bS=Symbol.for("react.fragment"),AS=Symbol.for("react.strict_mode"),CS=Symbol.for("react.profiler"),kS=Symbol.for("react.provider"),RS=Symbol.for("react.context"),PS=Symbol.for("react.forward_ref"),jS=Symbol.for("react.suspense"),DS=Symbol.for("react.memo"),OS=Symbol.for("react.lazy"),hy=Symbol.iterator;function LS(t){return t===null||typeof t!="object"?null:(t=hy&&t[hy]||t["@@iterator"],typeof t=="function"?t:null)}var Nw={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},bw=Object.assign,Aw={};function ko(t,e,n){this.props=t,this.context=e,this.refs=Aw,this.updater=n||Nw}ko.prototype.isReactComponent={};ko.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};ko.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function Cw(){}Cw.prototype=ko.prototype;function gp(t,e,n){this.props=t,this.context=e,this.refs=Aw,this.updater=n||Nw}var yp=gp.prototype=new Cw;yp.constructor=gp;bw(yp,ko.prototype);yp.isPureReactComponent=!0;var fy=Array.isArray,kw=Object.prototype.hasOwnProperty,vp={current:null},Rw={key:!0,ref:!0,__self:!0,__source:!0};function Pw(t,e,n){var r,s={},i=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)kw.call(e,r)&&!Rw.hasOwnProperty(r)&&(s[r]=e[r]);var l=arguments.length-2;if(l===1)s.children=n;else if(1<l){for(var u=Array(l),d=0;d<l;d++)u[d]=arguments[d+2];s.children=u}if(t&&t.defaultProps)for(r in l=t.defaultProps,l)s[r]===void 0&&(s[r]=l[r]);return{$$typeof:cl,type:t,key:i,ref:o,props:s,_owner:vp.current}}function VS(t,e){return{$$typeof:cl,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function _p(t){return typeof t=="object"&&t!==null&&t.$$typeof===cl}function MS(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var py=/\/+/g;function Gd(t,e){return typeof t=="object"&&t!==null&&t.key!=null?MS(""+t.key):e.toString(36)}function Tu(t,e,n,r,s){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case cl:case NS:o=!0}}if(o)return o=t,s=s(o),t=r===""?"."+Gd(o,0):r,fy(s)?(n="",t!=null&&(n=t.replace(py,"$&/")+"/"),Tu(s,e,n,"",function(d){return d})):s!=null&&(_p(s)&&(s=VS(s,n+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(py,"$&/")+"/")+t)),e.push(s)),1;if(o=0,r=r===""?".":r+":",fy(t))for(var l=0;l<t.length;l++){i=t[l];var u=r+Gd(i,l);o+=Tu(i,e,n,u,s)}else if(u=LS(t),typeof u=="function")for(t=u.call(t),l=0;!(i=t.next()).done;)i=i.value,u=r+Gd(i,l++),o+=Tu(i,e,n,u,s);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Xl(t,e,n){if(t==null)return t;var r=[],s=0;return Tu(t,r,"","",function(i){return e.call(n,i,s++)}),r}function US(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var tn={current:null},Iu={transition:null},FS={ReactCurrentDispatcher:tn,ReactCurrentBatchConfig:Iu,ReactCurrentOwner:vp};function jw(){throw Error("act(...) is not supported in production builds of React.")}xe.Children={map:Xl,forEach:function(t,e,n){Xl(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Xl(t,function(){e++}),e},toArray:function(t){return Xl(t,function(e){return e})||[]},only:function(t){if(!_p(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};xe.Component=ko;xe.Fragment=bS;xe.Profiler=CS;xe.PureComponent=gp;xe.StrictMode=AS;xe.Suspense=jS;xe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=FS;xe.act=jw;xe.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=bw({},t.props),s=t.key,i=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=vp.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(u in e)kw.call(e,u)&&!Rw.hasOwnProperty(u)&&(r[u]=e[u]===void 0&&l!==void 0?l[u]:e[u])}var u=arguments.length-2;if(u===1)r.children=n;else if(1<u){l=Array(u);for(var d=0;d<u;d++)l[d]=arguments[d+2];r.children=l}return{$$typeof:cl,type:t.type,key:s,ref:i,props:r,_owner:o}};xe.createContext=function(t){return t={$$typeof:RS,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:kS,_context:t},t.Consumer=t};xe.createElement=Pw;xe.createFactory=function(t){var e=Pw.bind(null,t);return e.type=t,e};xe.createRef=function(){return{current:null}};xe.forwardRef=function(t){return{$$typeof:PS,render:t}};xe.isValidElement=_p;xe.lazy=function(t){return{$$typeof:OS,_payload:{_status:-1,_result:t},_init:US}};xe.memo=function(t,e){return{$$typeof:DS,type:t,compare:e===void 0?null:e}};xe.startTransition=function(t){var e=Iu.transition;Iu.transition={};try{t()}finally{Iu.transition=e}};xe.unstable_act=jw;xe.useCallback=function(t,e){return tn.current.useCallback(t,e)};xe.useContext=function(t){return tn.current.useContext(t)};xe.useDebugValue=function(){};xe.useDeferredValue=function(t){return tn.current.useDeferredValue(t)};xe.useEffect=function(t,e){return tn.current.useEffect(t,e)};xe.useId=function(){return tn.current.useId()};xe.useImperativeHandle=function(t,e,n){return tn.current.useImperativeHandle(t,e,n)};xe.useInsertionEffect=function(t,e){return tn.current.useInsertionEffect(t,e)};xe.useLayoutEffect=function(t,e){return tn.current.useLayoutEffect(t,e)};xe.useMemo=function(t,e){return tn.current.useMemo(t,e)};xe.useReducer=function(t,e,n){return tn.current.useReducer(t,e,n)};xe.useRef=function(t){return tn.current.useRef(t)};xe.useState=function(t){return tn.current.useState(t)};xe.useSyncExternalStore=function(t,e,n){return tn.current.useSyncExternalStore(t,e,n)};xe.useTransition=function(){return tn.current.useTransition()};xe.version="18.3.1";Sw.exports=xe;var k=Sw.exports;const B=SS(k),$S=IS({__proto__:null,default:B},[k]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var BS=k,zS=Symbol.for("react.element"),qS=Symbol.for("react.fragment"),WS=Object.prototype.hasOwnProperty,HS=BS.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,GS={key:!0,ref:!0,__self:!0,__source:!0};function Dw(t,e,n){var r,s={},i=null,o=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)WS.call(e,r)&&!GS.hasOwnProperty(r)&&(s[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:zS,type:t,key:i,ref:o,props:s,_owner:HS.current}}Uc.Fragment=qS;Uc.jsx=Dw;Uc.jsxs=Dw;Iw.exports=Uc;var c=Iw.exports,Fh={},Ow={exports:{}},In={},Lw={exports:{}},Vw={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e($,K){var J=$.length;$.push(K);e:for(;0<J;){var _e=J-1>>>1,he=$[_e];if(0<s(he,K))$[_e]=K,$[J]=he,J=_e;else break e}}function n($){return $.length===0?null:$[0]}function r($){if($.length===0)return null;var K=$[0],J=$.pop();if(J!==K){$[0]=J;e:for(var _e=0,he=$.length,se=he>>>1;_e<se;){var it=2*(_e+1)-1,It=$[it],Ke=it+1,Oe=$[Ke];if(0>s(It,J))Ke<he&&0>s(Oe,It)?($[_e]=Oe,$[Ke]=J,_e=Ke):($[_e]=It,$[it]=J,_e=it);else if(Ke<he&&0>s(Oe,J))$[_e]=Oe,$[Ke]=J,_e=Ke;else break e}}return K}function s($,K){var J=$.sortIndex-K.sortIndex;return J!==0?J:$.id-K.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var u=[],d=[],f=1,p=null,m=3,y=!1,x=!1,A=!1,b=typeof setTimeout=="function"?setTimeout:null,E=typeof clearTimeout=="function"?clearTimeout:null,v=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w($){for(var K=n(d);K!==null;){if(K.callback===null)r(d);else if(K.startTime<=$)r(d),K.sortIndex=K.expirationTime,e(u,K);else break;K=n(d)}}function R($){if(A=!1,w($),!x)if(n(u)!==null)x=!0,Un(D);else{var K=n(d);K!==null&&Q(R,K.startTime-$)}}function D($,K){x=!1,A&&(A=!1,E(_),_=-1),y=!0;var J=m;try{for(w(K),p=n(u);p!==null&&(!(p.expirationTime>K)||$&&!P());){var _e=p.callback;if(typeof _e=="function"){p.callback=null,m=p.priorityLevel;var he=_e(p.expirationTime<=K);K=t.unstable_now(),typeof he=="function"?p.callback=he:p===n(u)&&r(u),w(K)}else r(u);p=n(u)}if(p!==null)var se=!0;else{var it=n(d);it!==null&&Q(R,it.startTime-K),se=!1}return se}finally{p=null,m=J,y=!1}}var L=!1,S=null,_=-1,I=5,N=-1;function P(){return!(t.unstable_now()-N<I)}function j(){if(S!==null){var $=t.unstable_now();N=$;var K=!0;try{K=S(!0,$)}finally{K?C():(L=!1,S=null)}}else L=!1}var C;if(typeof v=="function")C=function(){v(j)};else if(typeof MessageChannel<"u"){var lt=new MessageChannel,Tt=lt.port2;lt.port1.onmessage=j,C=function(){Tt.postMessage(null)}}else C=function(){b(j,0)};function Un($){S=$,L||(L=!0,C())}function Q($,K){_=b(function(){$(t.unstable_now())},K)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function($){$.callback=null},t.unstable_continueExecution=function(){x||y||(x=!0,Un(D))},t.unstable_forceFrameRate=function($){0>$||125<$?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<$?Math.floor(1e3/$):5},t.unstable_getCurrentPriorityLevel=function(){return m},t.unstable_getFirstCallbackNode=function(){return n(u)},t.unstable_next=function($){switch(m){case 1:case 2:case 3:var K=3;break;default:K=m}var J=m;m=K;try{return $()}finally{m=J}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function($,K){switch($){case 1:case 2:case 3:case 4:case 5:break;default:$=3}var J=m;m=$;try{return K()}finally{m=J}},t.unstable_scheduleCallback=function($,K,J){var _e=t.unstable_now();switch(typeof J=="object"&&J!==null?(J=J.delay,J=typeof J=="number"&&0<J?_e+J:_e):J=_e,$){case 1:var he=-1;break;case 2:he=250;break;case 5:he=1073741823;break;case 4:he=1e4;break;default:he=5e3}return he=J+he,$={id:f++,callback:K,priorityLevel:$,startTime:J,expirationTime:he,sortIndex:-1},J>_e?($.sortIndex=J,e(d,$),n(u)===null&&$===n(d)&&(A?(E(_),_=-1):A=!0,Q(R,J-_e))):($.sortIndex=he,e(u,$),x||y||(x=!0,Un(D))),$},t.unstable_shouldYield=P,t.unstable_wrapCallback=function($){var K=m;return function(){var J=m;m=K;try{return $.apply(this,arguments)}finally{m=J}}}})(Vw);Lw.exports=Vw;var KS=Lw.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var QS=k,En=KS;function q(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Mw=new Set,Pa={};function xi(t,e){po(t,e),po(t+"Capture",e)}function po(t,e){for(Pa[t]=e,t=0;t<e.length;t++)Mw.add(e[t])}var Ur=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),$h=Object.prototype.hasOwnProperty,YS=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,my={},gy={};function JS(t){return $h.call(gy,t)?!0:$h.call(my,t)?!1:YS.test(t)?gy[t]=!0:(my[t]=!0,!1)}function XS(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function ZS(t,e,n,r){if(e===null||typeof e>"u"||XS(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function nn(t,e,n,r,s,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var Vt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Vt[t]=new nn(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Vt[e]=new nn(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Vt[t]=new nn(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Vt[t]=new nn(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Vt[t]=new nn(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Vt[t]=new nn(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Vt[t]=new nn(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Vt[t]=new nn(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Vt[t]=new nn(t,5,!1,t.toLowerCase(),null,!1,!1)});var wp=/[\-:]([a-z])/g;function xp(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(wp,xp);Vt[e]=new nn(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(wp,xp);Vt[e]=new nn(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(wp,xp);Vt[e]=new nn(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Vt[t]=new nn(t,1,!1,t.toLowerCase(),null,!1,!1)});Vt.xlinkHref=new nn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Vt[t]=new nn(t,1,!1,t.toLowerCase(),null,!0,!0)});function Ep(t,e,n,r){var s=Vt.hasOwnProperty(e)?Vt[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(ZS(e,n,s,r)&&(n=null),r||s===null?JS(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):s.mustUseProperty?t[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?t.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var Gr=QS.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Zl=Symbol.for("react.element"),zi=Symbol.for("react.portal"),qi=Symbol.for("react.fragment"),Tp=Symbol.for("react.strict_mode"),Bh=Symbol.for("react.profiler"),Uw=Symbol.for("react.provider"),Fw=Symbol.for("react.context"),Ip=Symbol.for("react.forward_ref"),zh=Symbol.for("react.suspense"),qh=Symbol.for("react.suspense_list"),Sp=Symbol.for("react.memo"),os=Symbol.for("react.lazy"),$w=Symbol.for("react.offscreen"),yy=Symbol.iterator;function Zo(t){return t===null||typeof t!="object"?null:(t=yy&&t[yy]||t["@@iterator"],typeof t=="function"?t:null)}var rt=Object.assign,Kd;function aa(t){if(Kd===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Kd=e&&e[1]||""}return`
`+Kd+t}var Qd=!1;function Yd(t,e){if(!t||Qd)return"";Qd=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(d){var r=d}Reflect.construct(t,[],e)}else{try{e.call()}catch(d){r=d}t.call(e.prototype)}else{try{throw Error()}catch(d){r=d}t()}}catch(d){if(d&&r&&typeof d.stack=="string"){for(var s=d.stack.split(`
`),i=r.stack.split(`
`),o=s.length-1,l=i.length-1;1<=o&&0<=l&&s[o]!==i[l];)l--;for(;1<=o&&0<=l;o--,l--)if(s[o]!==i[l]){if(o!==1||l!==1)do if(o--,l--,0>l||s[o]!==i[l]){var u=`
`+s[o].replace(" at new "," at ");return t.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",t.displayName)),u}while(1<=o&&0<=l);break}}}finally{Qd=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?aa(t):""}function eN(t){switch(t.tag){case 5:return aa(t.type);case 16:return aa("Lazy");case 13:return aa("Suspense");case 19:return aa("SuspenseList");case 0:case 2:case 15:return t=Yd(t.type,!1),t;case 11:return t=Yd(t.type.render,!1),t;case 1:return t=Yd(t.type,!0),t;default:return""}}function Wh(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case qi:return"Fragment";case zi:return"Portal";case Bh:return"Profiler";case Tp:return"StrictMode";case zh:return"Suspense";case qh:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case Fw:return(t.displayName||"Context")+".Consumer";case Uw:return(t._context.displayName||"Context")+".Provider";case Ip:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Sp:return e=t.displayName||null,e!==null?e:Wh(t.type)||"Memo";case os:e=t._payload,t=t._init;try{return Wh(t(e))}catch{}}return null}function tN(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Wh(e);case 8:return e===Tp?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Rs(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function Bw(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function nN(t){var e=Bw(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(o){r=""+o,i.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function eu(t){t._valueTracker||(t._valueTracker=nN(t))}function zw(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=Bw(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function qu(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Hh(t,e){var n=e.checked;return rt({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function vy(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Rs(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function qw(t,e){e=e.checked,e!=null&&Ep(t,"checked",e,!1)}function Gh(t,e){qw(t,e);var n=Rs(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Kh(t,e.type,n):e.hasOwnProperty("defaultValue")&&Kh(t,e.type,Rs(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function _y(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Kh(t,e,n){(e!=="number"||qu(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var la=Array.isArray;function ro(t,e,n,r){if(t=t.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=e.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Rs(n),e=null,s=0;s<t.length;s++){if(t[s].value===n){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function Qh(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(q(91));return rt({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function wy(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(q(92));if(la(n)){if(1<n.length)throw Error(q(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Rs(n)}}function Ww(t,e){var n=Rs(e.value),r=Rs(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function xy(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function Hw(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Yh(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?Hw(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var tu,Gw=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(tu=tu||document.createElement("div"),tu.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=tu.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function ja(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var ga={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},rN=["Webkit","ms","Moz","O"];Object.keys(ga).forEach(function(t){rN.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),ga[e]=ga[t]})});function Kw(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||ga.hasOwnProperty(t)&&ga[t]?(""+e).trim():e+"px"}function Qw(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=Kw(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,s):t[n]=s}}var sN=rt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Jh(t,e){if(e){if(sN[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(q(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(q(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(q(61))}if(e.style!=null&&typeof e.style!="object")throw Error(q(62))}}function Xh(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Zh=null;function Np(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var ef=null,so=null,io=null;function Ey(t){if(t=fl(t)){if(typeof ef!="function")throw Error(q(280));var e=t.stateNode;e&&(e=qc(e),ef(t.stateNode,t.type,e))}}function Yw(t){so?io?io.push(t):io=[t]:so=t}function Jw(){if(so){var t=so,e=io;if(io=so=null,Ey(t),e)for(t=0;t<e.length;t++)Ey(e[t])}}function Xw(t,e){return t(e)}function Zw(){}var Jd=!1;function ex(t,e,n){if(Jd)return t(e,n);Jd=!0;try{return Xw(t,e,n)}finally{Jd=!1,(so!==null||io!==null)&&(Zw(),Jw())}}function Da(t,e){var n=t.stateNode;if(n===null)return null;var r=qc(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(q(231,e,typeof n));return n}var tf=!1;if(Ur)try{var ea={};Object.defineProperty(ea,"passive",{get:function(){tf=!0}}),window.addEventListener("test",ea,ea),window.removeEventListener("test",ea,ea)}catch{tf=!1}function iN(t,e,n,r,s,i,o,l,u){var d=Array.prototype.slice.call(arguments,3);try{e.apply(n,d)}catch(f){this.onError(f)}}var ya=!1,Wu=null,Hu=!1,nf=null,oN={onError:function(t){ya=!0,Wu=t}};function aN(t,e,n,r,s,i,o,l,u){ya=!1,Wu=null,iN.apply(oN,arguments)}function lN(t,e,n,r,s,i,o,l,u){if(aN.apply(this,arguments),ya){if(ya){var d=Wu;ya=!1,Wu=null}else throw Error(q(198));Hu||(Hu=!0,nf=d)}}function Ei(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function tx(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Ty(t){if(Ei(t)!==t)throw Error(q(188))}function uN(t){var e=t.alternate;if(!e){if(e=Ei(t),e===null)throw Error(q(188));return e!==t?null:t}for(var n=t,r=e;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return Ty(s),t;if(i===r)return Ty(s),e;i=i.sibling}throw Error(q(188))}if(n.return!==r.return)n=s,r=i;else{for(var o=!1,l=s.child;l;){if(l===n){o=!0,n=s,r=i;break}if(l===r){o=!0,r=s,n=i;break}l=l.sibling}if(!o){for(l=i.child;l;){if(l===n){o=!0,n=i,r=s;break}if(l===r){o=!0,r=i,n=s;break}l=l.sibling}if(!o)throw Error(q(189))}}if(n.alternate!==r)throw Error(q(190))}if(n.tag!==3)throw Error(q(188));return n.stateNode.current===n?t:e}function nx(t){return t=uN(t),t!==null?rx(t):null}function rx(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=rx(t);if(e!==null)return e;t=t.sibling}return null}var sx=En.unstable_scheduleCallback,Iy=En.unstable_cancelCallback,cN=En.unstable_shouldYield,dN=En.unstable_requestPaint,ct=En.unstable_now,hN=En.unstable_getCurrentPriorityLevel,bp=En.unstable_ImmediatePriority,ix=En.unstable_UserBlockingPriority,Gu=En.unstable_NormalPriority,fN=En.unstable_LowPriority,ox=En.unstable_IdlePriority,Fc=null,dr=null;function pN(t){if(dr&&typeof dr.onCommitFiberRoot=="function")try{dr.onCommitFiberRoot(Fc,t,void 0,(t.current.flags&128)===128)}catch{}}var Kn=Math.clz32?Math.clz32:yN,mN=Math.log,gN=Math.LN2;function yN(t){return t>>>=0,t===0?32:31-(mN(t)/gN|0)|0}var nu=64,ru=4194304;function ua(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Ku(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,s=t.suspendedLanes,i=t.pingedLanes,o=n&268435455;if(o!==0){var l=o&~s;l!==0?r=ua(l):(i&=o,i!==0&&(r=ua(i)))}else o=n&~s,o!==0?r=ua(o):i!==0&&(r=ua(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-Kn(e),s=1<<n,r|=t[n],e&=~s;return r}function vN(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function _N(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,i=t.pendingLanes;0<i;){var o=31-Kn(i),l=1<<o,u=s[o];u===-1?(!(l&n)||l&r)&&(s[o]=vN(l,e)):u<=e&&(t.expiredLanes|=l),i&=~l}}function rf(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function ax(){var t=nu;return nu<<=1,!(nu&4194240)&&(nu=64),t}function Xd(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function dl(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Kn(e),t[e]=n}function wN(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-Kn(n),i=1<<s;e[s]=0,r[s]=-1,t[s]=-1,n&=~i}}function Ap(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-Kn(n),s=1<<r;s&e|t[r]&e&&(t[r]|=e),n&=~s}}var Le=0;function lx(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var ux,Cp,cx,dx,hx,sf=!1,su=[],vs=null,_s=null,ws=null,Oa=new Map,La=new Map,ls=[],xN="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Sy(t,e){switch(t){case"focusin":case"focusout":vs=null;break;case"dragenter":case"dragleave":_s=null;break;case"mouseover":case"mouseout":ws=null;break;case"pointerover":case"pointerout":Oa.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":La.delete(e.pointerId)}}function ta(t,e,n,r,s,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},e!==null&&(e=fl(e),e!==null&&Cp(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function EN(t,e,n,r,s){switch(e){case"focusin":return vs=ta(vs,t,e,n,r,s),!0;case"dragenter":return _s=ta(_s,t,e,n,r,s),!0;case"mouseover":return ws=ta(ws,t,e,n,r,s),!0;case"pointerover":var i=s.pointerId;return Oa.set(i,ta(Oa.get(i)||null,t,e,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,La.set(i,ta(La.get(i)||null,t,e,n,r,s)),!0}return!1}function fx(t){var e=ei(t.target);if(e!==null){var n=Ei(e);if(n!==null){if(e=n.tag,e===13){if(e=tx(n),e!==null){t.blockedOn=e,hx(t.priority,function(){cx(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Su(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=of(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);Zh=r,n.target.dispatchEvent(r),Zh=null}else return e=fl(n),e!==null&&Cp(e),t.blockedOn=n,!1;e.shift()}return!0}function Ny(t,e,n){Su(t)&&n.delete(e)}function TN(){sf=!1,vs!==null&&Su(vs)&&(vs=null),_s!==null&&Su(_s)&&(_s=null),ws!==null&&Su(ws)&&(ws=null),Oa.forEach(Ny),La.forEach(Ny)}function na(t,e){t.blockedOn===e&&(t.blockedOn=null,sf||(sf=!0,En.unstable_scheduleCallback(En.unstable_NormalPriority,TN)))}function Va(t){function e(s){return na(s,t)}if(0<su.length){na(su[0],t);for(var n=1;n<su.length;n++){var r=su[n];r.blockedOn===t&&(r.blockedOn=null)}}for(vs!==null&&na(vs,t),_s!==null&&na(_s,t),ws!==null&&na(ws,t),Oa.forEach(e),La.forEach(e),n=0;n<ls.length;n++)r=ls[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<ls.length&&(n=ls[0],n.blockedOn===null);)fx(n),n.blockedOn===null&&ls.shift()}var oo=Gr.ReactCurrentBatchConfig,Qu=!0;function IN(t,e,n,r){var s=Le,i=oo.transition;oo.transition=null;try{Le=1,kp(t,e,n,r)}finally{Le=s,oo.transition=i}}function SN(t,e,n,r){var s=Le,i=oo.transition;oo.transition=null;try{Le=4,kp(t,e,n,r)}finally{Le=s,oo.transition=i}}function kp(t,e,n,r){if(Qu){var s=of(t,e,n,r);if(s===null)lh(t,e,r,Yu,n),Sy(t,r);else if(EN(s,t,e,n,r))r.stopPropagation();else if(Sy(t,r),e&4&&-1<xN.indexOf(t)){for(;s!==null;){var i=fl(s);if(i!==null&&ux(i),i=of(t,e,n,r),i===null&&lh(t,e,r,Yu,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else lh(t,e,r,null,n)}}var Yu=null;function of(t,e,n,r){if(Yu=null,t=Np(r),t=ei(t),t!==null)if(e=Ei(t),e===null)t=null;else if(n=e.tag,n===13){if(t=tx(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Yu=t,null}function px(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(hN()){case bp:return 1;case ix:return 4;case Gu:case fN:return 16;case ox:return 536870912;default:return 16}default:return 16}}var ps=null,Rp=null,Nu=null;function mx(){if(Nu)return Nu;var t,e=Rp,n=e.length,r,s="value"in ps?ps.value:ps.textContent,i=s.length;for(t=0;t<n&&e[t]===s[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===s[i-r];r++);return Nu=s.slice(t,1<r?1-r:void 0)}function bu(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function iu(){return!0}function by(){return!1}function Sn(t){function e(n,r,s,i,o){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(n=t[l],this[l]=n?n(i):i[l]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?iu:by,this.isPropagationStopped=by,this}return rt(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=iu)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=iu)},persist:function(){},isPersistent:iu}),e}var Ro={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Pp=Sn(Ro),hl=rt({},Ro,{view:0,detail:0}),NN=Sn(hl),Zd,eh,ra,$c=rt({},hl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:jp,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==ra&&(ra&&t.type==="mousemove"?(Zd=t.screenX-ra.screenX,eh=t.screenY-ra.screenY):eh=Zd=0,ra=t),Zd)},movementY:function(t){return"movementY"in t?t.movementY:eh}}),Ay=Sn($c),bN=rt({},$c,{dataTransfer:0}),AN=Sn(bN),CN=rt({},hl,{relatedTarget:0}),th=Sn(CN),kN=rt({},Ro,{animationName:0,elapsedTime:0,pseudoElement:0}),RN=Sn(kN),PN=rt({},Ro,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),jN=Sn(PN),DN=rt({},Ro,{data:0}),Cy=Sn(DN),ON={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},LN={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},VN={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function MN(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=VN[t])?!!e[t]:!1}function jp(){return MN}var UN=rt({},hl,{key:function(t){if(t.key){var e=ON[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=bu(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?LN[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:jp,charCode:function(t){return t.type==="keypress"?bu(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?bu(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),FN=Sn(UN),$N=rt({},$c,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ky=Sn($N),BN=rt({},hl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:jp}),zN=Sn(BN),qN=rt({},Ro,{propertyName:0,elapsedTime:0,pseudoElement:0}),WN=Sn(qN),HN=rt({},$c,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),GN=Sn(HN),KN=[9,13,27,32],Dp=Ur&&"CompositionEvent"in window,va=null;Ur&&"documentMode"in document&&(va=document.documentMode);var QN=Ur&&"TextEvent"in window&&!va,gx=Ur&&(!Dp||va&&8<va&&11>=va),Ry=" ",Py=!1;function yx(t,e){switch(t){case"keyup":return KN.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function vx(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Wi=!1;function YN(t,e){switch(t){case"compositionend":return vx(e);case"keypress":return e.which!==32?null:(Py=!0,Ry);case"textInput":return t=e.data,t===Ry&&Py?null:t;default:return null}}function JN(t,e){if(Wi)return t==="compositionend"||!Dp&&yx(t,e)?(t=mx(),Nu=Rp=ps=null,Wi=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return gx&&e.locale!=="ko"?null:e.data;default:return null}}var XN={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function jy(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!XN[t.type]:e==="textarea"}function _x(t,e,n,r){Yw(r),e=Ju(e,"onChange"),0<e.length&&(n=new Pp("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var _a=null,Ma=null;function ZN(t){kx(t,0)}function Bc(t){var e=Ki(t);if(zw(e))return t}function eb(t,e){if(t==="change")return e}var wx=!1;if(Ur){var nh;if(Ur){var rh="oninput"in document;if(!rh){var Dy=document.createElement("div");Dy.setAttribute("oninput","return;"),rh=typeof Dy.oninput=="function"}nh=rh}else nh=!1;wx=nh&&(!document.documentMode||9<document.documentMode)}function Oy(){_a&&(_a.detachEvent("onpropertychange",xx),Ma=_a=null)}function xx(t){if(t.propertyName==="value"&&Bc(Ma)){var e=[];_x(e,Ma,t,Np(t)),ex(ZN,e)}}function tb(t,e,n){t==="focusin"?(Oy(),_a=e,Ma=n,_a.attachEvent("onpropertychange",xx)):t==="focusout"&&Oy()}function nb(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Bc(Ma)}function rb(t,e){if(t==="click")return Bc(e)}function sb(t,e){if(t==="input"||t==="change")return Bc(e)}function ib(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Zn=typeof Object.is=="function"?Object.is:ib;function Ua(t,e){if(Zn(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!$h.call(e,s)||!Zn(t[s],e[s]))return!1}return!0}function Ly(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Vy(t,e){var n=Ly(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Ly(n)}}function Ex(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?Ex(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function Tx(){for(var t=window,e=qu();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=qu(t.document)}return e}function Op(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function ob(t){var e=Tx(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&Ex(n.ownerDocument.documentElement,n)){if(r!==null&&Op(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!t.extend&&i>r&&(s=r,r=i,i=s),s=Vy(n,i);var o=Vy(n,r);s&&o&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),i>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var ab=Ur&&"documentMode"in document&&11>=document.documentMode,Hi=null,af=null,wa=null,lf=!1;function My(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;lf||Hi==null||Hi!==qu(r)||(r=Hi,"selectionStart"in r&&Op(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),wa&&Ua(wa,r)||(wa=r,r=Ju(af,"onSelect"),0<r.length&&(e=new Pp("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Hi)))}function ou(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Gi={animationend:ou("Animation","AnimationEnd"),animationiteration:ou("Animation","AnimationIteration"),animationstart:ou("Animation","AnimationStart"),transitionend:ou("Transition","TransitionEnd")},sh={},Ix={};Ur&&(Ix=document.createElement("div").style,"AnimationEvent"in window||(delete Gi.animationend.animation,delete Gi.animationiteration.animation,delete Gi.animationstart.animation),"TransitionEvent"in window||delete Gi.transitionend.transition);function zc(t){if(sh[t])return sh[t];if(!Gi[t])return t;var e=Gi[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in Ix)return sh[t]=e[n];return t}var Sx=zc("animationend"),Nx=zc("animationiteration"),bx=zc("animationstart"),Ax=zc("transitionend"),Cx=new Map,Uy="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Us(t,e){Cx.set(t,e),xi(e,[t])}for(var ih=0;ih<Uy.length;ih++){var oh=Uy[ih],lb=oh.toLowerCase(),ub=oh[0].toUpperCase()+oh.slice(1);Us(lb,"on"+ub)}Us(Sx,"onAnimationEnd");Us(Nx,"onAnimationIteration");Us(bx,"onAnimationStart");Us("dblclick","onDoubleClick");Us("focusin","onFocus");Us("focusout","onBlur");Us(Ax,"onTransitionEnd");po("onMouseEnter",["mouseout","mouseover"]);po("onMouseLeave",["mouseout","mouseover"]);po("onPointerEnter",["pointerout","pointerover"]);po("onPointerLeave",["pointerout","pointerover"]);xi("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));xi("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));xi("onBeforeInput",["compositionend","keypress","textInput","paste"]);xi("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));xi("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));xi("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ca="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),cb=new Set("cancel close invalid load scroll toggle".split(" ").concat(ca));function Fy(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,lN(r,e,void 0,t),t.currentTarget=null}function kx(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],s=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var o=r.length-1;0<=o;o--){var l=r[o],u=l.instance,d=l.currentTarget;if(l=l.listener,u!==i&&s.isPropagationStopped())break e;Fy(s,l,d),i=u}else for(o=0;o<r.length;o++){if(l=r[o],u=l.instance,d=l.currentTarget,l=l.listener,u!==i&&s.isPropagationStopped())break e;Fy(s,l,d),i=u}}}if(Hu)throw t=nf,Hu=!1,nf=null,t}function We(t,e){var n=e[ff];n===void 0&&(n=e[ff]=new Set);var r=t+"__bubble";n.has(r)||(Rx(e,t,2,!1),n.add(r))}function ah(t,e,n){var r=0;e&&(r|=4),Rx(n,t,r,e)}var au="_reactListening"+Math.random().toString(36).slice(2);function Fa(t){if(!t[au]){t[au]=!0,Mw.forEach(function(n){n!=="selectionchange"&&(cb.has(n)||ah(n,!1,t),ah(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[au]||(e[au]=!0,ah("selectionchange",!1,e))}}function Rx(t,e,n,r){switch(px(e)){case 1:var s=IN;break;case 4:s=SN;break;default:s=kp}n=s.bind(null,e,n,t),s=void 0,!tf||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(e,n,{capture:!0,passive:s}):t.addEventListener(e,n,!0):s!==void 0?t.addEventListener(e,n,{passive:s}):t.addEventListener(e,n,!1)}function lh(t,e,n,r,s){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var l=r.stateNode.containerInfo;if(l===s||l.nodeType===8&&l.parentNode===s)break;if(o===4)for(o=r.return;o!==null;){var u=o.tag;if((u===3||u===4)&&(u=o.stateNode.containerInfo,u===s||u.nodeType===8&&u.parentNode===s))return;o=o.return}for(;l!==null;){if(o=ei(l),o===null)return;if(u=o.tag,u===5||u===6){r=i=o;continue e}l=l.parentNode}}r=r.return}ex(function(){var d=i,f=Np(n),p=[];e:{var m=Cx.get(t);if(m!==void 0){var y=Pp,x=t;switch(t){case"keypress":if(bu(n)===0)break e;case"keydown":case"keyup":y=FN;break;case"focusin":x="focus",y=th;break;case"focusout":x="blur",y=th;break;case"beforeblur":case"afterblur":y=th;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":y=Ay;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":y=AN;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":y=zN;break;case Sx:case Nx:case bx:y=RN;break;case Ax:y=WN;break;case"scroll":y=NN;break;case"wheel":y=GN;break;case"copy":case"cut":case"paste":y=jN;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":y=ky}var A=(e&4)!==0,b=!A&&t==="scroll",E=A?m!==null?m+"Capture":null:m;A=[];for(var v=d,w;v!==null;){w=v;var R=w.stateNode;if(w.tag===5&&R!==null&&(w=R,E!==null&&(R=Da(v,E),R!=null&&A.push($a(v,R,w)))),b)break;v=v.return}0<A.length&&(m=new y(m,x,null,n,f),p.push({event:m,listeners:A}))}}if(!(e&7)){e:{if(m=t==="mouseover"||t==="pointerover",y=t==="mouseout"||t==="pointerout",m&&n!==Zh&&(x=n.relatedTarget||n.fromElement)&&(ei(x)||x[Fr]))break e;if((y||m)&&(m=f.window===f?f:(m=f.ownerDocument)?m.defaultView||m.parentWindow:window,y?(x=n.relatedTarget||n.toElement,y=d,x=x?ei(x):null,x!==null&&(b=Ei(x),x!==b||x.tag!==5&&x.tag!==6)&&(x=null)):(y=null,x=d),y!==x)){if(A=Ay,R="onMouseLeave",E="onMouseEnter",v="mouse",(t==="pointerout"||t==="pointerover")&&(A=ky,R="onPointerLeave",E="onPointerEnter",v="pointer"),b=y==null?m:Ki(y),w=x==null?m:Ki(x),m=new A(R,v+"leave",y,n,f),m.target=b,m.relatedTarget=w,R=null,ei(f)===d&&(A=new A(E,v+"enter",x,n,f),A.target=w,A.relatedTarget=b,R=A),b=R,y&&x)t:{for(A=y,E=x,v=0,w=A;w;w=Ui(w))v++;for(w=0,R=E;R;R=Ui(R))w++;for(;0<v-w;)A=Ui(A),v--;for(;0<w-v;)E=Ui(E),w--;for(;v--;){if(A===E||E!==null&&A===E.alternate)break t;A=Ui(A),E=Ui(E)}A=null}else A=null;y!==null&&$y(p,m,y,A,!1),x!==null&&b!==null&&$y(p,b,x,A,!0)}}e:{if(m=d?Ki(d):window,y=m.nodeName&&m.nodeName.toLowerCase(),y==="select"||y==="input"&&m.type==="file")var D=eb;else if(jy(m))if(wx)D=sb;else{D=nb;var L=tb}else(y=m.nodeName)&&y.toLowerCase()==="input"&&(m.type==="checkbox"||m.type==="radio")&&(D=rb);if(D&&(D=D(t,d))){_x(p,D,n,f);break e}L&&L(t,m,d),t==="focusout"&&(L=m._wrapperState)&&L.controlled&&m.type==="number"&&Kh(m,"number",m.value)}switch(L=d?Ki(d):window,t){case"focusin":(jy(L)||L.contentEditable==="true")&&(Hi=L,af=d,wa=null);break;case"focusout":wa=af=Hi=null;break;case"mousedown":lf=!0;break;case"contextmenu":case"mouseup":case"dragend":lf=!1,My(p,n,f);break;case"selectionchange":if(ab)break;case"keydown":case"keyup":My(p,n,f)}var S;if(Dp)e:{switch(t){case"compositionstart":var _="onCompositionStart";break e;case"compositionend":_="onCompositionEnd";break e;case"compositionupdate":_="onCompositionUpdate";break e}_=void 0}else Wi?yx(t,n)&&(_="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(_="onCompositionStart");_&&(gx&&n.locale!=="ko"&&(Wi||_!=="onCompositionStart"?_==="onCompositionEnd"&&Wi&&(S=mx()):(ps=f,Rp="value"in ps?ps.value:ps.textContent,Wi=!0)),L=Ju(d,_),0<L.length&&(_=new Cy(_,t,null,n,f),p.push({event:_,listeners:L}),S?_.data=S:(S=vx(n),S!==null&&(_.data=S)))),(S=QN?YN(t,n):JN(t,n))&&(d=Ju(d,"onBeforeInput"),0<d.length&&(f=new Cy("onBeforeInput","beforeinput",null,n,f),p.push({event:f,listeners:d}),f.data=S))}kx(p,e)})}function $a(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Ju(t,e){for(var n=e+"Capture",r=[];t!==null;){var s=t,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=Da(t,n),i!=null&&r.unshift($a(t,i,s)),i=Da(t,e),i!=null&&r.push($a(t,i,s))),t=t.return}return r}function Ui(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function $y(t,e,n,r,s){for(var i=e._reactName,o=[];n!==null&&n!==r;){var l=n,u=l.alternate,d=l.stateNode;if(u!==null&&u===r)break;l.tag===5&&d!==null&&(l=d,s?(u=Da(n,i),u!=null&&o.unshift($a(n,u,l))):s||(u=Da(n,i),u!=null&&o.push($a(n,u,l)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var db=/\r\n?/g,hb=/\u0000|\uFFFD/g;function By(t){return(typeof t=="string"?t:""+t).replace(db,`
`).replace(hb,"")}function lu(t,e,n){if(e=By(e),By(t)!==e&&n)throw Error(q(425))}function Xu(){}var uf=null,cf=null;function df(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var hf=typeof setTimeout=="function"?setTimeout:void 0,fb=typeof clearTimeout=="function"?clearTimeout:void 0,zy=typeof Promise=="function"?Promise:void 0,pb=typeof queueMicrotask=="function"?queueMicrotask:typeof zy<"u"?function(t){return zy.resolve(null).then(t).catch(mb)}:hf;function mb(t){setTimeout(function(){throw t})}function uh(t,e){var n=e,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){t.removeChild(s),Va(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);Va(e)}function xs(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function qy(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Po=Math.random().toString(36).slice(2),cr="__reactFiber$"+Po,Ba="__reactProps$"+Po,Fr="__reactContainer$"+Po,ff="__reactEvents$"+Po,gb="__reactListeners$"+Po,yb="__reactHandles$"+Po;function ei(t){var e=t[cr];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Fr]||n[cr]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=qy(t);t!==null;){if(n=t[cr])return n;t=qy(t)}return e}t=n,n=t.parentNode}return null}function fl(t){return t=t[cr]||t[Fr],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Ki(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(q(33))}function qc(t){return t[Ba]||null}var pf=[],Qi=-1;function Fs(t){return{current:t}}function He(t){0>Qi||(t.current=pf[Qi],pf[Qi]=null,Qi--)}function Be(t,e){Qi++,pf[Qi]=t.current,t.current=e}var Ps={},Kt=Fs(Ps),hn=Fs(!1),li=Ps;function mo(t,e){var n=t.type.contextTypes;if(!n)return Ps;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=e[i];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function fn(t){return t=t.childContextTypes,t!=null}function Zu(){He(hn),He(Kt)}function Wy(t,e,n){if(Kt.current!==Ps)throw Error(q(168));Be(Kt,e),Be(hn,n)}function Px(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(q(108,tN(t)||"Unknown",s));return rt({},n,r)}function ec(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Ps,li=Kt.current,Be(Kt,t),Be(hn,hn.current),!0}function Hy(t,e,n){var r=t.stateNode;if(!r)throw Error(q(169));n?(t=Px(t,e,li),r.__reactInternalMemoizedMergedChildContext=t,He(hn),He(Kt),Be(Kt,t)):He(hn),Be(hn,n)}var Cr=null,Wc=!1,ch=!1;function jx(t){Cr===null?Cr=[t]:Cr.push(t)}function vb(t){Wc=!0,jx(t)}function $s(){if(!ch&&Cr!==null){ch=!0;var t=0,e=Le;try{var n=Cr;for(Le=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}Cr=null,Wc=!1}catch(s){throw Cr!==null&&(Cr=Cr.slice(t+1)),sx(bp,$s),s}finally{Le=e,ch=!1}}return null}var Yi=[],Ji=0,tc=null,nc=0,bn=[],An=0,ui=null,kr=1,Rr="";function Js(t,e){Yi[Ji++]=nc,Yi[Ji++]=tc,tc=t,nc=e}function Dx(t,e,n){bn[An++]=kr,bn[An++]=Rr,bn[An++]=ui,ui=t;var r=kr;t=Rr;var s=32-Kn(r)-1;r&=~(1<<s),n+=1;var i=32-Kn(e)+s;if(30<i){var o=s-s%5;i=(r&(1<<o)-1).toString(32),r>>=o,s-=o,kr=1<<32-Kn(e)+s|n<<s|r,Rr=i+t}else kr=1<<i|n<<s|r,Rr=t}function Lp(t){t.return!==null&&(Js(t,1),Dx(t,1,0))}function Vp(t){for(;t===tc;)tc=Yi[--Ji],Yi[Ji]=null,nc=Yi[--Ji],Yi[Ji]=null;for(;t===ui;)ui=bn[--An],bn[An]=null,Rr=bn[--An],bn[An]=null,kr=bn[--An],bn[An]=null}var xn=null,_n=null,Qe=!1,Hn=null;function Ox(t,e){var n=kn(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function Gy(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,xn=t,_n=xs(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,xn=t,_n=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=ui!==null?{id:kr,overflow:Rr}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=kn(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,xn=t,_n=null,!0):!1;default:return!1}}function mf(t){return(t.mode&1)!==0&&(t.flags&128)===0}function gf(t){if(Qe){var e=_n;if(e){var n=e;if(!Gy(t,e)){if(mf(t))throw Error(q(418));e=xs(n.nextSibling);var r=xn;e&&Gy(t,e)?Ox(r,n):(t.flags=t.flags&-4097|2,Qe=!1,xn=t)}}else{if(mf(t))throw Error(q(418));t.flags=t.flags&-4097|2,Qe=!1,xn=t}}}function Ky(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;xn=t}function uu(t){if(t!==xn)return!1;if(!Qe)return Ky(t),Qe=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!df(t.type,t.memoizedProps)),e&&(e=_n)){if(mf(t))throw Lx(),Error(q(418));for(;e;)Ox(t,e),e=xs(e.nextSibling)}if(Ky(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(q(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){_n=xs(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}_n=null}}else _n=xn?xs(t.stateNode.nextSibling):null;return!0}function Lx(){for(var t=_n;t;)t=xs(t.nextSibling)}function go(){_n=xn=null,Qe=!1}function Mp(t){Hn===null?Hn=[t]:Hn.push(t)}var _b=Gr.ReactCurrentBatchConfig;function sa(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(q(309));var r=n.stateNode}if(!r)throw Error(q(147,t));var s=r,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var l=s.refs;o===null?delete l[i]:l[i]=o},e._stringRef=i,e)}if(typeof t!="string")throw Error(q(284));if(!n._owner)throw Error(q(290,t))}return t}function cu(t,e){throw t=Object.prototype.toString.call(e),Error(q(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function Qy(t){var e=t._init;return e(t._payload)}function Vx(t){function e(E,v){if(t){var w=E.deletions;w===null?(E.deletions=[v],E.flags|=16):w.push(v)}}function n(E,v){if(!t)return null;for(;v!==null;)e(E,v),v=v.sibling;return null}function r(E,v){for(E=new Map;v!==null;)v.key!==null?E.set(v.key,v):E.set(v.index,v),v=v.sibling;return E}function s(E,v){return E=Ss(E,v),E.index=0,E.sibling=null,E}function i(E,v,w){return E.index=w,t?(w=E.alternate,w!==null?(w=w.index,w<v?(E.flags|=2,v):w):(E.flags|=2,v)):(E.flags|=1048576,v)}function o(E){return t&&E.alternate===null&&(E.flags|=2),E}function l(E,v,w,R){return v===null||v.tag!==6?(v=yh(w,E.mode,R),v.return=E,v):(v=s(v,w),v.return=E,v)}function u(E,v,w,R){var D=w.type;return D===qi?f(E,v,w.props.children,R,w.key):v!==null&&(v.elementType===D||typeof D=="object"&&D!==null&&D.$$typeof===os&&Qy(D)===v.type)?(R=s(v,w.props),R.ref=sa(E,v,w),R.return=E,R):(R=Du(w.type,w.key,w.props,null,E.mode,R),R.ref=sa(E,v,w),R.return=E,R)}function d(E,v,w,R){return v===null||v.tag!==4||v.stateNode.containerInfo!==w.containerInfo||v.stateNode.implementation!==w.implementation?(v=vh(w,E.mode,R),v.return=E,v):(v=s(v,w.children||[]),v.return=E,v)}function f(E,v,w,R,D){return v===null||v.tag!==7?(v=ai(w,E.mode,R,D),v.return=E,v):(v=s(v,w),v.return=E,v)}function p(E,v,w){if(typeof v=="string"&&v!==""||typeof v=="number")return v=yh(""+v,E.mode,w),v.return=E,v;if(typeof v=="object"&&v!==null){switch(v.$$typeof){case Zl:return w=Du(v.type,v.key,v.props,null,E.mode,w),w.ref=sa(E,null,v),w.return=E,w;case zi:return v=vh(v,E.mode,w),v.return=E,v;case os:var R=v._init;return p(E,R(v._payload),w)}if(la(v)||Zo(v))return v=ai(v,E.mode,w,null),v.return=E,v;cu(E,v)}return null}function m(E,v,w,R){var D=v!==null?v.key:null;if(typeof w=="string"&&w!==""||typeof w=="number")return D!==null?null:l(E,v,""+w,R);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Zl:return w.key===D?u(E,v,w,R):null;case zi:return w.key===D?d(E,v,w,R):null;case os:return D=w._init,m(E,v,D(w._payload),R)}if(la(w)||Zo(w))return D!==null?null:f(E,v,w,R,null);cu(E,w)}return null}function y(E,v,w,R,D){if(typeof R=="string"&&R!==""||typeof R=="number")return E=E.get(w)||null,l(v,E,""+R,D);if(typeof R=="object"&&R!==null){switch(R.$$typeof){case Zl:return E=E.get(R.key===null?w:R.key)||null,u(v,E,R,D);case zi:return E=E.get(R.key===null?w:R.key)||null,d(v,E,R,D);case os:var L=R._init;return y(E,v,w,L(R._payload),D)}if(la(R)||Zo(R))return E=E.get(w)||null,f(v,E,R,D,null);cu(v,R)}return null}function x(E,v,w,R){for(var D=null,L=null,S=v,_=v=0,I=null;S!==null&&_<w.length;_++){S.index>_?(I=S,S=null):I=S.sibling;var N=m(E,S,w[_],R);if(N===null){S===null&&(S=I);break}t&&S&&N.alternate===null&&e(E,S),v=i(N,v,_),L===null?D=N:L.sibling=N,L=N,S=I}if(_===w.length)return n(E,S),Qe&&Js(E,_),D;if(S===null){for(;_<w.length;_++)S=p(E,w[_],R),S!==null&&(v=i(S,v,_),L===null?D=S:L.sibling=S,L=S);return Qe&&Js(E,_),D}for(S=r(E,S);_<w.length;_++)I=y(S,E,_,w[_],R),I!==null&&(t&&I.alternate!==null&&S.delete(I.key===null?_:I.key),v=i(I,v,_),L===null?D=I:L.sibling=I,L=I);return t&&S.forEach(function(P){return e(E,P)}),Qe&&Js(E,_),D}function A(E,v,w,R){var D=Zo(w);if(typeof D!="function")throw Error(q(150));if(w=D.call(w),w==null)throw Error(q(151));for(var L=D=null,S=v,_=v=0,I=null,N=w.next();S!==null&&!N.done;_++,N=w.next()){S.index>_?(I=S,S=null):I=S.sibling;var P=m(E,S,N.value,R);if(P===null){S===null&&(S=I);break}t&&S&&P.alternate===null&&e(E,S),v=i(P,v,_),L===null?D=P:L.sibling=P,L=P,S=I}if(N.done)return n(E,S),Qe&&Js(E,_),D;if(S===null){for(;!N.done;_++,N=w.next())N=p(E,N.value,R),N!==null&&(v=i(N,v,_),L===null?D=N:L.sibling=N,L=N);return Qe&&Js(E,_),D}for(S=r(E,S);!N.done;_++,N=w.next())N=y(S,E,_,N.value,R),N!==null&&(t&&N.alternate!==null&&S.delete(N.key===null?_:N.key),v=i(N,v,_),L===null?D=N:L.sibling=N,L=N);return t&&S.forEach(function(j){return e(E,j)}),Qe&&Js(E,_),D}function b(E,v,w,R){if(typeof w=="object"&&w!==null&&w.type===qi&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case Zl:e:{for(var D=w.key,L=v;L!==null;){if(L.key===D){if(D=w.type,D===qi){if(L.tag===7){n(E,L.sibling),v=s(L,w.props.children),v.return=E,E=v;break e}}else if(L.elementType===D||typeof D=="object"&&D!==null&&D.$$typeof===os&&Qy(D)===L.type){n(E,L.sibling),v=s(L,w.props),v.ref=sa(E,L,w),v.return=E,E=v;break e}n(E,L);break}else e(E,L);L=L.sibling}w.type===qi?(v=ai(w.props.children,E.mode,R,w.key),v.return=E,E=v):(R=Du(w.type,w.key,w.props,null,E.mode,R),R.ref=sa(E,v,w),R.return=E,E=R)}return o(E);case zi:e:{for(L=w.key;v!==null;){if(v.key===L)if(v.tag===4&&v.stateNode.containerInfo===w.containerInfo&&v.stateNode.implementation===w.implementation){n(E,v.sibling),v=s(v,w.children||[]),v.return=E,E=v;break e}else{n(E,v);break}else e(E,v);v=v.sibling}v=vh(w,E.mode,R),v.return=E,E=v}return o(E);case os:return L=w._init,b(E,v,L(w._payload),R)}if(la(w))return x(E,v,w,R);if(Zo(w))return A(E,v,w,R);cu(E,w)}return typeof w=="string"&&w!==""||typeof w=="number"?(w=""+w,v!==null&&v.tag===6?(n(E,v.sibling),v=s(v,w),v.return=E,E=v):(n(E,v),v=yh(w,E.mode,R),v.return=E,E=v),o(E)):n(E,v)}return b}var yo=Vx(!0),Mx=Vx(!1),rc=Fs(null),sc=null,Xi=null,Up=null;function Fp(){Up=Xi=sc=null}function $p(t){var e=rc.current;He(rc),t._currentValue=e}function yf(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function ao(t,e){sc=t,Up=Xi=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(un=!0),t.firstContext=null)}function Pn(t){var e=t._currentValue;if(Up!==t)if(t={context:t,memoizedValue:e,next:null},Xi===null){if(sc===null)throw Error(q(308));Xi=t,sc.dependencies={lanes:0,firstContext:t}}else Xi=Xi.next=t;return e}var ti=null;function Bp(t){ti===null?ti=[t]:ti.push(t)}function Ux(t,e,n,r){var s=e.interleaved;return s===null?(n.next=n,Bp(e)):(n.next=s.next,s.next=n),e.interleaved=n,$r(t,r)}function $r(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var as=!1;function zp(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Fx(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Or(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Es(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,Ae&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,$r(t,n)}return s=r.interleaved,s===null?(e.next=e,Bp(r)):(e.next=s.next,s.next=e),r.interleaved=e,$r(t,n)}function Au(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Ap(t,n)}}function Yy(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=o:i=i.next=o,n=n.next}while(n!==null);i===null?s=i=e:i=i.next=e}else s=i=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function ic(t,e,n,r){var s=t.updateQueue;as=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,l=s.shared.pending;if(l!==null){s.shared.pending=null;var u=l,d=u.next;u.next=null,o===null?i=d:o.next=d,o=u;var f=t.alternate;f!==null&&(f=f.updateQueue,l=f.lastBaseUpdate,l!==o&&(l===null?f.firstBaseUpdate=d:l.next=d,f.lastBaseUpdate=u))}if(i!==null){var p=s.baseState;o=0,f=d=u=null,l=i;do{var m=l.lane,y=l.eventTime;if((r&m)===m){f!==null&&(f=f.next={eventTime:y,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var x=t,A=l;switch(m=e,y=n,A.tag){case 1:if(x=A.payload,typeof x=="function"){p=x.call(y,p,m);break e}p=x;break e;case 3:x.flags=x.flags&-65537|128;case 0:if(x=A.payload,m=typeof x=="function"?x.call(y,p,m):x,m==null)break e;p=rt({},p,m);break e;case 2:as=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,m=s.effects,m===null?s.effects=[l]:m.push(l))}else y={eventTime:y,lane:m,tag:l.tag,payload:l.payload,callback:l.callback,next:null},f===null?(d=f=y,u=p):f=f.next=y,o|=m;if(l=l.next,l===null){if(l=s.shared.pending,l===null)break;m=l,l=m.next,m.next=null,s.lastBaseUpdate=m,s.shared.pending=null}}while(!0);if(f===null&&(u=p),s.baseState=u,s.firstBaseUpdate=d,s.lastBaseUpdate=f,e=s.shared.interleaved,e!==null){s=e;do o|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);di|=o,t.lanes=o,t.memoizedState=p}}function Jy(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(q(191,s));s.call(r)}}}var pl={},hr=Fs(pl),za=Fs(pl),qa=Fs(pl);function ni(t){if(t===pl)throw Error(q(174));return t}function qp(t,e){switch(Be(qa,e),Be(za,t),Be(hr,pl),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Yh(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Yh(e,t)}He(hr),Be(hr,e)}function vo(){He(hr),He(za),He(qa)}function $x(t){ni(qa.current);var e=ni(hr.current),n=Yh(e,t.type);e!==n&&(Be(za,t),Be(hr,n))}function Wp(t){za.current===t&&(He(hr),He(za))}var Xe=Fs(0);function oc(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var dh=[];function Hp(){for(var t=0;t<dh.length;t++)dh[t]._workInProgressVersionPrimary=null;dh.length=0}var Cu=Gr.ReactCurrentDispatcher,hh=Gr.ReactCurrentBatchConfig,ci=0,tt=null,vt=null,bt=null,ac=!1,xa=!1,Wa=0,wb=0;function $t(){throw Error(q(321))}function Gp(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Zn(t[n],e[n]))return!1;return!0}function Kp(t,e,n,r,s,i){if(ci=i,tt=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Cu.current=t===null||t.memoizedState===null?Ib:Sb,t=n(r,s),xa){i=0;do{if(xa=!1,Wa=0,25<=i)throw Error(q(301));i+=1,bt=vt=null,e.updateQueue=null,Cu.current=Nb,t=n(r,s)}while(xa)}if(Cu.current=lc,e=vt!==null&&vt.next!==null,ci=0,bt=vt=tt=null,ac=!1,e)throw Error(q(300));return t}function Qp(){var t=Wa!==0;return Wa=0,t}function lr(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return bt===null?tt.memoizedState=bt=t:bt=bt.next=t,bt}function jn(){if(vt===null){var t=tt.alternate;t=t!==null?t.memoizedState:null}else t=vt.next;var e=bt===null?tt.memoizedState:bt.next;if(e!==null)bt=e,vt=t;else{if(t===null)throw Error(q(310));vt=t,t={memoizedState:vt.memoizedState,baseState:vt.baseState,baseQueue:vt.baseQueue,queue:vt.queue,next:null},bt===null?tt.memoizedState=bt=t:bt=bt.next=t}return bt}function Ha(t,e){return typeof e=="function"?e(t):e}function fh(t){var e=jn(),n=e.queue;if(n===null)throw Error(q(311));n.lastRenderedReducer=t;var r=vt,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var l=o=null,u=null,d=i;do{var f=d.lane;if((ci&f)===f)u!==null&&(u=u.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),r=d.hasEagerState?d.eagerState:t(r,d.action);else{var p={lane:f,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};u===null?(l=u=p,o=r):u=u.next=p,tt.lanes|=f,di|=f}d=d.next}while(d!==null&&d!==i);u===null?o=r:u.next=l,Zn(r,e.memoizedState)||(un=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=u,n.lastRenderedState=r}if(t=n.interleaved,t!==null){s=t;do i=s.lane,tt.lanes|=i,di|=i,s=s.next;while(s!==t)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function ph(t){var e=jn(),n=e.queue;if(n===null)throw Error(q(311));n.lastRenderedReducer=t;var r=n.dispatch,s=n.pending,i=e.memoizedState;if(s!==null){n.pending=null;var o=s=s.next;do i=t(i,o.action),o=o.next;while(o!==s);Zn(i,e.memoizedState)||(un=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,r]}function Bx(){}function zx(t,e){var n=tt,r=jn(),s=e(),i=!Zn(r.memoizedState,s);if(i&&(r.memoizedState=s,un=!0),r=r.queue,Yp(Hx.bind(null,n,r,t),[t]),r.getSnapshot!==e||i||bt!==null&&bt.memoizedState.tag&1){if(n.flags|=2048,Ga(9,Wx.bind(null,n,r,s,e),void 0,null),Ct===null)throw Error(q(349));ci&30||qx(n,e,s)}return s}function qx(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=tt.updateQueue,e===null?(e={lastEffect:null,stores:null},tt.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function Wx(t,e,n,r){e.value=n,e.getSnapshot=r,Gx(e)&&Kx(t)}function Hx(t,e,n){return n(function(){Gx(e)&&Kx(t)})}function Gx(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Zn(t,n)}catch{return!0}}function Kx(t){var e=$r(t,1);e!==null&&Qn(e,t,1,-1)}function Xy(t){var e=lr();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ha,lastRenderedState:t},e.queue=t,t=t.dispatch=Tb.bind(null,tt,t),[e.memoizedState,t]}function Ga(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=tt.updateQueue,e===null?(e={lastEffect:null,stores:null},tt.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function Qx(){return jn().memoizedState}function ku(t,e,n,r){var s=lr();tt.flags|=t,s.memoizedState=Ga(1|e,n,void 0,r===void 0?null:r)}function Hc(t,e,n,r){var s=jn();r=r===void 0?null:r;var i=void 0;if(vt!==null){var o=vt.memoizedState;if(i=o.destroy,r!==null&&Gp(r,o.deps)){s.memoizedState=Ga(e,n,i,r);return}}tt.flags|=t,s.memoizedState=Ga(1|e,n,i,r)}function Zy(t,e){return ku(8390656,8,t,e)}function Yp(t,e){return Hc(2048,8,t,e)}function Yx(t,e){return Hc(4,2,t,e)}function Jx(t,e){return Hc(4,4,t,e)}function Xx(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function Zx(t,e,n){return n=n!=null?n.concat([t]):null,Hc(4,4,Xx.bind(null,e,t),n)}function Jp(){}function e0(t,e){var n=jn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Gp(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function t0(t,e){var n=jn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Gp(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function n0(t,e,n){return ci&21?(Zn(n,e)||(n=ax(),tt.lanes|=n,di|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,un=!0),t.memoizedState=n)}function xb(t,e){var n=Le;Le=n!==0&&4>n?n:4,t(!0);var r=hh.transition;hh.transition={};try{t(!1),e()}finally{Le=n,hh.transition=r}}function r0(){return jn().memoizedState}function Eb(t,e,n){var r=Is(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},s0(t))i0(e,n);else if(n=Ux(t,e,n,r),n!==null){var s=Zt();Qn(n,t,r,s),o0(n,e,r)}}function Tb(t,e,n){var r=Is(t),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(s0(t))i0(e,s);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,l=i(o,n);if(s.hasEagerState=!0,s.eagerState=l,Zn(l,o)){var u=e.interleaved;u===null?(s.next=s,Bp(e)):(s.next=u.next,u.next=s),e.interleaved=s;return}}catch{}finally{}n=Ux(t,e,s,r),n!==null&&(s=Zt(),Qn(n,t,r,s),o0(n,e,r))}}function s0(t){var e=t.alternate;return t===tt||e!==null&&e===tt}function i0(t,e){xa=ac=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function o0(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Ap(t,n)}}var lc={readContext:Pn,useCallback:$t,useContext:$t,useEffect:$t,useImperativeHandle:$t,useInsertionEffect:$t,useLayoutEffect:$t,useMemo:$t,useReducer:$t,useRef:$t,useState:$t,useDebugValue:$t,useDeferredValue:$t,useTransition:$t,useMutableSource:$t,useSyncExternalStore:$t,useId:$t,unstable_isNewReconciler:!1},Ib={readContext:Pn,useCallback:function(t,e){return lr().memoizedState=[t,e===void 0?null:e],t},useContext:Pn,useEffect:Zy,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,ku(4194308,4,Xx.bind(null,e,t),n)},useLayoutEffect:function(t,e){return ku(4194308,4,t,e)},useInsertionEffect:function(t,e){return ku(4,2,t,e)},useMemo:function(t,e){var n=lr();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=lr();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=Eb.bind(null,tt,t),[r.memoizedState,t]},useRef:function(t){var e=lr();return t={current:t},e.memoizedState=t},useState:Xy,useDebugValue:Jp,useDeferredValue:function(t){return lr().memoizedState=t},useTransition:function(){var t=Xy(!1),e=t[0];return t=xb.bind(null,t[1]),lr().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=tt,s=lr();if(Qe){if(n===void 0)throw Error(q(407));n=n()}else{if(n=e(),Ct===null)throw Error(q(349));ci&30||qx(r,e,n)}s.memoizedState=n;var i={value:n,getSnapshot:e};return s.queue=i,Zy(Hx.bind(null,r,i,t),[t]),r.flags|=2048,Ga(9,Wx.bind(null,r,i,n,e),void 0,null),n},useId:function(){var t=lr(),e=Ct.identifierPrefix;if(Qe){var n=Rr,r=kr;n=(r&~(1<<32-Kn(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Wa++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=wb++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},Sb={readContext:Pn,useCallback:e0,useContext:Pn,useEffect:Yp,useImperativeHandle:Zx,useInsertionEffect:Yx,useLayoutEffect:Jx,useMemo:t0,useReducer:fh,useRef:Qx,useState:function(){return fh(Ha)},useDebugValue:Jp,useDeferredValue:function(t){var e=jn();return n0(e,vt.memoizedState,t)},useTransition:function(){var t=fh(Ha)[0],e=jn().memoizedState;return[t,e]},useMutableSource:Bx,useSyncExternalStore:zx,useId:r0,unstable_isNewReconciler:!1},Nb={readContext:Pn,useCallback:e0,useContext:Pn,useEffect:Yp,useImperativeHandle:Zx,useInsertionEffect:Yx,useLayoutEffect:Jx,useMemo:t0,useReducer:ph,useRef:Qx,useState:function(){return ph(Ha)},useDebugValue:Jp,useDeferredValue:function(t){var e=jn();return vt===null?e.memoizedState=t:n0(e,vt.memoizedState,t)},useTransition:function(){var t=ph(Ha)[0],e=jn().memoizedState;return[t,e]},useMutableSource:Bx,useSyncExternalStore:zx,useId:r0,unstable_isNewReconciler:!1};function qn(t,e){if(t&&t.defaultProps){e=rt({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function vf(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:rt({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Gc={isMounted:function(t){return(t=t._reactInternals)?Ei(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=Zt(),s=Is(t),i=Or(r,s);i.payload=e,n!=null&&(i.callback=n),e=Es(t,i,s),e!==null&&(Qn(e,t,s,r),Au(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=Zt(),s=Is(t),i=Or(r,s);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=Es(t,i,s),e!==null&&(Qn(e,t,s,r),Au(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Zt(),r=Is(t),s=Or(n,r);s.tag=2,e!=null&&(s.callback=e),e=Es(t,s,r),e!==null&&(Qn(e,t,r,n),Au(e,t,r))}};function ev(t,e,n,r,s,i,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,i,o):e.prototype&&e.prototype.isPureReactComponent?!Ua(n,r)||!Ua(s,i):!0}function a0(t,e,n){var r=!1,s=Ps,i=e.contextType;return typeof i=="object"&&i!==null?i=Pn(i):(s=fn(e)?li:Kt.current,r=e.contextTypes,i=(r=r!=null)?mo(t,s):Ps),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Gc,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=i),e}function tv(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Gc.enqueueReplaceState(e,e.state,null)}function _f(t,e,n,r){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs={},zp(t);var i=e.contextType;typeof i=="object"&&i!==null?s.context=Pn(i):(i=fn(e)?li:Kt.current,s.context=mo(t,i)),s.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(vf(t,e,i,n),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&Gc.enqueueReplaceState(s,s.state,null),ic(t,n,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function _o(t,e){try{var n="",r=e;do n+=eN(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:s,digest:null}}function mh(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function wf(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var bb=typeof WeakMap=="function"?WeakMap:Map;function l0(t,e,n){n=Or(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){cc||(cc=!0,kf=r),wf(t,e)},n}function u0(t,e,n){n=Or(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){wf(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){wf(t,e),typeof r!="function"&&(Ts===null?Ts=new Set([this]):Ts.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function nv(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new bb;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),t=$b.bind(null,t,e,n),e.then(t,t))}function rv(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function sv(t,e,n,r,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Or(-1,1),e.tag=2,Es(n,e,1))),n.lanes|=1),t)}var Ab=Gr.ReactCurrentOwner,un=!1;function Xt(t,e,n,r){e.child=t===null?Mx(e,null,n,r):yo(e,t.child,n,r)}function iv(t,e,n,r,s){n=n.render;var i=e.ref;return ao(e,s),r=Kp(t,e,n,r,i,s),n=Qp(),t!==null&&!un?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Br(t,e,s)):(Qe&&n&&Lp(e),e.flags|=1,Xt(t,e,r,s),e.child)}function ov(t,e,n,r,s){if(t===null){var i=n.type;return typeof i=="function"&&!im(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,c0(t,e,i,r,s)):(t=Du(n.type,null,r,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&s)){var o=i.memoizedProps;if(n=n.compare,n=n!==null?n:Ua,n(o,r)&&t.ref===e.ref)return Br(t,e,s)}return e.flags|=1,t=Ss(i,r),t.ref=e.ref,t.return=e,e.child=t}function c0(t,e,n,r,s){if(t!==null){var i=t.memoizedProps;if(Ua(i,r)&&t.ref===e.ref)if(un=!1,e.pendingProps=r=i,(t.lanes&s)!==0)t.flags&131072&&(un=!0);else return e.lanes=t.lanes,Br(t,e,s)}return xf(t,e,n,r,s)}function d0(t,e,n){var r=e.pendingProps,s=r.children,i=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Be(eo,yn),yn|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Be(eo,yn),yn|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,Be(eo,yn),yn|=r}else i!==null?(r=i.baseLanes|n,e.memoizedState=null):r=n,Be(eo,yn),yn|=r;return Xt(t,e,s,n),e.child}function h0(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function xf(t,e,n,r,s){var i=fn(n)?li:Kt.current;return i=mo(e,i),ao(e,s),n=Kp(t,e,n,r,i,s),r=Qp(),t!==null&&!un?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Br(t,e,s)):(Qe&&r&&Lp(e),e.flags|=1,Xt(t,e,n,s),e.child)}function av(t,e,n,r,s){if(fn(n)){var i=!0;ec(e)}else i=!1;if(ao(e,s),e.stateNode===null)Ru(t,e),a0(e,n,r),_f(e,n,r,s),r=!0;else if(t===null){var o=e.stateNode,l=e.memoizedProps;o.props=l;var u=o.context,d=n.contextType;typeof d=="object"&&d!==null?d=Pn(d):(d=fn(n)?li:Kt.current,d=mo(e,d));var f=n.getDerivedStateFromProps,p=typeof f=="function"||typeof o.getSnapshotBeforeUpdate=="function";p||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==r||u!==d)&&tv(e,o,r,d),as=!1;var m=e.memoizedState;o.state=m,ic(e,r,o,s),u=e.memoizedState,l!==r||m!==u||hn.current||as?(typeof f=="function"&&(vf(e,n,f,r),u=e.memoizedState),(l=as||ev(e,n,l,r,m,u,d))?(p||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=u),o.props=r,o.state=u,o.context=d,r=l):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,Fx(t,e),l=e.memoizedProps,d=e.type===e.elementType?l:qn(e.type,l),o.props=d,p=e.pendingProps,m=o.context,u=n.contextType,typeof u=="object"&&u!==null?u=Pn(u):(u=fn(n)?li:Kt.current,u=mo(e,u));var y=n.getDerivedStateFromProps;(f=typeof y=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==p||m!==u)&&tv(e,o,r,u),as=!1,m=e.memoizedState,o.state=m,ic(e,r,o,s);var x=e.memoizedState;l!==p||m!==x||hn.current||as?(typeof y=="function"&&(vf(e,n,y,r),x=e.memoizedState),(d=as||ev(e,n,d,r,m,x,u)||!1)?(f||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,x,u),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,x,u)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&m===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=x),o.props=r,o.state=x,o.context=u,r=d):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&m===t.memoizedState||(e.flags|=1024),r=!1)}return Ef(t,e,n,r,i,s)}function Ef(t,e,n,r,s,i){h0(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return s&&Hy(e,n,!1),Br(t,e,i);r=e.stateNode,Ab.current=e;var l=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=yo(e,t.child,null,i),e.child=yo(e,null,l,i)):Xt(t,e,l,i),e.memoizedState=r.state,s&&Hy(e,n,!0),e.child}function f0(t){var e=t.stateNode;e.pendingContext?Wy(t,e.pendingContext,e.pendingContext!==e.context):e.context&&Wy(t,e.context,!1),qp(t,e.containerInfo)}function lv(t,e,n,r,s){return go(),Mp(s),e.flags|=256,Xt(t,e,n,r),e.child}var Tf={dehydrated:null,treeContext:null,retryLane:0};function If(t){return{baseLanes:t,cachePool:null,transitions:null}}function p0(t,e,n){var r=e.pendingProps,s=Xe.current,i=!1,o=(e.flags&128)!==0,l;if((l=o)||(l=t!==null&&t.memoizedState===null?!1:(s&2)!==0),l?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),Be(Xe,s&1),t===null)return gf(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,i?(r=e.mode,i=e.child,o={mode:"hidden",children:o},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=Yc(o,r,0,null),t=ai(t,r,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=If(n),e.memoizedState=Tf,t):Xp(e,o));if(s=t.memoizedState,s!==null&&(l=s.dehydrated,l!==null))return Cb(t,e,o,r,l,s,n);if(i){i=r.fallback,o=e.mode,s=t.child,l=s.sibling;var u={mode:"hidden",children:r.children};return!(o&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=u,e.deletions=null):(r=Ss(s,u),r.subtreeFlags=s.subtreeFlags&14680064),l!==null?i=Ss(l,i):(i=ai(i,o,n,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,o=t.child.memoizedState,o=o===null?If(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=t.childLanes&~n,e.memoizedState=Tf,r}return i=t.child,t=i.sibling,r=Ss(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function Xp(t,e){return e=Yc({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function du(t,e,n,r){return r!==null&&Mp(r),yo(e,t.child,null,n),t=Xp(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function Cb(t,e,n,r,s,i,o){if(n)return e.flags&256?(e.flags&=-257,r=mh(Error(q(422))),du(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=r.fallback,s=e.mode,r=Yc({mode:"visible",children:r.children},s,0,null),i=ai(i,s,o,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&yo(e,t.child,null,o),e.child.memoizedState=If(o),e.memoizedState=Tf,i);if(!(e.mode&1))return du(t,e,o,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var l=r.dgst;return r=l,i=Error(q(419)),r=mh(i,r,void 0),du(t,e,o,r)}if(l=(o&t.childLanes)!==0,un||l){if(r=Ct,r!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|o)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,$r(t,s),Qn(r,t,s,-1))}return sm(),r=mh(Error(q(421))),du(t,e,o,r)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=Bb.bind(null,t),s._reactRetry=e,null):(t=i.treeContext,_n=xs(s.nextSibling),xn=e,Qe=!0,Hn=null,t!==null&&(bn[An++]=kr,bn[An++]=Rr,bn[An++]=ui,kr=t.id,Rr=t.overflow,ui=e),e=Xp(e,r.children),e.flags|=4096,e)}function uv(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),yf(t.return,e,n)}function gh(t,e,n,r,s){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function m0(t,e,n){var r=e.pendingProps,s=r.revealOrder,i=r.tail;if(Xt(t,e,r.children,n),r=Xe.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&uv(t,n,e);else if(t.tag===19)uv(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(Be(Xe,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)t=n.alternate,t!==null&&oc(t)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),gh(e,!1,s,n,i);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&oc(t)===null){e.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}gh(e,!0,n,null,i);break;case"together":gh(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Ru(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Br(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),di|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(q(153));if(e.child!==null){for(t=e.child,n=Ss(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Ss(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function kb(t,e,n){switch(e.tag){case 3:f0(e),go();break;case 5:$x(e);break;case 1:fn(e.type)&&ec(e);break;case 4:qp(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;Be(rc,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Be(Xe,Xe.current&1),e.flags|=128,null):n&e.child.childLanes?p0(t,e,n):(Be(Xe,Xe.current&1),t=Br(t,e,n),t!==null?t.sibling:null);Be(Xe,Xe.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return m0(t,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Be(Xe,Xe.current),r)break;return null;case 22:case 23:return e.lanes=0,d0(t,e,n)}return Br(t,e,n)}var g0,Sf,y0,v0;g0=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Sf=function(){};y0=function(t,e,n,r){var s=t.memoizedProps;if(s!==r){t=e.stateNode,ni(hr.current);var i=null;switch(n){case"input":s=Hh(t,s),r=Hh(t,r),i=[];break;case"select":s=rt({},s,{value:void 0}),r=rt({},r,{value:void 0}),i=[];break;case"textarea":s=Qh(t,s),r=Qh(t,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=Xu)}Jh(n,r);var o;n=null;for(d in s)if(!r.hasOwnProperty(d)&&s.hasOwnProperty(d)&&s[d]!=null)if(d==="style"){var l=s[d];for(o in l)l.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(Pa.hasOwnProperty(d)?i||(i=[]):(i=i||[]).push(d,null));for(d in r){var u=r[d];if(l=s!=null?s[d]:void 0,r.hasOwnProperty(d)&&u!==l&&(u!=null||l!=null))if(d==="style")if(l){for(o in l)!l.hasOwnProperty(o)||u&&u.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in u)u.hasOwnProperty(o)&&l[o]!==u[o]&&(n||(n={}),n[o]=u[o])}else n||(i||(i=[]),i.push(d,n)),n=u;else d==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,l=l?l.__html:void 0,u!=null&&l!==u&&(i=i||[]).push(d,u)):d==="children"?typeof u!="string"&&typeof u!="number"||(i=i||[]).push(d,""+u):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(Pa.hasOwnProperty(d)?(u!=null&&d==="onScroll"&&We("scroll",t),i||l===u||(i=[])):(i=i||[]).push(d,u))}n&&(i=i||[]).push("style",n);var d=i;(e.updateQueue=d)&&(e.flags|=4)}};v0=function(t,e,n,r){n!==r&&(e.flags|=4)};function ia(t,e){if(!Qe)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Bt(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function Rb(t,e,n){var r=e.pendingProps;switch(Vp(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Bt(e),null;case 1:return fn(e.type)&&Zu(),Bt(e),null;case 3:return r=e.stateNode,vo(),He(hn),He(Kt),Hp(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(uu(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Hn!==null&&(jf(Hn),Hn=null))),Sf(t,e),Bt(e),null;case 5:Wp(e);var s=ni(qa.current);if(n=e.type,t!==null&&e.stateNode!=null)y0(t,e,n,r,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(q(166));return Bt(e),null}if(t=ni(hr.current),uu(e)){r=e.stateNode,n=e.type;var i=e.memoizedProps;switch(r[cr]=e,r[Ba]=i,t=(e.mode&1)!==0,n){case"dialog":We("cancel",r),We("close",r);break;case"iframe":case"object":case"embed":We("load",r);break;case"video":case"audio":for(s=0;s<ca.length;s++)We(ca[s],r);break;case"source":We("error",r);break;case"img":case"image":case"link":We("error",r),We("load",r);break;case"details":We("toggle",r);break;case"input":vy(r,i),We("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},We("invalid",r);break;case"textarea":wy(r,i),We("invalid",r)}Jh(n,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var l=i[o];o==="children"?typeof l=="string"?r.textContent!==l&&(i.suppressHydrationWarning!==!0&&lu(r.textContent,l,t),s=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(i.suppressHydrationWarning!==!0&&lu(r.textContent,l,t),s=["children",""+l]):Pa.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&We("scroll",r)}switch(n){case"input":eu(r),_y(r,i,!0);break;case"textarea":eu(r),xy(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=Xu)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=Hw(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[cr]=e,t[Ba]=r,g0(t,e,!1,!1),e.stateNode=t;e:{switch(o=Xh(n,r),n){case"dialog":We("cancel",t),We("close",t),s=r;break;case"iframe":case"object":case"embed":We("load",t),s=r;break;case"video":case"audio":for(s=0;s<ca.length;s++)We(ca[s],t);s=r;break;case"source":We("error",t),s=r;break;case"img":case"image":case"link":We("error",t),We("load",t),s=r;break;case"details":We("toggle",t),s=r;break;case"input":vy(t,r),s=Hh(t,r),We("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=rt({},r,{value:void 0}),We("invalid",t);break;case"textarea":wy(t,r),s=Qh(t,r),We("invalid",t);break;default:s=r}Jh(n,s),l=s;for(i in l)if(l.hasOwnProperty(i)){var u=l[i];i==="style"?Qw(t,u):i==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&Gw(t,u)):i==="children"?typeof u=="string"?(n!=="textarea"||u!=="")&&ja(t,u):typeof u=="number"&&ja(t,""+u):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(Pa.hasOwnProperty(i)?u!=null&&i==="onScroll"&&We("scroll",t):u!=null&&Ep(t,i,u,o))}switch(n){case"input":eu(t),_y(t,r,!1);break;case"textarea":eu(t),xy(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Rs(r.value));break;case"select":t.multiple=!!r.multiple,i=r.value,i!=null?ro(t,!!r.multiple,i,!1):r.defaultValue!=null&&ro(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=Xu)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Bt(e),null;case 6:if(t&&e.stateNode!=null)v0(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(q(166));if(n=ni(qa.current),ni(hr.current),uu(e)){if(r=e.stateNode,n=e.memoizedProps,r[cr]=e,(i=r.nodeValue!==n)&&(t=xn,t!==null))switch(t.tag){case 3:lu(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&lu(r.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[cr]=e,e.stateNode=r}return Bt(e),null;case 13:if(He(Xe),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Qe&&_n!==null&&e.mode&1&&!(e.flags&128))Lx(),go(),e.flags|=98560,i=!1;else if(i=uu(e),r!==null&&r.dehydrated!==null){if(t===null){if(!i)throw Error(q(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(q(317));i[cr]=e}else go(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Bt(e),i=!1}else Hn!==null&&(jf(Hn),Hn=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||Xe.current&1?wt===0&&(wt=3):sm())),e.updateQueue!==null&&(e.flags|=4),Bt(e),null);case 4:return vo(),Sf(t,e),t===null&&Fa(e.stateNode.containerInfo),Bt(e),null;case 10:return $p(e.type._context),Bt(e),null;case 17:return fn(e.type)&&Zu(),Bt(e),null;case 19:if(He(Xe),i=e.memoizedState,i===null)return Bt(e),null;if(r=(e.flags&128)!==0,o=i.rendering,o===null)if(r)ia(i,!1);else{if(wt!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=oc(t),o!==null){for(e.flags|=128,ia(i,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)i=n,t=r,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,t=o.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Be(Xe,Xe.current&1|2),e.child}t=t.sibling}i.tail!==null&&ct()>wo&&(e.flags|=128,r=!0,ia(i,!1),e.lanes=4194304)}else{if(!r)if(t=oc(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),ia(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!Qe)return Bt(e),null}else 2*ct()-i.renderingStartTime>wo&&n!==1073741824&&(e.flags|=128,r=!0,ia(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(n=i.last,n!==null?n.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=ct(),e.sibling=null,n=Xe.current,Be(Xe,r?n&1|2:n&1),e):(Bt(e),null);case 22:case 23:return rm(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?yn&1073741824&&(Bt(e),e.subtreeFlags&6&&(e.flags|=8192)):Bt(e),null;case 24:return null;case 25:return null}throw Error(q(156,e.tag))}function Pb(t,e){switch(Vp(e),e.tag){case 1:return fn(e.type)&&Zu(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return vo(),He(hn),He(Kt),Hp(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Wp(e),null;case 13:if(He(Xe),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(q(340));go()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return He(Xe),null;case 4:return vo(),null;case 10:return $p(e.type._context),null;case 22:case 23:return rm(),null;case 24:return null;default:return null}}var hu=!1,Wt=!1,jb=typeof WeakSet=="function"?WeakSet:Set,X=null;function Zi(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){at(t,e,r)}else n.current=null}function Nf(t,e,n){try{n()}catch(r){at(t,e,r)}}var cv=!1;function Db(t,e){if(uf=Qu,t=Tx(),Op(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var o=0,l=-1,u=-1,d=0,f=0,p=t,m=null;t:for(;;){for(var y;p!==n||s!==0&&p.nodeType!==3||(l=o+s),p!==i||r!==0&&p.nodeType!==3||(u=o+r),p.nodeType===3&&(o+=p.nodeValue.length),(y=p.firstChild)!==null;)m=p,p=y;for(;;){if(p===t)break t;if(m===n&&++d===s&&(l=o),m===i&&++f===r&&(u=o),(y=p.nextSibling)!==null)break;p=m,m=p.parentNode}p=y}n=l===-1||u===-1?null:{start:l,end:u}}else n=null}n=n||{start:0,end:0}}else n=null;for(cf={focusedElem:t,selectionRange:n},Qu=!1,X=e;X!==null;)if(e=X,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,X=t;else for(;X!==null;){e=X;try{var x=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(x!==null){var A=x.memoizedProps,b=x.memoizedState,E=e.stateNode,v=E.getSnapshotBeforeUpdate(e.elementType===e.type?A:qn(e.type,A),b);E.__reactInternalSnapshotBeforeUpdate=v}break;case 3:var w=e.stateNode.containerInfo;w.nodeType===1?w.textContent="":w.nodeType===9&&w.documentElement&&w.removeChild(w.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(q(163))}}catch(R){at(e,e.return,R)}if(t=e.sibling,t!==null){t.return=e.return,X=t;break}X=e.return}return x=cv,cv=!1,x}function Ea(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var i=s.destroy;s.destroy=void 0,i!==void 0&&Nf(e,n,i)}s=s.next}while(s!==r)}}function Kc(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function bf(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function _0(t){var e=t.alternate;e!==null&&(t.alternate=null,_0(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[cr],delete e[Ba],delete e[ff],delete e[gb],delete e[yb])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function w0(t){return t.tag===5||t.tag===3||t.tag===4}function dv(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||w0(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Af(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=Xu));else if(r!==4&&(t=t.child,t!==null))for(Af(t,e,n),t=t.sibling;t!==null;)Af(t,e,n),t=t.sibling}function Cf(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(Cf(t,e,n),t=t.sibling;t!==null;)Cf(t,e,n),t=t.sibling}var jt=null,Wn=!1;function ns(t,e,n){for(n=n.child;n!==null;)x0(t,e,n),n=n.sibling}function x0(t,e,n){if(dr&&typeof dr.onCommitFiberUnmount=="function")try{dr.onCommitFiberUnmount(Fc,n)}catch{}switch(n.tag){case 5:Wt||Zi(n,e);case 6:var r=jt,s=Wn;jt=null,ns(t,e,n),jt=r,Wn=s,jt!==null&&(Wn?(t=jt,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):jt.removeChild(n.stateNode));break;case 18:jt!==null&&(Wn?(t=jt,n=n.stateNode,t.nodeType===8?uh(t.parentNode,n):t.nodeType===1&&uh(t,n),Va(t)):uh(jt,n.stateNode));break;case 4:r=jt,s=Wn,jt=n.stateNode.containerInfo,Wn=!0,ns(t,e,n),jt=r,Wn=s;break;case 0:case 11:case 14:case 15:if(!Wt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&Nf(n,e,o),s=s.next}while(s!==r)}ns(t,e,n);break;case 1:if(!Wt&&(Zi(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(l){at(n,e,l)}ns(t,e,n);break;case 21:ns(t,e,n);break;case 22:n.mode&1?(Wt=(r=Wt)||n.memoizedState!==null,ns(t,e,n),Wt=r):ns(t,e,n);break;default:ns(t,e,n)}}function hv(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new jb),e.forEach(function(r){var s=zb.bind(null,t,r);n.has(r)||(n.add(r),r.then(s,s))})}}function zn(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=t,o=e,l=o;e:for(;l!==null;){switch(l.tag){case 5:jt=l.stateNode,Wn=!1;break e;case 3:jt=l.stateNode.containerInfo,Wn=!0;break e;case 4:jt=l.stateNode.containerInfo,Wn=!0;break e}l=l.return}if(jt===null)throw Error(q(160));x0(i,o,s),jt=null,Wn=!1;var u=s.alternate;u!==null&&(u.return=null),s.return=null}catch(d){at(s,e,d)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)E0(e,t),e=e.sibling}function E0(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(zn(e,t),ar(t),r&4){try{Ea(3,t,t.return),Kc(3,t)}catch(A){at(t,t.return,A)}try{Ea(5,t,t.return)}catch(A){at(t,t.return,A)}}break;case 1:zn(e,t),ar(t),r&512&&n!==null&&Zi(n,n.return);break;case 5:if(zn(e,t),ar(t),r&512&&n!==null&&Zi(n,n.return),t.flags&32){var s=t.stateNode;try{ja(s,"")}catch(A){at(t,t.return,A)}}if(r&4&&(s=t.stateNode,s!=null)){var i=t.memoizedProps,o=n!==null?n.memoizedProps:i,l=t.type,u=t.updateQueue;if(t.updateQueue=null,u!==null)try{l==="input"&&i.type==="radio"&&i.name!=null&&qw(s,i),Xh(l,o);var d=Xh(l,i);for(o=0;o<u.length;o+=2){var f=u[o],p=u[o+1];f==="style"?Qw(s,p):f==="dangerouslySetInnerHTML"?Gw(s,p):f==="children"?ja(s,p):Ep(s,f,p,d)}switch(l){case"input":Gh(s,i);break;case"textarea":Ww(s,i);break;case"select":var m=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var y=i.value;y!=null?ro(s,!!i.multiple,y,!1):m!==!!i.multiple&&(i.defaultValue!=null?ro(s,!!i.multiple,i.defaultValue,!0):ro(s,!!i.multiple,i.multiple?[]:"",!1))}s[Ba]=i}catch(A){at(t,t.return,A)}}break;case 6:if(zn(e,t),ar(t),r&4){if(t.stateNode===null)throw Error(q(162));s=t.stateNode,i=t.memoizedProps;try{s.nodeValue=i}catch(A){at(t,t.return,A)}}break;case 3:if(zn(e,t),ar(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Va(e.containerInfo)}catch(A){at(t,t.return,A)}break;case 4:zn(e,t),ar(t);break;case 13:zn(e,t),ar(t),s=t.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(tm=ct())),r&4&&hv(t);break;case 22:if(f=n!==null&&n.memoizedState!==null,t.mode&1?(Wt=(d=Wt)||f,zn(e,t),Wt=d):zn(e,t),ar(t),r&8192){if(d=t.memoizedState!==null,(t.stateNode.isHidden=d)&&!f&&t.mode&1)for(X=t,f=t.child;f!==null;){for(p=X=f;X!==null;){switch(m=X,y=m.child,m.tag){case 0:case 11:case 14:case 15:Ea(4,m,m.return);break;case 1:Zi(m,m.return);var x=m.stateNode;if(typeof x.componentWillUnmount=="function"){r=m,n=m.return;try{e=r,x.props=e.memoizedProps,x.state=e.memoizedState,x.componentWillUnmount()}catch(A){at(r,n,A)}}break;case 5:Zi(m,m.return);break;case 22:if(m.memoizedState!==null){pv(p);continue}}y!==null?(y.return=m,X=y):pv(p)}f=f.sibling}e:for(f=null,p=t;;){if(p.tag===5){if(f===null){f=p;try{s=p.stateNode,d?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(l=p.stateNode,u=p.memoizedProps.style,o=u!=null&&u.hasOwnProperty("display")?u.display:null,l.style.display=Kw("display",o))}catch(A){at(t,t.return,A)}}}else if(p.tag===6){if(f===null)try{p.stateNode.nodeValue=d?"":p.memoizedProps}catch(A){at(t,t.return,A)}}else if((p.tag!==22&&p.tag!==23||p.memoizedState===null||p===t)&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===t)break e;for(;p.sibling===null;){if(p.return===null||p.return===t)break e;f===p&&(f=null),p=p.return}f===p&&(f=null),p.sibling.return=p.return,p=p.sibling}}break;case 19:zn(e,t),ar(t),r&4&&hv(t);break;case 21:break;default:zn(e,t),ar(t)}}function ar(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(w0(n)){var r=n;break e}n=n.return}throw Error(q(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(ja(s,""),r.flags&=-33);var i=dv(t);Cf(t,i,s);break;case 3:case 4:var o=r.stateNode.containerInfo,l=dv(t);Af(t,l,o);break;default:throw Error(q(161))}}catch(u){at(t,t.return,u)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function Ob(t,e,n){X=t,T0(t)}function T0(t,e,n){for(var r=(t.mode&1)!==0;X!==null;){var s=X,i=s.child;if(s.tag===22&&r){var o=s.memoizedState!==null||hu;if(!o){var l=s.alternate,u=l!==null&&l.memoizedState!==null||Wt;l=hu;var d=Wt;if(hu=o,(Wt=u)&&!d)for(X=s;X!==null;)o=X,u=o.child,o.tag===22&&o.memoizedState!==null?mv(s):u!==null?(u.return=o,X=u):mv(s);for(;i!==null;)X=i,T0(i),i=i.sibling;X=s,hu=l,Wt=d}fv(t)}else s.subtreeFlags&8772&&i!==null?(i.return=s,X=i):fv(t)}}function fv(t){for(;X!==null;){var e=X;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Wt||Kc(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Wt)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:qn(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&Jy(e,i,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}Jy(e,o,n)}break;case 5:var l=e.stateNode;if(n===null&&e.flags&4){n=l;var u=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&n.focus();break;case"img":u.src&&(n.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var d=e.alternate;if(d!==null){var f=d.memoizedState;if(f!==null){var p=f.dehydrated;p!==null&&Va(p)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(q(163))}Wt||e.flags&512&&bf(e)}catch(m){at(e,e.return,m)}}if(e===t){X=null;break}if(n=e.sibling,n!==null){n.return=e.return,X=n;break}X=e.return}}function pv(t){for(;X!==null;){var e=X;if(e===t){X=null;break}var n=e.sibling;if(n!==null){n.return=e.return,X=n;break}X=e.return}}function mv(t){for(;X!==null;){var e=X;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Kc(4,e)}catch(u){at(e,n,u)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(u){at(e,s,u)}}var i=e.return;try{bf(e)}catch(u){at(e,i,u)}break;case 5:var o=e.return;try{bf(e)}catch(u){at(e,o,u)}}}catch(u){at(e,e.return,u)}if(e===t){X=null;break}var l=e.sibling;if(l!==null){l.return=e.return,X=l;break}X=e.return}}var Lb=Math.ceil,uc=Gr.ReactCurrentDispatcher,Zp=Gr.ReactCurrentOwner,Rn=Gr.ReactCurrentBatchConfig,Ae=0,Ct=null,pt=null,Lt=0,yn=0,eo=Fs(0),wt=0,Ka=null,di=0,Qc=0,em=0,Ta=null,on=null,tm=0,wo=1/0,br=null,cc=!1,kf=null,Ts=null,fu=!1,ms=null,dc=0,Ia=0,Rf=null,Pu=-1,ju=0;function Zt(){return Ae&6?ct():Pu!==-1?Pu:Pu=ct()}function Is(t){return t.mode&1?Ae&2&&Lt!==0?Lt&-Lt:_b.transition!==null?(ju===0&&(ju=ax()),ju):(t=Le,t!==0||(t=window.event,t=t===void 0?16:px(t.type)),t):1}function Qn(t,e,n,r){if(50<Ia)throw Ia=0,Rf=null,Error(q(185));dl(t,n,r),(!(Ae&2)||t!==Ct)&&(t===Ct&&(!(Ae&2)&&(Qc|=n),wt===4&&us(t,Lt)),pn(t,r),n===1&&Ae===0&&!(e.mode&1)&&(wo=ct()+500,Wc&&$s()))}function pn(t,e){var n=t.callbackNode;_N(t,e);var r=Ku(t,t===Ct?Lt:0);if(r===0)n!==null&&Iy(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&Iy(n),e===1)t.tag===0?vb(gv.bind(null,t)):jx(gv.bind(null,t)),pb(function(){!(Ae&6)&&$s()}),n=null;else{switch(lx(r)){case 1:n=bp;break;case 4:n=ix;break;case 16:n=Gu;break;case 536870912:n=ox;break;default:n=Gu}n=R0(n,I0.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function I0(t,e){if(Pu=-1,ju=0,Ae&6)throw Error(q(327));var n=t.callbackNode;if(lo()&&t.callbackNode!==n)return null;var r=Ku(t,t===Ct?Lt:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=hc(t,r);else{e=r;var s=Ae;Ae|=2;var i=N0();(Ct!==t||Lt!==e)&&(br=null,wo=ct()+500,oi(t,e));do try{Ub();break}catch(l){S0(t,l)}while(!0);Fp(),uc.current=i,Ae=s,pt!==null?e=0:(Ct=null,Lt=0,e=wt)}if(e!==0){if(e===2&&(s=rf(t),s!==0&&(r=s,e=Pf(t,s))),e===1)throw n=Ka,oi(t,0),us(t,r),pn(t,ct()),n;if(e===6)us(t,r);else{if(s=t.current.alternate,!(r&30)&&!Vb(s)&&(e=hc(t,r),e===2&&(i=rf(t),i!==0&&(r=i,e=Pf(t,i))),e===1))throw n=Ka,oi(t,0),us(t,r),pn(t,ct()),n;switch(t.finishedWork=s,t.finishedLanes=r,e){case 0:case 1:throw Error(q(345));case 2:Xs(t,on,br);break;case 3:if(us(t,r),(r&130023424)===r&&(e=tm+500-ct(),10<e)){if(Ku(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){Zt(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=hf(Xs.bind(null,t,on,br),e);break}Xs(t,on,br);break;case 4:if(us(t,r),(r&4194240)===r)break;for(e=t.eventTimes,s=-1;0<r;){var o=31-Kn(r);i=1<<o,o=e[o],o>s&&(s=o),r&=~i}if(r=s,r=ct()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Lb(r/1960))-r,10<r){t.timeoutHandle=hf(Xs.bind(null,t,on,br),r);break}Xs(t,on,br);break;case 5:Xs(t,on,br);break;default:throw Error(q(329))}}}return pn(t,ct()),t.callbackNode===n?I0.bind(null,t):null}function Pf(t,e){var n=Ta;return t.current.memoizedState.isDehydrated&&(oi(t,e).flags|=256),t=hc(t,e),t!==2&&(e=on,on=n,e!==null&&jf(e)),t}function jf(t){on===null?on=t:on.push.apply(on,t)}function Vb(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!Zn(i(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function us(t,e){for(e&=~em,e&=~Qc,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Kn(e),r=1<<n;t[n]=-1,e&=~r}}function gv(t){if(Ae&6)throw Error(q(327));lo();var e=Ku(t,0);if(!(e&1))return pn(t,ct()),null;var n=hc(t,e);if(t.tag!==0&&n===2){var r=rf(t);r!==0&&(e=r,n=Pf(t,r))}if(n===1)throw n=Ka,oi(t,0),us(t,e),pn(t,ct()),n;if(n===6)throw Error(q(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Xs(t,on,br),pn(t,ct()),null}function nm(t,e){var n=Ae;Ae|=1;try{return t(e)}finally{Ae=n,Ae===0&&(wo=ct()+500,Wc&&$s())}}function hi(t){ms!==null&&ms.tag===0&&!(Ae&6)&&lo();var e=Ae;Ae|=1;var n=Rn.transition,r=Le;try{if(Rn.transition=null,Le=1,t)return t()}finally{Le=r,Rn.transition=n,Ae=e,!(Ae&6)&&$s()}}function rm(){yn=eo.current,He(eo)}function oi(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,fb(n)),pt!==null)for(n=pt.return;n!==null;){var r=n;switch(Vp(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Zu();break;case 3:vo(),He(hn),He(Kt),Hp();break;case 5:Wp(r);break;case 4:vo();break;case 13:He(Xe);break;case 19:He(Xe);break;case 10:$p(r.type._context);break;case 22:case 23:rm()}n=n.return}if(Ct=t,pt=t=Ss(t.current,null),Lt=yn=e,wt=0,Ka=null,em=Qc=di=0,on=Ta=null,ti!==null){for(e=0;e<ti.length;e++)if(n=ti[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var o=i.next;i.next=s,r.next=o}n.pending=r}ti=null}return t}function S0(t,e){do{var n=pt;try{if(Fp(),Cu.current=lc,ac){for(var r=tt.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}ac=!1}if(ci=0,bt=vt=tt=null,xa=!1,Wa=0,Zp.current=null,n===null||n.return===null){wt=1,Ka=e,pt=null;break}e:{var i=t,o=n.return,l=n,u=e;if(e=Lt,l.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var d=u,f=l,p=f.tag;if(!(f.mode&1)&&(p===0||p===11||p===15)){var m=f.alternate;m?(f.updateQueue=m.updateQueue,f.memoizedState=m.memoizedState,f.lanes=m.lanes):(f.updateQueue=null,f.memoizedState=null)}var y=rv(o);if(y!==null){y.flags&=-257,sv(y,o,l,i,e),y.mode&1&&nv(i,d,e),e=y,u=d;var x=e.updateQueue;if(x===null){var A=new Set;A.add(u),e.updateQueue=A}else x.add(u);break e}else{if(!(e&1)){nv(i,d,e),sm();break e}u=Error(q(426))}}else if(Qe&&l.mode&1){var b=rv(o);if(b!==null){!(b.flags&65536)&&(b.flags|=256),sv(b,o,l,i,e),Mp(_o(u,l));break e}}i=u=_o(u,l),wt!==4&&(wt=2),Ta===null?Ta=[i]:Ta.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var E=l0(i,u,e);Yy(i,E);break e;case 1:l=u;var v=i.type,w=i.stateNode;if(!(i.flags&128)&&(typeof v.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(Ts===null||!Ts.has(w)))){i.flags|=65536,e&=-e,i.lanes|=e;var R=u0(i,l,e);Yy(i,R);break e}}i=i.return}while(i!==null)}A0(n)}catch(D){e=D,pt===n&&n!==null&&(pt=n=n.return);continue}break}while(!0)}function N0(){var t=uc.current;return uc.current=lc,t===null?lc:t}function sm(){(wt===0||wt===3||wt===2)&&(wt=4),Ct===null||!(di&268435455)&&!(Qc&268435455)||us(Ct,Lt)}function hc(t,e){var n=Ae;Ae|=2;var r=N0();(Ct!==t||Lt!==e)&&(br=null,oi(t,e));do try{Mb();break}catch(s){S0(t,s)}while(!0);if(Fp(),Ae=n,uc.current=r,pt!==null)throw Error(q(261));return Ct=null,Lt=0,wt}function Mb(){for(;pt!==null;)b0(pt)}function Ub(){for(;pt!==null&&!cN();)b0(pt)}function b0(t){var e=k0(t.alternate,t,yn);t.memoizedProps=t.pendingProps,e===null?A0(t):pt=e,Zp.current=null}function A0(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=Pb(n,e),n!==null){n.flags&=32767,pt=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{wt=6,pt=null;return}}else if(n=Rb(n,e,yn),n!==null){pt=n;return}if(e=e.sibling,e!==null){pt=e;return}pt=e=t}while(e!==null);wt===0&&(wt=5)}function Xs(t,e,n){var r=Le,s=Rn.transition;try{Rn.transition=null,Le=1,Fb(t,e,n,r)}finally{Rn.transition=s,Le=r}return null}function Fb(t,e,n,r){do lo();while(ms!==null);if(Ae&6)throw Error(q(327));n=t.finishedWork;var s=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(q(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(wN(t,i),t===Ct&&(pt=Ct=null,Lt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||fu||(fu=!0,R0(Gu,function(){return lo(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=Rn.transition,Rn.transition=null;var o=Le;Le=1;var l=Ae;Ae|=4,Zp.current=null,Db(t,n),E0(n,t),ob(cf),Qu=!!uf,cf=uf=null,t.current=n,Ob(n),dN(),Ae=l,Le=o,Rn.transition=i}else t.current=n;if(fu&&(fu=!1,ms=t,dc=s),i=t.pendingLanes,i===0&&(Ts=null),pN(n.stateNode),pn(t,ct()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(cc)throw cc=!1,t=kf,kf=null,t;return dc&1&&t.tag!==0&&lo(),i=t.pendingLanes,i&1?t===Rf?Ia++:(Ia=0,Rf=t):Ia=0,$s(),null}function lo(){if(ms!==null){var t=lx(dc),e=Rn.transition,n=Le;try{if(Rn.transition=null,Le=16>t?16:t,ms===null)var r=!1;else{if(t=ms,ms=null,dc=0,Ae&6)throw Error(q(331));var s=Ae;for(Ae|=4,X=t.current;X!==null;){var i=X,o=i.child;if(X.flags&16){var l=i.deletions;if(l!==null){for(var u=0;u<l.length;u++){var d=l[u];for(X=d;X!==null;){var f=X;switch(f.tag){case 0:case 11:case 15:Ea(8,f,i)}var p=f.child;if(p!==null)p.return=f,X=p;else for(;X!==null;){f=X;var m=f.sibling,y=f.return;if(_0(f),f===d){X=null;break}if(m!==null){m.return=y,X=m;break}X=y}}}var x=i.alternate;if(x!==null){var A=x.child;if(A!==null){x.child=null;do{var b=A.sibling;A.sibling=null,A=b}while(A!==null)}}X=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,X=o;else e:for(;X!==null;){if(i=X,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Ea(9,i,i.return)}var E=i.sibling;if(E!==null){E.return=i.return,X=E;break e}X=i.return}}var v=t.current;for(X=v;X!==null;){o=X;var w=o.child;if(o.subtreeFlags&2064&&w!==null)w.return=o,X=w;else e:for(o=v;X!==null;){if(l=X,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:Kc(9,l)}}catch(D){at(l,l.return,D)}if(l===o){X=null;break e}var R=l.sibling;if(R!==null){R.return=l.return,X=R;break e}X=l.return}}if(Ae=s,$s(),dr&&typeof dr.onPostCommitFiberRoot=="function")try{dr.onPostCommitFiberRoot(Fc,t)}catch{}r=!0}return r}finally{Le=n,Rn.transition=e}}return!1}function yv(t,e,n){e=_o(n,e),e=l0(t,e,1),t=Es(t,e,1),e=Zt(),t!==null&&(dl(t,1,e),pn(t,e))}function at(t,e,n){if(t.tag===3)yv(t,t,n);else for(;e!==null;){if(e.tag===3){yv(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Ts===null||!Ts.has(r))){t=_o(n,t),t=u0(e,t,1),e=Es(e,t,1),t=Zt(),e!==null&&(dl(e,1,t),pn(e,t));break}}e=e.return}}function $b(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=Zt(),t.pingedLanes|=t.suspendedLanes&n,Ct===t&&(Lt&n)===n&&(wt===4||wt===3&&(Lt&130023424)===Lt&&500>ct()-tm?oi(t,0):em|=n),pn(t,e)}function C0(t,e){e===0&&(t.mode&1?(e=ru,ru<<=1,!(ru&130023424)&&(ru=4194304)):e=1);var n=Zt();t=$r(t,e),t!==null&&(dl(t,e,n),pn(t,n))}function Bb(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),C0(t,n)}function zb(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(q(314))}r!==null&&r.delete(e),C0(t,n)}var k0;k0=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||hn.current)un=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return un=!1,kb(t,e,n);un=!!(t.flags&131072)}else un=!1,Qe&&e.flags&1048576&&Dx(e,nc,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Ru(t,e),t=e.pendingProps;var s=mo(e,Kt.current);ao(e,n),s=Kp(null,e,r,t,s,n);var i=Qp();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,fn(r)?(i=!0,ec(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,zp(e),s.updater=Gc,e.stateNode=s,s._reactInternals=e,_f(e,r,t,n),e=Ef(null,e,r,!0,i,n)):(e.tag=0,Qe&&i&&Lp(e),Xt(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Ru(t,e),t=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=Wb(r),t=qn(r,t),s){case 0:e=xf(null,e,r,t,n);break e;case 1:e=av(null,e,r,t,n);break e;case 11:e=iv(null,e,r,t,n);break e;case 14:e=ov(null,e,r,qn(r.type,t),n);break e}throw Error(q(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:qn(r,s),xf(t,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:qn(r,s),av(t,e,r,s,n);case 3:e:{if(f0(e),t===null)throw Error(q(387));r=e.pendingProps,i=e.memoizedState,s=i.element,Fx(t,e),ic(e,r,null,n);var o=e.memoizedState;if(r=o.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=_o(Error(q(423)),e),e=lv(t,e,r,n,s);break e}else if(r!==s){s=_o(Error(q(424)),e),e=lv(t,e,r,n,s);break e}else for(_n=xs(e.stateNode.containerInfo.firstChild),xn=e,Qe=!0,Hn=null,n=Mx(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(go(),r===s){e=Br(t,e,n);break e}Xt(t,e,r,n)}e=e.child}return e;case 5:return $x(e),t===null&&gf(e),r=e.type,s=e.pendingProps,i=t!==null?t.memoizedProps:null,o=s.children,df(r,s)?o=null:i!==null&&df(r,i)&&(e.flags|=32),h0(t,e),Xt(t,e,o,n),e.child;case 6:return t===null&&gf(e),null;case 13:return p0(t,e,n);case 4:return qp(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=yo(e,null,r,n):Xt(t,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:qn(r,s),iv(t,e,r,s,n);case 7:return Xt(t,e,e.pendingProps,n),e.child;case 8:return Xt(t,e,e.pendingProps.children,n),e.child;case 12:return Xt(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,i=e.memoizedProps,o=s.value,Be(rc,r._currentValue),r._currentValue=o,i!==null)if(Zn(i.value,o)){if(i.children===s.children&&!hn.current){e=Br(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var l=i.dependencies;if(l!==null){o=i.child;for(var u=l.firstContext;u!==null;){if(u.context===r){if(i.tag===1){u=Or(-1,n&-n),u.tag=2;var d=i.updateQueue;if(d!==null){d=d.shared;var f=d.pending;f===null?u.next=u:(u.next=f.next,f.next=u),d.pending=u}}i.lanes|=n,u=i.alternate,u!==null&&(u.lanes|=n),yf(i.return,n,e),l.lanes|=n;break}u=u.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(q(341));o.lanes|=n,l=o.alternate,l!==null&&(l.lanes|=n),yf(o,n,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}Xt(t,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,ao(e,n),s=Pn(s),r=r(s),e.flags|=1,Xt(t,e,r,n),e.child;case 14:return r=e.type,s=qn(r,e.pendingProps),s=qn(r.type,s),ov(t,e,r,s,n);case 15:return c0(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:qn(r,s),Ru(t,e),e.tag=1,fn(r)?(t=!0,ec(e)):t=!1,ao(e,n),a0(e,r,s),_f(e,r,s,n),Ef(null,e,r,!0,t,n);case 19:return m0(t,e,n);case 22:return d0(t,e,n)}throw Error(q(156,e.tag))};function R0(t,e){return sx(t,e)}function qb(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function kn(t,e,n,r){return new qb(t,e,n,r)}function im(t){return t=t.prototype,!(!t||!t.isReactComponent)}function Wb(t){if(typeof t=="function")return im(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Ip)return 11;if(t===Sp)return 14}return 2}function Ss(t,e){var n=t.alternate;return n===null?(n=kn(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Du(t,e,n,r,s,i){var o=2;if(r=t,typeof t=="function")im(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case qi:return ai(n.children,s,i,e);case Tp:o=8,s|=8;break;case Bh:return t=kn(12,n,e,s|2),t.elementType=Bh,t.lanes=i,t;case zh:return t=kn(13,n,e,s),t.elementType=zh,t.lanes=i,t;case qh:return t=kn(19,n,e,s),t.elementType=qh,t.lanes=i,t;case $w:return Yc(n,s,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case Uw:o=10;break e;case Fw:o=9;break e;case Ip:o=11;break e;case Sp:o=14;break e;case os:o=16,r=null;break e}throw Error(q(130,t==null?t:typeof t,""))}return e=kn(o,n,e,s),e.elementType=t,e.type=r,e.lanes=i,e}function ai(t,e,n,r){return t=kn(7,t,r,e),t.lanes=n,t}function Yc(t,e,n,r){return t=kn(22,t,r,e),t.elementType=$w,t.lanes=n,t.stateNode={isHidden:!1},t}function yh(t,e,n){return t=kn(6,t,null,e),t.lanes=n,t}function vh(t,e,n){return e=kn(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function Hb(t,e,n,r,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Xd(0),this.expirationTimes=Xd(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Xd(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function om(t,e,n,r,s,i,o,l,u){return t=new Hb(t,e,n,l,u),e===1?(e=1,i===!0&&(e|=8)):e=0,i=kn(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},zp(i),t}function Gb(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:zi,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function P0(t){if(!t)return Ps;t=t._reactInternals;e:{if(Ei(t)!==t||t.tag!==1)throw Error(q(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(fn(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(q(171))}if(t.tag===1){var n=t.type;if(fn(n))return Px(t,n,e)}return e}function j0(t,e,n,r,s,i,o,l,u){return t=om(n,r,!0,t,s,i,o,l,u),t.context=P0(null),n=t.current,r=Zt(),s=Is(n),i=Or(r,s),i.callback=e??null,Es(n,i,s),t.current.lanes=s,dl(t,s,r),pn(t,r),t}function Jc(t,e,n,r){var s=e.current,i=Zt(),o=Is(s);return n=P0(n),e.context===null?e.context=n:e.pendingContext=n,e=Or(i,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Es(s,e,o),t!==null&&(Qn(t,s,o,i),Au(t,s,o)),o}function fc(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function vv(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function am(t,e){vv(t,e),(t=t.alternate)&&vv(t,e)}function Kb(){return null}var D0=typeof reportError=="function"?reportError:function(t){console.error(t)};function lm(t){this._internalRoot=t}Xc.prototype.render=lm.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(q(409));Jc(t,e,null,null)};Xc.prototype.unmount=lm.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;hi(function(){Jc(null,t,null,null)}),e[Fr]=null}};function Xc(t){this._internalRoot=t}Xc.prototype.unstable_scheduleHydration=function(t){if(t){var e=dx();t={blockedOn:null,target:t,priority:e};for(var n=0;n<ls.length&&e!==0&&e<ls[n].priority;n++);ls.splice(n,0,t),n===0&&fx(t)}};function um(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Zc(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function _v(){}function Qb(t,e,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var d=fc(o);i.call(d)}}var o=j0(e,r,t,0,null,!1,!1,"",_v);return t._reactRootContainer=o,t[Fr]=o.current,Fa(t.nodeType===8?t.parentNode:t),hi(),o}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var l=r;r=function(){var d=fc(u);l.call(d)}}var u=om(t,0,!1,null,null,!1,!1,"",_v);return t._reactRootContainer=u,t[Fr]=u.current,Fa(t.nodeType===8?t.parentNode:t),hi(function(){Jc(e,u,n,r)}),u}function ed(t,e,n,r,s){var i=n._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var l=s;s=function(){var u=fc(o);l.call(u)}}Jc(e,o,t,s)}else o=Qb(n,e,t,s,r);return fc(o)}ux=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=ua(e.pendingLanes);n!==0&&(Ap(e,n|1),pn(e,ct()),!(Ae&6)&&(wo=ct()+500,$s()))}break;case 13:hi(function(){var r=$r(t,1);if(r!==null){var s=Zt();Qn(r,t,1,s)}}),am(t,1)}};Cp=function(t){if(t.tag===13){var e=$r(t,134217728);if(e!==null){var n=Zt();Qn(e,t,134217728,n)}am(t,134217728)}};cx=function(t){if(t.tag===13){var e=Is(t),n=$r(t,e);if(n!==null){var r=Zt();Qn(n,t,e,r)}am(t,e)}};dx=function(){return Le};hx=function(t,e){var n=Le;try{return Le=t,e()}finally{Le=n}};ef=function(t,e,n){switch(e){case"input":if(Gh(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var s=qc(r);if(!s)throw Error(q(90));zw(r),Gh(r,s)}}}break;case"textarea":Ww(t,n);break;case"select":e=n.value,e!=null&&ro(t,!!n.multiple,e,!1)}};Xw=nm;Zw=hi;var Yb={usingClientEntryPoint:!1,Events:[fl,Ki,qc,Yw,Jw,nm]},oa={findFiberByHostInstance:ei,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Jb={bundleType:oa.bundleType,version:oa.version,rendererPackageName:oa.rendererPackageName,rendererConfig:oa.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Gr.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=nx(t),t===null?null:t.stateNode},findFiberByHostInstance:oa.findFiberByHostInstance||Kb,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var pu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!pu.isDisabled&&pu.supportsFiber)try{Fc=pu.inject(Jb),dr=pu}catch{}}In.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Yb;In.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!um(e))throw Error(q(200));return Gb(t,e,null,n)};In.createRoot=function(t,e){if(!um(t))throw Error(q(299));var n=!1,r="",s=D0;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=om(t,1,!1,null,null,n,!1,r,s),t[Fr]=e.current,Fa(t.nodeType===8?t.parentNode:t),new lm(e)};In.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(q(188)):(t=Object.keys(t).join(","),Error(q(268,t)));return t=nx(e),t=t===null?null:t.stateNode,t};In.flushSync=function(t){return hi(t)};In.hydrate=function(t,e,n){if(!Zc(e))throw Error(q(200));return ed(null,t,e,!0,n)};In.hydrateRoot=function(t,e,n){if(!um(t))throw Error(q(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",o=D0;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=j0(e,null,t,1,n??null,s,!1,i,o),t[Fr]=e.current,Fa(t),r)for(t=0;t<r.length;t++)n=r[t],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new Xc(e)};In.render=function(t,e,n){if(!Zc(e))throw Error(q(200));return ed(null,t,e,!1,n)};In.unmountComponentAtNode=function(t){if(!Zc(t))throw Error(q(40));return t._reactRootContainer?(hi(function(){ed(null,null,t,!1,function(){t._reactRootContainer=null,t[Fr]=null})}),!0):!1};In.unstable_batchedUpdates=nm;In.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Zc(n))throw Error(q(200));if(t==null||t._reactInternals===void 0)throw Error(q(38));return ed(t,e,n,!1,r)};In.version="18.3.1-next-f1338f8080-20240426";function O0(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(O0)}catch(t){console.error(t)}}O0(),Ow.exports=In;var Xb=Ow.exports,wv=Xb;Fh.createRoot=wv.createRoot,Fh.hydrateRoot=wv.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Qa(){return Qa=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Qa.apply(this,arguments)}var gs;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(gs||(gs={}));const xv="popstate";function Zb(t){t===void 0&&(t={});function e(r,s){let{pathname:i,search:o,hash:l}=r.location;return Df("",{pathname:i,search:o,hash:l},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function n(r,s){return typeof s=="string"?s:pc(s)}return tA(e,n,null,t)}function nt(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function L0(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function eA(){return Math.random().toString(36).substr(2,8)}function Ev(t,e){return{usr:t.state,key:t.key,idx:e}}function Df(t,e,n,r){return n===void 0&&(n=null),Qa({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?jo(e):e,{state:n,key:e&&e.key||r||eA()})}function pc(t){let{pathname:e="/",search:n="",hash:r=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function jo(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substr(r),t=t.substr(0,r)),t&&(e.pathname=t)}return e}function tA(t,e,n,r){r===void 0&&(r={});let{window:s=document.defaultView,v5Compat:i=!1}=r,o=s.history,l=gs.Pop,u=null,d=f();d==null&&(d=0,o.replaceState(Qa({},o.state,{idx:d}),""));function f(){return(o.state||{idx:null}).idx}function p(){l=gs.Pop;let b=f(),E=b==null?null:b-d;d=b,u&&u({action:l,location:A.location,delta:E})}function m(b,E){l=gs.Push;let v=Df(A.location,b,E);d=f()+1;let w=Ev(v,d),R=A.createHref(v);try{o.pushState(w,"",R)}catch(D){if(D instanceof DOMException&&D.name==="DataCloneError")throw D;s.location.assign(R)}i&&u&&u({action:l,location:A.location,delta:1})}function y(b,E){l=gs.Replace;let v=Df(A.location,b,E);d=f();let w=Ev(v,d),R=A.createHref(v);o.replaceState(w,"",R),i&&u&&u({action:l,location:A.location,delta:0})}function x(b){let E=s.location.origin!=="null"?s.location.origin:s.location.href,v=typeof b=="string"?b:pc(b);return v=v.replace(/ $/,"%20"),nt(E,"No window.location.(origin|href) available to create URL for href: "+v),new URL(v,E)}let A={get action(){return l},get location(){return t(s,o)},listen(b){if(u)throw new Error("A history only accepts one active listener");return s.addEventListener(xv,p),u=b,()=>{s.removeEventListener(xv,p),u=null}},createHref(b){return e(s,b)},createURL:x,encodeLocation(b){let E=x(b);return{pathname:E.pathname,search:E.search,hash:E.hash}},push:m,replace:y,go(b){return o.go(b)}};return A}var Tv;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(Tv||(Tv={}));function nA(t,e,n){return n===void 0&&(n="/"),rA(t,e,n)}function rA(t,e,n,r){let s=typeof e=="string"?jo(e):e,i=xo(s.pathname||"/",n);if(i==null)return null;let o=V0(t);sA(o);let l=null;for(let u=0;l==null&&u<o.length;++u){let d=mA(i);l=fA(o[u],d)}return l}function V0(t,e,n,r){e===void 0&&(e=[]),n===void 0&&(n=[]),r===void 0&&(r="");let s=(i,o,l)=>{let u={relativePath:l===void 0?i.path||"":l,caseSensitive:i.caseSensitive===!0,childrenIndex:o,route:i};u.relativePath.startsWith("/")&&(nt(u.relativePath.startsWith(r),'Absolute route path "'+u.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),u.relativePath=u.relativePath.slice(r.length));let d=Ns([r,u.relativePath]),f=n.concat(u);i.children&&i.children.length>0&&(nt(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+d+'".')),V0(i.children,e,f,d)),!(i.path==null&&!i.index)&&e.push({path:d,score:dA(d,i.index),routesMeta:f})};return t.forEach((i,o)=>{var l;if(i.path===""||!((l=i.path)!=null&&l.includes("?")))s(i,o);else for(let u of M0(i.path))s(i,o,u)}),e}function M0(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,s=n.endsWith("?"),i=n.replace(/\?$/,"");if(r.length===0)return s?[i,""]:[i];let o=M0(r.join("/")),l=[];return l.push(...o.map(u=>u===""?i:[i,u].join("/"))),s&&l.push(...o),l.map(u=>t.startsWith("/")&&u===""?"/":u)}function sA(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:hA(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const iA=/^:[\w-]+$/,oA=3,aA=2,lA=1,uA=10,cA=-2,Iv=t=>t==="*";function dA(t,e){let n=t.split("/"),r=n.length;return n.some(Iv)&&(r+=cA),e&&(r+=aA),n.filter(s=>!Iv(s)).reduce((s,i)=>s+(iA.test(i)?oA:i===""?lA:uA),r)}function hA(t,e){return t.length===e.length&&t.slice(0,-1).every((r,s)=>r===e[s])?t[t.length-1]-e[e.length-1]:0}function fA(t,e,n){let{routesMeta:r}=t,s={},i="/",o=[];for(let l=0;l<r.length;++l){let u=r[l],d=l===r.length-1,f=i==="/"?e:e.slice(i.length)||"/",p=Of({path:u.relativePath,caseSensitive:u.caseSensitive,end:d},f),m=u.route;if(!p)return null;Object.assign(s,p.params),o.push({params:s,pathname:Ns([i,p.pathname]),pathnameBase:_A(Ns([i,p.pathnameBase])),route:m}),p.pathnameBase!=="/"&&(i=Ns([i,p.pathnameBase]))}return o}function Of(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=pA(t.path,t.caseSensitive,t.end),s=e.match(n);if(!s)return null;let i=s[0],o=i.replace(/(.)\/+$/,"$1"),l=s.slice(1);return{params:r.reduce((d,f,p)=>{let{paramName:m,isOptional:y}=f;if(m==="*"){let A=l[p]||"";o=i.slice(0,i.length-A.length).replace(/(.)\/+$/,"$1")}const x=l[p];return y&&!x?d[m]=void 0:d[m]=(x||"").replace(/%2F/g,"/"),d},{}),pathname:i,pathnameBase:o,pattern:t}}function pA(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),L0(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let r=[],s="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,l,u)=>(r.push({paramName:l,isOptional:u!=null}),u?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(r.push({paramName:"*"}),s+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?s+="\\/*$":t!==""&&t!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),r]}function mA(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return L0(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function xo(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}function gA(t,e){e===void 0&&(e="/");let{pathname:n,search:r="",hash:s=""}=typeof t=="string"?jo(t):t;return{pathname:n?n.startsWith("/")?n:yA(n,e):e,search:wA(r),hash:xA(s)}}function yA(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(s=>{s===".."?n.length>1&&n.pop():s!=="."&&n.push(s)}),n.length>1?n.join("/"):"/"}function _h(t,e,n,r){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function vA(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function cm(t,e){let n=vA(t);return e?n.map((r,s)=>s===n.length-1?r.pathname:r.pathnameBase):n.map(r=>r.pathnameBase)}function dm(t,e,n,r){r===void 0&&(r=!1);let s;typeof t=="string"?s=jo(t):(s=Qa({},t),nt(!s.pathname||!s.pathname.includes("?"),_h("?","pathname","search",s)),nt(!s.pathname||!s.pathname.includes("#"),_h("#","pathname","hash",s)),nt(!s.search||!s.search.includes("#"),_h("#","search","hash",s)));let i=t===""||s.pathname==="",o=i?"/":s.pathname,l;if(o==null)l=n;else{let p=e.length-1;if(!r&&o.startsWith("..")){let m=o.split("/");for(;m[0]==="..";)m.shift(),p-=1;s.pathname=m.join("/")}l=p>=0?e[p]:"/"}let u=gA(s,l),d=o&&o!=="/"&&o.endsWith("/"),f=(i||o===".")&&n.endsWith("/");return!u.pathname.endsWith("/")&&(d||f)&&(u.pathname+="/"),u}const Ns=t=>t.join("/").replace(/\/\/+/g,"/"),_A=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),wA=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,xA=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function EA(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const U0=["post","put","patch","delete"];new Set(U0);const TA=["get",...U0];new Set(TA);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Ya(){return Ya=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Ya.apply(this,arguments)}const td=k.createContext(null),F0=k.createContext(null),Kr=k.createContext(null),nd=k.createContext(null),Qr=k.createContext({outlet:null,matches:[],isDataRoute:!1}),$0=k.createContext(null);function IA(t,e){let{relative:n}=e===void 0?{}:e;Do()||nt(!1);let{basename:r,navigator:s}=k.useContext(Kr),{hash:i,pathname:o,search:l}=rd(t,{relative:n}),u=o;return r!=="/"&&(u=o==="/"?r:Ns([r,o])),s.createHref({pathname:u,search:l,hash:i})}function Do(){return k.useContext(nd)!=null}function Vn(){return Do()||nt(!1),k.useContext(nd).location}function B0(t){k.useContext(Kr).static||k.useLayoutEffect(t)}function Yr(){let{isDataRoute:t}=k.useContext(Qr);return t?VA():SA()}function SA(){Do()||nt(!1);let t=k.useContext(td),{basename:e,future:n,navigator:r}=k.useContext(Kr),{matches:s}=k.useContext(Qr),{pathname:i}=Vn(),o=JSON.stringify(cm(s,n.v7_relativeSplatPath)),l=k.useRef(!1);return B0(()=>{l.current=!0}),k.useCallback(function(d,f){if(f===void 0&&(f={}),!l.current)return;if(typeof d=="number"){r.go(d);return}let p=dm(d,JSON.parse(o),i,f.relative==="path");t==null&&e!=="/"&&(p.pathname=p.pathname==="/"?e:Ns([e,p.pathname])),(f.replace?r.replace:r.push)(p,f.state,f)},[e,r,o,i,t])}function Ti(){let{matches:t}=k.useContext(Qr),e=t[t.length-1];return e?e.params:{}}function rd(t,e){let{relative:n}=e===void 0?{}:e,{future:r}=k.useContext(Kr),{matches:s}=k.useContext(Qr),{pathname:i}=Vn(),o=JSON.stringify(cm(s,r.v7_relativeSplatPath));return k.useMemo(()=>dm(t,JSON.parse(o),i,n==="path"),[t,o,i,n])}function NA(t,e){return bA(t,e)}function bA(t,e,n,r){Do()||nt(!1);let{navigator:s}=k.useContext(Kr),{matches:i}=k.useContext(Qr),o=i[i.length-1],l=o?o.params:{};o&&o.pathname;let u=o?o.pathnameBase:"/";o&&o.route;let d=Vn(),f;if(e){var p;let b=typeof e=="string"?jo(e):e;u==="/"||(p=b.pathname)!=null&&p.startsWith(u)||nt(!1),f=b}else f=d;let m=f.pathname||"/",y=m;if(u!=="/"){let b=u.replace(/^\//,"").split("/");y="/"+m.replace(/^\//,"").split("/").slice(b.length).join("/")}let x=nA(t,{pathname:y}),A=PA(x&&x.map(b=>Object.assign({},b,{params:Object.assign({},l,b.params),pathname:Ns([u,s.encodeLocation?s.encodeLocation(b.pathname).pathname:b.pathname]),pathnameBase:b.pathnameBase==="/"?u:Ns([u,s.encodeLocation?s.encodeLocation(b.pathnameBase).pathname:b.pathnameBase])})),i,n,r);return e&&A?k.createElement(nd.Provider,{value:{location:Ya({pathname:"/",search:"",hash:"",state:null,key:"default"},f),navigationType:gs.Pop}},A):A}function AA(){let t=LA(),e=EA(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return k.createElement(k.Fragment,null,k.createElement("h2",null,"Unexpected Application Error!"),k.createElement("h3",{style:{fontStyle:"italic"}},e),n?k.createElement("pre",{style:s},n):null,null)}const CA=k.createElement(AA,null);class kA extends k.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?k.createElement(Qr.Provider,{value:this.props.routeContext},k.createElement($0.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function RA(t){let{routeContext:e,match:n,children:r}=t,s=k.useContext(td);return s&&s.static&&s.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=n.route.id),k.createElement(Qr.Provider,{value:e},r)}function PA(t,e,n,r){var s;if(e===void 0&&(e=[]),n===void 0&&(n=null),r===void 0&&(r=null),t==null){var i;if(!n)return null;if(n.errors)t=n.matches;else if((i=r)!=null&&i.v7_partialHydration&&e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let o=t,l=(s=n)==null?void 0:s.errors;if(l!=null){let f=o.findIndex(p=>p.route.id&&(l==null?void 0:l[p.route.id])!==void 0);f>=0||nt(!1),o=o.slice(0,Math.min(o.length,f+1))}let u=!1,d=-1;if(n&&r&&r.v7_partialHydration)for(let f=0;f<o.length;f++){let p=o[f];if((p.route.HydrateFallback||p.route.hydrateFallbackElement)&&(d=f),p.route.id){let{loaderData:m,errors:y}=n,x=p.route.loader&&m[p.route.id]===void 0&&(!y||y[p.route.id]===void 0);if(p.route.lazy||x){u=!0,d>=0?o=o.slice(0,d+1):o=[o[0]];break}}}return o.reduceRight((f,p,m)=>{let y,x=!1,A=null,b=null;n&&(y=l&&p.route.id?l[p.route.id]:void 0,A=p.route.errorElement||CA,u&&(d<0&&m===0?(MA("route-fallback"),x=!0,b=null):d===m&&(x=!0,b=p.route.hydrateFallbackElement||null)));let E=e.concat(o.slice(0,m+1)),v=()=>{let w;return y?w=A:x?w=b:p.route.Component?w=k.createElement(p.route.Component,null):p.route.element?w=p.route.element:w=f,k.createElement(RA,{match:p,routeContext:{outlet:f,matches:E,isDataRoute:n!=null},children:w})};return n&&(p.route.ErrorBoundary||p.route.errorElement||m===0)?k.createElement(kA,{location:n.location,revalidation:n.revalidation,component:A,error:y,children:v(),routeContext:{outlet:null,matches:E,isDataRoute:!0}}):v()},null)}var z0=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(z0||{}),q0=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(q0||{});function jA(t){let e=k.useContext(td);return e||nt(!1),e}function DA(t){let e=k.useContext(F0);return e||nt(!1),e}function OA(t){let e=k.useContext(Qr);return e||nt(!1),e}function W0(t){let e=OA(),n=e.matches[e.matches.length-1];return n.route.id||nt(!1),n.route.id}function LA(){var t;let e=k.useContext($0),n=DA(),r=W0();return e!==void 0?e:(t=n.errors)==null?void 0:t[r]}function VA(){let{router:t}=jA(z0.UseNavigateStable),e=W0(q0.UseNavigateStable),n=k.useRef(!1);return B0(()=>{n.current=!0}),k.useCallback(function(s,i){i===void 0&&(i={}),n.current&&(typeof s=="number"?t.navigate(s):t.navigate(s,Ya({fromRouteId:e},i)))},[t,e])}const Sv={};function MA(t,e,n){Sv[t]||(Sv[t]=!0)}function UA(t,e){t==null||t.v7_startTransition,t==null||t.v7_relativeSplatPath}function fr(t){let{to:e,replace:n,state:r,relative:s}=t;Do()||nt(!1);let{future:i,static:o}=k.useContext(Kr),{matches:l}=k.useContext(Qr),{pathname:u}=Vn(),d=Yr(),f=dm(e,cm(l,i.v7_relativeSplatPath),u,s==="path"),p=JSON.stringify(f);return k.useEffect(()=>d(JSON.parse(p),{replace:n,state:r,relative:s}),[d,p,s,n,r]),null}function Pe(t){nt(!1)}function FA(t){let{basename:e="/",children:n=null,location:r,navigationType:s=gs.Pop,navigator:i,static:o=!1,future:l}=t;Do()&&nt(!1);let u=e.replace(/^\/*/,"/"),d=k.useMemo(()=>({basename:u,navigator:i,static:o,future:Ya({v7_relativeSplatPath:!1},l)}),[u,l,i,o]);typeof r=="string"&&(r=jo(r));let{pathname:f="/",search:p="",hash:m="",state:y=null,key:x="default"}=r,A=k.useMemo(()=>{let b=xo(f,u);return b==null?null:{location:{pathname:b,search:p,hash:m,state:y,key:x},navigationType:s}},[u,f,p,m,y,x,s]);return A==null?null:k.createElement(Kr.Provider,{value:d},k.createElement(nd.Provider,{children:n,value:A}))}function $A(t){let{children:e,location:n}=t;return NA(Lf(e),n)}new Promise(()=>{});function Lf(t,e){e===void 0&&(e=[]);let n=[];return k.Children.forEach(t,(r,s)=>{if(!k.isValidElement(r))return;let i=[...e,s];if(r.type===k.Fragment){n.push.apply(n,Lf(r.props.children,i));return}r.type!==Pe&&nt(!1),!r.props.index||!r.props.children||nt(!1);let o={id:r.props.id||i.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(o.children=Lf(r.props.children,i)),n.push(o)}),n}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function mc(){return mc=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},mc.apply(this,arguments)}function H0(t,e){if(t==null)return{};var n={},r=Object.keys(t),s,i;for(i=0;i<r.length;i++)s=r[i],!(e.indexOf(s)>=0)&&(n[s]=t[s]);return n}function BA(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function zA(t,e){return t.button===0&&(!e||e==="_self")&&!BA(t)}function Vf(t){return t===void 0&&(t=""),new URLSearchParams(typeof t=="string"||Array.isArray(t)||t instanceof URLSearchParams?t:Object.keys(t).reduce((e,n)=>{let r=t[n];return e.concat(Array.isArray(r)?r.map(s=>[n,s]):[[n,r]])},[]))}function qA(t,e){let n=Vf(t);return e&&e.forEach((r,s)=>{n.has(s)||e.getAll(s).forEach(i=>{n.append(s,i)})}),n}const WA=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],HA=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],GA="6";try{window.__reactRouterVersion=GA}catch{}const KA=k.createContext({isTransitioning:!1}),QA="startTransition",Nv=$S[QA];function YA(t){let{basename:e,children:n,future:r,window:s}=t,i=k.useRef();i.current==null&&(i.current=Zb({window:s,v5Compat:!0}));let o=i.current,[l,u]=k.useState({action:o.action,location:o.location}),{v7_startTransition:d}=r||{},f=k.useCallback(p=>{d&&Nv?Nv(()=>u(p)):u(p)},[u,d]);return k.useLayoutEffect(()=>o.listen(f),[o,f]),k.useEffect(()=>UA(r),[r]),k.createElement(FA,{basename:e,children:n,location:l.location,navigationType:l.action,navigator:o,future:r})}const JA=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",XA=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,we=k.forwardRef(function(e,n){let{onClick:r,relative:s,reloadDocument:i,replace:o,state:l,target:u,to:d,preventScrollReset:f,viewTransition:p}=e,m=H0(e,WA),{basename:y}=k.useContext(Kr),x,A=!1;if(typeof d=="string"&&XA.test(d)&&(x=d,JA))try{let w=new URL(window.location.href),R=d.startsWith("//")?new URL(w.protocol+d):new URL(d),D=xo(R.pathname,y);R.origin===w.origin&&D!=null?d=D+R.search+R.hash:A=!0}catch{}let b=IA(d,{relative:s}),E=e1(d,{replace:o,state:l,target:u,preventScrollReset:f,relative:s,viewTransition:p});function v(w){r&&r(w),w.defaultPrevented||E(w)}return k.createElement("a",mc({},m,{href:x||b,onClick:A||i?r:v,ref:n,target:u}))}),mu=k.forwardRef(function(e,n){let{"aria-current":r="page",caseSensitive:s=!1,className:i="",end:o=!1,style:l,to:u,viewTransition:d,children:f}=e,p=H0(e,HA),m=rd(u,{relative:p.relative}),y=Vn(),x=k.useContext(F0),{navigator:A,basename:b}=k.useContext(Kr),E=x!=null&&n1(m)&&d===!0,v=A.encodeLocation?A.encodeLocation(m).pathname:m.pathname,w=y.pathname,R=x&&x.navigation&&x.navigation.location?x.navigation.location.pathname:null;s||(w=w.toLowerCase(),R=R?R.toLowerCase():null,v=v.toLowerCase()),R&&b&&(R=xo(R,b)||R);const D=v!=="/"&&v.endsWith("/")?v.length-1:v.length;let L=w===v||!o&&w.startsWith(v)&&w.charAt(D)==="/",S=R!=null&&(R===v||!o&&R.startsWith(v)&&R.charAt(v.length)==="/"),_={isActive:L,isPending:S,isTransitioning:E},I=L?r:void 0,N;typeof i=="function"?N=i(_):N=[i,L?"active":null,S?"pending":null,E?"transitioning":null].filter(Boolean).join(" ");let P=typeof l=="function"?l(_):l;return k.createElement(we,mc({},p,{"aria-current":I,className:N,ref:n,style:P,to:u,viewTransition:d}),typeof f=="function"?f(_):f)});var Mf;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(Mf||(Mf={}));var bv;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(bv||(bv={}));function ZA(t){let e=k.useContext(td);return e||nt(!1),e}function e1(t,e){let{target:n,replace:r,state:s,preventScrollReset:i,relative:o,viewTransition:l}=e===void 0?{}:e,u=Yr(),d=Vn(),f=rd(t,{relative:o});return k.useCallback(p=>{if(zA(p,n)){p.preventDefault();let m=r!==void 0?r:pc(d)===pc(f);u(t,{replace:m,state:s,preventScrollReset:i,relative:o,viewTransition:l})}},[d,u,f,r,s,n,t,i,o,l])}function t1(t){let e=k.useRef(Vf(t)),n=k.useRef(!1),r=Vn(),s=k.useMemo(()=>qA(r.search,n.current?null:e.current),[r.search]),i=Yr(),o=k.useCallback((l,u)=>{const d=Vf(typeof l=="function"?l(s):l);n.current=!0,i("?"+d,u)},[i,s]);return[s,o]}function n1(t,e){e===void 0&&(e={});let n=k.useContext(KA);n==null&&nt(!1);let{basename:r}=ZA(Mf.useViewTransitionState),s=rd(t,{relative:e.relative});if(!n.isTransitioning)return!1;let i=xo(n.currentLocation.pathname,r)||n.currentLocation.pathname,o=xo(n.nextLocation.pathname,r)||n.nextLocation.pathname;return Of(s.pathname,o)!=null||Of(s.pathname,i)!=null}const r1=()=>{};var Av={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const G0=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},s1=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[n++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[n++],o=t[n++],l=t[n++],u=((s&7)<<18|(i&63)<<12|(o&63)<<6|l&63)-65536;e[r++]=String.fromCharCode(55296+(u>>10)),e[r++]=String.fromCharCode(56320+(u&1023))}else{const i=t[n++],o=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},K0={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const i=t[s],o=s+1<t.length,l=o?t[s+1]:0,u=s+2<t.length,d=u?t[s+2]:0,f=i>>2,p=(i&3)<<4|l>>4;let m=(l&15)<<2|d>>6,y=d&63;u||(y=64,o||(m=64)),r.push(n[f],n[p],n[m],n[y])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(G0(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):s1(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const i=n[t.charAt(s++)],l=s<t.length?n[t.charAt(s)]:0;++s;const d=s<t.length?n[t.charAt(s)]:64;++s;const p=s<t.length?n[t.charAt(s)]:64;if(++s,i==null||l==null||d==null||p==null)throw new i1;const m=i<<2|l>>4;if(r.push(m),d!==64){const y=l<<4&240|d>>2;if(r.push(y),p!==64){const x=d<<6&192|p;r.push(x)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class i1 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const o1=function(t){const e=G0(t);return K0.encodeByteArray(e,!0)},gc=function(t){return o1(t).replace(/\./g,"")},Q0=function(t){try{return K0.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function a1(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const l1=()=>a1().__FIREBASE_DEFAULTS__,u1=()=>{if(typeof process>"u"||typeof Av>"u")return;const t=Av.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},c1=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&Q0(t[1]);return e&&JSON.parse(e)},sd=()=>{try{return r1()||l1()||u1()||c1()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},Y0=t=>{var e,n;return(n=(e=sd())==null?void 0:e.emulatorHosts)==null?void 0:n[t]},J0=t=>{const e=Y0(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},X0=()=>{var t;return(t=sd())==null?void 0:t.config},Z0=t=>{var e;return(e=sd())==null?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d1{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ii(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function hm(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function h1(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",s=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}},...t};return[gc(JSON.stringify(n)),gc(JSON.stringify(o)),""].join(".")}const Sa={};function f1(){const t={prod:[],emulator:[]};for(const e of Object.keys(Sa))Sa[e]?t.emulator.push(e):t.prod.push(e);return t}function p1(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let Cv=!1;function fm(t,e){if(typeof window>"u"||typeof document>"u"||!Ii(window.location.host)||Sa[t]===e||Sa[t]||Cv)return;Sa[t]=e;function n(m){return`__firebase__banner__${m}`}const r="__firebase__banner",i=f1().prod.length>0;function o(){const m=document.getElementById(r);m&&m.remove()}function l(m){m.style.display="flex",m.style.background="#7faaf0",m.style.position="fixed",m.style.bottom="5px",m.style.left="5px",m.style.padding=".5em",m.style.borderRadius="5px",m.style.alignItems="center"}function u(m,y){m.setAttribute("width","24"),m.setAttribute("id",y),m.setAttribute("height","24"),m.setAttribute("viewBox","0 0 24 24"),m.setAttribute("fill","none"),m.style.marginLeft="-6px"}function d(){const m=document.createElement("span");return m.style.cursor="pointer",m.style.marginLeft="16px",m.style.fontSize="24px",m.innerHTML=" &times;",m.onclick=()=>{Cv=!0,o()},m}function f(m,y){m.setAttribute("id",y),m.innerText="Learn more",m.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",m.setAttribute("target","__blank"),m.style.paddingLeft="5px",m.style.textDecoration="underline"}function p(){const m=p1(r),y=n("text"),x=document.getElementById(y)||document.createElement("span"),A=n("learnmore"),b=document.getElementById(A)||document.createElement("a"),E=n("preprendIcon"),v=document.getElementById(E)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(m.created){const w=m.element;l(w),f(b,A);const R=d();u(v,E),w.append(v,x,b,R),document.body.appendChild(w)}i?(x.innerText="Preview backend disconnected.",v.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(v.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,x.innerText="Preview backend running in this workspace."),x.setAttribute("id",y)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",p):p()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qt(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function m1(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Qt())}function g1(){var e;const t=(e=sd())==null?void 0:e.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function y1(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function v1(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function _1(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function w1(){const t=Qt();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function x1(){return!g1()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function eE(){try{return typeof indexedDB=="object"}catch{return!1}}function tE(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var i;e(((i=s.error)==null?void 0:i.message)||"")}}catch(n){e(n)}})}function E1(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const T1="FirebaseError";class nr extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=T1,Object.setPrototypeOf(this,nr.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Si.prototype.create)}}class Si{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?I1(i,r):"Error",l=`${this.serviceName}: ${o} (${s}).`;return new nr(s,l,r)}}function I1(t,e){return t.replace(S1,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const S1=/\{\$([^}]+)}/g;function N1(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function fi(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const s of n){if(!r.includes(s))return!1;const i=t[s],o=e[s];if(kv(i)&&kv(o)){if(!fi(i,o))return!1}else if(i!==o)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function kv(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ml(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function da(t){const e={};return t.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[s,i]=r.split("=");e[decodeURIComponent(s)]=decodeURIComponent(i)}}),e}function ha(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}function b1(t,e){const n=new A1(t,e);return n.subscribe.bind(n)}class A1{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let s;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");C1(e,["next","error","complete"])?s=e:s={next:e,error:n,complete:r},s.next===void 0&&(s.next=wh),s.error===void 0&&(s.error=wh),s.complete===void 0&&(s.complete=wh);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function C1(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function wh(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function De(t){return t&&t._delegate?t._delegate:t}class Dn{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zs="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k1{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new d1;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),r=(e==null?void 0:e.optional)??!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(s){if(r)return null;throw s}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(P1(e))try{this.getOrInitializeService({instanceIdentifier:Zs})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=Zs){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Zs){return this.instances.has(e)}getOptions(e=Zs){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[i,o]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(i);r===l&&o.resolve(s)}return s}onInit(e,n){const r=this.normalizeInstanceIdentifier(n),s=this.onInitCallbacks.get(r)??new Set;s.add(e),this.onInitCallbacks.set(r,s);const i=this.instances.get(r);return i&&e(i,r),()=>{s.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const s of r)try{s(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:R1(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Zs){return this.component?this.component.multipleInstances?e:Zs:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function R1(t){return t===Zs?void 0:t}function P1(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j1{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new k1(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ee;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Ee||(Ee={}));const D1={debug:Ee.DEBUG,verbose:Ee.VERBOSE,info:Ee.INFO,warn:Ee.WARN,error:Ee.ERROR,silent:Ee.SILENT},O1=Ee.INFO,L1={[Ee.DEBUG]:"log",[Ee.VERBOSE]:"log",[Ee.INFO]:"info",[Ee.WARN]:"warn",[Ee.ERROR]:"error"},V1=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),s=L1[e];if(s)console[s](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class pm{constructor(e){this.name=e,this._logLevel=O1,this._logHandler=V1,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ee))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?D1[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ee.DEBUG,...e),this._logHandler(this,Ee.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ee.VERBOSE,...e),this._logHandler(this,Ee.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ee.INFO,...e),this._logHandler(this,Ee.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ee.WARN,...e),this._logHandler(this,Ee.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ee.ERROR,...e),this._logHandler(this,Ee.ERROR,...e)}}const M1=(t,e)=>e.some(n=>t instanceof n);let Rv,Pv;function U1(){return Rv||(Rv=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function F1(){return Pv||(Pv=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const nE=new WeakMap,Uf=new WeakMap,rE=new WeakMap,xh=new WeakMap,mm=new WeakMap;function $1(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{n(Lr(t.result)),s()},o=()=>{r(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&nE.set(n,t)}).catch(()=>{}),mm.set(e,t),e}function B1(t){if(Uf.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{n(),s()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)});Uf.set(t,e)}let Ff={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return Uf.get(t);if(e==="objectStoreNames")return t.objectStoreNames||rE.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Lr(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function z1(t){Ff=t(Ff)}function q1(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(Eh(this),e,...n);return rE.set(r,e.sort?e.sort():[e]),Lr(r)}:F1().includes(t)?function(...e){return t.apply(Eh(this),e),Lr(nE.get(this))}:function(...e){return Lr(t.apply(Eh(this),e))}}function W1(t){return typeof t=="function"?q1(t):(t instanceof IDBTransaction&&B1(t),M1(t,U1())?new Proxy(t,Ff):t)}function Lr(t){if(t instanceof IDBRequest)return $1(t);if(xh.has(t))return xh.get(t);const e=W1(t);return e!==t&&(xh.set(t,e),mm.set(e,t)),e}const Eh=t=>mm.get(t);function id(t,e,{blocked:n,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(t,e),l=Lr(o);return r&&o.addEventListener("upgradeneeded",u=>{r(Lr(o.result),u.oldVersion,u.newVersion,Lr(o.transaction),u)}),n&&o.addEventListener("blocked",u=>n(u.oldVersion,u.newVersion,u)),l.then(u=>{i&&u.addEventListener("close",()=>i()),s&&u.addEventListener("versionchange",d=>s(d.oldVersion,d.newVersion,d))}).catch(()=>{}),l}function Th(t,{blocked:e}={}){const n=indexedDB.deleteDatabase(t);return e&&n.addEventListener("blocked",r=>e(r.oldVersion,r)),Lr(n).then(()=>{})}const H1=["get","getKey","getAll","getAllKeys","count"],G1=["put","add","delete","clear"],Ih=new Map;function jv(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Ih.get(e))return Ih.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=G1.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||H1.includes(n)))return;const i=async function(o,...l){const u=this.transaction(o,s?"readwrite":"readonly");let d=u.store;return r&&(d=d.index(l.shift())),(await Promise.all([d[n](...l),s&&u.done]))[0]};return Ih.set(e,i),i}z1(t=>({...t,get:(e,n,r)=>jv(e,n)||t.get(e,n,r),has:(e,n)=>!!jv(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K1{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(Q1(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function Q1(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const $f="@firebase/app",Dv="0.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zr=new pm("@firebase/app"),Y1="@firebase/app-compat",J1="@firebase/analytics-compat",X1="@firebase/analytics",Z1="@firebase/app-check-compat",eC="@firebase/app-check",tC="@firebase/auth",nC="@firebase/auth-compat",rC="@firebase/database",sC="@firebase/data-connect",iC="@firebase/database-compat",oC="@firebase/functions",aC="@firebase/functions-compat",lC="@firebase/installations",uC="@firebase/installations-compat",cC="@firebase/messaging",dC="@firebase/messaging-compat",hC="@firebase/performance",fC="@firebase/performance-compat",pC="@firebase/remote-config",mC="@firebase/remote-config-compat",gC="@firebase/storage",yC="@firebase/storage-compat",vC="@firebase/firestore",_C="@firebase/ai",wC="@firebase/firestore-compat",xC="firebase",EC="12.1.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bf="[DEFAULT]",TC={[$f]:"fire-core",[Y1]:"fire-core-compat",[X1]:"fire-analytics",[J1]:"fire-analytics-compat",[eC]:"fire-app-check",[Z1]:"fire-app-check-compat",[tC]:"fire-auth",[nC]:"fire-auth-compat",[rC]:"fire-rtdb",[sC]:"fire-data-connect",[iC]:"fire-rtdb-compat",[oC]:"fire-fn",[aC]:"fire-fn-compat",[lC]:"fire-iid",[uC]:"fire-iid-compat",[cC]:"fire-fcm",[dC]:"fire-fcm-compat",[hC]:"fire-perf",[fC]:"fire-perf-compat",[pC]:"fire-rc",[mC]:"fire-rc-compat",[gC]:"fire-gcs",[yC]:"fire-gcs-compat",[vC]:"fire-fst",[wC]:"fire-fst-compat",[_C]:"fire-vertex","fire-js":"fire-js",[xC]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ja=new Map,IC=new Map,zf=new Map;function Ov(t,e){try{t.container.addComponent(e)}catch(n){zr.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function er(t){const e=t.name;if(zf.has(e))return zr.debug(`There were multiple attempts to register component ${e}.`),!1;zf.set(e,t);for(const n of Ja.values())Ov(n,t);for(const n of IC.values())Ov(n,t);return!0}function Ni(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function an(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SC={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},bs=new Si("app","Firebase",SC);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NC{constructor(e,n,r){this._isDeleted=!1,this._options={...e},this._config={...n},this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Dn("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw bs.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Oo=EC;function sE(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r={name:Bf,automaticDataCollectionEnabled:!0,...e},s=r.name;if(typeof s!="string"||!s)throw bs.create("bad-app-name",{appName:String(s)});if(n||(n=X0()),!n)throw bs.create("no-options");const i=Ja.get(s);if(i){if(fi(n,i.options)&&fi(r,i.config))return i;throw bs.create("duplicate-app",{appName:s})}const o=new j1(s);for(const u of zf.values())o.addComponent(u);const l=new NC(n,r,o);return Ja.set(s,l),l}function gl(t=Bf){const e=Ja.get(t);if(!e&&t===Bf&&X0())return sE();if(!e)throw bs.create("no-app",{appName:t});return e}function bC(){return Array.from(Ja.values())}function mn(t,e,n){let r=TC[t]??t;n&&(r+=`-${n}`);const s=r.match(/\s|\//),i=e.match(/\s|\//);if(s||i){const o=[`Unable to register library "${r}" with version "${e}":`];s&&o.push(`library name "${r}" contains illegal characters (whitespace or "/")`),s&&i&&o.push("and"),i&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),zr.warn(o.join(" "));return}er(new Dn(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AC="firebase-heartbeat-database",CC=1,Xa="firebase-heartbeat-store";let Sh=null;function iE(){return Sh||(Sh=id(AC,CC,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Xa)}catch(n){console.warn(n)}}}}).catch(t=>{throw bs.create("idb-open",{originalErrorMessage:t.message})})),Sh}async function kC(t){try{const n=(await iE()).transaction(Xa),r=await n.objectStore(Xa).get(oE(t));return await n.done,r}catch(e){if(e instanceof nr)zr.warn(e.message);else{const n=bs.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});zr.warn(n.message)}}}async function Lv(t,e){try{const r=(await iE()).transaction(Xa,"readwrite");await r.objectStore(Xa).put(e,oE(t)),await r.done}catch(n){if(n instanceof nr)zr.warn(n.message);else{const r=bs.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});zr.warn(r.message)}}}function oE(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RC=1024,PC=30;class jC{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new OC(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=Vv();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)==null?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats.length>PC){const o=LC(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){zr.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=Vv(),{heartbeatsToSend:r,unsentEntries:s}=DC(this._heartbeatsCache.heartbeats),i=gc(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(n){return zr.warn(n),""}}}function Vv(){return new Date().toISOString().substring(0,10)}function DC(t,e=RC){const n=[];let r=t.slice();for(const s of t){const i=n.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),Mv(n)>e){i.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),Mv(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class OC{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return eE()?tE().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await kC(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return Lv(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return Lv(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function Mv(t){return gc(JSON.stringify({version:2,heartbeats:t})).length}function LC(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let r=1;r<t.length;r++)t[r].date<n&&(n=t[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VC(t){er(new Dn("platform-logger",e=>new K1(e),"PRIVATE")),er(new Dn("heartbeat",e=>new jC(e),"PRIVATE")),mn($f,Dv,t),mn($f,Dv,"esm2020"),mn("fire-js","")}VC("");function aE(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const MC=aE,lE=new Si("auth","Firebase",aE());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yc=new pm("@firebase/auth");function UC(t,...e){yc.logLevel<=Ee.WARN&&yc.warn(`Auth (${Oo}): ${t}`,...e)}function Ou(t,...e){yc.logLevel<=Ee.ERROR&&yc.error(`Auth (${Oo}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tn(t,...e){throw ym(t,...e)}function Yn(t,...e){return ym(t,...e)}function gm(t,e,n){const r={...MC(),[e]:n};return new Si("auth","Firebase",r).create(e,{appName:t.name})}function Vr(t){return gm(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function FC(t,e,n){const r=n;if(!(e instanceof r))throw r.name!==e.constructor.name&&Tn(t,"argument-error"),gm(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function ym(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return lE.create(t,...e)}function re(t,e,...n){if(!t)throw ym(e,...n)}function Pr(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Ou(e),new Error(e)}function qr(t,e){t||Pr(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qf(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.href)||""}function $C(){return Uv()==="http:"||Uv()==="https:"}function Uv(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BC(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&($C()||v1()||"connection"in navigator)?navigator.onLine:!0}function zC(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yl{constructor(e,n){this.shortDelay=e,this.longDelay=n,qr(n>e,"Short delay should be less than long delay!"),this.isMobile=m1()||_1()}get(){return BC()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vm(t,e){qr(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uE{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Pr("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Pr("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Pr("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qC={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WC=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],HC=new yl(3e4,6e4);function wr(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function rr(t,e,n,r,s={}){return cE(t,s,async()=>{let i={},o={};r&&(e==="GET"?o=r:i={body:JSON.stringify(r)});const l=ml({key:t.config.apiKey,...o}).slice(1),u=await t._getAdditionalHeaders();u["Content-Type"]="application/json",t.languageCode&&(u["X-Firebase-Locale"]=t.languageCode);const d={method:e,headers:u,...i};return y1()||(d.referrerPolicy="no-referrer"),t.emulatorConfig&&Ii(t.emulatorConfig.host)&&(d.credentials="include"),uE.fetch()(await dE(t,t.config.apiHost,n,l),d)})}async function cE(t,e,n){t._canInitEmulator=!1;const r={...qC,...e};try{const s=new KC(t),i=await Promise.race([n(),s.promise]);s.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw gu(t,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const l=i.ok?o.errorMessage:o.error.message,[u,d]=l.split(" : ");if(u==="FEDERATED_USER_ID_ALREADY_LINKED")throw gu(t,"credential-already-in-use",o);if(u==="EMAIL_EXISTS")throw gu(t,"email-already-in-use",o);if(u==="USER_DISABLED")throw gu(t,"user-disabled",o);const f=r[u]||u.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw gm(t,f,d);Tn(t,f)}}catch(s){if(s instanceof nr)throw s;Tn(t,"network-request-failed",{message:String(s)})}}async function vl(t,e,n,r,s={}){const i=await rr(t,e,n,r,s);return"mfaPendingCredential"in i&&Tn(t,"multi-factor-auth-required",{_serverResponse:i}),i}async function dE(t,e,n,r){const s=`${e}${n}?${r}`,i=t,o=i.config.emulator?vm(t.config,s):`${t.config.apiScheme}://${s}`;return WC.includes(n)&&(await i._persistenceManagerAvailable,i._getPersistenceType()==="COOKIE")?i._getPersistence()._getFinalTarget(o).toString():o}function GC(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class KC{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(Yn(this.auth,"network-request-failed")),HC.get())})}}function gu(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const s=Yn(t,e,r);return s.customData._tokenResponse=n,s}function Fv(t){return t!==void 0&&t.enterprise!==void 0}class QC{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return GC(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function YC(t,e){return rr(t,"GET","/v2/recaptchaConfig",wr(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function JC(t,e){return rr(t,"POST","/v1/accounts:delete",e)}async function vc(t,e){return rr(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Na(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function XC(t,e=!1){const n=De(t),r=await n.getIdToken(e),s=_m(r);re(s&&s.exp&&s.auth_time&&s.iat,n.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,o=i==null?void 0:i.sign_in_provider;return{claims:s,token:r,authTime:Na(Nh(s.auth_time)),issuedAtTime:Na(Nh(s.iat)),expirationTime:Na(Nh(s.exp)),signInProvider:o||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function Nh(t){return Number(t)*1e3}function _m(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return Ou("JWT malformed, contained fewer than 3 sections"),null;try{const s=Q0(n);return s?JSON.parse(s):(Ou("Failed to decode base64 JWT payload"),null)}catch(s){return Ou("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function $v(t){const e=_m(t);return re(e,"internal-error"),re(typeof e.exp<"u","internal-error"),re(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Eo(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof nr&&ZC(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function ZC({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ek{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wf{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=Na(this.lastLoginAt),this.creationTime=Na(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _c(t){var p;const e=t.auth,n=await t.getIdToken(),r=await Eo(t,vc(e,{idToken:n}));re(r==null?void 0:r.users.length,e,"internal-error");const s=r.users[0];t._notifyReloadListener(s);const i=(p=s.providerUserInfo)!=null&&p.length?hE(s.providerUserInfo):[],o=nk(t.providerData,i),l=t.isAnonymous,u=!(t.email&&s.passwordHash)&&!(o!=null&&o.length),d=l?u:!1,f={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new Wf(s.createdAt,s.lastLoginAt),isAnonymous:d};Object.assign(t,f)}async function tk(t){const e=De(t);await _c(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function nk(t,e){return[...t.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function hE(t){return t.map(({providerId:e,...n})=>({providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function rk(t,e){const n=await cE(t,{},async()=>{const r=ml({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=t.config,o=await dE(t,s,"/v1/token",`key=${i}`),l=await t._getAdditionalHeaders();l["Content-Type"]="application/x-www-form-urlencoded";const u={method:"POST",headers:l,body:r};return t.emulatorConfig&&Ii(t.emulatorConfig.host)&&(u.credentials="include"),uE.fetch()(o,u)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function sk(t,e){return rr(t,"POST","/v2/accounts:revokeToken",wr(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uo{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){re(e.idToken,"internal-error"),re(typeof e.idToken<"u","internal-error"),re(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):$v(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){re(e.length!==0,"internal-error");const n=$v(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(re(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:s,expiresIn:i}=await rk(e,n);this.updateTokensAndExpiration(r,s,Number(i))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:s,expirationTime:i}=n,o=new uo;return r&&(re(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),s&&(re(typeof s=="string","internal-error",{appName:e}),o.accessToken=s),i&&(re(typeof i=="number","internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new uo,this.toJSON())}_performRefresh(){return Pr("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rs(t,e){re(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Gn{constructor({uid:e,auth:n,stsTokenManager:r,...s}){this.providerId="firebase",this.proactiveRefresh=new ek(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new Wf(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const n=await Eo(this,this.stsTokenManager.getToken(this.auth,e));return re(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return XC(this,e)}reload(){return tk(this)}_assign(e){this!==e&&(re(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>({...n})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new Gn({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return n.metadata._copy(this.metadata),n}_onReload(e){re(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await _c(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(an(this.auth.app))return Promise.reject(Vr(this.auth));const e=await this.getIdToken();return await Eo(this,JC(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){const r=n.displayName??void 0,s=n.email??void 0,i=n.phoneNumber??void 0,o=n.photoURL??void 0,l=n.tenantId??void 0,u=n._redirectEventId??void 0,d=n.createdAt??void 0,f=n.lastLoginAt??void 0,{uid:p,emailVerified:m,isAnonymous:y,providerData:x,stsTokenManager:A}=n;re(p&&A,e,"internal-error");const b=uo.fromJSON(this.name,A);re(typeof p=="string",e,"internal-error"),rs(r,e.name),rs(s,e.name),re(typeof m=="boolean",e,"internal-error"),re(typeof y=="boolean",e,"internal-error"),rs(i,e.name),rs(o,e.name),rs(l,e.name),rs(u,e.name),rs(d,e.name),rs(f,e.name);const E=new Gn({uid:p,auth:e,email:s,emailVerified:m,displayName:r,isAnonymous:y,photoURL:o,phoneNumber:i,tenantId:l,stsTokenManager:b,createdAt:d,lastLoginAt:f});return x&&Array.isArray(x)&&(E.providerData=x.map(v=>({...v}))),u&&(E._redirectEventId=u),E}static async _fromIdTokenResponse(e,n,r=!1){const s=new uo;s.updateFromServerResponse(n);const i=new Gn({uid:n.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await _c(i),i}static async _fromGetAccountInfoResponse(e,n,r){const s=n.users[0];re(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?hE(s.providerUserInfo):[],o=!(s.email&&s.passwordHash)&&!(i!=null&&i.length),l=new uo;l.updateFromIdToken(r);const u=new Gn({uid:s.localId,auth:e,stsTokenManager:l,isAnonymous:o}),d={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new Wf(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(i!=null&&i.length)};return Object.assign(u,d),u}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bv=new Map;function jr(t){qr(t instanceof Function,"Expected a class definition");let e=Bv.get(t);return e?(qr(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,Bv.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fE{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}fE.type="NONE";const zv=fE;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lu(t,e,n){return`firebase:${t}:${e}:${n}`}class co{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:s,name:i}=this.auth;this.fullUserKey=Lu(this.userKey,s.apiKey,i),this.fullPersistenceKey=Lu("persistence",s.apiKey,i),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const n=await vc(this.auth,{idToken:e}).catch(()=>{});return n?Gn._fromGetAccountInfoResponse(this.auth,n,e):null}return Gn._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new co(jr(zv),e,r);const s=(await Promise.all(n.map(async d=>{if(await d._isAvailable())return d}))).filter(d=>d);let i=s[0]||jr(zv);const o=Lu(r,e.config.apiKey,e.name);let l=null;for(const d of n)try{const f=await d._get(o);if(f){let p;if(typeof f=="string"){const m=await vc(e,{idToken:f}).catch(()=>{});if(!m)break;p=await Gn._fromGetAccountInfoResponse(e,m,f)}else p=Gn._fromJSON(e,f);d!==i&&(l=p),i=d;break}}catch{}const u=s.filter(d=>d._shouldAllowMigration);return!i._shouldAllowMigration||!u.length?new co(i,e,r):(i=u[0],l&&await i._set(o,l.toJSON()),await Promise.all(n.map(async d=>{if(d!==i)try{await d._remove(o)}catch{}})),new co(i,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qv(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(yE(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(pE(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(_E(e))return"Blackberry";if(wE(e))return"Webos";if(mE(e))return"Safari";if((e.includes("chrome/")||gE(e))&&!e.includes("edge/"))return"Chrome";if(vE(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function pE(t=Qt()){return/firefox\//i.test(t)}function mE(t=Qt()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function gE(t=Qt()){return/crios\//i.test(t)}function yE(t=Qt()){return/iemobile/i.test(t)}function vE(t=Qt()){return/android/i.test(t)}function _E(t=Qt()){return/blackberry/i.test(t)}function wE(t=Qt()){return/webos/i.test(t)}function wm(t=Qt()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function ik(t=Qt()){var e;return wm(t)&&!!((e=window.navigator)!=null&&e.standalone)}function ok(){return w1()&&document.documentMode===10}function xE(t=Qt()){return wm(t)||vE(t)||wE(t)||_E(t)||/windows phone/i.test(t)||yE(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EE(t,e=[]){let n;switch(t){case"Browser":n=qv(Qt());break;case"Worker":n=`${qv(Qt())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${Oo}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ak{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=i=>new Promise((o,l)=>{try{const u=e(i);o(u)}catch(u){l(u)}});r.onAbort=n,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const s of n)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function lk(t,e={}){return rr(t,"GET","/v2/passwordPolicy",wr(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uk=6;class ck{constructor(e){var r;const n=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=n.minPasswordLength??uk,n.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=n.maxPasswordLength),n.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=n.containsLowercaseCharacter),n.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=n.containsUppercaseCharacter),n.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=n.containsNumericCharacter),n.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=n.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((r=e.allowedNonAlphanumericCharacters)==null?void 0:r.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const n={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,n),this.validatePasswordCharacterOptions(e,n),n.isValid&&(n.isValid=n.meetsMinPasswordLength??!0),n.isValid&&(n.isValid=n.meetsMaxPasswordLength??!0),n.isValid&&(n.isValid=n.containsLowercaseLetter??!0),n.isValid&&(n.isValid=n.containsUppercaseLetter??!0),n.isValid&&(n.isValid=n.containsNumericCharacter??!0),n.isValid&&(n.isValid=n.containsNonAlphanumericCharacter??!0),n}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),s&&(n.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dk{constructor(e,n,r,s){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Wv(this),this.idTokenSubscription=new Wv(this),this.beforeStateQueue=new ak(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=lE,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(i=>this._resolvePersistenceManagerAvailable=i)}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=jr(n)),this._initializationPromise=this.queue(async()=>{var r,s,i;if(!this._deleted&&(this.persistenceManager=await co.create(this,e),(r=this._resolvePersistenceManagerAvailable)==null||r.call(this),!this._deleted)){if((s=this._popupRedirectResolver)!=null&&s._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((i=this.currentUser)==null?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await vc(this,{idToken:e}),r=await Gn._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var i;if(an(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(l=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(l,l))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let r=n,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(i=this.redirectUser)==null?void 0:i._redirectEventId,l=r==null?void 0:r._redirectEventId,u=await this.tryRedirectSignIn(e);(!o||o===l)&&(u!=null&&u.user)&&(r=u.user,s=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(r)}catch(o){r=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return re(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await _c(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=zC()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(an(this.app))return Promise.reject(Vr(this));const n=e?De(e):null;return n&&re(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&re(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return an(this.app)?Promise.reject(Vr(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return an(this.app)?Promise.reject(Vr(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(jr(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await lk(this),n=new ck(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Si("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await sk(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&jr(e)||this._popupRedirectResolver;re(n,this,"argument-error"),this.redirectPersistenceManager=await co.create(this,[jr(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)==null?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)==null?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((n=this.currentUser)==null?void 0:n.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,s){if(this._deleted)return()=>{};const i=typeof n=="function"?n:n.next.bind(n);let o=!1;const l=this._isInitialized?Promise.resolve():this._initializationPromise;if(re(l,this,"internal-error"),l.then(()=>{o||i(this.currentUser)}),typeof n=="function"){const u=e.addObserver(n,r,s);return()=>{o=!0,u()}}else{const u=e.addObserver(n);return()=>{o=!0,u()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return re(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=EE(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var s;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const n=await((s=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:s.getHeartbeatsHeader());n&&(e["X-Firebase-Client"]=n);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){var n;if(an(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((n=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:n.getToken());return e!=null&&e.error&&UC(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function xr(t){return De(t)}class Wv{constructor(e){this.auth=e,this.observer=null,this.addObserver=b1(n=>this.observer=n)}get next(){return re(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let od={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function hk(t){od=t}function TE(t){return od.loadJS(t)}function fk(){return od.recaptchaEnterpriseScript}function pk(){return od.gapiScript}function mk(t){return`__${t}${Math.floor(Math.random()*1e6)}`}class gk{constructor(){this.enterprise=new yk}ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}class yk{ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}const vk="recaptcha-enterprise",IE="NO_RECAPTCHA";class _k{constructor(e){this.type=vk,this.auth=xr(e)}async verify(e="verify",n=!1){async function r(i){if(!n){if(i.tenantId==null&&i._agentRecaptchaConfig!=null)return i._agentRecaptchaConfig.siteKey;if(i.tenantId!=null&&i._tenantRecaptchaConfigs[i.tenantId]!==void 0)return i._tenantRecaptchaConfigs[i.tenantId].siteKey}return new Promise(async(o,l)=>{YC(i,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(u=>{if(u.recaptchaKey===void 0)l(new Error("recaptcha Enterprise site key undefined"));else{const d=new QC(u);return i.tenantId==null?i._agentRecaptchaConfig=d:i._tenantRecaptchaConfigs[i.tenantId]=d,o(d.siteKey)}}).catch(u=>{l(u)})})}function s(i,o,l){const u=window.grecaptcha;Fv(u)?u.enterprise.ready(()=>{u.enterprise.execute(i,{action:e}).then(d=>{o(d)}).catch(()=>{o(IE)})}):l(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new gk().execute("siteKey",{action:"verify"}):new Promise((i,o)=>{r(this.auth).then(l=>{if(!n&&Fv(window.grecaptcha))s(l,i,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let u=fk();u.length!==0&&(u+=l),TE(u).then(()=>{s(l,i,o)}).catch(d=>{o(d)})}}).catch(l=>{o(l)})})}}async function Hv(t,e,n,r=!1,s=!1){const i=new _k(t);let o;if(s)o=IE;else try{o=await i.verify(n)}catch{o=await i.verify(n,!0)}const l={...e};if(n==="mfaSmsEnrollment"||n==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in l){const u=l.phoneEnrollmentInfo.phoneNumber,d=l.phoneEnrollmentInfo.recaptchaToken;Object.assign(l,{phoneEnrollmentInfo:{phoneNumber:u,recaptchaToken:d,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in l){const u=l.phoneSignInInfo.recaptchaToken;Object.assign(l,{phoneSignInInfo:{recaptchaToken:u,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return l}return r?Object.assign(l,{captchaResp:o}):Object.assign(l,{captchaResponse:o}),Object.assign(l,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(l,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),l}async function wc(t,e,n,r,s){var i;if((i=t._getRecaptchaConfig())!=null&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const o=await Hv(t,e,n,n==="getOobCode");return r(t,o)}else return r(t,e).catch(async o=>{if(o.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const l=await Hv(t,e,n,n==="getOobCode");return r(t,l)}else return Promise.reject(o)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wk(t,e){const n=Ni(t,"auth");if(n.isInitialized()){const s=n.getImmediate(),i=n.getOptions();if(fi(i,e??{}))return s;Tn(s,"already-initialized")}return n.initialize({options:e})}function xk(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(jr);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function Ek(t,e,n){const r=xr(t);re(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!1,i=SE(e),{host:o,port:l}=Tk(e),u=l===null?"":`:${l}`,d={url:`${i}//${o}${u}/`},f=Object.freeze({host:o,port:l,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!r._canInitEmulator){re(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),re(fi(d,r.config.emulator)&&fi(f,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=d,r.emulatorConfig=f,r.settings.appVerificationDisabledForTesting=!0,Ii(o)?(hm(`${i}//${o}${u}`),fm("Auth",!0)):Ik()}function SE(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function Tk(t){const e=SE(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const i=s[1];return{host:i,port:Gv(r.substr(i.length+1))}}else{const[i,o]=r.split(":");return{host:i,port:Gv(o)}}}function Gv(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function Ik(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xm{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return Pr("not implemented")}_getIdTokenResponse(e){return Pr("not implemented")}_linkToIdToken(e,n){return Pr("not implemented")}_getReauthenticationResolver(e){return Pr("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function NE(t,e){return rr(t,"POST","/v1/accounts:resetPassword",wr(t,e))}async function Sk(t,e){return rr(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Nk(t,e){return vl(t,"POST","/v1/accounts:signInWithPassword",wr(t,e))}async function bk(t,e){return rr(t,"POST","/v1/accounts:sendOobCode",wr(t,e))}async function Ak(t,e){return bk(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ck(t,e){return vl(t,"POST","/v1/accounts:signInWithEmailLink",wr(t,e))}async function kk(t,e){return vl(t,"POST","/v1/accounts:signInWithEmailLink",wr(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Za extends xm{constructor(e,n,r,s=null){super("password",r),this._email=e,this._password=n,this._tenantId=s}static _fromEmailAndPassword(e,n){return new Za(e,n,"password")}static _fromEmailAndCode(e,n,r=null){return new Za(e,n,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n!=null&&n.email&&(n!=null&&n.password)){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return wc(e,n,"signInWithPassword",Nk);case"emailLink":return Ck(e,{email:this._email,oobCode:this._password});default:Tn(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const r={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return wc(e,r,"signUpPassword",Sk);case"emailLink":return kk(e,{idToken:n,email:this._email,oobCode:this._password});default:Tn(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ho(t,e){return vl(t,"POST","/v1/accounts:signInWithIdp",wr(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rk="http://localhost";class pi extends xm{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new pi(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):Tn("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s,...i}=n;if(!r||!s)return null;const o=new pi(r,s);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return ho(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,ho(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,ho(e,n)}buildRequest(){const e={requestUri:Rk,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=ml(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pk(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function jk(t){const e=da(ha(t)).link,n=e?da(ha(e)).deep_link_id:null,r=da(ha(t)).deep_link_id;return(r?da(ha(r)).link:null)||r||n||e||t}class Em{constructor(e){const n=da(ha(e)),r=n.apiKey??null,s=n.oobCode??null,i=Pk(n.mode??null);re(r&&s&&i,"argument-error"),this.apiKey=r,this.operation=i,this.code=s,this.continueUrl=n.continueUrl??null,this.languageCode=n.lang??null,this.tenantId=n.tenantId??null}static parseLink(e){const n=jk(e);try{return new Em(n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lo{constructor(){this.providerId=Lo.PROVIDER_ID}static credential(e,n){return Za._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const r=Em.parseLink(n);return re(r,"argument-error"),Za._fromEmailAndCode(e,r.code,r.tenantId)}}Lo.PROVIDER_ID="password";Lo.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Lo.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tm{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _l extends Tm{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cs extends _l{constructor(){super("facebook.com")}static credential(e){return pi._fromParams({providerId:cs.PROVIDER_ID,signInMethod:cs.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return cs.credentialFromTaggedObject(e)}static credentialFromError(e){return cs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return cs.credential(e.oauthAccessToken)}catch{return null}}}cs.FACEBOOK_SIGN_IN_METHOD="facebook.com";cs.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cn extends _l{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return pi._fromParams({providerId:Cn.PROVIDER_ID,signInMethod:Cn.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return Cn.credentialFromTaggedObject(e)}static credentialFromError(e){return Cn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return Cn.credential(n,r)}catch{return null}}}Cn.GOOGLE_SIGN_IN_METHOD="google.com";Cn.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ds extends _l{constructor(){super("github.com")}static credential(e){return pi._fromParams({providerId:ds.PROVIDER_ID,signInMethod:ds.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ds.credentialFromTaggedObject(e)}static credentialFromError(e){return ds.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ds.credential(e.oauthAccessToken)}catch{return null}}}ds.GITHUB_SIGN_IN_METHOD="github.com";ds.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hs extends _l{constructor(){super("twitter.com")}static credential(e,n){return pi._fromParams({providerId:hs.PROVIDER_ID,signInMethod:hs.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return hs.credentialFromTaggedObject(e)}static credentialFromError(e){return hs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return hs.credential(n,r)}catch{return null}}}hs.TWITTER_SIGN_IN_METHOD="twitter.com";hs.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Dk(t,e){return vl(t,"POST","/v1/accounts:signUp",wr(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mi{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,s=!1){const i=await Gn._fromIdTokenResponse(e,r,s),o=Kv(r);return new mi({user:i,providerId:o,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const s=Kv(r);return new mi({user:e,providerId:s,_tokenResponse:r,operationType:n})}}function Kv(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xc extends nr{constructor(e,n,r,s){super(n.code,n.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,xc.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,s){return new xc(e,n,r,s)}}function bE(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?xc._fromErrorAndOperation(t,i,e,r):i})}async function Ok(t,e,n=!1){const r=await Eo(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return mi._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Lk(t,e,n=!1){const{auth:r}=t;if(an(r.app))return Promise.reject(Vr(r));const s="reauthenticate";try{const i=await Eo(t,bE(r,s,e,t),n);re(i.idToken,r,"internal-error");const o=_m(i.idToken);re(o,r,"internal-error");const{sub:l}=o;return re(t.uid===l,r,"user-mismatch"),mi._forOperation(t,s,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&Tn(r,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function AE(t,e,n=!1){if(an(t.app))return Promise.reject(Vr(t));const r="signIn",s=await bE(t,r,e),i=await mi._fromIdTokenResponse(t,r,s);return n||await t._updateCurrentUser(i.user),i}async function Vk(t,e){return AE(xr(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Im{constructor(e,n){this.factorId=e,this.uid=n.mfaEnrollmentId,this.enrollmentTime=new Date(n.enrolledAt).toUTCString(),this.displayName=n.displayName}static _fromServerResponse(e,n){return"phoneInfo"in n?Sm._fromServerResponse(e,n):"totpInfo"in n?Nm._fromServerResponse(e,n):Tn(e,"internal-error")}}class Sm extends Im{constructor(e){super("phone",e),this.phoneNumber=e.phoneInfo}static _fromServerResponse(e,n){return new Sm(n)}}class Nm extends Im{constructor(e){super("totp",e)}static _fromServerResponse(e,n){return new Nm(n)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function bm(t){const e=xr(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function Mk(t,e,n){const r=xr(t);await wc(r,{requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"},"getOobCode",Ak)}async function Uk(t,e,n){await NE(De(t),{oobCode:e,newPassword:n}).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&bm(t),r})}async function Fk(t,e){const n=De(t),r=await NE(n,{oobCode:e}),s=r.requestType;switch(re(s,n,"internal-error"),s){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":re(r.newEmail,n,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":re(r.mfaInfo,n,"internal-error");default:re(r.email,n,"internal-error")}let i=null;return r.mfaInfo&&(i=Im._fromServerResponse(xr(n),r.mfaInfo)),{data:{email:(r.requestType==="VERIFY_AND_CHANGE_EMAIL"?r.newEmail:r.email)||null,previousEmail:(r.requestType==="VERIFY_AND_CHANGE_EMAIL"?r.email:r.newEmail)||null,multiFactorInfo:i},operation:s}}async function $k(t,e){const{data:n}=await Fk(De(t),e);return n.email}async function Bk(t,e,n){if(an(t.app))return Promise.reject(Vr(t));const r=xr(t),o=await wc(r,{returnSecureToken:!0,email:e,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",Dk).catch(u=>{throw u.code==="auth/password-does-not-meet-requirements"&&bm(t),u}),l=await mi._fromIdTokenResponse(r,"signIn",o);return await r._updateCurrentUser(l.user),l}function CE(t,e,n){return an(t.app)?Promise.reject(Vr(t)):Vk(De(t),Lo.credential(e,n)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&bm(t),r})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function zk(t,e){return rr(t,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function kE(t,{displayName:e,photoURL:n}){if(e===void 0&&n===void 0)return;const r=De(t),i={idToken:await r.getIdToken(),displayName:e,photoUrl:n,returnSecureToken:!0},o=await Eo(r,zk(r.auth,i));r.displayName=o.displayName||null,r.photoURL=o.photoUrl||null;const l=r.providerData.find(({providerId:u})=>u==="password");l&&(l.displayName=r.displayName,l.photoURL=r.photoURL),await r._updateTokensIfNecessary(o)}function qk(t,e,n,r){return De(t).onIdTokenChanged(e,n,r)}function Wk(t,e,n){return De(t).beforeAuthStateChanged(e,n)}function Mn(t,e,n,r){return De(t).onAuthStateChanged(e,n,r)}function Hf(t){return De(t).signOut()}const Ec="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RE{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(Ec,"1"),this.storage.removeItem(Ec),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hk=1e3,Gk=10;class PE extends RE{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=xE(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),s=this.localCache[n];r!==s&&e(n,s,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,l,u)=>{this.notifyListeners(o,u)});return}const r=e.key;n?this.detachListener():this.stopPolling();const s=()=>{const o=this.storage.getItem(r);!n&&this.localCache[r]===o||this.notifyListeners(r,o)},i=this.storage.getItem(r);ok()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,Gk):s()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},Hk)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}PE.type="LOCAL";const Kk=PE;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jE extends RE{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}jE.type="SESSION";const DE=jE;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qk(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ad{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(s=>s.isListeningto(e));if(n)return n;const r=new ad(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:s,data:i}=n.data,o=this.handlersMap[s];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const l=Array.from(o).map(async d=>d(n.origin,i)),u=await Qk(l);n.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:u})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}ad.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Am(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yk{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,o;return new Promise((l,u)=>{const d=Am("",20);s.port1.start();const f=setTimeout(()=>{u(new Error("unsupported_event"))},r);o={messageChannel:s,onMessage(p){const m=p;if(m.data.eventId===d)switch(m.data.status){case"ack":clearTimeout(f),i=setTimeout(()=>{u(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),l(m.data.response);break;default:clearTimeout(f),clearTimeout(i),u(new Error("invalid_response"));break}}},this.handlers.add(o),s.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:d,data:n},[s.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pr(){return window}function Jk(t){pr().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OE(){return typeof pr().WorkerGlobalScope<"u"&&typeof pr().importScripts=="function"}async function Xk(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function Zk(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)==null?void 0:t.controller)||null}function eR(){return OE()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LE="firebaseLocalStorageDb",tR=1,Tc="firebaseLocalStorage",VE="fbase_key";class wl{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function ld(t,e){return t.transaction([Tc],e?"readwrite":"readonly").objectStore(Tc)}function nR(){const t=indexedDB.deleteDatabase(LE);return new wl(t).toPromise()}function Gf(){const t=indexedDB.open(LE,tR);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(Tc,{keyPath:VE})}catch(s){n(s)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(Tc)?e(r):(r.close(),await nR(),e(await Gf()))})})}async function Qv(t,e,n){const r=ld(t,!0).put({[VE]:e,value:n});return new wl(r).toPromise()}async function rR(t,e){const n=ld(t,!1).get(e),r=await new wl(n).toPromise();return r===void 0?null:r.value}function Yv(t,e){const n=ld(t,!0).delete(e);return new wl(n).toPromise()}const sR=800,iR=3;class ME{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Gf(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>iR)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return OE()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=ad._getInstance(eR()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var n,r;if(this.activeServiceWorker=await Xk(),!this.activeServiceWorker)return;this.sender=new Yk(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(n=e[0])!=null&&n.fulfilled&&(r=e[0])!=null&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||Zk()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Gf();return await Qv(e,Ec,"1"),await Yv(e,Ec),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>Qv(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>rR(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>Yv(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=ld(s,!1).getAll();return new wl(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),n.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),n.push(s));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),sR)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}ME.type="LOCAL";const oR=ME;new yl(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UE(t,e){return e?jr(e):(re(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cm extends xm{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return ho(e,this._buildIdpRequest())}_linkToIdToken(e,n){return ho(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return ho(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function aR(t){return AE(t.auth,new Cm(t),t.bypassAuthState)}function lR(t){const{auth:e,user:n}=t;return re(n,e,"internal-error"),Lk(n,new Cm(t),t.bypassAuthState)}async function uR(t){const{auth:e,user:n}=t;return re(n,e,"internal-error"),Ok(n,new Cm(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FE{constructor(e,n,r,s,i=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:s,tenantId:i,error:o,type:l}=e;if(o){this.reject(o);return}const u={auth:this.auth,requestUri:n,sessionId:r,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(l)(u))}catch(d){this.reject(d)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return aR;case"linkViaPopup":case"linkViaRedirect":return uR;case"reauthViaPopup":case"reauthViaRedirect":return lR;default:Tn(this.auth,"internal-error")}}resolve(e){qr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){qr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cR=new yl(2e3,1e4);async function km(t,e,n){if(an(t.app))return Promise.reject(Yn(t,"operation-not-supported-in-this-environment"));const r=xr(t);FC(t,e,Tm);const s=UE(r,n);return new ri(r,"signInViaPopup",e,s).executeNotNull()}class ri extends FE{constructor(e,n,r,s,i){super(e,n,s,i),this.provider=r,this.authWindow=null,this.pollId=null,ri.currentPopupAction&&ri.currentPopupAction.cancel(),ri.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return re(e,this.auth,"internal-error"),e}async onExecution(){qr(this.filter.length===1,"Popup operations only handle one event");const e=Am();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(Yn(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(Yn(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,ri.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if((r=(n=this.authWindow)==null?void 0:n.window)!=null&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Yn(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,cR.get())};e()}}ri.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dR="pendingRedirect",Vu=new Map;class hR extends FE{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=Vu.get(this.auth._key());if(!e){try{const r=await fR(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}Vu.set(this.auth._key(),e)}return this.bypassAuthState||Vu.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function fR(t,e){const n=gR(e),r=mR(t);if(!await r._isAvailable())return!1;const s=await r._get(n)==="true";return await r._remove(n),s}function pR(t,e){Vu.set(t._key(),e)}function mR(t){return jr(t._redirectPersistence)}function gR(t){return Lu(dR,t.config.apiKey,t.name)}async function yR(t,e,n=!1){if(an(t.app))return Promise.reject(Vr(t));const r=xr(t),s=UE(r,e),o=await new hR(r,s,n).execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vR=10*60*1e3;class _R{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!wR(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!$E(e)){const s=((r=e.error.code)==null?void 0:r.split("auth/")[1])||"internal-error";n.onError(Yn(this.auth,s))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=vR&&this.cachedEventUids.clear(),this.cachedEventUids.has(Jv(e))}saveEventToCache(e){this.cachedEventUids.add(Jv(e)),this.lastProcessedEventTime=Date.now()}}function Jv(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function $E({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function wR(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return $E(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function xR(t,e={}){return rr(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ER=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,TR=/^https?/;async function IR(t){if(t.config.emulator)return;const{authorizedDomains:e}=await xR(t);for(const n of e)try{if(SR(n))return}catch{}Tn(t,"unauthorized-domain")}function SR(t){const e=qf(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!TR.test(n))return!1;if(ER.test(t))return r===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NR=new yl(3e4,6e4);function Xv(){const t=pr().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function bR(t){return new Promise((e,n)=>{var s,i,o;function r(){Xv(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Xv(),n(Yn(t,"network-request-failed"))},timeout:NR.get()})}if((i=(s=pr().gapi)==null?void 0:s.iframes)!=null&&i.Iframe)e(gapi.iframes.getContext());else if((o=pr().gapi)!=null&&o.load)r();else{const l=mk("iframefcb");return pr()[l]=()=>{gapi.load?r():n(Yn(t,"network-request-failed"))},TE(`${pk()}?onload=${l}`).catch(u=>n(u))}}).catch(e=>{throw Mu=null,e})}let Mu=null;function AR(t){return Mu=Mu||bR(t),Mu}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CR=new yl(5e3,15e3),kR="__/auth/iframe",RR="emulator/auth/iframe",PR={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},jR=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function DR(t){const e=t.config;re(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?vm(e,RR):`https://${t.config.authDomain}/${kR}`,r={apiKey:e.apiKey,appName:t.name,v:Oo},s=jR.get(t.config.apiHost);s&&(r.eid=s);const i=t._getFrameworks();return i.length&&(r.fw=i.join(",")),`${n}?${ml(r).slice(1)}`}async function OR(t){const e=await AR(t),n=pr().gapi;return re(n,t,"internal-error"),e.open({where:document.body,url:DR(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:PR,dontclear:!0},r=>new Promise(async(s,i)=>{await r.restyle({setHideOnLeave:!1});const o=Yn(t,"network-request-failed"),l=pr().setTimeout(()=>{i(o)},CR.get());function u(){pr().clearTimeout(l),s(r)}r.ping(u).then(u,()=>{i(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LR={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},VR=500,MR=600,UR="_blank",FR="http://localhost";class Zv{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function $R(t,e,n,r=VR,s=MR){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let l="";const u={...LR,width:r.toString(),height:s.toString(),top:i,left:o},d=Qt().toLowerCase();n&&(l=gE(d)?UR:n),pE(d)&&(e=e||FR,u.scrollbars="yes");const f=Object.entries(u).reduce((m,[y,x])=>`${m}${y}=${x},`,"");if(ik(d)&&l!=="_self")return BR(e||"",l),new Zv(null);const p=window.open(e||"",l,f);re(p,t,"popup-blocked");try{p.focus()}catch{}return new Zv(p)}function BR(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zR="__/auth/handler",qR="emulator/auth/handler",WR=encodeURIComponent("fac");async function e_(t,e,n,r,s,i){re(t.config.authDomain,t,"auth-domain-config-required"),re(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:Oo,eventId:s};if(e instanceof Tm){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",N1(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[f,p]of Object.entries({}))o[f]=p}if(e instanceof _l){const f=e.getScopes().filter(p=>p!=="");f.length>0&&(o.scopes=f.join(","))}t.tenantId&&(o.tid=t.tenantId);const l=o;for(const f of Object.keys(l))l[f]===void 0&&delete l[f];const u=await t._getAppCheckToken(),d=u?`#${WR}=${encodeURIComponent(u)}`:"";return`${HR(t)}?${ml(l).slice(1)}${d}`}function HR({config:t}){return t.emulator?vm(t,qR):`https://${t.authDomain}/${zR}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bh="webStorageSupport";class GR{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=DE,this._completeRedirectFn=yR,this._overrideRedirectResult=pR}async _openPopup(e,n,r,s){var o;qr((o=this.eventManagers[e._key()])==null?void 0:o.manager,"_initialize() not called before _openPopup()");const i=await e_(e,n,r,qf(),s);return $R(e,i,Am())}async _openRedirect(e,n,r,s){await this._originValidation(e);const i=await e_(e,n,r,qf(),s);return Jk(i),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:s,promise:i}=this.eventManagers[n];return s?Promise.resolve(s):(qr(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await OR(e),r=new _R(e);return n.register("authEvent",s=>(re(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(bh,{type:bh},s=>{var o;const i=(o=s==null?void 0:s[0])==null?void 0:o[bh];i!==void 0&&n(!!i),Tn(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=IR(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return xE()||mE()||wm()}}const KR=GR;var t_="@firebase/auth",n_="1.11.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QR{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){re(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YR(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function JR(t){er(new Dn("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:o,authDomain:l}=r.options;re(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const u={apiKey:o,authDomain:l,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:EE(t)},d=new dk(r,s,i,u);return xk(d,n),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),er(new Dn("auth-internal",e=>{const n=xr(e.getProvider("auth").getImmediate());return(r=>new QR(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),mn(t_,n_,YR(t)),mn(t_,n_,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XR=5*60,ZR=Z0("authIdTokenMaxAge")||XR;let r_=null;const eP=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>ZR)return;const s=n==null?void 0:n.token;r_!==s&&(r_=s,await fetch(t,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function Ge(t=gl()){const e=Ni(t,"auth");if(e.isInitialized())return e.getImmediate();const n=wk(t,{popupRedirectResolver:KR,persistence:[oR,Kk,DE]}),r=Z0("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(r,location.origin);if(location.origin===i.origin){const o=eP(i.toString());Wk(n,o,()=>o(n.currentUser)),qk(n,l=>o(l))}}const s=Y0("auth");return s&&Ek(n,`http://${s}`),n}function tP(){var t;return((t=document.getElementsByTagName("head"))==null?void 0:t[0])??document}hk({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=s=>{const i=Yn("internal-error");i.customData=s,n(i)},r.type="text/javascript",r.charset="UTF-8",tP().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});JR("Browser");var s_=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var As,BE;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(S,_){function I(){}I.prototype=_.prototype,S.D=_.prototype,S.prototype=new I,S.prototype.constructor=S,S.C=function(N,P,j){for(var C=Array(arguments.length-2),lt=2;lt<arguments.length;lt++)C[lt-2]=arguments[lt];return _.prototype[P].apply(N,C)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,n),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(S,_,I){I||(I=0);var N=Array(16);if(typeof _=="string")for(var P=0;16>P;++P)N[P]=_.charCodeAt(I++)|_.charCodeAt(I++)<<8|_.charCodeAt(I++)<<16|_.charCodeAt(I++)<<24;else for(P=0;16>P;++P)N[P]=_[I++]|_[I++]<<8|_[I++]<<16|_[I++]<<24;_=S.g[0],I=S.g[1],P=S.g[2];var j=S.g[3],C=_+(j^I&(P^j))+N[0]+3614090360&4294967295;_=I+(C<<7&4294967295|C>>>25),C=j+(P^_&(I^P))+N[1]+3905402710&4294967295,j=_+(C<<12&4294967295|C>>>20),C=P+(I^j&(_^I))+N[2]+606105819&4294967295,P=j+(C<<17&4294967295|C>>>15),C=I+(_^P&(j^_))+N[3]+3250441966&4294967295,I=P+(C<<22&4294967295|C>>>10),C=_+(j^I&(P^j))+N[4]+4118548399&4294967295,_=I+(C<<7&4294967295|C>>>25),C=j+(P^_&(I^P))+N[5]+1200080426&4294967295,j=_+(C<<12&4294967295|C>>>20),C=P+(I^j&(_^I))+N[6]+2821735955&4294967295,P=j+(C<<17&4294967295|C>>>15),C=I+(_^P&(j^_))+N[7]+4249261313&4294967295,I=P+(C<<22&4294967295|C>>>10),C=_+(j^I&(P^j))+N[8]+1770035416&4294967295,_=I+(C<<7&4294967295|C>>>25),C=j+(P^_&(I^P))+N[9]+2336552879&4294967295,j=_+(C<<12&4294967295|C>>>20),C=P+(I^j&(_^I))+N[10]+4294925233&4294967295,P=j+(C<<17&4294967295|C>>>15),C=I+(_^P&(j^_))+N[11]+2304563134&4294967295,I=P+(C<<22&4294967295|C>>>10),C=_+(j^I&(P^j))+N[12]+1804603682&4294967295,_=I+(C<<7&4294967295|C>>>25),C=j+(P^_&(I^P))+N[13]+4254626195&4294967295,j=_+(C<<12&4294967295|C>>>20),C=P+(I^j&(_^I))+N[14]+2792965006&4294967295,P=j+(C<<17&4294967295|C>>>15),C=I+(_^P&(j^_))+N[15]+1236535329&4294967295,I=P+(C<<22&4294967295|C>>>10),C=_+(P^j&(I^P))+N[1]+4129170786&4294967295,_=I+(C<<5&4294967295|C>>>27),C=j+(I^P&(_^I))+N[6]+3225465664&4294967295,j=_+(C<<9&4294967295|C>>>23),C=P+(_^I&(j^_))+N[11]+643717713&4294967295,P=j+(C<<14&4294967295|C>>>18),C=I+(j^_&(P^j))+N[0]+3921069994&4294967295,I=P+(C<<20&4294967295|C>>>12),C=_+(P^j&(I^P))+N[5]+3593408605&4294967295,_=I+(C<<5&4294967295|C>>>27),C=j+(I^P&(_^I))+N[10]+38016083&4294967295,j=_+(C<<9&4294967295|C>>>23),C=P+(_^I&(j^_))+N[15]+3634488961&4294967295,P=j+(C<<14&4294967295|C>>>18),C=I+(j^_&(P^j))+N[4]+3889429448&4294967295,I=P+(C<<20&4294967295|C>>>12),C=_+(P^j&(I^P))+N[9]+568446438&4294967295,_=I+(C<<5&4294967295|C>>>27),C=j+(I^P&(_^I))+N[14]+3275163606&4294967295,j=_+(C<<9&4294967295|C>>>23),C=P+(_^I&(j^_))+N[3]+4107603335&4294967295,P=j+(C<<14&4294967295|C>>>18),C=I+(j^_&(P^j))+N[8]+1163531501&4294967295,I=P+(C<<20&4294967295|C>>>12),C=_+(P^j&(I^P))+N[13]+2850285829&4294967295,_=I+(C<<5&4294967295|C>>>27),C=j+(I^P&(_^I))+N[2]+4243563512&4294967295,j=_+(C<<9&4294967295|C>>>23),C=P+(_^I&(j^_))+N[7]+1735328473&4294967295,P=j+(C<<14&4294967295|C>>>18),C=I+(j^_&(P^j))+N[12]+2368359562&4294967295,I=P+(C<<20&4294967295|C>>>12),C=_+(I^P^j)+N[5]+4294588738&4294967295,_=I+(C<<4&4294967295|C>>>28),C=j+(_^I^P)+N[8]+2272392833&4294967295,j=_+(C<<11&4294967295|C>>>21),C=P+(j^_^I)+N[11]+1839030562&4294967295,P=j+(C<<16&4294967295|C>>>16),C=I+(P^j^_)+N[14]+4259657740&4294967295,I=P+(C<<23&4294967295|C>>>9),C=_+(I^P^j)+N[1]+2763975236&4294967295,_=I+(C<<4&4294967295|C>>>28),C=j+(_^I^P)+N[4]+1272893353&4294967295,j=_+(C<<11&4294967295|C>>>21),C=P+(j^_^I)+N[7]+4139469664&4294967295,P=j+(C<<16&4294967295|C>>>16),C=I+(P^j^_)+N[10]+3200236656&4294967295,I=P+(C<<23&4294967295|C>>>9),C=_+(I^P^j)+N[13]+681279174&4294967295,_=I+(C<<4&4294967295|C>>>28),C=j+(_^I^P)+N[0]+3936430074&4294967295,j=_+(C<<11&4294967295|C>>>21),C=P+(j^_^I)+N[3]+3572445317&4294967295,P=j+(C<<16&4294967295|C>>>16),C=I+(P^j^_)+N[6]+76029189&4294967295,I=P+(C<<23&4294967295|C>>>9),C=_+(I^P^j)+N[9]+3654602809&4294967295,_=I+(C<<4&4294967295|C>>>28),C=j+(_^I^P)+N[12]+3873151461&4294967295,j=_+(C<<11&4294967295|C>>>21),C=P+(j^_^I)+N[15]+530742520&4294967295,P=j+(C<<16&4294967295|C>>>16),C=I+(P^j^_)+N[2]+3299628645&4294967295,I=P+(C<<23&4294967295|C>>>9),C=_+(P^(I|~j))+N[0]+4096336452&4294967295,_=I+(C<<6&4294967295|C>>>26),C=j+(I^(_|~P))+N[7]+1126891415&4294967295,j=_+(C<<10&4294967295|C>>>22),C=P+(_^(j|~I))+N[14]+2878612391&4294967295,P=j+(C<<15&4294967295|C>>>17),C=I+(j^(P|~_))+N[5]+4237533241&4294967295,I=P+(C<<21&4294967295|C>>>11),C=_+(P^(I|~j))+N[12]+1700485571&4294967295,_=I+(C<<6&4294967295|C>>>26),C=j+(I^(_|~P))+N[3]+2399980690&4294967295,j=_+(C<<10&4294967295|C>>>22),C=P+(_^(j|~I))+N[10]+4293915773&4294967295,P=j+(C<<15&4294967295|C>>>17),C=I+(j^(P|~_))+N[1]+2240044497&4294967295,I=P+(C<<21&4294967295|C>>>11),C=_+(P^(I|~j))+N[8]+1873313359&4294967295,_=I+(C<<6&4294967295|C>>>26),C=j+(I^(_|~P))+N[15]+4264355552&4294967295,j=_+(C<<10&4294967295|C>>>22),C=P+(_^(j|~I))+N[6]+2734768916&4294967295,P=j+(C<<15&4294967295|C>>>17),C=I+(j^(P|~_))+N[13]+1309151649&4294967295,I=P+(C<<21&4294967295|C>>>11),C=_+(P^(I|~j))+N[4]+4149444226&4294967295,_=I+(C<<6&4294967295|C>>>26),C=j+(I^(_|~P))+N[11]+3174756917&4294967295,j=_+(C<<10&4294967295|C>>>22),C=P+(_^(j|~I))+N[2]+718787259&4294967295,P=j+(C<<15&4294967295|C>>>17),C=I+(j^(P|~_))+N[9]+3951481745&4294967295,S.g[0]=S.g[0]+_&4294967295,S.g[1]=S.g[1]+(P+(C<<21&4294967295|C>>>11))&4294967295,S.g[2]=S.g[2]+P&4294967295,S.g[3]=S.g[3]+j&4294967295}r.prototype.u=function(S,_){_===void 0&&(_=S.length);for(var I=_-this.blockSize,N=this.B,P=this.h,j=0;j<_;){if(P==0)for(;j<=I;)s(this,S,j),j+=this.blockSize;if(typeof S=="string"){for(;j<_;)if(N[P++]=S.charCodeAt(j++),P==this.blockSize){s(this,N),P=0;break}}else for(;j<_;)if(N[P++]=S[j++],P==this.blockSize){s(this,N),P=0;break}}this.h=P,this.o+=_},r.prototype.v=function(){var S=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);S[0]=128;for(var _=1;_<S.length-8;++_)S[_]=0;var I=8*this.o;for(_=S.length-8;_<S.length;++_)S[_]=I&255,I/=256;for(this.u(S),S=Array(16),_=I=0;4>_;++_)for(var N=0;32>N;N+=8)S[I++]=this.g[_]>>>N&255;return S};function i(S,_){var I=l;return Object.prototype.hasOwnProperty.call(I,S)?I[S]:I[S]=_(S)}function o(S,_){this.h=_;for(var I=[],N=!0,P=S.length-1;0<=P;P--){var j=S[P]|0;N&&j==_||(I[P]=j,N=!1)}this.g=I}var l={};function u(S){return-128<=S&&128>S?i(S,function(_){return new o([_|0],0>_?-1:0)}):new o([S|0],0>S?-1:0)}function d(S){if(isNaN(S)||!isFinite(S))return p;if(0>S)return b(d(-S));for(var _=[],I=1,N=0;S>=I;N++)_[N]=S/I|0,I*=4294967296;return new o(_,0)}function f(S,_){if(S.length==0)throw Error("number format error: empty string");if(_=_||10,2>_||36<_)throw Error("radix out of range: "+_);if(S.charAt(0)=="-")return b(f(S.substring(1),_));if(0<=S.indexOf("-"))throw Error('number format error: interior "-" character');for(var I=d(Math.pow(_,8)),N=p,P=0;P<S.length;P+=8){var j=Math.min(8,S.length-P),C=parseInt(S.substring(P,P+j),_);8>j?(j=d(Math.pow(_,j)),N=N.j(j).add(d(C))):(N=N.j(I),N=N.add(d(C)))}return N}var p=u(0),m=u(1),y=u(16777216);t=o.prototype,t.m=function(){if(A(this))return-b(this).m();for(var S=0,_=1,I=0;I<this.g.length;I++){var N=this.i(I);S+=(0<=N?N:4294967296+N)*_,_*=4294967296}return S},t.toString=function(S){if(S=S||10,2>S||36<S)throw Error("radix out of range: "+S);if(x(this))return"0";if(A(this))return"-"+b(this).toString(S);for(var _=d(Math.pow(S,6)),I=this,N="";;){var P=R(I,_).g;I=E(I,P.j(_));var j=((0<I.g.length?I.g[0]:I.h)>>>0).toString(S);if(I=P,x(I))return j+N;for(;6>j.length;)j="0"+j;N=j+N}},t.i=function(S){return 0>S?0:S<this.g.length?this.g[S]:this.h};function x(S){if(S.h!=0)return!1;for(var _=0;_<S.g.length;_++)if(S.g[_]!=0)return!1;return!0}function A(S){return S.h==-1}t.l=function(S){return S=E(this,S),A(S)?-1:x(S)?0:1};function b(S){for(var _=S.g.length,I=[],N=0;N<_;N++)I[N]=~S.g[N];return new o(I,~S.h).add(m)}t.abs=function(){return A(this)?b(this):this},t.add=function(S){for(var _=Math.max(this.g.length,S.g.length),I=[],N=0,P=0;P<=_;P++){var j=N+(this.i(P)&65535)+(S.i(P)&65535),C=(j>>>16)+(this.i(P)>>>16)+(S.i(P)>>>16);N=C>>>16,j&=65535,C&=65535,I[P]=C<<16|j}return new o(I,I[I.length-1]&-2147483648?-1:0)};function E(S,_){return S.add(b(_))}t.j=function(S){if(x(this)||x(S))return p;if(A(this))return A(S)?b(this).j(b(S)):b(b(this).j(S));if(A(S))return b(this.j(b(S)));if(0>this.l(y)&&0>S.l(y))return d(this.m()*S.m());for(var _=this.g.length+S.g.length,I=[],N=0;N<2*_;N++)I[N]=0;for(N=0;N<this.g.length;N++)for(var P=0;P<S.g.length;P++){var j=this.i(N)>>>16,C=this.i(N)&65535,lt=S.i(P)>>>16,Tt=S.i(P)&65535;I[2*N+2*P]+=C*Tt,v(I,2*N+2*P),I[2*N+2*P+1]+=j*Tt,v(I,2*N+2*P+1),I[2*N+2*P+1]+=C*lt,v(I,2*N+2*P+1),I[2*N+2*P+2]+=j*lt,v(I,2*N+2*P+2)}for(N=0;N<_;N++)I[N]=I[2*N+1]<<16|I[2*N];for(N=_;N<2*_;N++)I[N]=0;return new o(I,0)};function v(S,_){for(;(S[_]&65535)!=S[_];)S[_+1]+=S[_]>>>16,S[_]&=65535,_++}function w(S,_){this.g=S,this.h=_}function R(S,_){if(x(_))throw Error("division by zero");if(x(S))return new w(p,p);if(A(S))return _=R(b(S),_),new w(b(_.g),b(_.h));if(A(_))return _=R(S,b(_)),new w(b(_.g),_.h);if(30<S.g.length){if(A(S)||A(_))throw Error("slowDivide_ only works with positive integers.");for(var I=m,N=_;0>=N.l(S);)I=D(I),N=D(N);var P=L(I,1),j=L(N,1);for(N=L(N,2),I=L(I,2);!x(N);){var C=j.add(N);0>=C.l(S)&&(P=P.add(I),j=C),N=L(N,1),I=L(I,1)}return _=E(S,P.j(_)),new w(P,_)}for(P=p;0<=S.l(_);){for(I=Math.max(1,Math.floor(S.m()/_.m())),N=Math.ceil(Math.log(I)/Math.LN2),N=48>=N?1:Math.pow(2,N-48),j=d(I),C=j.j(_);A(C)||0<C.l(S);)I-=N,j=d(I),C=j.j(_);x(j)&&(j=m),P=P.add(j),S=E(S,C)}return new w(P,S)}t.A=function(S){return R(this,S).h},t.and=function(S){for(var _=Math.max(this.g.length,S.g.length),I=[],N=0;N<_;N++)I[N]=this.i(N)&S.i(N);return new o(I,this.h&S.h)},t.or=function(S){for(var _=Math.max(this.g.length,S.g.length),I=[],N=0;N<_;N++)I[N]=this.i(N)|S.i(N);return new o(I,this.h|S.h)},t.xor=function(S){for(var _=Math.max(this.g.length,S.g.length),I=[],N=0;N<_;N++)I[N]=this.i(N)^S.i(N);return new o(I,this.h^S.h)};function D(S){for(var _=S.g.length+1,I=[],N=0;N<_;N++)I[N]=S.i(N)<<1|S.i(N-1)>>>31;return new o(I,S.h)}function L(S,_){var I=_>>5;_%=32;for(var N=S.g.length-I,P=[],j=0;j<N;j++)P[j]=0<_?S.i(j+I)>>>_|S.i(j+I+1)<<32-_:S.i(j+I);return new o(P,S.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,BE=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=d,o.fromString=f,As=o}).apply(typeof s_<"u"?s_:typeof self<"u"?self:typeof window<"u"?window:{});var yu=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var zE,fa,qE,Uu,Kf,WE,HE,GE;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(a,h,g){return a==Array.prototype||a==Object.prototype||(a[h]=g.value),a};function n(a){a=[typeof globalThis=="object"&&globalThis,a,typeof window=="object"&&window,typeof self=="object"&&self,typeof yu=="object"&&yu];for(var h=0;h<a.length;++h){var g=a[h];if(g&&g.Math==Math)return g}throw Error("Cannot find global object")}var r=n(this);function s(a,h){if(h)e:{var g=r;a=a.split(".");for(var T=0;T<a.length-1;T++){var O=a[T];if(!(O in g))break e;g=g[O]}a=a[a.length-1],T=g[a],h=h(T),h!=T&&h!=null&&e(g,a,{configurable:!0,writable:!0,value:h})}}function i(a,h){a instanceof String&&(a+="");var g=0,T=!1,O={next:function(){if(!T&&g<a.length){var V=g++;return{value:h(V,a[V]),done:!1}}return T=!0,{done:!0,value:void 0}}};return O[Symbol.iterator]=function(){return O},O}s("Array.prototype.values",function(a){return a||function(){return i(this,function(h,g){return g})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},l=this||self;function u(a){var h=typeof a;return h=h!="object"?h:a?Array.isArray(a)?"array":h:"null",h=="array"||h=="object"&&typeof a.length=="number"}function d(a){var h=typeof a;return h=="object"&&a!=null||h=="function"}function f(a,h,g){return a.call.apply(a.bind,arguments)}function p(a,h,g){if(!a)throw Error();if(2<arguments.length){var T=Array.prototype.slice.call(arguments,2);return function(){var O=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(O,T),a.apply(h,O)}}return function(){return a.apply(h,arguments)}}function m(a,h,g){return m=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?f:p,m.apply(null,arguments)}function y(a,h){var g=Array.prototype.slice.call(arguments,1);return function(){var T=g.slice();return T.push.apply(T,arguments),a.apply(this,T)}}function x(a,h){function g(){}g.prototype=h.prototype,a.aa=h.prototype,a.prototype=new g,a.prototype.constructor=a,a.Qb=function(T,O,V){for(var W=Array(arguments.length-2),Me=2;Me<arguments.length;Me++)W[Me-2]=arguments[Me];return h.prototype[O].apply(T,W)}}function A(a){const h=a.length;if(0<h){const g=Array(h);for(let T=0;T<h;T++)g[T]=a[T];return g}return[]}function b(a,h){for(let g=1;g<arguments.length;g++){const T=arguments[g];if(u(T)){const O=a.length||0,V=T.length||0;a.length=O+V;for(let W=0;W<V;W++)a[O+W]=T[W]}else a.push(T)}}class E{constructor(h,g){this.i=h,this.j=g,this.h=0,this.g=null}get(){let h;return 0<this.h?(this.h--,h=this.g,this.g=h.next,h.next=null):h=this.i(),h}}function v(a){return/^[\s\xa0]*$/.test(a)}function w(){var a=l.navigator;return a&&(a=a.userAgent)?a:""}function R(a){return R[" "](a),a}R[" "]=function(){};var D=w().indexOf("Gecko")!=-1&&!(w().toLowerCase().indexOf("webkit")!=-1&&w().indexOf("Edge")==-1)&&!(w().indexOf("Trident")!=-1||w().indexOf("MSIE")!=-1)&&w().indexOf("Edge")==-1;function L(a,h,g){for(const T in a)h.call(g,a[T],T,a)}function S(a,h){for(const g in a)h.call(void 0,a[g],g,a)}function _(a){const h={};for(const g in a)h[g]=a[g];return h}const I="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function N(a,h){let g,T;for(let O=1;O<arguments.length;O++){T=arguments[O];for(g in T)a[g]=T[g];for(let V=0;V<I.length;V++)g=I[V],Object.prototype.hasOwnProperty.call(T,g)&&(a[g]=T[g])}}function P(a){var h=1;a=a.split(":");const g=[];for(;0<h&&a.length;)g.push(a.shift()),h--;return a.length&&g.push(a.join(":")),g}function j(a){l.setTimeout(()=>{throw a},0)}function C(){var a=K;let h=null;return a.g&&(h=a.g,a.g=a.g.next,a.g||(a.h=null),h.next=null),h}class lt{constructor(){this.h=this.g=null}add(h,g){const T=Tt.get();T.set(h,g),this.h?this.h.next=T:this.g=T,this.h=T}}var Tt=new E(()=>new Un,a=>a.reset());class Un{constructor(){this.next=this.g=this.h=null}set(h,g){this.h=h,this.g=g,this.next=null}reset(){this.next=this.g=this.h=null}}let Q,$=!1,K=new lt,J=()=>{const a=l.Promise.resolve(void 0);Q=()=>{a.then(_e)}};var _e=()=>{for(var a;a=C();){try{a.h.call(a.g)}catch(g){j(g)}var h=Tt;h.j(a),100>h.h&&(h.h++,a.next=h.g,h.g=a)}$=!1};function he(){this.s=this.s,this.C=this.C}he.prototype.s=!1,he.prototype.ma=function(){this.s||(this.s=!0,this.N())},he.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function se(a,h){this.type=a,this.g=this.target=h,this.defaultPrevented=!1}se.prototype.h=function(){this.defaultPrevented=!0};var it=function(){if(!l.addEventListener||!Object.defineProperty)return!1;var a=!1,h=Object.defineProperty({},"passive",{get:function(){a=!0}});try{const g=()=>{};l.addEventListener("test",g,h),l.removeEventListener("test",g,h)}catch{}return a}();function It(a,h){if(se.call(this,a?a.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,a){var g=this.type=a.type,T=a.changedTouches&&a.changedTouches.length?a.changedTouches[0]:null;if(this.target=a.target||a.srcElement,this.g=h,h=a.relatedTarget){if(D){e:{try{R(h.nodeName);var O=!0;break e}catch{}O=!1}O||(h=null)}}else g=="mouseover"?h=a.fromElement:g=="mouseout"&&(h=a.toElement);this.relatedTarget=h,T?(this.clientX=T.clientX!==void 0?T.clientX:T.pageX,this.clientY=T.clientY!==void 0?T.clientY:T.pageY,this.screenX=T.screenX||0,this.screenY=T.screenY||0):(this.clientX=a.clientX!==void 0?a.clientX:a.pageX,this.clientY=a.clientY!==void 0?a.clientY:a.pageY,this.screenX=a.screenX||0,this.screenY=a.screenY||0),this.button=a.button,this.key=a.key||"",this.ctrlKey=a.ctrlKey,this.altKey=a.altKey,this.shiftKey=a.shiftKey,this.metaKey=a.metaKey,this.pointerId=a.pointerId||0,this.pointerType=typeof a.pointerType=="string"?a.pointerType:Ke[a.pointerType]||"",this.state=a.state,this.i=a,a.defaultPrevented&&It.aa.h.call(this)}}x(It,se);var Ke={2:"touch",3:"pen",4:"mouse"};It.prototype.h=function(){It.aa.h.call(this);var a=this.i;a.preventDefault?a.preventDefault():a.returnValue=!1};var Oe="closure_listenable_"+(1e6*Math.random()|0),St=0;function z(a,h,g,T,O){this.listener=a,this.proxy=null,this.src=h,this.type=g,this.capture=!!T,this.ha=O,this.key=++St,this.da=this.fa=!1}function Z(a){a.da=!0,a.listener=null,a.proxy=null,a.src=null,a.ha=null}function ge(a){this.src=a,this.g={},this.h=0}ge.prototype.add=function(a,h,g,T,O){var V=a.toString();a=this.g[V],a||(a=this.g[V]=[],this.h++);var W=Se(a,h,T,O);return-1<W?(h=a[W],g||(h.fa=!1)):(h=new z(h,this.src,V,!!T,O),h.fa=g,a.push(h)),h};function le(a,h){var g=h.type;if(g in a.g){var T=a.g[g],O=Array.prototype.indexOf.call(T,h,void 0),V;(V=0<=O)&&Array.prototype.splice.call(T,O,1),V&&(Z(h),a.g[g].length==0&&(delete a.g[g],a.h--))}}function Se(a,h,g,T){for(var O=0;O<a.length;++O){var V=a[O];if(!V.da&&V.listener==h&&V.capture==!!g&&V.ha==T)return O}return-1}var ce="closure_lm_"+(1e6*Math.random()|0),ee={};function Je(a,h,g,T,O){if(Array.isArray(h)){for(var V=0;V<h.length;V++)Je(a,h[V],g,T,O);return null}return g=Pl(g),a&&a[Oe]?a.K(h,g,d(T)?!!T.capture:!1,O):ve(a,h,g,!1,T,O)}function ve(a,h,g,T,O,V){if(!h)throw Error("Invalid event type");var W=d(O)?!!O.capture:!!O,Me=Jr(a);if(Me||(a[ce]=Me=new ge(a)),g=Me.add(h,g,T,W,V),g.proxy)return g;if(T=Ve(),g.proxy=T,T.src=a,T.listener=g,a.addEventListener)it||(O=W),O===void 0&&(O=!1),a.addEventListener(h.toString(),T,O);else if(a.attachEvent)a.attachEvent(Yt(h.toString()),T);else if(a.addListener&&a.removeListener)a.addListener(T);else throw Error("addEventListener and attachEvent are unavailable.");return g}function Ve(){function a(g){return h.call(a.src,a.listener,g)}const h=Fn;return a}function ze(a,h,g,T,O){if(Array.isArray(h))for(var V=0;V<h.length;V++)ze(a,h[V],g,T,O);else T=d(T)?!!T.capture:!!T,g=Pl(g),a&&a[Oe]?(a=a.i,h=String(h).toString(),h in a.g&&(V=a.g[h],g=Se(V,g,T,O),-1<g&&(Z(V[g]),Array.prototype.splice.call(V,g,1),V.length==0&&(delete a.g[h],a.h--)))):a&&(a=Jr(a))&&(h=a.g[h.toString()],a=-1,h&&(a=Se(h,g,T,O)),(g=-1<a?h[a]:null)&&yt(g))}function yt(a){if(typeof a!="number"&&a&&!a.da){var h=a.src;if(h&&h[Oe])le(h.i,a);else{var g=a.type,T=a.proxy;h.removeEventListener?h.removeEventListener(g,T,a.capture):h.detachEvent?h.detachEvent(Yt(g),T):h.addListener&&h.removeListener&&h.removeListener(T),(g=Jr(h))?(le(g,a),g.h==0&&(g.src=null,h[ce]=null)):Z(a)}}}function Yt(a){return a in ee?ee[a]:ee[a]="on"+a}function Fn(a,h){if(a.da)a=!0;else{h=new It(h,this);var g=a.listener,T=a.ha||a.src;a.fa&&yt(a),a=g.call(T,h)}return a}function Jr(a){return a=a[ce],a instanceof ge?a:null}var Tr="__closure_events_fn_"+(1e9*Math.random()>>>0);function Pl(a){return typeof a=="function"?a:(a[Tr]||(a[Tr]=function(h){return a.handleEvent(h)}),a[Tr])}function dt(){he.call(this),this.i=new ge(this),this.M=this,this.F=null}x(dt,he),dt.prototype[Oe]=!0,dt.prototype.removeEventListener=function(a,h,g,T){ze(this,a,h,g,T)};function ht(a,h){var g,T=a.F;if(T)for(g=[];T;T=T.F)g.push(T);if(a=a.M,T=h.type||h,typeof h=="string")h=new se(h,a);else if(h instanceof se)h.target=h.target||a;else{var O=h;h=new se(T,a),N(h,O)}if(O=!0,g)for(var V=g.length-1;0<=V;V--){var W=h.g=g[V];O=$n(W,T,!0,h)&&O}if(W=h.g=a,O=$n(W,T,!0,h)&&O,O=$n(W,T,!1,h)&&O,g)for(V=0;V<g.length;V++)W=h.g=g[V],O=$n(W,T,!1,h)&&O}dt.prototype.N=function(){if(dt.aa.N.call(this),this.i){var a=this.i,h;for(h in a.g){for(var g=a.g[h],T=0;T<g.length;T++)Z(g[T]);delete a.g[h],a.h--}}this.F=null},dt.prototype.K=function(a,h,g,T){return this.i.add(String(a),h,!1,g,T)},dt.prototype.L=function(a,h,g,T){return this.i.add(String(a),h,!0,g,T)};function $n(a,h,g,T){if(h=a.i.g[String(h)],!h)return!0;h=h.concat();for(var O=!0,V=0;V<h.length;++V){var W=h[V];if(W&&!W.da&&W.capture==g){var Me=W.listener,Pt=W.ha||W.src;W.fa&&le(a.i,W),O=Me.call(Pt,T)!==!1&&O}}return O&&!T.defaultPrevented}function jl(a,h,g){if(typeof a=="function")g&&(a=m(a,g));else if(a&&typeof a.handleEvent=="function")a=m(a.handleEvent,a);else throw Error("Invalid listener argument");return 2147483647<Number(h)?-1:l.setTimeout(a,h||0)}function Pi(a){a.g=jl(()=>{a.g=null,a.i&&(a.i=!1,Pi(a))},a.l);const h=a.h;a.h=null,a.m.apply(null,h)}class Dl extends he{constructor(h,g){super(),this.m=h,this.l=g,this.h=null,this.i=!1,this.g=null}j(h){this.h=arguments,this.g?this.i=!0:Pi(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function qs(a){he.call(this),this.h=a,this.g={}}x(qs,he);var ji=[];function Ol(a){L(a.g,function(h,g){this.g.hasOwnProperty(g)&&yt(h)},a),a.g={}}qs.prototype.N=function(){qs.aa.N.call(this),Ol(this)},qs.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Bo=l.JSON.stringify,jd=l.JSON.parse,Dd=class{stringify(a){return l.JSON.stringify(a,void 0)}parse(a){return l.JSON.parse(a,void 0)}};function zo(){}zo.prototype.h=null;function Ll(a){return a.h||(a.h=a.i())}function ir(){}var Ws={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Di(){se.call(this,"d")}x(Di,se);function qo(){se.call(this,"c")}x(qo,se);var or={},Vl=null;function Hs(){return Vl=Vl||new dt}or.La="serverreachability";function F(a){se.call(this,or.La,a)}x(F,se);function ie(a){const h=Hs();ht(h,new F(h))}or.STAT_EVENT="statevent";function ye(a,h){se.call(this,or.STAT_EVENT,a),this.stat=h}x(ye,se);function oe(a){const h=Hs();ht(h,new ye(h,a))}or.Ma="timingevent";function Re(a,h){se.call(this,or.Ma,a),this.size=h}x(Re,se);function ue(a,h){if(typeof a!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){a()},h)}function de(){this.g=!0}de.prototype.xa=function(){this.g=!1};function Mt(a,h,g,T,O,V){a.info(function(){if(a.g)if(V)for(var W="",Me=V.split("&"),Pt=0;Pt<Me.length;Pt++){var Ce=Me[Pt].split("=");if(1<Ce.length){var Ut=Ce[0];Ce=Ce[1];var Ft=Ut.split("_");W=2<=Ft.length&&Ft[1]=="type"?W+(Ut+"="+Ce+"&"):W+(Ut+"=redacted&")}}else W=null;else W=V;return"XMLHTTP REQ ("+T+") [attempt "+O+"]: "+h+`
`+g+`
`+W})}function Ir(a,h,g,T,O,V,W){a.info(function(){return"XMLHTTP RESP ("+T+") [ attempt "+O+"]: "+h+`
`+g+`
`+V+" "+W})}function rn(a,h,g,T){a.info(function(){return"XMLHTTP TEXT ("+h+"): "+Xr(a,g)+(T?" "+T:"")})}function Oi(a,h){a.info(function(){return"TIMEOUT: "+h})}de.prototype.info=function(){};function Xr(a,h){if(!a.g)return h;if(!h)return null;try{var g=JSON.parse(h);if(g){for(a=0;a<g.length;a++)if(Array.isArray(g[a])){var T=g[a];if(!(2>T.length)){var O=T[1];if(Array.isArray(O)&&!(1>O.length)){var V=O[0];if(V!="noop"&&V!="stop"&&V!="close")for(var W=1;W<O.length;W++)O[W]=""}}}}return Bo(g)}catch{return h}}var Ml={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},bg={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Od;function Ul(){}x(Ul,zo),Ul.prototype.g=function(){return new XMLHttpRequest},Ul.prototype.i=function(){return{}},Od=new Ul;function Zr(a,h,g,T){this.j=a,this.i=h,this.l=g,this.R=T||1,this.U=new qs(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Ag}function Ag(){this.i=null,this.g="",this.h=!1}var Cg={},Ld={};function Vd(a,h,g){a.L=1,a.v=zl(Sr(h)),a.m=g,a.P=!0,kg(a,null)}function kg(a,h){a.F=Date.now(),Fl(a),a.A=Sr(a.v);var g=a.A,T=a.R;Array.isArray(T)||(T=[String(T)]),qg(g.i,"t",T),a.C=0,g=a.j.J,a.h=new Ag,a.g=ly(a.j,g?h:null,!a.m),0<a.O&&(a.M=new Dl(m(a.Y,a,a.g),a.O)),h=a.U,g=a.g,T=a.ca;var O="readystatechange";Array.isArray(O)||(O&&(ji[0]=O.toString()),O=ji);for(var V=0;V<O.length;V++){var W=Je(g,O[V],T||h.handleEvent,!1,h.h||h);if(!W)break;h.g[W.key]=W}h=a.H?_(a.H):{},a.m?(a.u||(a.u="POST"),h["Content-Type"]="application/x-www-form-urlencoded",a.g.ea(a.A,a.u,a.m,h)):(a.u="GET",a.g.ea(a.A,a.u,null,h)),ie(),Mt(a.i,a.u,a.A,a.l,a.R,a.m)}Zr.prototype.ca=function(a){a=a.target;const h=this.M;h&&Nr(a)==3?h.j():this.Y(a)},Zr.prototype.Y=function(a){try{if(a==this.g)e:{const Ft=Nr(this.g);var h=this.g.Ba();const Mi=this.g.Z();if(!(3>Ft)&&(Ft!=3||this.g&&(this.h.h||this.g.oa()||Jg(this.g)))){this.J||Ft!=4||h==7||(h==8||0>=Mi?ie(3):ie(2)),Md(this);var g=this.g.Z();this.X=g;t:if(Rg(this)){var T=Jg(this.g);a="";var O=T.length,V=Nr(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Gs(this),Wo(this);var W="";break t}this.h.i=new l.TextDecoder}for(h=0;h<O;h++)this.h.h=!0,a+=this.h.i.decode(T[h],{stream:!(V&&h==O-1)});T.length=0,this.h.g+=a,this.C=0,W=this.h.g}else W=this.g.oa();if(this.o=g==200,Ir(this.i,this.u,this.A,this.l,this.R,Ft,g),this.o){if(this.T&&!this.K){t:{if(this.g){var Me,Pt=this.g;if((Me=Pt.g?Pt.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!v(Me)){var Ce=Me;break t}}Ce=null}if(g=Ce)rn(this.i,this.l,g,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Ud(this,g);else{this.o=!1,this.s=3,oe(12),Gs(this),Wo(this);break e}}if(this.P){g=!0;let Bn;for(;!this.J&&this.C<W.length;)if(Bn=iS(this,W),Bn==Ld){Ft==4&&(this.s=4,oe(14),g=!1),rn(this.i,this.l,null,"[Incomplete Response]");break}else if(Bn==Cg){this.s=4,oe(15),rn(this.i,this.l,W,"[Invalid Chunk]"),g=!1;break}else rn(this.i,this.l,Bn,null),Ud(this,Bn);if(Rg(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Ft!=4||W.length!=0||this.h.h||(this.s=1,oe(16),g=!1),this.o=this.o&&g,!g)rn(this.i,this.l,W,"[Invalid Chunked Response]"),Gs(this),Wo(this);else if(0<W.length&&!this.W){this.W=!0;var Ut=this.j;Ut.g==this&&Ut.ba&&!Ut.M&&(Ut.j.info("Great, no buffering proxy detected. Bytes received: "+W.length),Wd(Ut),Ut.M=!0,oe(11))}}else rn(this.i,this.l,W,null),Ud(this,W);Ft==4&&Gs(this),this.o&&!this.J&&(Ft==4?sy(this.j,this):(this.o=!1,Fl(this)))}else ES(this.g),g==400&&0<W.indexOf("Unknown SID")?(this.s=3,oe(12)):(this.s=0,oe(13)),Gs(this),Wo(this)}}}catch{}finally{}};function Rg(a){return a.g?a.u=="GET"&&a.L!=2&&a.j.Ca:!1}function iS(a,h){var g=a.C,T=h.indexOf(`
`,g);return T==-1?Ld:(g=Number(h.substring(g,T)),isNaN(g)?Cg:(T+=1,T+g>h.length?Ld:(h=h.slice(T,T+g),a.C=T+g,h)))}Zr.prototype.cancel=function(){this.J=!0,Gs(this)};function Fl(a){a.S=Date.now()+a.I,Pg(a,a.I)}function Pg(a,h){if(a.B!=null)throw Error("WatchDog timer not null");a.B=ue(m(a.ba,a),h)}function Md(a){a.B&&(l.clearTimeout(a.B),a.B=null)}Zr.prototype.ba=function(){this.B=null;const a=Date.now();0<=a-this.S?(Oi(this.i,this.A),this.L!=2&&(ie(),oe(17)),Gs(this),this.s=2,Wo(this)):Pg(this,this.S-a)};function Wo(a){a.j.G==0||a.J||sy(a.j,a)}function Gs(a){Md(a);var h=a.M;h&&typeof h.ma=="function"&&h.ma(),a.M=null,Ol(a.U),a.g&&(h=a.g,a.g=null,h.abort(),h.ma())}function Ud(a,h){try{var g=a.j;if(g.G!=0&&(g.g==a||Fd(g.h,a))){if(!a.K&&Fd(g.h,a)&&g.G==3){try{var T=g.Da.g.parse(h)}catch{T=null}if(Array.isArray(T)&&T.length==3){var O=T;if(O[0]==0){e:if(!g.u){if(g.g)if(g.g.F+3e3<a.F)Ql(g),Gl(g);else break e;qd(g),oe(18)}}else g.za=O[1],0<g.za-g.T&&37500>O[2]&&g.F&&g.v==0&&!g.C&&(g.C=ue(m(g.Za,g),6e3));if(1>=Og(g.h)&&g.ca){try{g.ca()}catch{}g.ca=void 0}}else Qs(g,11)}else if((a.K||g.g==a)&&Ql(g),!v(h))for(O=g.Da.g.parse(h),h=0;h<O.length;h++){let Ce=O[h];if(g.T=Ce[0],Ce=Ce[1],g.G==2)if(Ce[0]=="c"){g.K=Ce[1],g.ia=Ce[2];const Ut=Ce[3];Ut!=null&&(g.la=Ut,g.j.info("VER="+g.la));const Ft=Ce[4];Ft!=null&&(g.Aa=Ft,g.j.info("SVER="+g.Aa));const Mi=Ce[5];Mi!=null&&typeof Mi=="number"&&0<Mi&&(T=1.5*Mi,g.L=T,g.j.info("backChannelRequestTimeoutMs_="+T)),T=g;const Bn=a.g;if(Bn){const Jl=Bn.g?Bn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Jl){var V=T.h;V.g||Jl.indexOf("spdy")==-1&&Jl.indexOf("quic")==-1&&Jl.indexOf("h2")==-1||(V.j=V.l,V.g=new Set,V.h&&($d(V,V.h),V.h=null))}if(T.D){const Hd=Bn.g?Bn.g.getResponseHeader("X-HTTP-Session-Id"):null;Hd&&(T.ya=Hd,qe(T.I,T.D,Hd))}}g.G=3,g.l&&g.l.ua(),g.ba&&(g.R=Date.now()-a.F,g.j.info("Handshake RTT: "+g.R+"ms")),T=g;var W=a;if(T.qa=ay(T,T.J?T.ia:null,T.W),W.K){Lg(T.h,W);var Me=W,Pt=T.L;Pt&&(Me.I=Pt),Me.B&&(Md(Me),Fl(Me)),T.g=W}else ny(T);0<g.i.length&&Kl(g)}else Ce[0]!="stop"&&Ce[0]!="close"||Qs(g,7);else g.G==3&&(Ce[0]=="stop"||Ce[0]=="close"?Ce[0]=="stop"?Qs(g,7):zd(g):Ce[0]!="noop"&&g.l&&g.l.ta(Ce),g.v=0)}}ie(4)}catch{}}var oS=class{constructor(a,h){this.g=a,this.map=h}};function jg(a){this.l=a||10,l.PerformanceNavigationTiming?(a=l.performance.getEntriesByType("navigation"),a=0<a.length&&(a[0].nextHopProtocol=="hq"||a[0].nextHopProtocol=="h2")):a=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=a?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Dg(a){return a.h?!0:a.g?a.g.size>=a.j:!1}function Og(a){return a.h?1:a.g?a.g.size:0}function Fd(a,h){return a.h?a.h==h:a.g?a.g.has(h):!1}function $d(a,h){a.g?a.g.add(h):a.h=h}function Lg(a,h){a.h&&a.h==h?a.h=null:a.g&&a.g.has(h)&&a.g.delete(h)}jg.prototype.cancel=function(){if(this.i=Vg(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const a of this.g.values())a.cancel();this.g.clear()}};function Vg(a){if(a.h!=null)return a.i.concat(a.h.D);if(a.g!=null&&a.g.size!==0){let h=a.i;for(const g of a.g.values())h=h.concat(g.D);return h}return A(a.i)}function aS(a){if(a.V&&typeof a.V=="function")return a.V();if(typeof Map<"u"&&a instanceof Map||typeof Set<"u"&&a instanceof Set)return Array.from(a.values());if(typeof a=="string")return a.split("");if(u(a)){for(var h=[],g=a.length,T=0;T<g;T++)h.push(a[T]);return h}h=[],g=0;for(T in a)h[g++]=a[T];return h}function lS(a){if(a.na&&typeof a.na=="function")return a.na();if(!a.V||typeof a.V!="function"){if(typeof Map<"u"&&a instanceof Map)return Array.from(a.keys());if(!(typeof Set<"u"&&a instanceof Set)){if(u(a)||typeof a=="string"){var h=[];a=a.length;for(var g=0;g<a;g++)h.push(g);return h}h=[],g=0;for(const T in a)h[g++]=T;return h}}}function Mg(a,h){if(a.forEach&&typeof a.forEach=="function")a.forEach(h,void 0);else if(u(a)||typeof a=="string")Array.prototype.forEach.call(a,h,void 0);else for(var g=lS(a),T=aS(a),O=T.length,V=0;V<O;V++)h.call(void 0,T[V],g&&g[V],a)}var Ug=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function uS(a,h){if(a){a=a.split("&");for(var g=0;g<a.length;g++){var T=a[g].indexOf("="),O=null;if(0<=T){var V=a[g].substring(0,T);O=a[g].substring(T+1)}else V=a[g];h(V,O?decodeURIComponent(O.replace(/\+/g," ")):"")}}}function Ks(a){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,a instanceof Ks){this.h=a.h,$l(this,a.j),this.o=a.o,this.g=a.g,Bl(this,a.s),this.l=a.l;var h=a.i,g=new Ko;g.i=h.i,h.g&&(g.g=new Map(h.g),g.h=h.h),Fg(this,g),this.m=a.m}else a&&(h=String(a).match(Ug))?(this.h=!1,$l(this,h[1]||"",!0),this.o=Ho(h[2]||""),this.g=Ho(h[3]||"",!0),Bl(this,h[4]),this.l=Ho(h[5]||"",!0),Fg(this,h[6]||"",!0),this.m=Ho(h[7]||"")):(this.h=!1,this.i=new Ko(null,this.h))}Ks.prototype.toString=function(){var a=[],h=this.j;h&&a.push(Go(h,$g,!0),":");var g=this.g;return(g||h=="file")&&(a.push("//"),(h=this.o)&&a.push(Go(h,$g,!0),"@"),a.push(encodeURIComponent(String(g)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),g=this.s,g!=null&&a.push(":",String(g))),(g=this.l)&&(this.g&&g.charAt(0)!="/"&&a.push("/"),a.push(Go(g,g.charAt(0)=="/"?hS:dS,!0))),(g=this.i.toString())&&a.push("?",g),(g=this.m)&&a.push("#",Go(g,pS)),a.join("")};function Sr(a){return new Ks(a)}function $l(a,h,g){a.j=g?Ho(h,!0):h,a.j&&(a.j=a.j.replace(/:$/,""))}function Bl(a,h){if(h){if(h=Number(h),isNaN(h)||0>h)throw Error("Bad port number "+h);a.s=h}else a.s=null}function Fg(a,h,g){h instanceof Ko?(a.i=h,mS(a.i,a.h)):(g||(h=Go(h,fS)),a.i=new Ko(h,a.h))}function qe(a,h,g){a.i.set(h,g)}function zl(a){return qe(a,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),a}function Ho(a,h){return a?h?decodeURI(a.replace(/%25/g,"%2525")):decodeURIComponent(a):""}function Go(a,h,g){return typeof a=="string"?(a=encodeURI(a).replace(h,cS),g&&(a=a.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),a):null}function cS(a){return a=a.charCodeAt(0),"%"+(a>>4&15).toString(16)+(a&15).toString(16)}var $g=/[#\/\?@]/g,dS=/[#\?:]/g,hS=/[#\?]/g,fS=/[#\?@]/g,pS=/#/g;function Ko(a,h){this.h=this.g=null,this.i=a||null,this.j=!!h}function es(a){a.g||(a.g=new Map,a.h=0,a.i&&uS(a.i,function(h,g){a.add(decodeURIComponent(h.replace(/\+/g," ")),g)}))}t=Ko.prototype,t.add=function(a,h){es(this),this.i=null,a=Li(this,a);var g=this.g.get(a);return g||this.g.set(a,g=[]),g.push(h),this.h+=1,this};function Bg(a,h){es(a),h=Li(a,h),a.g.has(h)&&(a.i=null,a.h-=a.g.get(h).length,a.g.delete(h))}function zg(a,h){return es(a),h=Li(a,h),a.g.has(h)}t.forEach=function(a,h){es(this),this.g.forEach(function(g,T){g.forEach(function(O){a.call(h,O,T,this)},this)},this)},t.na=function(){es(this);const a=Array.from(this.g.values()),h=Array.from(this.g.keys()),g=[];for(let T=0;T<h.length;T++){const O=a[T];for(let V=0;V<O.length;V++)g.push(h[T])}return g},t.V=function(a){es(this);let h=[];if(typeof a=="string")zg(this,a)&&(h=h.concat(this.g.get(Li(this,a))));else{a=Array.from(this.g.values());for(let g=0;g<a.length;g++)h=h.concat(a[g])}return h},t.set=function(a,h){return es(this),this.i=null,a=Li(this,a),zg(this,a)&&(this.h-=this.g.get(a).length),this.g.set(a,[h]),this.h+=1,this},t.get=function(a,h){return a?(a=this.V(a),0<a.length?String(a[0]):h):h};function qg(a,h,g){Bg(a,h),0<g.length&&(a.i=null,a.g.set(Li(a,h),A(g)),a.h+=g.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const a=[],h=Array.from(this.g.keys());for(var g=0;g<h.length;g++){var T=h[g];const V=encodeURIComponent(String(T)),W=this.V(T);for(T=0;T<W.length;T++){var O=V;W[T]!==""&&(O+="="+encodeURIComponent(String(W[T]))),a.push(O)}}return this.i=a.join("&")};function Li(a,h){return h=String(h),a.j&&(h=h.toLowerCase()),h}function mS(a,h){h&&!a.j&&(es(a),a.i=null,a.g.forEach(function(g,T){var O=T.toLowerCase();T!=O&&(Bg(this,T),qg(this,O,g))},a)),a.j=h}function gS(a,h){const g=new de;if(l.Image){const T=new Image;T.onload=y(ts,g,"TestLoadImage: loaded",!0,h,T),T.onerror=y(ts,g,"TestLoadImage: error",!1,h,T),T.onabort=y(ts,g,"TestLoadImage: abort",!1,h,T),T.ontimeout=y(ts,g,"TestLoadImage: timeout",!1,h,T),l.setTimeout(function(){T.ontimeout&&T.ontimeout()},1e4),T.src=a}else h(!1)}function yS(a,h){const g=new de,T=new AbortController,O=setTimeout(()=>{T.abort(),ts(g,"TestPingServer: timeout",!1,h)},1e4);fetch(a,{signal:T.signal}).then(V=>{clearTimeout(O),V.ok?ts(g,"TestPingServer: ok",!0,h):ts(g,"TestPingServer: server error",!1,h)}).catch(()=>{clearTimeout(O),ts(g,"TestPingServer: error",!1,h)})}function ts(a,h,g,T,O){try{O&&(O.onload=null,O.onerror=null,O.onabort=null,O.ontimeout=null),T(g)}catch{}}function vS(){this.g=new Dd}function _S(a,h,g){const T=g||"";try{Mg(a,function(O,V){let W=O;d(O)&&(W=Bo(O)),h.push(T+V+"="+encodeURIComponent(W))})}catch(O){throw h.push(T+"type="+encodeURIComponent("_badmap")),O}}function ql(a){this.l=a.Ub||null,this.j=a.eb||!1}x(ql,zo),ql.prototype.g=function(){return new Wl(this.l,this.j)},ql.prototype.i=function(a){return function(){return a}}({});function Wl(a,h){dt.call(this),this.D=a,this.o=h,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}x(Wl,dt),t=Wl.prototype,t.open=function(a,h){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=a,this.A=h,this.readyState=1,Yo(this)},t.send=function(a){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const h={headers:this.u,method:this.B,credentials:this.m,cache:void 0};a&&(h.body=a),(this.D||l).fetch(new Request(this.A,h)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Qo(this)),this.readyState=0},t.Sa=function(a){if(this.g&&(this.l=a,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=a.headers,this.readyState=2,Yo(this)),this.g&&(this.readyState=3,Yo(this),this.g)))if(this.responseType==="arraybuffer")a.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in a){if(this.j=a.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Wg(this)}else a.text().then(this.Ra.bind(this),this.ga.bind(this))};function Wg(a){a.j.read().then(a.Pa.bind(a)).catch(a.ga.bind(a))}t.Pa=function(a){if(this.g){if(this.o&&a.value)this.response.push(a.value);else if(!this.o){var h=a.value?a.value:new Uint8Array(0);(h=this.v.decode(h,{stream:!a.done}))&&(this.response=this.responseText+=h)}a.done?Qo(this):Yo(this),this.readyState==3&&Wg(this)}},t.Ra=function(a){this.g&&(this.response=this.responseText=a,Qo(this))},t.Qa=function(a){this.g&&(this.response=a,Qo(this))},t.ga=function(){this.g&&Qo(this)};function Qo(a){a.readyState=4,a.l=null,a.j=null,a.v=null,Yo(a)}t.setRequestHeader=function(a,h){this.u.append(a,h)},t.getResponseHeader=function(a){return this.h&&this.h.get(a.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const a=[],h=this.h.entries();for(var g=h.next();!g.done;)g=g.value,a.push(g[0]+": "+g[1]),g=h.next();return a.join(`\r
`)};function Yo(a){a.onreadystatechange&&a.onreadystatechange.call(a)}Object.defineProperty(Wl.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(a){this.m=a?"include":"same-origin"}});function Hg(a){let h="";return L(a,function(g,T){h+=T,h+=":",h+=g,h+=`\r
`}),h}function Bd(a,h,g){e:{for(T in g){var T=!1;break e}T=!0}T||(g=Hg(g),typeof a=="string"?g!=null&&encodeURIComponent(String(g)):qe(a,h,g))}function ot(a){dt.call(this),this.headers=new Map,this.o=a||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}x(ot,dt);var wS=/^https?$/i,xS=["POST","PUT"];t=ot.prototype,t.Ha=function(a){this.J=a},t.ea=function(a,h,g,T){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+a);h=h?h.toUpperCase():"GET",this.D=a,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Od.g(),this.v=this.o?Ll(this.o):Ll(Od),this.g.onreadystatechange=m(this.Ea,this);try{this.B=!0,this.g.open(h,String(a),!0),this.B=!1}catch(V){Gg(this,V);return}if(a=g||"",g=new Map(this.headers),T)if(Object.getPrototypeOf(T)===Object.prototype)for(var O in T)g.set(O,T[O]);else if(typeof T.keys=="function"&&typeof T.get=="function")for(const V of T.keys())g.set(V,T.get(V));else throw Error("Unknown input type for opt_headers: "+String(T));T=Array.from(g.keys()).find(V=>V.toLowerCase()=="content-type"),O=l.FormData&&a instanceof l.FormData,!(0<=Array.prototype.indexOf.call(xS,h,void 0))||T||O||g.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[V,W]of g)this.g.setRequestHeader(V,W);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Yg(this),this.u=!0,this.g.send(a),this.u=!1}catch(V){Gg(this,V)}};function Gg(a,h){a.h=!1,a.g&&(a.j=!0,a.g.abort(),a.j=!1),a.l=h,a.m=5,Kg(a),Hl(a)}function Kg(a){a.A||(a.A=!0,ht(a,"complete"),ht(a,"error"))}t.abort=function(a){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=a||7,ht(this,"complete"),ht(this,"abort"),Hl(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Hl(this,!0)),ot.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?Qg(this):this.bb())},t.bb=function(){Qg(this)};function Qg(a){if(a.h&&typeof o<"u"&&(!a.v[1]||Nr(a)!=4||a.Z()!=2)){if(a.u&&Nr(a)==4)jl(a.Ea,0,a);else if(ht(a,"readystatechange"),Nr(a)==4){a.h=!1;try{const W=a.Z();e:switch(W){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var h=!0;break e;default:h=!1}var g;if(!(g=h)){var T;if(T=W===0){var O=String(a.D).match(Ug)[1]||null;!O&&l.self&&l.self.location&&(O=l.self.location.protocol.slice(0,-1)),T=!wS.test(O?O.toLowerCase():"")}g=T}if(g)ht(a,"complete"),ht(a,"success");else{a.m=6;try{var V=2<Nr(a)?a.g.statusText:""}catch{V=""}a.l=V+" ["+a.Z()+"]",Kg(a)}}finally{Hl(a)}}}}function Hl(a,h){if(a.g){Yg(a);const g=a.g,T=a.v[0]?()=>{}:null;a.g=null,a.v=null,h||ht(a,"ready");try{g.onreadystatechange=T}catch{}}}function Yg(a){a.I&&(l.clearTimeout(a.I),a.I=null)}t.isActive=function(){return!!this.g};function Nr(a){return a.g?a.g.readyState:0}t.Z=function(){try{return 2<Nr(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(a){if(this.g){var h=this.g.responseText;return a&&h.indexOf(a)==0&&(h=h.substring(a.length)),jd(h)}};function Jg(a){try{if(!a.g)return null;if("response"in a.g)return a.g.response;switch(a.H){case"":case"text":return a.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in a.g)return a.g.mozResponseArrayBuffer}return null}catch{return null}}function ES(a){const h={};a=(a.g&&2<=Nr(a)&&a.g.getAllResponseHeaders()||"").split(`\r
`);for(let T=0;T<a.length;T++){if(v(a[T]))continue;var g=P(a[T]);const O=g[0];if(g=g[1],typeof g!="string")continue;g=g.trim();const V=h[O]||[];h[O]=V,V.push(g)}S(h,function(T){return T.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Jo(a,h,g){return g&&g.internalChannelParams&&g.internalChannelParams[a]||h}function Xg(a){this.Aa=0,this.i=[],this.j=new de,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Jo("failFast",!1,a),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Jo("baseRetryDelayMs",5e3,a),this.cb=Jo("retryDelaySeedMs",1e4,a),this.Wa=Jo("forwardChannelMaxRetries",2,a),this.wa=Jo("forwardChannelRequestTimeoutMs",2e4,a),this.pa=a&&a.xmlHttpFactory||void 0,this.Xa=a&&a.Tb||void 0,this.Ca=a&&a.useFetchStreams||!1,this.L=void 0,this.J=a&&a.supportsCrossDomainXhr||!1,this.K="",this.h=new jg(a&&a.concurrentRequestLimit),this.Da=new vS,this.P=a&&a.fastHandshake||!1,this.O=a&&a.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=a&&a.Rb||!1,a&&a.xa&&this.j.xa(),a&&a.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&a&&a.detectBufferingProxy||!1,this.ja=void 0,a&&a.longPollingTimeout&&0<a.longPollingTimeout&&(this.ja=a.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=Xg.prototype,t.la=8,t.G=1,t.connect=function(a,h,g,T){oe(0),this.W=a,this.H=h||{},g&&T!==void 0&&(this.H.OSID=g,this.H.OAID=T),this.F=this.X,this.I=ay(this,null,this.W),Kl(this)};function zd(a){if(Zg(a),a.G==3){var h=a.U++,g=Sr(a.I);if(qe(g,"SID",a.K),qe(g,"RID",h),qe(g,"TYPE","terminate"),Xo(a,g),h=new Zr(a,a.j,h),h.L=2,h.v=zl(Sr(g)),g=!1,l.navigator&&l.navigator.sendBeacon)try{g=l.navigator.sendBeacon(h.v.toString(),"")}catch{}!g&&l.Image&&(new Image().src=h.v,g=!0),g||(h.g=ly(h.j,null),h.g.ea(h.v)),h.F=Date.now(),Fl(h)}oy(a)}function Gl(a){a.g&&(Wd(a),a.g.cancel(),a.g=null)}function Zg(a){Gl(a),a.u&&(l.clearTimeout(a.u),a.u=null),Ql(a),a.h.cancel(),a.s&&(typeof a.s=="number"&&l.clearTimeout(a.s),a.s=null)}function Kl(a){if(!Dg(a.h)&&!a.s){a.s=!0;var h=a.Ga;Q||J(),$||(Q(),$=!0),K.add(h,a),a.B=0}}function TS(a,h){return Og(a.h)>=a.h.j-(a.s?1:0)?!1:a.s?(a.i=h.D.concat(a.i),!0):a.G==1||a.G==2||a.B>=(a.Va?0:a.Wa)?!1:(a.s=ue(m(a.Ga,a,h),iy(a,a.B)),a.B++,!0)}t.Ga=function(a){if(this.s)if(this.s=null,this.G==1){if(!a){this.U=Math.floor(1e5*Math.random()),a=this.U++;const O=new Zr(this,this.j,a);let V=this.o;if(this.S&&(V?(V=_(V),N(V,this.S)):V=this.S),this.m!==null||this.O||(O.H=V,V=null),this.P)e:{for(var h=0,g=0;g<this.i.length;g++){t:{var T=this.i[g];if("__data__"in T.map&&(T=T.map.__data__,typeof T=="string")){T=T.length;break t}T=void 0}if(T===void 0)break;if(h+=T,4096<h){h=g;break e}if(h===4096||g===this.i.length-1){h=g+1;break e}}h=1e3}else h=1e3;h=ty(this,O,h),g=Sr(this.I),qe(g,"RID",a),qe(g,"CVER",22),this.D&&qe(g,"X-HTTP-Session-Id",this.D),Xo(this,g),V&&(this.O?h="headers="+encodeURIComponent(String(Hg(V)))+"&"+h:this.m&&Bd(g,this.m,V)),$d(this.h,O),this.Ua&&qe(g,"TYPE","init"),this.P?(qe(g,"$req",h),qe(g,"SID","null"),O.T=!0,Vd(O,g,null)):Vd(O,g,h),this.G=2}}else this.G==3&&(a?ey(this,a):this.i.length==0||Dg(this.h)||ey(this))};function ey(a,h){var g;h?g=h.l:g=a.U++;const T=Sr(a.I);qe(T,"SID",a.K),qe(T,"RID",g),qe(T,"AID",a.T),Xo(a,T),a.m&&a.o&&Bd(T,a.m,a.o),g=new Zr(a,a.j,g,a.B+1),a.m===null&&(g.H=a.o),h&&(a.i=h.D.concat(a.i)),h=ty(a,g,1e3),g.I=Math.round(.5*a.wa)+Math.round(.5*a.wa*Math.random()),$d(a.h,g),Vd(g,T,h)}function Xo(a,h){a.H&&L(a.H,function(g,T){qe(h,T,g)}),a.l&&Mg({},function(g,T){qe(h,T,g)})}function ty(a,h,g){g=Math.min(a.i.length,g);var T=a.l?m(a.l.Na,a.l,a):null;e:{var O=a.i;let V=-1;for(;;){const W=["count="+g];V==-1?0<g?(V=O[0].g,W.push("ofs="+V)):V=0:W.push("ofs="+V);let Me=!0;for(let Pt=0;Pt<g;Pt++){let Ce=O[Pt].g;const Ut=O[Pt].map;if(Ce-=V,0>Ce)V=Math.max(0,O[Pt].g-100),Me=!1;else try{_S(Ut,W,"req"+Ce+"_")}catch{T&&T(Ut)}}if(Me){T=W.join("&");break e}}}return a=a.i.splice(0,g),h.D=a,T}function ny(a){if(!a.g&&!a.u){a.Y=1;var h=a.Fa;Q||J(),$||(Q(),$=!0),K.add(h,a),a.v=0}}function qd(a){return a.g||a.u||3<=a.v?!1:(a.Y++,a.u=ue(m(a.Fa,a),iy(a,a.v)),a.v++,!0)}t.Fa=function(){if(this.u=null,ry(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var a=2*this.R;this.j.info("BP detection timer enabled: "+a),this.A=ue(m(this.ab,this),a)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,oe(10),Gl(this),ry(this))};function Wd(a){a.A!=null&&(l.clearTimeout(a.A),a.A=null)}function ry(a){a.g=new Zr(a,a.j,"rpc",a.Y),a.m===null&&(a.g.H=a.o),a.g.O=0;var h=Sr(a.qa);qe(h,"RID","rpc"),qe(h,"SID",a.K),qe(h,"AID",a.T),qe(h,"CI",a.F?"0":"1"),!a.F&&a.ja&&qe(h,"TO",a.ja),qe(h,"TYPE","xmlhttp"),Xo(a,h),a.m&&a.o&&Bd(h,a.m,a.o),a.L&&(a.g.I=a.L);var g=a.g;a=a.ia,g.L=1,g.v=zl(Sr(h)),g.m=null,g.P=!0,kg(g,a)}t.Za=function(){this.C!=null&&(this.C=null,Gl(this),qd(this),oe(19))};function Ql(a){a.C!=null&&(l.clearTimeout(a.C),a.C=null)}function sy(a,h){var g=null;if(a.g==h){Ql(a),Wd(a),a.g=null;var T=2}else if(Fd(a.h,h))g=h.D,Lg(a.h,h),T=1;else return;if(a.G!=0){if(h.o)if(T==1){g=h.m?h.m.length:0,h=Date.now()-h.F;var O=a.B;T=Hs(),ht(T,new Re(T,g)),Kl(a)}else ny(a);else if(O=h.s,O==3||O==0&&0<h.X||!(T==1&&TS(a,h)||T==2&&qd(a)))switch(g&&0<g.length&&(h=a.h,h.i=h.i.concat(g)),O){case 1:Qs(a,5);break;case 4:Qs(a,10);break;case 3:Qs(a,6);break;default:Qs(a,2)}}}function iy(a,h){let g=a.Ta+Math.floor(Math.random()*a.cb);return a.isActive()||(g*=2),g*h}function Qs(a,h){if(a.j.info("Error code "+h),h==2){var g=m(a.fb,a),T=a.Xa;const O=!T;T=new Ks(T||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||$l(T,"https"),zl(T),O?gS(T.toString(),g):yS(T.toString(),g)}else oe(2);a.G=0,a.l&&a.l.sa(h),oy(a),Zg(a)}t.fb=function(a){a?(this.j.info("Successfully pinged google.com"),oe(2)):(this.j.info("Failed to ping google.com"),oe(1))};function oy(a){if(a.G=0,a.ka=[],a.l){const h=Vg(a.h);(h.length!=0||a.i.length!=0)&&(b(a.ka,h),b(a.ka,a.i),a.h.i.length=0,A(a.i),a.i.length=0),a.l.ra()}}function ay(a,h,g){var T=g instanceof Ks?Sr(g):new Ks(g);if(T.g!="")h&&(T.g=h+"."+T.g),Bl(T,T.s);else{var O=l.location;T=O.protocol,h=h?h+"."+O.hostname:O.hostname,O=+O.port;var V=new Ks(null);T&&$l(V,T),h&&(V.g=h),O&&Bl(V,O),g&&(V.l=g),T=V}return g=a.D,h=a.ya,g&&h&&qe(T,g,h),qe(T,"VER",a.la),Xo(a,T),T}function ly(a,h,g){if(h&&!a.J)throw Error("Can't create secondary domain capable XhrIo object.");return h=a.Ca&&!a.pa?new ot(new ql({eb:g})):new ot(a.pa),h.Ha(a.J),h}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function uy(){}t=uy.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function Yl(){}Yl.prototype.g=function(a,h){return new gn(a,h)};function gn(a,h){dt.call(this),this.g=new Xg(h),this.l=a,this.h=h&&h.messageUrlParams||null,a=h&&h.messageHeaders||null,h&&h.clientProtocolHeaderRequired&&(a?a["X-Client-Protocol"]="webchannel":a={"X-Client-Protocol":"webchannel"}),this.g.o=a,a=h&&h.initMessageHeaders||null,h&&h.messageContentType&&(a?a["X-WebChannel-Content-Type"]=h.messageContentType:a={"X-WebChannel-Content-Type":h.messageContentType}),h&&h.va&&(a?a["X-WebChannel-Client-Profile"]=h.va:a={"X-WebChannel-Client-Profile":h.va}),this.g.S=a,(a=h&&h.Sb)&&!v(a)&&(this.g.m=a),this.v=h&&h.supportsCrossDomainXhr||!1,this.u=h&&h.sendRawJson||!1,(h=h&&h.httpSessionIdParam)&&!v(h)&&(this.g.D=h,a=this.h,a!==null&&h in a&&(a=this.h,h in a&&delete a[h])),this.j=new Vi(this)}x(gn,dt),gn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},gn.prototype.close=function(){zd(this.g)},gn.prototype.o=function(a){var h=this.g;if(typeof a=="string"){var g={};g.__data__=a,a=g}else this.u&&(g={},g.__data__=Bo(a),a=g);h.i.push(new oS(h.Ya++,a)),h.G==3&&Kl(h)},gn.prototype.N=function(){this.g.l=null,delete this.j,zd(this.g),delete this.g,gn.aa.N.call(this)};function cy(a){Di.call(this),a.__headers__&&(this.headers=a.__headers__,this.statusCode=a.__status__,delete a.__headers__,delete a.__status__);var h=a.__sm__;if(h){e:{for(const g in h){a=g;break e}a=void 0}(this.i=a)&&(a=this.i,h=h!==null&&a in h?h[a]:void 0),this.data=h}else this.data=a}x(cy,Di);function dy(){qo.call(this),this.status=1}x(dy,qo);function Vi(a){this.g=a}x(Vi,uy),Vi.prototype.ua=function(){ht(this.g,"a")},Vi.prototype.ta=function(a){ht(this.g,new cy(a))},Vi.prototype.sa=function(a){ht(this.g,new dy)},Vi.prototype.ra=function(){ht(this.g,"b")},Yl.prototype.createWebChannel=Yl.prototype.g,gn.prototype.send=gn.prototype.o,gn.prototype.open=gn.prototype.m,gn.prototype.close=gn.prototype.close,GE=function(){return new Yl},HE=function(){return Hs()},WE=or,Kf={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Ml.NO_ERROR=0,Ml.TIMEOUT=8,Ml.HTTP_ERROR=6,Uu=Ml,bg.COMPLETE="complete",qE=bg,ir.EventType=Ws,Ws.OPEN="a",Ws.CLOSE="b",Ws.ERROR="c",Ws.MESSAGE="d",dt.prototype.listen=dt.prototype.K,fa=ir,ot.prototype.listenOnce=ot.prototype.L,ot.prototype.getLastError=ot.prototype.Ka,ot.prototype.getLastErrorCode=ot.prototype.Ba,ot.prototype.getStatus=ot.prototype.Z,ot.prototype.getResponseJson=ot.prototype.Oa,ot.prototype.getResponseText=ot.prototype.oa,ot.prototype.send=ot.prototype.ea,ot.prototype.setWithCredentials=ot.prototype.Ha,zE=ot}).apply(typeof yu<"u"?yu:typeof self<"u"?self:typeof window<"u"?window:{});const i_="@firebase/firestore",o_="4.9.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qt{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}qt.UNAUTHENTICATED=new qt(null),qt.GOOGLE_CREDENTIALS=new qt("google-credentials-uid"),qt.FIRST_PARTY=new qt("first-party-uid"),qt.MOCK_USER=new qt("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Vo="12.0.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gi=new pm("@firebase/firestore");function Fi(){return gi.logLevel}function Y(t,...e){if(gi.logLevel<=Ee.DEBUG){const n=e.map(Rm);gi.debug(`Firestore (${Vo}): ${t}`,...n)}}function Wr(t,...e){if(gi.logLevel<=Ee.ERROR){const n=e.map(Rm);gi.error(`Firestore (${Vo}): ${t}`,...n)}}function yi(t,...e){if(gi.logLevel<=Ee.WARN){const n=e.map(Rm);gi.warn(`Firestore (${Vo}): ${t}`,...n)}}function Rm(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ae(t,e,n){let r="Unexpected state";typeof e=="string"?r=e:n=e,KE(t,r,n)}function KE(t,e,n){let r=`FIRESTORE (${Vo}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(n!==void 0)try{r+=" CONTEXT: "+JSON.stringify(n)}catch{r+=" CONTEXT: "+n}throw Wr(r),new Error(r)}function je(t,e,n,r){let s="Unexpected state";typeof n=="string"?s=n:r=n,t||KE(e,s,r)}function pe(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const M={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class H extends nr{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mr{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QE{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class YE{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(qt.UNAUTHENTICATED))}shutdown(){}}class nP{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class rP{constructor(e){this.t=e,this.currentUser=qt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){je(this.o===void 0,42304);let r=this.i;const s=u=>this.i!==r?(r=this.i,n(u)):Promise.resolve();let i=new mr;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new mr,e.enqueueRetryable(()=>s(this.currentUser))};const o=()=>{const u=i;e.enqueueRetryable(async()=>{await u.promise,await s(this.currentUser)})},l=u=>{Y("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(u=>l(u)),setTimeout(()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?l(u):(Y("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new mr)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(Y("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(je(typeof r.accessToken=="string",31837,{l:r}),new QE(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return je(e===null||typeof e=="string",2055,{h:e}),new qt(e)}}class sP{constructor(e,n,r){this.P=e,this.T=n,this.I=r,this.type="FirstParty",this.user=qt.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class iP{constructor(e,n,r){this.P=e,this.T=n,this.I=r}getToken(){return Promise.resolve(new sP(this.P,this.T,this.I))}start(e,n){e.enqueueRetryable(()=>n(qt.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class a_{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class oP{constructor(e,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,an(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,n){je(this.o===void 0,3512);const r=i=>{i.error!=null&&Y("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.m;return this.m=i.token,Y("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>r(i))};const s=i=>{Y("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.V.getImmediate({optional:!0});i?s(i):Y("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new a_(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(je(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new a_(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aP(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ud{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const s=aP(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<n&&(r+=e.charAt(s[i]%62))}return r}}function Te(t,e){return t<e?-1:t>e?1:0}function Qf(t,e){const n=Math.min(t.length,e.length);for(let r=0;r<n;r++){const s=t.charAt(r),i=e.charAt(r);if(s!==i)return Ah(s)===Ah(i)?Te(s,i):Ah(s)?1:-1}return Te(t.length,e.length)}const lP=55296,uP=57343;function Ah(t){const e=t.charCodeAt(0);return e>=lP&&e<=uP}function To(t,e,n){return t.length===e.length&&t.every((r,s)=>n(r,e[s]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yf="__name__";class ur{constructor(e,n,r){n===void 0?n=0:n>e.length&&ae(637,{offset:n,range:e.length}),r===void 0?r=e.length-n:r>e.length-n&&ae(1746,{length:r,range:e.length-n}),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return ur.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof ur?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let s=0;s<r;s++){const i=ur.compareSegments(e.get(s),n.get(s));if(i!==0)return i}return Te(e.length,n.length)}static compareSegments(e,n){const r=ur.isNumericId(e),s=ur.isNumericId(n);return r&&!s?-1:!r&&s?1:r&&s?ur.extractNumericId(e).compare(ur.extractNumericId(n)):Qf(e,n)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return As.fromString(e.substring(4,e.length-2))}}class Ue extends ur{construct(e,n,r){return new Ue(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new H(M.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(s=>s.length>0))}return new Ue(n)}static emptyPath(){return new Ue([])}}const cP=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class At extends ur{construct(e,n,r){return new At(e,n,r)}static isValidIdentifier(e){return cP.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),At.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===Yf}static keyField(){return new At([Yf])}static fromServerFormat(e){const n=[];let r="",s=0;const i=()=>{if(r.length===0)throw new H(M.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;s<e.length;){const l=e[s];if(l==="\\"){if(s+1===e.length)throw new H(M.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[s+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new H(M.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,s+=2}else l==="`"?(o=!o,s++):l!=="."||o?(r+=l,s++):(i(),s++)}if(i(),o)throw new H(M.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new At(n)}static emptyPath(){return new At([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class te{constructor(e){this.path=e}static fromPath(e){return new te(Ue.fromString(e))}static fromName(e){return new te(Ue.fromString(e).popFirst(5))}static empty(){return new te(Ue.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Ue.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return Ue.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new te(new Ue(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pm(t,e,n){if(!n)throw new H(M.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function JE(t,e,n,r){if(e===!0&&r===!0)throw new H(M.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function l_(t){if(!te.isDocumentKey(t))throw new H(M.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function u_(t){if(te.isDocumentKey(t))throw new H(M.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function XE(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function cd(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":ae(12329,{type:typeof t})}function kt(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new H(M.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=cd(t);throw new H(M.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gt(t,e){const n={typeString:t};return e&&(n.value=e),n}function xl(t,e){if(!XE(t))throw new H(M.INVALID_ARGUMENT,"JSON must be an object");let n;for(const r in e)if(e[r]){const s=e[r].typeString,i="value"in e[r]?{value:e[r].value}:void 0;if(!(r in t)){n=`JSON missing required field: '${r}'`;break}const o=t[r];if(s&&typeof o!==s){n=`JSON field '${r}' must be a ${s}.`;break}if(i!==void 0&&o!==i.value){n=`Expected '${r}' field to equal '${i.value}'`;break}}if(n)throw new H(M.INVALID_ARGUMENT,n);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const c_=-62135596800,d_=1e6;class $e{static now(){return $e.fromMillis(Date.now())}static fromDate(e){return $e.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor((e-1e3*n)*d_);return new $e(n,r)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new H(M.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new H(M.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<c_)throw new H(M.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new H(M.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/d_}_compareTo(e){return this.seconds===e.seconds?Te(this.nanoseconds,e.nanoseconds):Te(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:$e._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(xl(e,$e._jsonSchema))return new $e(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-c_;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}$e._jsonSchemaVersion="firestore/timestamp/1.0",$e._jsonSchema={type:gt("string",$e._jsonSchemaVersion),seconds:gt("number"),nanoseconds:gt("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class me{static fromTimestamp(e){return new me(e)}static min(){return new me(new $e(0,0))}static max(){return new me(new $e(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const el=-1;function dP(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,s=me.fromTimestamp(r===1e9?new $e(n+1,0):new $e(n,r));return new js(s,te.empty(),e)}function hP(t){return new js(t.readTime,t.key,el)}class js{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new js(me.min(),te.empty(),el)}static max(){return new js(me.max(),te.empty(),el)}}function fP(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=te.comparator(t.documentKey,e.documentKey),n!==0?n:Te(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pP="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class mP{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Mo(t){if(t.code!==M.FAILED_PRECONDITION||t.message!==pP)throw t;Y("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&ae(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new U((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(n,i).next(r,s)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof U?n:U.resolve(n)}catch(n){return U.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):U.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):U.reject(n)}static resolve(e){return new U((n,r)=>{n(e)})}static reject(e){return new U((n,r)=>{r(e)})}static waitFor(e){return new U((n,r)=>{let s=0,i=0,o=!1;e.forEach(l=>{++s,l.next(()=>{++i,o&&i===s&&n()},u=>r(u))}),o=!0,i===s&&n()})}static or(e){let n=U.resolve(!1);for(const r of e)n=n.next(s=>s?U.resolve(s):r());return n}static forEach(e,n){const r=[];return e.forEach((s,i)=>{r.push(n.call(this,s,i))}),this.waitFor(r)}static mapArray(e,n){return new U((r,s)=>{const i=e.length,o=new Array(i);let l=0;for(let u=0;u<i;u++){const d=u;n(e[d]).next(f=>{o[d]=f,++l,l===i&&r(o)},f=>s(f))}})}static doWhile(e,n){return new U((r,s)=>{const i=()=>{e()===!0?n().next(()=>{i()},s):r()};i()})}}function gP(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function Uo(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dd{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>n.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}dd.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jm=-1;function hd(t){return t==null}function Ic(t){return t===0&&1/t==-1/0}function yP(t){return typeof t=="number"&&Number.isInteger(t)&&!Ic(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZE="";function vP(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=h_(e)),e=_P(t.get(n),e);return h_(e)}function _P(t,e){let n=e;const r=t.length;for(let s=0;s<r;s++){const i=t.charAt(s);switch(i){case"\0":n+="";break;case ZE:n+="";break;default:n+=i}}return n}function h_(t){return t+ZE+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function f_(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Bs(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function wP(t,e){const n=[];for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&n.push(e(t[r],r,t));return n}function eT(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class st{constructor(e,n){this.comparator=e,this.root=n||Dt.EMPTY}insert(e,n){return new st(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Dt.BLACK,null,null))}remove(e){return new st(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Dt.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return n+r.left.size;s<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new vu(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new vu(this.root,e,this.comparator,!1)}getReverseIterator(){return new vu(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new vu(this.root,e,this.comparator,!0)}}class vu{constructor(e,n,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=n?r(e.key,n):1,n&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Dt{constructor(e,n,r,s,i){this.key=e,this.value=n,this.color=r??Dt.RED,this.left=s??Dt.EMPTY,this.right=i??Dt.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,s,i){return new Dt(e??this.key,n??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,n,r),null):i===0?s.copy(null,n,null,null,null):s.copy(null,null,null,null,s.right.insert(e,n,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return Dt.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,s=this;if(n(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),n(e,s.key)===0){if(s.right.isEmpty())return Dt.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Dt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Dt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw ae(43730,{key:this.key,value:this.value});if(this.right.isRed())throw ae(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw ae(27949);return e+(this.isRed()?0:1)}}Dt.EMPTY=null,Dt.RED=!0,Dt.BLACK=!1;Dt.EMPTY=new class{constructor(){this.size=0}get key(){throw ae(57766)}get value(){throw ae(16141)}get color(){throw ae(16727)}get left(){throw ae(29726)}get right(){throw ae(36894)}copy(e,n,r,s,i){return this}insert(e,n,r){return new Dt(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xt{constructor(e){this.comparator=e,this.data=new st(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;n(s.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new p_(this.data.getIterator())}getIteratorFrom(e){return new p_(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof xt)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new xt(this.comparator);return n.data=e,n}}class p_{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wn{constructor(e){this.fields=e,e.sort(At.comparator)}static empty(){return new wn([])}unionWith(e){let n=new xt(At.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new wn(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return To(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tT extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rt{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new tT("Invalid base64 string: "+i):i}}(e);return new Rt(n)}static fromUint8Array(e){const n=function(s){let i="";for(let o=0;o<s.length;++o)i+=String.fromCharCode(s[o]);return i}(e);return new Rt(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Te(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Rt.EMPTY_BYTE_STRING=new Rt("");const xP=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ds(t){if(je(!!t,39018),typeof t=="string"){let e=0;const n=xP.exec(t);if(je(!!n,46558,{timestamp:t}),n[1]){let s=n[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:ut(t.seconds),nanos:ut(t.nanos)}}function ut(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Os(t){return typeof t=="string"?Rt.fromBase64String(t):Rt.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nT="server_timestamp",rT="__type__",sT="__previous_value__",iT="__local_write_time__";function Dm(t){var n,r;return((r=(((n=t==null?void 0:t.mapValue)==null?void 0:n.fields)||{})[rT])==null?void 0:r.stringValue)===nT}function fd(t){const e=t.mapValue.fields[sT];return Dm(e)?fd(e):e}function tl(t){const e=Ds(t.mapValue.fields[iT].timestampValue);return new $e(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EP{constructor(e,n,r,s,i,o,l,u,d,f){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=l,this.longPollingOptions=u,this.useFetchStreams=d,this.isUsingEmulator=f}}const Sc="(default)";class Io{constructor(e,n){this.projectId=e,this.database=n||Sc}static empty(){return new Io("","")}get isDefaultDatabase(){return this.database===Sc}isEqual(e){return e instanceof Io&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oT="__type__",TP="__max__",_u={mapValue:{}},aT="__vector__",Nc="value";function Ls(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Dm(t)?4:SP(t)?9007199254740991:IP(t)?10:11:ae(28295,{value:t})}function _r(t,e){if(t===e)return!0;const n=Ls(t);if(n!==Ls(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return tl(t).isEqual(tl(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const o=Ds(s.timestampValue),l=Ds(i.timestampValue);return o.seconds===l.seconds&&o.nanos===l.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,i){return Os(s.bytesValue).isEqual(Os(i.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,i){return ut(s.geoPointValue.latitude)===ut(i.geoPointValue.latitude)&&ut(s.geoPointValue.longitude)===ut(i.geoPointValue.longitude)}(t,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return ut(s.integerValue)===ut(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const o=ut(s.doubleValue),l=ut(i.doubleValue);return o===l?Ic(o)===Ic(l):isNaN(o)&&isNaN(l)}return!1}(t,e);case 9:return To(t.arrayValue.values||[],e.arrayValue.values||[],_r);case 10:case 11:return function(s,i){const o=s.mapValue.fields||{},l=i.mapValue.fields||{};if(f_(o)!==f_(l))return!1;for(const u in o)if(o.hasOwnProperty(u)&&(l[u]===void 0||!_r(o[u],l[u])))return!1;return!0}(t,e);default:return ae(52216,{left:t})}}function nl(t,e){return(t.values||[]).find(n=>_r(n,e))!==void 0}function So(t,e){if(t===e)return 0;const n=Ls(t),r=Ls(e);if(n!==r)return Te(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return Te(t.booleanValue,e.booleanValue);case 2:return function(i,o){const l=ut(i.integerValue||i.doubleValue),u=ut(o.integerValue||o.doubleValue);return l<u?-1:l>u?1:l===u?0:isNaN(l)?isNaN(u)?0:-1:1}(t,e);case 3:return m_(t.timestampValue,e.timestampValue);case 4:return m_(tl(t),tl(e));case 5:return Qf(t.stringValue,e.stringValue);case 6:return function(i,o){const l=Os(i),u=Os(o);return l.compareTo(u)}(t.bytesValue,e.bytesValue);case 7:return function(i,o){const l=i.split("/"),u=o.split("/");for(let d=0;d<l.length&&d<u.length;d++){const f=Te(l[d],u[d]);if(f!==0)return f}return Te(l.length,u.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,o){const l=Te(ut(i.latitude),ut(o.latitude));return l!==0?l:Te(ut(i.longitude),ut(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return g_(t.arrayValue,e.arrayValue);case 10:return function(i,o){var m,y,x,A;const l=i.fields||{},u=o.fields||{},d=(m=l[Nc])==null?void 0:m.arrayValue,f=(y=u[Nc])==null?void 0:y.arrayValue,p=Te(((x=d==null?void 0:d.values)==null?void 0:x.length)||0,((A=f==null?void 0:f.values)==null?void 0:A.length)||0);return p!==0?p:g_(d,f)}(t.mapValue,e.mapValue);case 11:return function(i,o){if(i===_u.mapValue&&o===_u.mapValue)return 0;if(i===_u.mapValue)return 1;if(o===_u.mapValue)return-1;const l=i.fields||{},u=Object.keys(l),d=o.fields||{},f=Object.keys(d);u.sort(),f.sort();for(let p=0;p<u.length&&p<f.length;++p){const m=Qf(u[p],f[p]);if(m!==0)return m;const y=So(l[u[p]],d[f[p]]);if(y!==0)return y}return Te(u.length,f.length)}(t.mapValue,e.mapValue);default:throw ae(23264,{he:n})}}function m_(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Te(t,e);const n=Ds(t),r=Ds(e),s=Te(n.seconds,r.seconds);return s!==0?s:Te(n.nanos,r.nanos)}function g_(t,e){const n=t.values||[],r=e.values||[];for(let s=0;s<n.length&&s<r.length;++s){const i=So(n[s],r[s]);if(i)return i}return Te(n.length,r.length)}function No(t){return Jf(t)}function Jf(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=Ds(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return Os(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return te.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",s=!0;for(const i of n.values||[])s?s=!1:r+=",",r+=Jf(i);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let s="{",i=!0;for(const o of r)i?i=!1:s+=",",s+=`${o}:${Jf(n.fields[o])}`;return s+"}"}(t.mapValue):ae(61005,{value:t})}function Fu(t){switch(Ls(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=fd(t);return e?16+Fu(e):16;case 5:return 2*t.stringValue.length;case 6:return Os(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((s,i)=>s+Fu(i),0)}(t.arrayValue);case 10:case 11:return function(r){let s=0;return Bs(r.fields,(i,o)=>{s+=i.length+Fu(o)}),s}(t.mapValue);default:throw ae(13486,{value:t})}}function y_(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function Xf(t){return!!t&&"integerValue"in t}function Om(t){return!!t&&"arrayValue"in t}function v_(t){return!!t&&"nullValue"in t}function __(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function $u(t){return!!t&&"mapValue"in t}function IP(t){var n,r;return((r=(((n=t==null?void 0:t.mapValue)==null?void 0:n.fields)||{})[oT])==null?void 0:r.stringValue)===aT}function ba(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return Bs(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=ba(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=ba(t.arrayValue.values[n]);return e}return{...t}}function SP(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===TP}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ln{constructor(e){this.value=e}static empty(){return new ln({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!$u(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=ba(n)}setAll(e){let n=At.emptyPath(),r={},s=[];e.forEach((o,l)=>{if(!n.isImmediateParentOf(l)){const u=this.getFieldsMap(n);this.applyChanges(u,r,s),r={},s=[],n=l.popLast()}o?r[l.lastSegment()]=ba(o):s.push(l.lastSegment())});const i=this.getFieldsMap(n);this.applyChanges(i,r,s)}delete(e){const n=this.field(e.popLast());$u(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return _r(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=n.mapValue.fields[e.get(r)];$u(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=s),n=s}return n.mapValue.fields}applyChanges(e,n,r){Bs(n,(s,i)=>e[s]=i);for(const s of r)delete e[s]}clone(){return new ln(ba(this.value))}}function lT(t){const e=[];return Bs(t.fields,(n,r)=>{const s=new At([n]);if($u(r)){const i=lT(r.mapValue).fields;if(i.length===0)e.push(s);else for(const o of i)e.push(s.child(o))}else e.push(s)}),new wn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ht{constructor(e,n,r,s,i,o,l){this.key=e,this.documentType=n,this.version=r,this.readTime=s,this.createTime=i,this.data=o,this.documentState=l}static newInvalidDocument(e){return new Ht(e,0,me.min(),me.min(),me.min(),ln.empty(),0)}static newFoundDocument(e,n,r,s){return new Ht(e,1,n,me.min(),r,s,0)}static newNoDocument(e,n){return new Ht(e,2,n,me.min(),me.min(),ln.empty(),0)}static newUnknownDocument(e,n){return new Ht(e,3,n,me.min(),me.min(),ln.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(me.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=ln.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=ln.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=me.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Ht&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Ht(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bc{constructor(e,n){this.position=e,this.inclusive=n}}function w_(t,e,n){let r=0;for(let s=0;s<t.position.length;s++){const i=e[s],o=t.position[s];if(i.field.isKeyField()?r=te.comparator(te.fromName(o.referenceValue),n.key):r=So(o,n.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function x_(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!_r(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rl{constructor(e,n="asc"){this.field=e,this.dir=n}}function NP(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uT{}class mt extends uT{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new AP(e,n,r):n==="array-contains"?new RP(e,r):n==="in"?new PP(e,r):n==="not-in"?new jP(e,r):n==="array-contains-any"?new DP(e,r):new mt(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new CP(e,r):new kP(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(So(n,this.value)):n!==null&&Ls(this.value)===Ls(n)&&this.matchesComparison(So(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return ae(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class tr extends uT{constructor(e,n){super(),this.filters=e,this.op=n,this.Pe=null}static create(e,n){return new tr(e,n)}matches(e){return cT(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function cT(t){return t.op==="and"}function dT(t){return bP(t)&&cT(t)}function bP(t){for(const e of t.filters)if(e instanceof tr)return!1;return!0}function Zf(t){if(t instanceof mt)return t.field.canonicalString()+t.op.toString()+No(t.value);if(dT(t))return t.filters.map(e=>Zf(e)).join(",");{const e=t.filters.map(n=>Zf(n)).join(",");return`${t.op}(${e})`}}function hT(t,e){return t instanceof mt?function(r,s){return s instanceof mt&&r.op===s.op&&r.field.isEqual(s.field)&&_r(r.value,s.value)}(t,e):t instanceof tr?function(r,s){return s instanceof tr&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce((i,o,l)=>i&&hT(o,s.filters[l]),!0):!1}(t,e):void ae(19439)}function fT(t){return t instanceof mt?function(n){return`${n.field.canonicalString()} ${n.op} ${No(n.value)}`}(t):t instanceof tr?function(n){return n.op.toString()+" {"+n.getFilters().map(fT).join(" ,")+"}"}(t):"Filter"}class AP extends mt{constructor(e,n,r){super(e,n,r),this.key=te.fromName(r.referenceValue)}matches(e){const n=te.comparator(e.key,this.key);return this.matchesComparison(n)}}class CP extends mt{constructor(e,n){super(e,"in",n),this.keys=pT("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class kP extends mt{constructor(e,n){super(e,"not-in",n),this.keys=pT("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function pT(t,e){var n;return(((n=e.arrayValue)==null?void 0:n.values)||[]).map(r=>te.fromName(r.referenceValue))}class RP extends mt{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return Om(n)&&nl(n.arrayValue,this.value)}}class PP extends mt{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&nl(this.value.arrayValue,n)}}class jP extends mt{constructor(e,n){super(e,"not-in",n)}matches(e){if(nl(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&n.nullValue===void 0&&!nl(this.value.arrayValue,n)}}class DP extends mt{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!Om(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>nl(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OP{constructor(e,n=null,r=[],s=[],i=null,o=null,l=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=o,this.endAt=l,this.Te=null}}function E_(t,e=null,n=[],r=[],s=null,i=null,o=null){return new OP(t,e,n,r,s,i,o)}function Lm(t){const e=pe(t);if(e.Te===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>Zf(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(i){return i.field.canonicalString()+i.dir}(r)).join(","),hd(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>No(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>No(r)).join(",")),e.Te=n}return e.Te}function Vm(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!NP(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!hT(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!x_(t.startAt,e.startAt)&&x_(t.endAt,e.endAt)}function ep(t){return te.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bi{constructor(e,n=null,r=[],s=[],i=null,o="F",l=null,u=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=o,this.startAt=l,this.endAt=u,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function LP(t,e,n,r,s,i,o,l){return new bi(t,e,n,r,s,i,o,l)}function pd(t){return new bi(t)}function T_(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function mT(t){return t.collectionGroup!==null}function Aa(t){const e=pe(t);if(e.Ie===null){e.Ie=[];const n=new Set;for(const i of e.explicitOrderBy)e.Ie.push(i),n.add(i.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let l=new xt(At.comparator);return o.filters.forEach(u=>{u.getFlattenedFilters().forEach(d=>{d.isInequality()&&(l=l.add(d.field))})}),l})(e).forEach(i=>{n.has(i.canonicalString())||i.isKeyField()||e.Ie.push(new rl(i,r))}),n.has(At.keyField().canonicalString())||e.Ie.push(new rl(At.keyField(),r))}return e.Ie}function gr(t){const e=pe(t);return e.Ee||(e.Ee=gT(e,Aa(t))),e.Ee}function VP(t){const e=pe(t);return e.de||(e.de=gT(e,t.explicitOrderBy)),e.de}function gT(t,e){if(t.limitType==="F")return E_(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new rl(s.field,i)});const n=t.endAt?new bc(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new bc(t.startAt.position,t.startAt.inclusive):null;return E_(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function tp(t,e){const n=t.filters.concat([e]);return new bi(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function np(t,e,n){return new bi(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function md(t,e){return Vm(gr(t),gr(e))&&t.limitType===e.limitType}function yT(t){return`${Lm(gr(t))}|lt:${t.limitType}`}function $i(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(s=>fT(s)).join(", ")}]`),hd(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(s=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(s)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(s=>No(s)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(s=>No(s)).join(",")),`Target(${r})`}(gr(t))}; limitType=${t.limitType})`}function gd(t,e){return e.isFoundDocument()&&function(r,s){const i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):te.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)}(t,e)&&function(r,s){for(const i of Aa(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(t,e)&&function(r,s){for(const i of r.filters)if(!i.matches(s))return!1;return!0}(t,e)&&function(r,s){return!(r.startAt&&!function(o,l,u){const d=w_(o,l,u);return o.inclusive?d<=0:d<0}(r.startAt,Aa(r),s)||r.endAt&&!function(o,l,u){const d=w_(o,l,u);return o.inclusive?d>=0:d>0}(r.endAt,Aa(r),s))}(t,e)}function MP(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function vT(t){return(e,n)=>{let r=!1;for(const s of Aa(t)){const i=UP(s,e,n);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function UP(t,e,n){const r=t.field.isKeyField()?te.comparator(e.key,n.key):function(i,o,l){const u=o.data.field(i),d=l.data.field(i);return u!==null&&d!==null?So(u,d):ae(42886)}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return ae(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ai{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,n]);s.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[n]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){Bs(this.inner,(n,r)=>{for(const[s,i]of r)e(s,i)})}isEmpty(){return eT(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FP=new st(te.comparator);function Hr(){return FP}const _T=new st(te.comparator);function pa(...t){let e=_T;for(const n of t)e=e.insert(n.key,n);return e}function wT(t){let e=_T;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function si(){return Ca()}function xT(){return Ca()}function Ca(){return new Ai(t=>t.toString(),(t,e)=>t.isEqual(e))}const $P=new st(te.comparator),BP=new xt(te.comparator);function Ie(...t){let e=BP;for(const n of t)e=e.add(n);return e}const zP=new xt(Te);function qP(){return zP}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mm(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ic(e)?"-0":e}}function ET(t){return{integerValue:""+t}}function WP(t,e){return yP(e)?ET(e):Mm(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yd{constructor(){this._=void 0}}function HP(t,e,n){return t instanceof sl?function(s,i){const o={fields:{[rT]:{stringValue:nT},[iT]:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&Dm(i)&&(i=fd(i)),i&&(o.fields[sT]=i),{mapValue:o}}(n,e):t instanceof il?IT(t,e):t instanceof ol?ST(t,e):function(s,i){const o=TT(s,i),l=I_(o)+I_(s.Ae);return Xf(o)&&Xf(s.Ae)?ET(l):Mm(s.serializer,l)}(t,e)}function GP(t,e,n){return t instanceof il?IT(t,e):t instanceof ol?ST(t,e):n}function TT(t,e){return t instanceof Ac?function(r){return Xf(r)||function(i){return!!i&&"doubleValue"in i}(r)}(e)?e:{integerValue:0}:null}class sl extends yd{}class il extends yd{constructor(e){super(),this.elements=e}}function IT(t,e){const n=NT(e);for(const r of t.elements)n.some(s=>_r(s,r))||n.push(r);return{arrayValue:{values:n}}}class ol extends yd{constructor(e){super(),this.elements=e}}function ST(t,e){let n=NT(e);for(const r of t.elements)n=n.filter(s=>!_r(s,r));return{arrayValue:{values:n}}}class Ac extends yd{constructor(e,n){super(),this.serializer=e,this.Ae=n}}function I_(t){return ut(t.integerValue||t.doubleValue)}function NT(t){return Om(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KP{constructor(e,n){this.field=e,this.transform=n}}function QP(t,e){return t.field.isEqual(e.field)&&function(r,s){return r instanceof il&&s instanceof il||r instanceof ol&&s instanceof ol?To(r.elements,s.elements,_r):r instanceof Ac&&s instanceof Ac?_r(r.Ae,s.Ae):r instanceof sl&&s instanceof sl}(t.transform,e.transform)}class YP{constructor(e,n){this.version=e,this.transformResults=n}}class en{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new en}static exists(e){return new en(void 0,e)}static updateTime(e){return new en(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Bu(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class vd{}function bT(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new _d(t.key,en.none()):new El(t.key,t.data,en.none());{const n=t.data,r=ln.empty();let s=new xt(At.comparator);for(let i of e.fields)if(!s.has(i)){let o=n.field(i);o===null&&i.length>1&&(i=i.popLast(),o=n.field(i)),o===null?r.delete(i):r.set(i,o),s=s.add(i)}return new zs(t.key,r,new wn(s.toArray()),en.none())}}function JP(t,e,n){t instanceof El?function(s,i,o){const l=s.value.clone(),u=N_(s.fieldTransforms,i,o.transformResults);l.setAll(u),i.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(t,e,n):t instanceof zs?function(s,i,o){if(!Bu(s.precondition,i))return void i.convertToUnknownDocument(o.version);const l=N_(s.fieldTransforms,i,o.transformResults),u=i.data;u.setAll(AT(s)),u.setAll(l),i.convertToFoundDocument(o.version,u).setHasCommittedMutations()}(t,e,n):function(s,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function ka(t,e,n,r){return t instanceof El?function(i,o,l,u){if(!Bu(i.precondition,o))return l;const d=i.value.clone(),f=b_(i.fieldTransforms,u,o);return d.setAll(f),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),null}(t,e,n,r):t instanceof zs?function(i,o,l,u){if(!Bu(i.precondition,o))return l;const d=b_(i.fieldTransforms,u,o),f=o.data;return f.setAll(AT(i)),f.setAll(d),o.convertToFoundDocument(o.version,f).setHasLocalMutations(),l===null?null:l.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(p=>p.field))}(t,e,n,r):function(i,o,l){return Bu(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):l}(t,e,n)}function XP(t,e){let n=null;for(const r of t.fieldTransforms){const s=e.data.field(r.field),i=TT(r.transform,s||null);i!=null&&(n===null&&(n=ln.empty()),n.set(r.field,i))}return n||null}function S_(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&To(r,s,(i,o)=>QP(i,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class El extends vd{constructor(e,n,r,s=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class zs extends vd{constructor(e,n,r,s,i=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function AT(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function N_(t,e,n){const r=new Map;je(t.length===n.length,32656,{Re:n.length,Ve:t.length});for(let s=0;s<n.length;s++){const i=t[s],o=i.transform,l=e.data.field(i.field);r.set(i.field,GP(o,l,n[s]))}return r}function b_(t,e,n){const r=new Map;for(const s of t){const i=s.transform,o=n.data.field(s.field);r.set(s.field,HP(i,o,e))}return r}class _d extends vd{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class ZP extends vd{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e2{constructor(e,n,r,s){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&JP(i,e,r[s])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=ka(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=ka(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=xT();return this.mutations.forEach(s=>{const i=e.get(s.key),o=i.overlayedDocument;let l=this.applyToLocalView(o,i.mutatedFields);l=n.has(s.key)?null:l;const u=bT(o,l);u!==null&&r.set(s.key,u),o.isValidDocument()||o.convertToNoDocument(me.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),Ie())}isEqual(e){return this.batchId===e.batchId&&To(this.mutations,e.mutations,(n,r)=>S_(n,r))&&To(this.baseMutations,e.baseMutations,(n,r)=>S_(n,r))}}class Um{constructor(e,n,r,s){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=s}static from(e,n,r){je(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let s=function(){return $P}();const i=e.mutations;for(let o=0;o<i.length;o++)s=s.insert(i[o].key,r[o].version);return new Um(e,n,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t2{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n2{constructor(e,n,r){this.alias=e,this.aggregateType=n,this.fieldPath=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r2{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ft,Ne;function s2(t){switch(t){case M.OK:return ae(64938);case M.CANCELLED:case M.UNKNOWN:case M.DEADLINE_EXCEEDED:case M.RESOURCE_EXHAUSTED:case M.INTERNAL:case M.UNAVAILABLE:case M.UNAUTHENTICATED:return!1;case M.INVALID_ARGUMENT:case M.NOT_FOUND:case M.ALREADY_EXISTS:case M.PERMISSION_DENIED:case M.FAILED_PRECONDITION:case M.ABORTED:case M.OUT_OF_RANGE:case M.UNIMPLEMENTED:case M.DATA_LOSS:return!0;default:return ae(15467,{code:t})}}function CT(t){if(t===void 0)return Wr("GRPC error has no .code"),M.UNKNOWN;switch(t){case ft.OK:return M.OK;case ft.CANCELLED:return M.CANCELLED;case ft.UNKNOWN:return M.UNKNOWN;case ft.DEADLINE_EXCEEDED:return M.DEADLINE_EXCEEDED;case ft.RESOURCE_EXHAUSTED:return M.RESOURCE_EXHAUSTED;case ft.INTERNAL:return M.INTERNAL;case ft.UNAVAILABLE:return M.UNAVAILABLE;case ft.UNAUTHENTICATED:return M.UNAUTHENTICATED;case ft.INVALID_ARGUMENT:return M.INVALID_ARGUMENT;case ft.NOT_FOUND:return M.NOT_FOUND;case ft.ALREADY_EXISTS:return M.ALREADY_EXISTS;case ft.PERMISSION_DENIED:return M.PERMISSION_DENIED;case ft.FAILED_PRECONDITION:return M.FAILED_PRECONDITION;case ft.ABORTED:return M.ABORTED;case ft.OUT_OF_RANGE:return M.OUT_OF_RANGE;case ft.UNIMPLEMENTED:return M.UNIMPLEMENTED;case ft.DATA_LOSS:return M.DATA_LOSS;default:return ae(39323,{code:t})}}(Ne=ft||(ft={}))[Ne.OK=0]="OK",Ne[Ne.CANCELLED=1]="CANCELLED",Ne[Ne.UNKNOWN=2]="UNKNOWN",Ne[Ne.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ne[Ne.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ne[Ne.NOT_FOUND=5]="NOT_FOUND",Ne[Ne.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ne[Ne.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ne[Ne.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ne[Ne.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ne[Ne.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ne[Ne.ABORTED=10]="ABORTED",Ne[Ne.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ne[Ne.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ne[Ne.INTERNAL=13]="INTERNAL",Ne[Ne.UNAVAILABLE=14]="UNAVAILABLE",Ne[Ne.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function i2(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const o2=new As([4294967295,4294967295],0);function A_(t){const e=i2().encode(t),n=new BE;return n.update(e),new Uint8Array(n.digest())}function C_(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new As([n,r],0),new As([s,i],0)]}class Fm{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new ma(`Invalid padding: ${n}`);if(r<0)throw new ma(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new ma(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new ma(`Invalid padding when bitmap length is 0: ${n}`);this.ge=8*e.length-n,this.pe=As.fromNumber(this.ge)}ye(e,n,r){let s=e.add(n.multiply(As.fromNumber(r)));return s.compare(o2)===1&&(s=new As([s.getBits(0),s.getBits(1)],0)),s.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const n=A_(e),[r,s]=C_(n);for(let i=0;i<this.hashCount;i++){const o=this.ye(r,s,i);if(!this.we(o))return!1}return!0}static create(e,n,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new Fm(i,s,n);return r.forEach(l=>o.insert(l)),o}insert(e){if(this.ge===0)return;const n=A_(e),[r,s]=C_(n);for(let i=0;i<this.hashCount;i++){const o=this.ye(r,s,i);this.Se(o)}}Se(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class ma extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wd{constructor(e,n,r,s,i){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const s=new Map;return s.set(e,Tl.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new wd(me.min(),s,new st(Te),Hr(),Ie())}}class Tl{constructor(e,n,r,s,i){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new Tl(r,n,Ie(),Ie(),Ie())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zu{constructor(e,n,r,s){this.be=e,this.removedTargetIds=n,this.key=r,this.De=s}}class kT{constructor(e,n){this.targetId=e,this.Ce=n}}class RT{constructor(e,n,r=Rt.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=s}}class k_{constructor(){this.ve=0,this.Fe=R_(),this.Me=Rt.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Ie(),n=Ie(),r=Ie();return this.Fe.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:n=n.add(s);break;case 1:r=r.add(s);break;default:ae(38017,{changeType:i})}}),new Tl(this.Me,this.xe,e,n,r)}qe(){this.Oe=!1,this.Fe=R_()}Qe(e,n){this.Oe=!0,this.Fe=this.Fe.insert(e,n)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,je(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class a2{constructor(e){this.Ge=e,this.ze=new Map,this.je=Hr(),this.Je=wu(),this.He=wu(),this.Ye=new st(Te)}Ze(e){for(const n of e.be)e.De&&e.De.isFoundDocument()?this.Xe(n,e.De):this.et(n,e.key,e.De);for(const n of e.removedTargetIds)this.et(n,e.key,e.De)}tt(e){this.forEachTarget(e,n=>{const r=this.nt(n);switch(e.state){case 0:this.rt(n)&&r.Le(e.resumeToken);break;case 1:r.Ke(),r.Ne||r.qe(),r.Le(e.resumeToken);break;case 2:r.Ke(),r.Ne||this.removeTarget(n);break;case 3:this.rt(n)&&(r.We(),r.Le(e.resumeToken));break;case 4:this.rt(n)&&(this.it(n),r.Le(e.resumeToken));break;default:ae(56790,{state:e.state})}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.ze.forEach((r,s)=>{this.rt(s)&&n(s)})}st(e){const n=e.targetId,r=e.Ce.count,s=this.ot(n);if(s){const i=s.target;if(ep(i))if(r===0){const o=new te(i.path);this.et(n,o,Ht.newNoDocument(o,me.min()))}else je(r===1,20013,{expectedCount:r});else{const o=this._t(n);if(o!==r){const l=this.ut(e),u=l?this.ct(l,e,o):1;if(u!==0){this.it(n);const d=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(n,d)}}}}}ut(e){const n=e.Ce.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:i=0}=n;let o,l;try{o=Os(r).toUint8Array()}catch(u){if(u instanceof tT)return yi("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{l=new Fm(o,s,i)}catch(u){return yi(u instanceof ma?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return l.ge===0?null:l}ct(e,n,r){return n.Ce.count===r-this.Pt(e,n.targetId)?0:2}Pt(e,n){const r=this.Ge.getRemoteKeysForTarget(n);let s=0;return r.forEach(i=>{const o=this.Ge.ht(),l=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;e.mightContain(l)||(this.et(n,i,null),s++)}),s}Tt(e){const n=new Map;this.ze.forEach((i,o)=>{const l=this.ot(o);if(l){if(i.current&&ep(l.target)){const u=new te(l.target.path);this.It(u).has(o)||this.Et(o,u)||this.et(o,u,Ht.newNoDocument(u,e))}i.Be&&(n.set(o,i.ke()),i.qe())}});let r=Ie();this.He.forEach((i,o)=>{let l=!0;o.forEachWhile(u=>{const d=this.ot(u);return!d||d.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)}),l&&(r=r.add(i))}),this.je.forEach((i,o)=>o.setReadTime(e));const s=new wd(e,n,this.Ye,this.je,r);return this.je=Hr(),this.Je=wu(),this.He=wu(),this.Ye=new st(Te),s}Xe(e,n){if(!this.rt(e))return;const r=this.Et(e,n.key)?2:0;this.nt(e).Qe(n.key,r),this.je=this.je.insert(n.key,n),this.Je=this.Je.insert(n.key,this.It(n.key).add(e)),this.He=this.He.insert(n.key,this.dt(n.key).add(e))}et(e,n,r){if(!this.rt(e))return;const s=this.nt(e);this.Et(e,n)?s.Qe(n,1):s.$e(n),this.He=this.He.insert(n,this.dt(n).delete(e)),this.He=this.He.insert(n,this.dt(n).add(e)),r&&(this.je=this.je.insert(n,r))}removeTarget(e){this.ze.delete(e)}_t(e){const n=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let n=this.ze.get(e);return n||(n=new k_,this.ze.set(e,n)),n}dt(e){let n=this.He.get(e);return n||(n=new xt(Te),this.He=this.He.insert(e,n)),n}It(e){let n=this.Je.get(e);return n||(n=new xt(Te),this.Je=this.Je.insert(e,n)),n}rt(e){const n=this.ot(e)!==null;return n||Y("WatchChangeAggregator","Detected inactive target",e),n}ot(e){const n=this.ze.get(e);return n&&n.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new k_),this.Ge.getRemoteKeysForTarget(e).forEach(n=>{this.et(e,n,null)})}Et(e,n){return this.Ge.getRemoteKeysForTarget(e).has(n)}}function wu(){return new st(te.comparator)}function R_(){return new st(te.comparator)}const l2={asc:"ASCENDING",desc:"DESCENDING"},u2={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},c2={and:"AND",or:"OR"};class d2{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function rp(t,e){return t.useProto3Json||hd(e)?e:{value:e}}function Cc(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function PT(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function h2(t,e){return Cc(t,e.toTimestamp())}function yr(t){return je(!!t,49232),me.fromTimestamp(function(n){const r=Ds(n);return new $e(r.seconds,r.nanos)}(t))}function $m(t,e){return sp(t,e).canonicalString()}function sp(t,e){const n=function(s){return new Ue(["projects",s.projectId,"databases",s.database])}(t).child("documents");return e===void 0?n:n.child(e)}function jT(t){const e=Ue.fromString(t);return je(UT(e),10190,{key:e.toString()}),e}function ip(t,e){return $m(t.databaseId,e.path)}function Ch(t,e){const n=jT(e);if(n.get(1)!==t.databaseId.projectId)throw new H(M.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new H(M.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new te(OT(n))}function DT(t,e){return $m(t.databaseId,e)}function f2(t){const e=jT(t);return e.length===4?Ue.emptyPath():OT(e)}function op(t){return new Ue(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function OT(t){return je(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function P_(t,e,n){return{name:ip(t,e),fields:n.value.mapValue.fields}}function p2(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:ae(39313,{state:d})}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(d,f){return d.useProto3Json?(je(f===void 0||typeof f=="string",58123),Rt.fromBase64String(f||"")):(je(f===void 0||f instanceof Buffer||f instanceof Uint8Array,16193),Rt.fromUint8Array(f||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,l=o&&function(d){const f=d.code===void 0?M.UNKNOWN:CT(d.code);return new H(f,d.message||"")}(o);n=new RT(r,s,i,l||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=Ch(t,r.document.name),i=yr(r.document.updateTime),o=r.document.createTime?yr(r.document.createTime):me.min(),l=new ln({mapValue:{fields:r.document.fields}}),u=Ht.newFoundDocument(s,i,o,l),d=r.targetIds||[],f=r.removedTargetIds||[];n=new zu(d,f,u.key,u)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=Ch(t,r.document),i=r.readTime?yr(r.readTime):me.min(),o=Ht.newNoDocument(s,i),l=r.removedTargetIds||[];n=new zu([],l,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=Ch(t,r.document),i=r.removedTargetIds||[];n=new zu([],i,s,null)}else{if(!("filter"in e))return ae(11601,{Rt:e});{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,o=new r2(s,i),l=r.targetId;n=new kT(l,o)}}return n}function m2(t,e){let n;if(e instanceof El)n={update:P_(t,e.key,e.value)};else if(e instanceof _d)n={delete:ip(t,e.key)};else if(e instanceof zs)n={update:P_(t,e.key,e.data),updateMask:I2(e.fieldMask)};else{if(!(e instanceof ZP))return ae(16599,{Vt:e.type});n={verify:ip(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(i,o){const l=o.transform;if(l instanceof sl)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof il)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof ol)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof Ac)return{fieldPath:o.field.canonicalString(),increment:l.Ae};throw ae(20930,{transform:o.transform})}(0,r))),e.precondition.isNone||(n.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:h2(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:ae(27497)}(t,e.precondition)),n}function g2(t,e){return t&&t.length>0?(je(e!==void 0,14353),t.map(n=>function(s,i){let o=s.updateTime?yr(s.updateTime):yr(i);return o.isEqual(me.min())&&(o=yr(i)),new YP(o,s.transformResults||[])}(n,e))):[]}function y2(t,e){return{documents:[DT(t,e.path)]}}function LT(t,e){const n={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=DT(t,s);const i=function(d){if(d.length!==0)return MT(tr.create(d,"and"))}(e.filters);i&&(n.structuredQuery.where=i);const o=function(d){if(d.length!==0)return d.map(f=>function(m){return{field:fs(m.field),direction:x2(m.dir)}}(f))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const l=rp(t,e.limit);return l!==null&&(n.structuredQuery.limit=l),e.startAt&&(n.structuredQuery.startAt=function(d){return{before:d.inclusive,values:d.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(d){return{before:!d.inclusive,values:d.position}}(e.endAt)),{ft:n,parent:s}}function v2(t,e,n,r){const{ft:s,parent:i}=LT(t,e),o={},l=[];let u=0;return n.forEach(d=>{const f="aggregate_"+u++;o[f]=d.alias,d.aggregateType==="count"?l.push({alias:f,count:{}}):d.aggregateType==="avg"?l.push({alias:f,avg:{field:fs(d.fieldPath)}}):d.aggregateType==="sum"&&l.push({alias:f,sum:{field:fs(d.fieldPath)}})}),{request:{structuredAggregationQuery:{aggregations:l,structuredQuery:s.structuredQuery},parent:s.parent},gt:o,parent:i}}function _2(t){let e=f2(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let s=null;if(r>0){je(r===1,65062);const f=n.from[0];f.allDescendants?s=f.collectionId:e=e.child(f.collectionId)}let i=[];n.where&&(i=function(p){const m=VT(p);return m instanceof tr&&dT(m)?m.getFilters():[m]}(n.where));let o=[];n.orderBy&&(o=function(p){return p.map(m=>function(x){return new rl(Bi(x.field),function(b){switch(b){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(x.direction))}(m))}(n.orderBy));let l=null;n.limit&&(l=function(p){let m;return m=typeof p=="object"?p.value:p,hd(m)?null:m}(n.limit));let u=null;n.startAt&&(u=function(p){const m=!!p.before,y=p.values||[];return new bc(y,m)}(n.startAt));let d=null;return n.endAt&&(d=function(p){const m=!p.before,y=p.values||[];return new bc(y,m)}(n.endAt)),LP(e,s,o,i,l,"F",u,d)}function w2(t,e){const n=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ae(28987,{purpose:s})}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function VT(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=Bi(n.unaryFilter.field);return mt.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=Bi(n.unaryFilter.field);return mt.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=Bi(n.unaryFilter.field);return mt.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Bi(n.unaryFilter.field);return mt.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return ae(61313);default:return ae(60726)}}(t):t.fieldFilter!==void 0?function(n){return mt.create(Bi(n.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return ae(58110);default:return ae(50506)}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return tr.create(n.compositeFilter.filters.map(r=>VT(r)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return ae(1026)}}(n.compositeFilter.op))}(t):ae(30097,{filter:t})}function x2(t){return l2[t]}function E2(t){return u2[t]}function T2(t){return c2[t]}function fs(t){return{fieldPath:t.canonicalString()}}function Bi(t){return At.fromServerFormat(t.fieldPath)}function MT(t){return t instanceof mt?function(n){if(n.op==="=="){if(__(n.value))return{unaryFilter:{field:fs(n.field),op:"IS_NAN"}};if(v_(n.value))return{unaryFilter:{field:fs(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(__(n.value))return{unaryFilter:{field:fs(n.field),op:"IS_NOT_NAN"}};if(v_(n.value))return{unaryFilter:{field:fs(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:fs(n.field),op:E2(n.op),value:n.value}}}(t):t instanceof tr?function(n){const r=n.getFilters().map(s=>MT(s));return r.length===1?r[0]:{compositeFilter:{op:T2(n.op),filters:r}}}(t):ae(54877,{filter:t})}function I2(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function UT(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ys{constructor(e,n,r,s,i=me.min(),o=me.min(),l=Rt.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=l,this.expectedCount=u}withSequenceNumber(e){return new ys(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new ys(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new ys(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new ys(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S2{constructor(e){this.yt=e}}function N2(t){const e=_2({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?np(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b2{constructor(){this.Cn=new A2}addToCollectionParentIndex(e,n){return this.Cn.add(n),U.resolve()}getCollectionParents(e,n){return U.resolve(this.Cn.getEntries(n))}addFieldIndex(e,n){return U.resolve()}deleteFieldIndex(e,n){return U.resolve()}deleteAllFieldIndexes(e){return U.resolve()}createTargetIndexes(e,n){return U.resolve()}getDocumentsMatchingTarget(e,n){return U.resolve(null)}getIndexType(e,n){return U.resolve(0)}getFieldIndexes(e,n){return U.resolve([])}getNextCollectionGroupToUpdate(e){return U.resolve(null)}getMinOffset(e,n){return U.resolve(js.min())}getMinOffsetFromCollectionGroup(e,n){return U.resolve(js.min())}updateCollectionGroup(e,n,r){return U.resolve()}updateIndexEntries(e,n){return U.resolve()}}class A2{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n]||new xt(Ue.comparator),i=!s.has(r);return this.index[n]=s.add(r),i}has(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n];return s&&s.has(r)}getEntries(e){return(this.index[e]||new xt(Ue.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const j_={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},FT=41943040;class sn{static withCacheSize(e){return new sn(e,sn.DEFAULT_COLLECTION_PERCENTILE,sn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */sn.DEFAULT_COLLECTION_PERCENTILE=10,sn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,sn.DEFAULT=new sn(FT,sn.DEFAULT_COLLECTION_PERCENTILE,sn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),sn.DISABLED=new sn(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bo{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new bo(0)}static cr(){return new bo(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const D_="LruGarbageCollector",C2=1048576;function O_([t,e],[n,r]){const s=Te(t,n);return s===0?Te(e,r):s}class k2{constructor(e){this.Ir=e,this.buffer=new xt(O_),this.Er=0}dr(){return++this.Er}Ar(e){const n=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();O_(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class R2{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){Y(D_,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){Uo(n)?Y(D_,"Ignoring IndexedDB error during garbage collection: ",n):await Mo(n)}await this.Vr(3e5)})}}class P2{constructor(e,n){this.mr=e,this.params=n}calculateTargetCount(e,n){return this.mr.gr(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return U.resolve(dd.ce);const r=new k2(n);return this.mr.forEachTarget(e,s=>r.Ar(s.sequenceNumber)).next(()=>this.mr.pr(e,s=>r.Ar(s))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.mr.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.mr.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(Y("LruGarbageCollector","Garbage collection skipped; disabled"),U.resolve(j_)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(Y("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),j_):this.yr(e,n))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,n){let r,s,i,o,l,u,d;const f=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(p=>(p>this.params.maximumSequenceNumbersToCollect?(Y("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${p}`),s=this.params.maximumSequenceNumbersToCollect):s=p,o=Date.now(),this.nthSequenceNumber(e,s))).next(p=>(r=p,l=Date.now(),this.removeTargets(e,r,n))).next(p=>(i=p,u=Date.now(),this.removeOrphanedDocuments(e,r))).next(p=>(d=Date.now(),Fi()<=Ee.DEBUG&&Y("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-f}ms
	Determined least recently used ${s} in `+(l-o)+`ms
	Removed ${i} targets in `+(u-l)+`ms
	Removed ${p} documents in `+(d-u)+`ms
Total Duration: ${d-f}ms`),U.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:i,documentsRemoved:p})))}}function j2(t,e){return new P2(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D2{constructor(){this.changes=new Ai(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,Ht.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?U.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O2{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L2{constructor(e,n,r,s){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,n))).next(s=>(r!==null&&ka(r.mutation,s,wn.empty(),$e.now()),s))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,Ie()).next(()=>r))}getLocalViewOfDocuments(e,n,r=Ie()){const s=si();return this.populateOverlays(e,s,n).next(()=>this.computeViews(e,n,s,r).next(i=>{let o=pa();return i.forEach((l,u)=>{o=o.insert(l,u.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=si();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,Ie()))}populateOverlays(e,n,r){const s=[];return r.forEach(i=>{n.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((o,l)=>{n.set(o,l)})})}computeViews(e,n,r,s){let i=Hr();const o=Ca(),l=function(){return Ca()}();return n.forEach((u,d)=>{const f=r.get(d.key);s.has(d.key)&&(f===void 0||f.mutation instanceof zs)?i=i.insert(d.key,d):f!==void 0?(o.set(d.key,f.mutation.getFieldMask()),ka(f.mutation,d,f.mutation.getFieldMask(),$e.now())):o.set(d.key,wn.empty())}),this.recalculateAndSaveOverlays(e,i).next(u=>(u.forEach((d,f)=>o.set(d,f)),n.forEach((d,f)=>l.set(d,new O2(f,o.get(d)??null))),l))}recalculateAndSaveOverlays(e,n){const r=Ca();let s=new st((o,l)=>o-l),i=Ie();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const l of o)l.keys().forEach(u=>{const d=n.get(u);if(d===null)return;let f=r.get(u)||wn.empty();f=l.applyToLocalView(d,f),r.set(u,f);const p=(s.get(l.batchId)||Ie()).add(u);s=s.insert(l.batchId,p)})}).next(()=>{const o=[],l=s.getReverseIterator();for(;l.hasNext();){const u=l.getNext(),d=u.key,f=u.value,p=xT();f.forEach(m=>{if(!i.has(m)){const y=bT(n.get(m),r.get(m));y!==null&&p.set(m,y),i=i.add(m)}}),o.push(this.documentOverlayCache.saveOverlays(e,d,p))}return U.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,s){return function(o){return te.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):mT(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,s):this.getDocumentsMatchingCollectionQuery(e,n,r,s)}getNextDocuments(e,n,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,s).next(i=>{const o=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,s-i.size):U.resolve(si());let l=el,u=i;return o.next(d=>U.forEach(d,(f,p)=>(l<p.largestBatchId&&(l=p.largestBatchId),i.get(f)?U.resolve():this.remoteDocumentCache.getEntry(e,f).next(m=>{u=u.insert(f,m)}))).next(()=>this.populateOverlays(e,d,i)).next(()=>this.computeViews(e,u,d,Ie())).next(f=>({batchId:l,changes:wT(f)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new te(n)).next(r=>{let s=pa();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,n,r,s){const i=n.collectionGroup;let o=pa();return this.indexManager.getCollectionParents(e,i).next(l=>U.forEach(l,u=>{const d=function(p,m){return new bi(m,null,p.explicitOrderBy.slice(),p.filters.slice(),p.limit,p.limitType,p.startAt,p.endAt)}(n,u.child(i));return this.getDocumentsMatchingCollectionQuery(e,d,r,s).next(f=>{f.forEach((p,m)=>{o=o.insert(p,m)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,i,s))).next(o=>{i.forEach((u,d)=>{const f=d.getKey();o.get(f)===null&&(o=o.insert(f,Ht.newInvalidDocument(f)))});let l=pa();return o.forEach((u,d)=>{const f=i.get(u);f!==void 0&&ka(f.mutation,d,wn.empty(),$e.now()),gd(n,d)&&(l=l.insert(u,d))}),l})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V2{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,n){return U.resolve(this.Lr.get(n))}saveBundleMetadata(e,n){return this.Lr.set(n.id,function(s){return{id:s.id,version:s.version,createTime:yr(s.createTime)}}(n)),U.resolve()}getNamedQuery(e,n){return U.resolve(this.kr.get(n))}saveNamedQuery(e,n){return this.kr.set(n.name,function(s){return{name:s.name,query:N2(s.bundledQuery),readTime:yr(s.readTime)}}(n)),U.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M2{constructor(){this.overlays=new st(te.comparator),this.qr=new Map}getOverlay(e,n){return U.resolve(this.overlays.get(n))}getOverlays(e,n){const r=si();return U.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((s,i)=>{this.St(e,n,i)}),U.resolve()}removeOverlaysForBatchId(e,n,r){const s=this.qr.get(r);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.qr.delete(r)),U.resolve()}getOverlaysForCollection(e,n,r){const s=si(),i=n.length+1,o=new te(n.child("")),l=this.overlays.getIteratorFrom(o);for(;l.hasNext();){const u=l.getNext().value,d=u.getKey();if(!n.isPrefixOf(d.path))break;d.path.length===i&&u.largestBatchId>r&&s.set(u.getKey(),u)}return U.resolve(s)}getOverlaysForCollectionGroup(e,n,r,s){let i=new st((d,f)=>d-f);const o=this.overlays.getIterator();for(;o.hasNext();){const d=o.getNext().value;if(d.getKey().getCollectionGroup()===n&&d.largestBatchId>r){let f=i.get(d.largestBatchId);f===null&&(f=si(),i=i.insert(d.largestBatchId,f)),f.set(d.getKey(),d)}}const l=si(),u=i.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((d,f)=>l.set(d,f)),!(l.size()>=s)););return U.resolve(l)}St(e,n,r){const s=this.overlays.get(r.key);if(s!==null){const o=this.qr.get(s.largestBatchId).delete(r.key);this.qr.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new t2(n,r));let i=this.qr.get(n);i===void 0&&(i=Ie(),this.qr.set(n,i)),this.qr.set(n,i.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U2{constructor(){this.sessionToken=Rt.EMPTY_BYTE_STRING}getSessionToken(e){return U.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,U.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bm{constructor(){this.Qr=new xt(Nt.$r),this.Ur=new xt(Nt.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,n){const r=new Nt(e,n);this.Qr=this.Qr.add(r),this.Ur=this.Ur.add(r)}Wr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Gr(new Nt(e,n))}zr(e,n){e.forEach(r=>this.removeReference(r,n))}jr(e){const n=new te(new Ue([])),r=new Nt(n,e),s=new Nt(n,e+1),i=[];return this.Ur.forEachInRange([r,s],o=>{this.Gr(o),i.push(o.key)}),i}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const n=new te(new Ue([])),r=new Nt(n,e),s=new Nt(n,e+1);let i=Ie();return this.Ur.forEachInRange([r,s],o=>{i=i.add(o.key)}),i}containsKey(e){const n=new Nt(e,0),r=this.Qr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class Nt{constructor(e,n){this.key=e,this.Yr=n}static $r(e,n){return te.comparator(e.key,n.key)||Te(e.Yr,n.Yr)}static Kr(e,n){return Te(e.Yr,n.Yr)||te.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F2{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.tr=1,this.Zr=new xt(Nt.$r)}checkEmpty(e){return U.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,s){const i=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new e2(i,n,r,s);this.mutationQueue.push(o);for(const l of s)this.Zr=this.Zr.add(new Nt(l.key,i)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return U.resolve(o)}lookupMutationBatch(e,n){return U.resolve(this.Xr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=this.ei(r),i=s<0?0:s;return U.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return U.resolve(this.mutationQueue.length===0?jm:this.tr-1)}getAllMutationBatches(e){return U.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new Nt(n,0),s=new Nt(n,Number.POSITIVE_INFINITY),i=[];return this.Zr.forEachInRange([r,s],o=>{const l=this.Xr(o.Yr);i.push(l)}),U.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new xt(Te);return n.forEach(s=>{const i=new Nt(s,0),o=new Nt(s,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([i,o],l=>{r=r.add(l.Yr)})}),U.resolve(this.ti(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1;let i=r;te.isDocumentKey(i)||(i=i.child(""));const o=new Nt(new te(i),0);let l=new xt(Te);return this.Zr.forEachWhile(u=>{const d=u.key.path;return!!r.isPrefixOf(d)&&(d.length===s&&(l=l.add(u.Yr)),!0)},o),U.resolve(this.ti(l))}ti(e){const n=[];return e.forEach(r=>{const s=this.Xr(r);s!==null&&n.push(s)}),n}removeMutationBatch(e,n){je(this.ni(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Zr;return U.forEach(n.mutations,s=>{const i=new Nt(s.key,n.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.Zr=r})}ir(e){}containsKey(e,n){const r=new Nt(n,0),s=this.Zr.firstAfterOrEqual(r);return U.resolve(n.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,U.resolve()}ni(e,n){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const n=this.ei(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $2{constructor(e){this.ri=e,this.docs=function(){return new st(te.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,s=this.docs.get(r),i=s?s.size:0,o=this.ri(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return U.resolve(r?r.document.mutableCopy():Ht.newInvalidDocument(n))}getEntries(e,n){let r=Hr();return n.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():Ht.newInvalidDocument(s))}),U.resolve(r)}getDocumentsMatchingQuery(e,n,r,s){let i=Hr();const o=n.path,l=new te(o.child("__id-9223372036854775808__")),u=this.docs.getIteratorFrom(l);for(;u.hasNext();){const{key:d,value:{document:f}}=u.getNext();if(!o.isPrefixOf(d.path))break;d.path.length>o.length+1||fP(hP(f),r)<=0||(s.has(f.key)||gd(n,f))&&(i=i.insert(f.key,f.mutableCopy()))}return U.resolve(i)}getAllFromCollectionGroup(e,n,r,s){ae(9500)}ii(e,n){return U.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new B2(this)}getSize(e){return U.resolve(this.size)}}class B2 extends D2{constructor(e){super(),this.Nr=e}applyChanges(e){const n=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?n.push(this.Nr.addEntry(e,s)):this.Nr.removeEntry(r)}),U.waitFor(n)}getFromCache(e,n){return this.Nr.getEntry(e,n)}getAllFromCache(e,n){return this.Nr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z2{constructor(e){this.persistence=e,this.si=new Ai(n=>Lm(n),Vm),this.lastRemoteSnapshotVersion=me.min(),this.highestTargetId=0,this.oi=0,this._i=new Bm,this.targetCount=0,this.ai=bo.ur()}forEachTarget(e,n){return this.si.forEach((r,s)=>n(s)),U.resolve()}getLastRemoteSnapshotVersion(e){return U.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return U.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),U.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.oi&&(this.oi=n),U.resolve()}Pr(e){this.si.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.ai=new bo(n),this.highestTargetId=n),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,n){return this.Pr(n),this.targetCount+=1,U.resolve()}updateTargetData(e,n){return this.Pr(n),U.resolve()}removeTargetData(e,n){return this.si.delete(n.target),this._i.jr(n.targetId),this.targetCount-=1,U.resolve()}removeTargets(e,n,r){let s=0;const i=[];return this.si.forEach((o,l)=>{l.sequenceNumber<=n&&r.get(l.targetId)===null&&(this.si.delete(o),i.push(this.removeMatchingKeysForTargetId(e,l.targetId)),s++)}),U.waitFor(i).next(()=>s)}getTargetCount(e){return U.resolve(this.targetCount)}getTargetData(e,n){const r=this.si.get(n)||null;return U.resolve(r)}addMatchingKeys(e,n,r){return this._i.Wr(n,r),U.resolve()}removeMatchingKeys(e,n,r){this._i.zr(n,r);const s=this.persistence.referenceDelegate,i=[];return s&&n.forEach(o=>{i.push(s.markPotentiallyOrphaned(e,o))}),U.waitFor(i)}removeMatchingKeysForTargetId(e,n){return this._i.jr(n),U.resolve()}getMatchingKeysForTargetId(e,n){const r=this._i.Hr(n);return U.resolve(r)}containsKey(e,n){return U.resolve(this._i.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $T{constructor(e,n){this.ui={},this.overlays={},this.ci=new dd(0),this.li=!1,this.li=!0,this.hi=new U2,this.referenceDelegate=e(this),this.Pi=new z2(this),this.indexManager=new b2,this.remoteDocumentCache=function(s){return new $2(s)}(r=>this.referenceDelegate.Ti(r)),this.serializer=new S2(n),this.Ii=new V2(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new M2,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.ui[e.toKey()];return r||(r=new F2(n,this.referenceDelegate),this.ui[e.toKey()]=r),r}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,n,r){Y("MemoryPersistence","Starting transaction:",e);const s=new q2(this.ci.next());return this.referenceDelegate.Ei(),r(s).next(i=>this.referenceDelegate.di(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Ai(e,n){return U.or(Object.values(this.ui).map(r=>()=>r.containsKey(e,n)))}}class q2 extends mP{constructor(e){super(),this.currentSequenceNumber=e}}class zm{constructor(e){this.persistence=e,this.Ri=new Bm,this.Vi=null}static mi(e){return new zm(e)}get fi(){if(this.Vi)return this.Vi;throw ae(60996)}addReference(e,n,r){return this.Ri.addReference(r,n),this.fi.delete(r.toString()),U.resolve()}removeReference(e,n,r){return this.Ri.removeReference(r,n),this.fi.add(r.toString()),U.resolve()}markPotentiallyOrphaned(e,n){return this.fi.add(n.toString()),U.resolve()}removeTarget(e,n){this.Ri.jr(n.targetId).forEach(s=>this.fi.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(s=>{s.forEach(i=>this.fi.add(i.toString()))}).next(()=>r.removeTargetData(e,n))}Ei(){this.Vi=new Set}di(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return U.forEach(this.fi,r=>{const s=te.fromPath(r);return this.gi(e,s).next(i=>{i||n.removeEntry(s,me.min())})}).next(()=>(this.Vi=null,n.apply(e)))}updateLimboDocument(e,n){return this.gi(e,n).next(r=>{r?this.fi.delete(n.toString()):this.fi.add(n.toString())})}Ti(e){return 0}gi(e,n){return U.or([()=>U.resolve(this.Ri.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ai(e,n)])}}class kc{constructor(e,n){this.persistence=e,this.pi=new Ai(r=>vP(r.path),(r,s)=>r.isEqual(s)),this.garbageCollector=j2(this,n)}static mi(e,n){return new kc(e,n)}Ei(){}di(e){return U.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}gr(e){const n=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>n.next(s=>r+s))}wr(e){let n=0;return this.pr(e,r=>{n++}).next(()=>n)}pr(e,n){return U.forEach(this.pi,(r,s)=>this.br(e,r,s).next(i=>i?U.resolve():n(s)))}removeTargets(e,n,r){return this.persistence.getTargetCache().removeTargets(e,n,r)}removeOrphanedDocuments(e,n){let r=0;const s=this.persistence.getRemoteDocumentCache(),i=s.newChangeBuffer();return s.ii(e,o=>this.br(e,o,n).next(l=>{l||(r++,i.removeEntry(o,me.min()))})).next(()=>i.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,n){return this.pi.set(n,e.currentSequenceNumber),U.resolve()}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,n,r){return this.pi.set(r,e.currentSequenceNumber),U.resolve()}removeReference(e,n,r){return this.pi.set(r,e.currentSequenceNumber),U.resolve()}updateLimboDocument(e,n){return this.pi.set(n,e.currentSequenceNumber),U.resolve()}Ti(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=Fu(e.data.value)),n}br(e,n,r){return U.or([()=>this.persistence.Ai(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const s=this.pi.get(n);return U.resolve(s!==void 0&&s>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qm{constructor(e,n,r,s){this.targetId=e,this.fromCache=n,this.Es=r,this.ds=s}static As(e,n){let r=Ie(),s=Ie();for(const i of n.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new qm(e,n.fromCache,r,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W2{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H2{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=function(){return x1()?8:gP(Qt())>0?6:4}()}initialize(e,n){this.ps=e,this.indexManager=n,this.Rs=!0}getDocumentsMatchingQuery(e,n,r,s){const i={result:null};return this.ys(e,n).next(o=>{i.result=o}).next(()=>{if(!i.result)return this.ws(e,n,s,r).next(o=>{i.result=o})}).next(()=>{if(i.result)return;const o=new W2;return this.Ss(e,n,o).next(l=>{if(i.result=l,this.Vs)return this.bs(e,n,o,l.size)})}).next(()=>i.result)}bs(e,n,r,s){return r.documentReadCount<this.fs?(Fi()<=Ee.DEBUG&&Y("QueryEngine","SDK will not create cache indexes for query:",$i(n),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),U.resolve()):(Fi()<=Ee.DEBUG&&Y("QueryEngine","Query:",$i(n),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.gs*s?(Fi()<=Ee.DEBUG&&Y("QueryEngine","The SDK decides to create cache indexes for query:",$i(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,gr(n))):U.resolve())}ys(e,n){if(T_(n))return U.resolve(null);let r=gr(n);return this.indexManager.getIndexType(e,r).next(s=>s===0?null:(n.limit!==null&&s===1&&(n=np(n,null,"F"),r=gr(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(i=>{const o=Ie(...i);return this.ps.getDocuments(e,o).next(l=>this.indexManager.getMinOffset(e,r).next(u=>{const d=this.Ds(n,l);return this.Cs(n,d,o,u.readTime)?this.ys(e,np(n,null,"F")):this.vs(e,d,n,u)}))})))}ws(e,n,r,s){return T_(n)||s.isEqual(me.min())?U.resolve(null):this.ps.getDocuments(e,r).next(i=>{const o=this.Ds(n,i);return this.Cs(n,o,r,s)?U.resolve(null):(Fi()<=Ee.DEBUG&&Y("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),$i(n)),this.vs(e,o,n,dP(s,el)).next(l=>l))})}Ds(e,n){let r=new xt(vT(e));return n.forEach((s,i)=>{gd(e,i)&&(r=r.add(i))}),r}Cs(e,n,r,s){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const i=e.limitType==="F"?n.last():n.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Ss(e,n,r){return Fi()<=Ee.DEBUG&&Y("QueryEngine","Using full collection scan to execute query:",$i(n)),this.ps.getDocumentsMatchingQuery(e,n,js.min(),r)}vs(e,n,r,s){return this.ps.getDocumentsMatchingQuery(e,r,s).next(i=>(n.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wm="LocalStore",G2=3e8;class K2{constructor(e,n,r,s){this.persistence=e,this.Fs=n,this.serializer=s,this.Ms=new st(Te),this.xs=new Ai(i=>Lm(i),Vm),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(r)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new L2(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.Ms))}}function Q2(t,e,n,r){return new K2(t,e,n,r)}async function BT(t,e){const n=pe(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let s;return n.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,n.Bs(e),n.mutationQueue.getAllMutationBatches(r))).next(i=>{const o=[],l=[];let u=Ie();for(const d of s){o.push(d.batchId);for(const f of d.mutations)u=u.add(f.key)}for(const d of i){l.push(d.batchId);for(const f of d.mutations)u=u.add(f.key)}return n.localDocuments.getDocuments(r,u).next(d=>({Ls:d,removedBatchIds:o,addedBatchIds:l}))})})}function Y2(t,e){const n=pe(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),i=n.Ns.newChangeBuffer({trackRemovals:!0});return function(l,u,d,f){const p=d.batch,m=p.keys();let y=U.resolve();return m.forEach(x=>{y=y.next(()=>f.getEntry(u,x)).next(A=>{const b=d.docVersions.get(x);je(b!==null,48541),A.version.compareTo(b)<0&&(p.applyToRemoteDocument(A,d),A.isValidDocument()&&(A.setReadTime(d.commitVersion),f.addEntry(A)))})}),y.next(()=>l.mutationQueue.removeMutationBatch(u,p))}(n,r,e,i).next(()=>i.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(l){let u=Ie();for(let d=0;d<l.mutationResults.length;++d)l.mutationResults[d].transformResults.length>0&&(u=u.add(l.batch.mutations[d].key));return u}(e))).next(()=>n.localDocuments.getDocuments(r,s))})}function zT(t){const e=pe(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Pi.getLastRemoteSnapshotVersion(n))}function J2(t,e){const n=pe(t),r=e.snapshotVersion;let s=n.Ms;return n.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=n.Ns.newChangeBuffer({trackRemovals:!0});s=n.Ms;const l=[];e.targetChanges.forEach((f,p)=>{const m=s.get(p);if(!m)return;l.push(n.Pi.removeMatchingKeys(i,f.removedDocuments,p).next(()=>n.Pi.addMatchingKeys(i,f.addedDocuments,p)));let y=m.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(p)!==null?y=y.withResumeToken(Rt.EMPTY_BYTE_STRING,me.min()).withLastLimboFreeSnapshotVersion(me.min()):f.resumeToken.approximateByteSize()>0&&(y=y.withResumeToken(f.resumeToken,r)),s=s.insert(p,y),function(A,b,E){return A.resumeToken.approximateByteSize()===0||b.snapshotVersion.toMicroseconds()-A.snapshotVersion.toMicroseconds()>=G2?!0:E.addedDocuments.size+E.modifiedDocuments.size+E.removedDocuments.size>0}(m,y,f)&&l.push(n.Pi.updateTargetData(i,y))});let u=Hr(),d=Ie();if(e.documentUpdates.forEach(f=>{e.resolvedLimboDocuments.has(f)&&l.push(n.persistence.referenceDelegate.updateLimboDocument(i,f))}),l.push(X2(i,o,e.documentUpdates).next(f=>{u=f.ks,d=f.qs})),!r.isEqual(me.min())){const f=n.Pi.getLastRemoteSnapshotVersion(i).next(p=>n.Pi.setTargetsMetadata(i,i.currentSequenceNumber,r));l.push(f)}return U.waitFor(l).next(()=>o.apply(i)).next(()=>n.localDocuments.getLocalViewOfDocuments(i,u,d)).next(()=>u)}).then(i=>(n.Ms=s,i))}function X2(t,e,n){let r=Ie(),s=Ie();return n.forEach(i=>r=r.add(i)),e.getEntries(t,r).next(i=>{let o=Hr();return n.forEach((l,u)=>{const d=i.get(l);u.isFoundDocument()!==d.isFoundDocument()&&(s=s.add(l)),u.isNoDocument()&&u.version.isEqual(me.min())?(e.removeEntry(l,u.readTime),o=o.insert(l,u)):!d.isValidDocument()||u.version.compareTo(d.version)>0||u.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(u),o=o.insert(l,u)):Y(Wm,"Ignoring outdated watch update for ",l,". Current version:",d.version," Watch version:",u.version)}),{ks:o,qs:s}})}function Z2(t,e){const n=pe(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=jm),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function ej(t,e){const n=pe(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return n.Pi.getTargetData(r,e).next(i=>i?(s=i,U.resolve(s)):n.Pi.allocateTargetId(r).next(o=>(s=new ys(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.Pi.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=n.Ms.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(n.Ms=n.Ms.insert(r.targetId,r),n.xs.set(e,r.targetId)),r})}async function ap(t,e,n){const r=pe(t),s=r.Ms.get(e),i=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",i,o=>r.persistence.referenceDelegate.removeTarget(o,s))}catch(o){if(!Uo(o))throw o;Y(Wm,`Failed to update sequence numbers for target ${e}: ${o}`)}r.Ms=r.Ms.remove(e),r.xs.delete(s.target)}function L_(t,e,n){const r=pe(t);let s=me.min(),i=Ie();return r.persistence.runTransaction("Execute query","readwrite",o=>function(u,d,f){const p=pe(u),m=p.xs.get(f);return m!==void 0?U.resolve(p.Ms.get(m)):p.Pi.getTargetData(d,f)}(r,o,gr(e)).next(l=>{if(l)return s=l.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(o,l.targetId).next(u=>{i=u})}).next(()=>r.Fs.getDocumentsMatchingQuery(o,e,n?s:me.min(),n?i:Ie())).next(l=>(tj(r,MP(e),l),{documents:l,Qs:i})))}function tj(t,e,n){let r=t.Os.get(e)||me.min();n.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),t.Os.set(e,r)}class V_{constructor(){this.activeTargetIds=qP()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class nj{constructor(){this.Mo=new V_,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,n,r){this.xo[e]=n}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new V_,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rj{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const M_="ConnectivityMonitor";class U_{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){Y(M_,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){Y(M_,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let xu=null;function lp(){return xu===null?xu=function(){return 268435456+Math.round(2147483648*Math.random())}():xu++,"0x"+xu.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kh="RestConnection",sj={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class ij{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Uo=n+"://"+e.host,this.Ko=`projects/${r}/databases/${s}`,this.Wo=this.databaseId.database===Sc?`project_id=${r}`:`project_id=${r}&database_id=${s}`}Go(e,n,r,s,i){const o=lp(),l=this.zo(e,n.toUriEncodedString());Y(kh,`Sending RPC '${e}' ${o}:`,l,r);const u={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(u,s,i);const{host:d}=new URL(l),f=Ii(d);return this.Jo(e,l,u,r,f).then(p=>(Y(kh,`Received RPC '${e}' ${o}: `,p),p),p=>{throw yi(kh,`RPC '${e}' ${o} failed with error: `,p,"url: ",l,"request:",r),p})}Ho(e,n,r,s,i,o){return this.Go(e,n,r,s,i)}jo(e,n,r){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Vo}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((s,i)=>e[i]=s),r&&r.headers.forEach((s,i)=>e[i]=s)}zo(e,n){const r=sj[e];return`${this.Uo}/v1/${n}:${r}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oj{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zt="WebChannelConnection";class aj extends ij{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,n,r,s,i){const o=lp();return new Promise((l,u)=>{const d=new zE;d.setWithCredentials(!0),d.listenOnce(qE.COMPLETE,()=>{try{switch(d.getLastErrorCode()){case Uu.NO_ERROR:const p=d.getResponseJson();Y(zt,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(p)),l(p);break;case Uu.TIMEOUT:Y(zt,`RPC '${e}' ${o} timed out`),u(new H(M.DEADLINE_EXCEEDED,"Request time out"));break;case Uu.HTTP_ERROR:const m=d.getStatus();if(Y(zt,`RPC '${e}' ${o} failed with status:`,m,"response text:",d.getResponseText()),m>0){let y=d.getResponseJson();Array.isArray(y)&&(y=y[0]);const x=y==null?void 0:y.error;if(x&&x.status&&x.message){const A=function(E){const v=E.toLowerCase().replace(/_/g,"-");return Object.values(M).indexOf(v)>=0?v:M.UNKNOWN}(x.status);u(new H(A,x.message))}else u(new H(M.UNKNOWN,"Server responded with status "+d.getStatus()))}else u(new H(M.UNAVAILABLE,"Connection failed."));break;default:ae(9055,{l_:e,streamId:o,h_:d.getLastErrorCode(),P_:d.getLastError()})}}finally{Y(zt,`RPC '${e}' ${o} completed.`)}});const f=JSON.stringify(s);Y(zt,`RPC '${e}' ${o} sending request:`,s),d.send(n,"POST",f,r,15)})}T_(e,n,r){const s=lp(),i=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=GE(),l=HE(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(u.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(u.useFetchStreams=!0),this.jo(u.initMessageHeaders,n,r),u.encodeInitMessageHeaders=!0;const f=i.join("");Y(zt,`Creating RPC '${e}' stream ${s}: ${f}`,u);const p=o.createWebChannel(f,u);this.I_(p);let m=!1,y=!1;const x=new oj({Yo:b=>{y?Y(zt,`Not sending because RPC '${e}' stream ${s} is closed:`,b):(m||(Y(zt,`Opening RPC '${e}' stream ${s} transport.`),p.open(),m=!0),Y(zt,`RPC '${e}' stream ${s} sending:`,b),p.send(b))},Zo:()=>p.close()}),A=(b,E,v)=>{b.listen(E,w=>{try{v(w)}catch(R){setTimeout(()=>{throw R},0)}})};return A(p,fa.EventType.OPEN,()=>{y||(Y(zt,`RPC '${e}' stream ${s} transport opened.`),x.o_())}),A(p,fa.EventType.CLOSE,()=>{y||(y=!0,Y(zt,`RPC '${e}' stream ${s} transport closed`),x.a_(),this.E_(p))}),A(p,fa.EventType.ERROR,b=>{y||(y=!0,yi(zt,`RPC '${e}' stream ${s} transport errored. Name:`,b.name,"Message:",b.message),x.a_(new H(M.UNAVAILABLE,"The operation could not be completed")))}),A(p,fa.EventType.MESSAGE,b=>{var E;if(!y){const v=b.data[0];je(!!v,16349);const w=v,R=(w==null?void 0:w.error)||((E=w[0])==null?void 0:E.error);if(R){Y(zt,`RPC '${e}' stream ${s} received error:`,R);const D=R.status;let L=function(I){const N=ft[I];if(N!==void 0)return CT(N)}(D),S=R.message;L===void 0&&(L=M.INTERNAL,S="Unknown error status: "+D+" with message "+R.message),y=!0,x.a_(new H(L,S)),p.close()}else Y(zt,`RPC '${e}' stream ${s} received:`,v),x.u_(v)}}),A(l,WE.STAT_EVENT,b=>{b.stat===Kf.PROXY?Y(zt,`RPC '${e}' stream ${s} detected buffering proxy`):b.stat===Kf.NOPROXY&&Y(zt,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{x.__()},0),x}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(n=>n===e)}}function Rh(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xd(t){return new d2(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qT{constructor(e,n,r=1e3,s=1.5,i=6e4){this.Mi=e,this.timerId=n,this.d_=r,this.A_=s,this.R_=i,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const n=Math.floor(this.V_+this.y_()),r=Math.max(0,Date.now()-this.f_),s=Math.max(0,n-r);s>0&&Y("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.V_} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,s,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F_="PersistentStream";class WT{constructor(e,n,r,s,i,o,l,u){this.Mi=e,this.S_=r,this.b_=s,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=l,this.listener=u,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new qT(e,n)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,n){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():n&&n.code===M.RESOURCE_EXHAUSTED?(Wr(n.toString()),Wr("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):n&&n.code===M.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(n)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),n=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.D_===n&&this.G_(r,s)},r=>{e(()=>{const s=new H(M.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(s)})})}G_(e,n){const r=this.W_(this.D_);this.stream=this.j_(e,n),this.stream.Xo(()=>{r(()=>this.listener.Xo())}),this.stream.t_(()=>{r(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(s=>{r(()=>this.z_(s))}),this.stream.onMessage(s=>{r(()=>++this.F_==1?this.J_(s):this.onNext(s))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return Y(F_,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return n=>{this.Mi.enqueueAndForget(()=>this.D_===e?n():(Y(F_,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class lj extends WT{constructor(e,n,r,s,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}j_(e,n){return this.connection.T_("Listen",e,n)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const n=p2(this.serializer,e),r=function(i){if(!("targetChange"in i))return me.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?me.min():o.readTime?yr(o.readTime):me.min()}(e);return this.listener.H_(n,r)}Y_(e){const n={};n.database=op(this.serializer),n.addTarget=function(i,o){let l;const u=o.target;if(l=ep(u)?{documents:y2(i,u)}:{query:LT(i,u).ft},l.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){l.resumeToken=PT(i,o.resumeToken);const d=rp(i,o.expectedCount);d!==null&&(l.expectedCount=d)}else if(o.snapshotVersion.compareTo(me.min())>0){l.readTime=Cc(i,o.snapshotVersion.toTimestamp());const d=rp(i,o.expectedCount);d!==null&&(l.expectedCount=d)}return l}(this.serializer,e);const r=w2(this.serializer,e);r&&(n.labels=r),this.q_(n)}Z_(e){const n={};n.database=op(this.serializer),n.removeTarget=e,this.q_(n)}}class uj extends WT{constructor(e,n,r,s,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,n){return this.connection.T_("Write",e,n)}J_(e){return je(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,je(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){je(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const n=g2(e.writeResults,e.commitTime),r=yr(e.commitTime);return this.listener.na(r,n)}ra(){const e={};e.database=op(this.serializer),this.q_(e)}ea(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>m2(this.serializer,r))};this.q_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cj{}class dj extends cj{constructor(e,n,r,s){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=s,this.ia=!1}sa(){if(this.ia)throw new H(M.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,n,r,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.Go(e,sp(n,r),s,i,o)).catch(i=>{throw i.name==="FirebaseError"?(i.code===M.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new H(M.UNKNOWN,i.toString())})}Ho(e,n,r,s,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,l])=>this.connection.Ho(e,sp(n,r),s,o,l,i)).catch(o=>{throw o.name==="FirebaseError"?(o.code===M.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new H(M.UNKNOWN,o.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class hj{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Wr(n),this.aa=!1):Y("OnlineStateTracker",n)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vi="RemoteStore";class fj{constructor(e,n,r,s,i){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=i,this.Aa.Oo(o=>{r.enqueueAndForget(async()=>{Ci(this)&&(Y(vi,"Restarting streams for network reachability change."),await async function(u){const d=pe(u);d.Ea.add(4),await Il(d),d.Ra.set("Unknown"),d.Ea.delete(4),await Ed(d)}(this))})}),this.Ra=new hj(r,s)}}async function Ed(t){if(Ci(t))for(const e of t.da)await e(!0)}async function Il(t){for(const e of t.da)await e(!1)}function HT(t,e){const n=pe(t);n.Ia.has(e.targetId)||(n.Ia.set(e.targetId,e),Qm(n)?Km(n):Fo(n).O_()&&Gm(n,e))}function Hm(t,e){const n=pe(t),r=Fo(n);n.Ia.delete(e),r.O_()&&GT(n,e),n.Ia.size===0&&(r.O_()?r.L_():Ci(n)&&n.Ra.set("Unknown"))}function Gm(t,e){if(t.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(me.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}Fo(t).Y_(e)}function GT(t,e){t.Va.Ue(e),Fo(t).Z_(e)}function Km(t){t.Va=new a2({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),Fo(t).start(),t.Ra.ua()}function Qm(t){return Ci(t)&&!Fo(t).x_()&&t.Ia.size>0}function Ci(t){return pe(t).Ea.size===0}function KT(t){t.Va=void 0}async function pj(t){t.Ra.set("Online")}async function mj(t){t.Ia.forEach((e,n)=>{Gm(t,e)})}async function gj(t,e){KT(t),Qm(t)?(t.Ra.ha(e),Km(t)):t.Ra.set("Unknown")}async function yj(t,e,n){if(t.Ra.set("Online"),e instanceof RT&&e.state===2&&e.cause)try{await async function(s,i){const o=i.cause;for(const l of i.targetIds)s.Ia.has(l)&&(await s.remoteSyncer.rejectListen(l,o),s.Ia.delete(l),s.Va.removeTarget(l))}(t,e)}catch(r){Y(vi,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Rc(t,r)}else if(e instanceof zu?t.Va.Ze(e):e instanceof kT?t.Va.st(e):t.Va.tt(e),!n.isEqual(me.min()))try{const r=await zT(t.localStore);n.compareTo(r)>=0&&await function(i,o){const l=i.Va.Tt(o);return l.targetChanges.forEach((u,d)=>{if(u.resumeToken.approximateByteSize()>0){const f=i.Ia.get(d);f&&i.Ia.set(d,f.withResumeToken(u.resumeToken,o))}}),l.targetMismatches.forEach((u,d)=>{const f=i.Ia.get(u);if(!f)return;i.Ia.set(u,f.withResumeToken(Rt.EMPTY_BYTE_STRING,f.snapshotVersion)),GT(i,u);const p=new ys(f.target,u,d,f.sequenceNumber);Gm(i,p)}),i.remoteSyncer.applyRemoteEvent(l)}(t,n)}catch(r){Y(vi,"Failed to raise snapshot:",r),await Rc(t,r)}}async function Rc(t,e,n){if(!Uo(e))throw e;t.Ea.add(1),await Il(t),t.Ra.set("Offline"),n||(n=()=>zT(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{Y(vi,"Retrying IndexedDB access"),await n(),t.Ea.delete(1),await Ed(t)})}function QT(t,e){return e().catch(n=>Rc(t,n,e))}async function Td(t){const e=pe(t),n=Vs(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:jm;for(;vj(e);)try{const s=await Z2(e.localStore,r);if(s===null){e.Ta.length===0&&n.L_();break}r=s.batchId,_j(e,s)}catch(s){await Rc(e,s)}YT(e)&&JT(e)}function vj(t){return Ci(t)&&t.Ta.length<10}function _j(t,e){t.Ta.push(e);const n=Vs(t);n.O_()&&n.X_&&n.ea(e.mutations)}function YT(t){return Ci(t)&&!Vs(t).x_()&&t.Ta.length>0}function JT(t){Vs(t).start()}async function wj(t){Vs(t).ra()}async function xj(t){const e=Vs(t);for(const n of t.Ta)e.ea(n.mutations)}async function Ej(t,e,n){const r=t.Ta.shift(),s=Um.from(r,e,n);await QT(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await Td(t)}async function Tj(t,e){e&&Vs(t).X_&&await async function(r,s){if(function(o){return s2(o)&&o!==M.ABORTED}(s.code)){const i=r.Ta.shift();Vs(r).B_(),await QT(r,()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s)),await Td(r)}}(t,e),YT(t)&&JT(t)}async function $_(t,e){const n=pe(t);n.asyncQueue.verifyOperationInProgress(),Y(vi,"RemoteStore received new credentials");const r=Ci(n);n.Ea.add(3),await Il(n),r&&n.Ra.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.Ea.delete(3),await Ed(n)}async function Ij(t,e){const n=pe(t);e?(n.Ea.delete(2),await Ed(n)):e||(n.Ea.add(2),await Il(n),n.Ra.set("Unknown"))}function Fo(t){return t.ma||(t.ma=function(n,r,s){const i=pe(n);return i.sa(),new lj(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Xo:pj.bind(null,t),t_:mj.bind(null,t),r_:gj.bind(null,t),H_:yj.bind(null,t)}),t.da.push(async e=>{e?(t.ma.B_(),Qm(t)?Km(t):t.Ra.set("Unknown")):(await t.ma.stop(),KT(t))})),t.ma}function Vs(t){return t.fa||(t.fa=function(n,r,s){const i=pe(n);return i.sa(),new uj(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Xo:()=>Promise.resolve(),t_:wj.bind(null,t),r_:Tj.bind(null,t),ta:xj.bind(null,t),na:Ej.bind(null,t)}),t.da.push(async e=>{e?(t.fa.B_(),await Td(t)):(await t.fa.stop(),t.Ta.length>0&&(Y(vi,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))})),t.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ym{constructor(e,n,r,s,i){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new mr,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,s,i){const o=Date.now()+r,l=new Ym(e,n,o,s,i);return l.start(r),l}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new H(M.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Jm(t,e){if(Wr("AsyncQueue",`${e}: ${t}`),Uo(t))return new H(M.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fo{static emptySet(e){return new fo(e.comparator)}constructor(e){this.comparator=e?(n,r)=>e(n,r)||te.comparator(n.key,r.key):(n,r)=>te.comparator(n.key,r.key),this.keyedMap=pa(),this.sortedSet=new st(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof fo)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new fo;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B_{constructor(){this.ga=new st(te.comparator)}track(e){const n=e.doc.key,r=this.ga.get(n);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(n,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(n):e.type===1&&r.type===2?this.ga=this.ga.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):ae(63341,{Rt:e,pa:r}):this.ga=this.ga.insert(n,e)}ya(){const e=[];return this.ga.inorderTraversal((n,r)=>{e.push(r)}),e}}class Ao{constructor(e,n,r,s,i,o,l,u,d){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=l,this.excludesMetadataChanges=u,this.hasCachedResults=d}static fromInitialDocuments(e,n,r,s,i){const o=[];return n.forEach(l=>{o.push({type:0,doc:l})}),new Ao(e,n,fo.emptySet(n),o,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&md(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let s=0;s<n.length;s++)if(n[s].type!==r[s].type||!n[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sj{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class Nj{constructor(){this.queries=z_(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(n,r){const s=pe(n),i=s.queries;s.queries=z_(),i.forEach((o,l)=>{for(const u of l.Sa)u.onError(r)})})(this,new H(M.ABORTED,"Firestore shutting down"))}}function z_(){return new Ai(t=>yT(t),md)}async function Xm(t,e){const n=pe(t);let r=3;const s=e.query;let i=n.queries.get(s);i?!i.ba()&&e.Da()&&(r=2):(i=new Sj,r=e.Da()?0:1);try{switch(r){case 0:i.wa=await n.onListen(s,!0);break;case 1:i.wa=await n.onListen(s,!1);break;case 2:await n.onFirstRemoteStoreListen(s)}}catch(o){const l=Jm(o,`Initialization of query '${$i(e.query)}' failed`);return void e.onError(l)}n.queries.set(s,i),i.Sa.push(e),e.va(n.onlineState),i.wa&&e.Fa(i.wa)&&eg(n)}async function Zm(t,e){const n=pe(t),r=e.query;let s=3;const i=n.queries.get(r);if(i){const o=i.Sa.indexOf(e);o>=0&&(i.Sa.splice(o,1),i.Sa.length===0?s=e.Da()?0:1:!i.ba()&&e.Da()&&(s=2))}switch(s){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function bj(t,e){const n=pe(t);let r=!1;for(const s of e){const i=s.query,o=n.queries.get(i);if(o){for(const l of o.Sa)l.Fa(s)&&(r=!0);o.wa=s}}r&&eg(n)}function Aj(t,e,n){const r=pe(t),s=r.queries.get(e);if(s)for(const i of s.Sa)i.onError(n);r.queries.delete(e)}function eg(t){t.Ca.forEach(e=>{e.next()})}var up,q_;(q_=up||(up={})).Ma="default",q_.Cache="cache";class tg{constructor(e,n,r){this.query=e,this.xa=n,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new Ao(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),n=!0):this.La(e,this.onlineState)&&(this.ka(e),n=!0),this.Na=e,n}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let n=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),n=!0),n}La(e,n){if(!e.fromCache||!this.Da())return!0;const r=n!=="Offline";return(!this.options.qa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const n=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}ka(e){e=Ao.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==up.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XT{constructor(e){this.key=e}}class ZT{constructor(e){this.key=e}}class Cj{constructor(e,n){this.query=e,this.Ya=n,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=Ie(),this.mutatedKeys=Ie(),this.eu=vT(e),this.tu=new fo(this.eu)}get nu(){return this.Ya}ru(e,n){const r=n?n.iu:new B_,s=n?n.tu:this.tu;let i=n?n.mutatedKeys:this.mutatedKeys,o=s,l=!1;const u=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,d=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((f,p)=>{const m=s.get(f),y=gd(this.query,p)?p:null,x=!!m&&this.mutatedKeys.has(m.key),A=!!y&&(y.hasLocalMutations||this.mutatedKeys.has(y.key)&&y.hasCommittedMutations);let b=!1;m&&y?m.data.isEqual(y.data)?x!==A&&(r.track({type:3,doc:y}),b=!0):this.su(m,y)||(r.track({type:2,doc:y}),b=!0,(u&&this.eu(y,u)>0||d&&this.eu(y,d)<0)&&(l=!0)):!m&&y?(r.track({type:0,doc:y}),b=!0):m&&!y&&(r.track({type:1,doc:m}),b=!0,(u||d)&&(l=!0)),b&&(y?(o=o.add(y),i=A?i.add(f):i.delete(f)):(o=o.delete(f),i=i.delete(f)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const f=this.query.limitType==="F"?o.last():o.first();o=o.delete(f.key),i=i.delete(f.key),r.track({type:1,doc:f})}return{tu:o,iu:r,Cs:l,mutatedKeys:i}}su(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,s){const i=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const o=e.iu.ya();o.sort((f,p)=>function(y,x){const A=b=>{switch(b){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ae(20277,{Rt:b})}};return A(y)-A(x)}(f.type,p.type)||this.eu(f.doc,p.doc)),this.ou(r),s=s??!1;const l=n&&!s?this._u():[],u=this.Xa.size===0&&this.current&&!s?1:0,d=u!==this.Za;return this.Za=u,o.length!==0||d?{snapshot:new Ao(this.query,e.tu,i,o,e.mutatedKeys,u===0,d,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:l}:{au:l}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new B_,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(n=>this.Ya=this.Ya.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ya=this.Ya.delete(n)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=Ie(),this.tu.forEach(r=>{this.uu(r.key)&&(this.Xa=this.Xa.add(r.key))});const n=[];return e.forEach(r=>{this.Xa.has(r)||n.push(new ZT(r))}),this.Xa.forEach(r=>{e.has(r)||n.push(new XT(r))}),n}cu(e){this.Ya=e.Qs,this.Xa=Ie();const n=this.ru(e.documents);return this.applyChanges(n,!0)}lu(){return Ao.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const ng="SyncEngine";class kj{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class Rj{constructor(e){this.key=e,this.hu=!1}}class Pj{constructor(e,n,r,s,i,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new Ai(l=>yT(l),md),this.Iu=new Map,this.Eu=new Set,this.du=new st(te.comparator),this.Au=new Map,this.Ru=new Bm,this.Vu={},this.mu=new Map,this.fu=bo.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function jj(t,e,n=!0){const r=iI(t);let s;const i=r.Tu.get(e);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.lu()):s=await eI(r,e,n,!0),s}async function Dj(t,e){const n=iI(t);await eI(n,e,!0,!1)}async function eI(t,e,n,r){const s=await ej(t.localStore,gr(e)),i=s.targetId,o=t.sharedClientState.addLocalQueryTarget(i,n);let l;return r&&(l=await Oj(t,e,i,o==="current",s.resumeToken)),t.isPrimaryClient&&n&&HT(t.remoteStore,s),l}async function Oj(t,e,n,r,s){t.pu=(p,m,y)=>async function(A,b,E,v){let w=b.view.ru(E);w.Cs&&(w=await L_(A.localStore,b.query,!1).then(({documents:S})=>b.view.ru(S,w)));const R=v&&v.targetChanges.get(b.targetId),D=v&&v.targetMismatches.get(b.targetId)!=null,L=b.view.applyChanges(w,A.isPrimaryClient,R,D);return H_(A,b.targetId,L.au),L.snapshot}(t,p,m,y);const i=await L_(t.localStore,e,!0),o=new Cj(e,i.Qs),l=o.ru(i.documents),u=Tl.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",s),d=o.applyChanges(l,t.isPrimaryClient,u);H_(t,n,d.au);const f=new kj(e,n,o);return t.Tu.set(e,f),t.Iu.has(n)?t.Iu.get(n).push(e):t.Iu.set(n,[e]),d.snapshot}async function Lj(t,e,n){const r=pe(t),s=r.Tu.get(e),i=r.Iu.get(s.targetId);if(i.length>1)return r.Iu.set(s.targetId,i.filter(o=>!md(o,e))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await ap(r.localStore,s.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(s.targetId),n&&Hm(r.remoteStore,s.targetId),cp(r,s.targetId)}).catch(Mo)):(cp(r,s.targetId),await ap(r.localStore,s.targetId,!0))}async function Vj(t,e){const n=pe(t),r=n.Tu.get(e),s=n.Iu.get(r.targetId);n.isPrimaryClient&&s.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),Hm(n.remoteStore,r.targetId))}async function Mj(t,e,n){const r=Wj(t);try{const s=await function(o,l){const u=pe(o),d=$e.now(),f=l.reduce((y,x)=>y.add(x.key),Ie());let p,m;return u.persistence.runTransaction("Locally write mutations","readwrite",y=>{let x=Hr(),A=Ie();return u.Ns.getEntries(y,f).next(b=>{x=b,x.forEach((E,v)=>{v.isValidDocument()||(A=A.add(E))})}).next(()=>u.localDocuments.getOverlayedDocuments(y,x)).next(b=>{p=b;const E=[];for(const v of l){const w=XP(v,p.get(v.key).overlayedDocument);w!=null&&E.push(new zs(v.key,w,lT(w.value.mapValue),en.exists(!0)))}return u.mutationQueue.addMutationBatch(y,d,E,l)}).next(b=>{m=b;const E=b.applyToLocalDocumentSet(p,A);return u.documentOverlayCache.saveOverlays(y,b.batchId,E)})}).then(()=>({batchId:m.batchId,changes:wT(p)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(o,l,u){let d=o.Vu[o.currentUser.toKey()];d||(d=new st(Te)),d=d.insert(l,u),o.Vu[o.currentUser.toKey()]=d}(r,s.batchId,n),await Sl(r,s.changes),await Td(r.remoteStore)}catch(s){const i=Jm(s,"Failed to persist write");n.reject(i)}}async function tI(t,e){const n=pe(t);try{const r=await J2(n.localStore,e);e.targetChanges.forEach((s,i)=>{const o=n.Au.get(i);o&&(je(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1,22616),s.addedDocuments.size>0?o.hu=!0:s.modifiedDocuments.size>0?je(o.hu,14607):s.removedDocuments.size>0&&(je(o.hu,42227),o.hu=!1))}),await Sl(n,r,e)}catch(r){await Mo(r)}}function W_(t,e,n){const r=pe(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const s=[];r.Tu.forEach((i,o)=>{const l=o.view.va(e);l.snapshot&&s.push(l.snapshot)}),function(o,l){const u=pe(o);u.onlineState=l;let d=!1;u.queries.forEach((f,p)=>{for(const m of p.Sa)m.va(l)&&(d=!0)}),d&&eg(u)}(r.eventManager,e),s.length&&r.Pu.H_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function Uj(t,e,n){const r=pe(t);r.sharedClientState.updateQueryState(e,"rejected",n);const s=r.Au.get(e),i=s&&s.key;if(i){let o=new st(te.comparator);o=o.insert(i,Ht.newNoDocument(i,me.min()));const l=Ie().add(i),u=new wd(me.min(),new Map,new st(Te),o,l);await tI(r,u),r.du=r.du.remove(i),r.Au.delete(e),rg(r)}else await ap(r.localStore,e,!1).then(()=>cp(r,e,n)).catch(Mo)}async function Fj(t,e){const n=pe(t),r=e.batch.batchId;try{const s=await Y2(n.localStore,e);rI(n,r,null),nI(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await Sl(n,s)}catch(s){await Mo(s)}}async function $j(t,e,n){const r=pe(t);try{const s=await function(o,l){const u=pe(o);return u.persistence.runTransaction("Reject batch","readwrite-primary",d=>{let f;return u.mutationQueue.lookupMutationBatch(d,l).next(p=>(je(p!==null,37113),f=p.keys(),u.mutationQueue.removeMutationBatch(d,p))).next(()=>u.mutationQueue.performConsistencyCheck(d)).next(()=>u.documentOverlayCache.removeOverlaysForBatchId(d,f,l)).next(()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,f)).next(()=>u.localDocuments.getDocuments(d,f))})}(r.localStore,e);rI(r,e,n),nI(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await Sl(r,s)}catch(s){await Mo(s)}}function nI(t,e){(t.mu.get(e)||[]).forEach(n=>{n.resolve()}),t.mu.delete(e)}function rI(t,e,n){const r=pe(t);let s=r.Vu[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(n?i.reject(n):i.resolve(),s=s.remove(e)),r.Vu[r.currentUser.toKey()]=s}}function cp(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Iu.get(e))t.Tu.delete(r),n&&t.Pu.yu(r,n);t.Iu.delete(e),t.isPrimaryClient&&t.Ru.jr(e).forEach(r=>{t.Ru.containsKey(r)||sI(t,r)})}function sI(t,e){t.Eu.delete(e.path.canonicalString());const n=t.du.get(e);n!==null&&(Hm(t.remoteStore,n),t.du=t.du.remove(e),t.Au.delete(n),rg(t))}function H_(t,e,n){for(const r of n)r instanceof XT?(t.Ru.addReference(r.key,e),Bj(t,r)):r instanceof ZT?(Y(ng,"Document no longer in limbo: "+r.key),t.Ru.removeReference(r.key,e),t.Ru.containsKey(r.key)||sI(t,r.key)):ae(19791,{wu:r})}function Bj(t,e){const n=e.key,r=n.path.canonicalString();t.du.get(n)||t.Eu.has(r)||(Y(ng,"New document in limbo: "+n),t.Eu.add(r),rg(t))}function rg(t){for(;t.Eu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const n=new te(Ue.fromString(e)),r=t.fu.next();t.Au.set(r,new Rj(n)),t.du=t.du.insert(n,r),HT(t.remoteStore,new ys(gr(pd(n.path)),r,"TargetPurposeLimboResolution",dd.ce))}}async function Sl(t,e,n){const r=pe(t),s=[],i=[],o=[];r.Tu.isEmpty()||(r.Tu.forEach((l,u)=>{o.push(r.pu(u,e,n).then(d=>{var f;if((d||n)&&r.isPrimaryClient){const p=d?!d.fromCache:(f=n==null?void 0:n.targetChanges.get(u.targetId))==null?void 0:f.current;r.sharedClientState.updateQueryState(u.targetId,p?"current":"not-current")}if(d){s.push(d);const p=qm.As(u.targetId,d);i.push(p)}}))}),await Promise.all(o),r.Pu.H_(s),await async function(u,d){const f=pe(u);try{await f.persistence.runTransaction("notifyLocalViewChanges","readwrite",p=>U.forEach(d,m=>U.forEach(m.Es,y=>f.persistence.referenceDelegate.addReference(p,m.targetId,y)).next(()=>U.forEach(m.ds,y=>f.persistence.referenceDelegate.removeReference(p,m.targetId,y)))))}catch(p){if(!Uo(p))throw p;Y(Wm,"Failed to update sequence numbers: "+p)}for(const p of d){const m=p.targetId;if(!p.fromCache){const y=f.Ms.get(m),x=y.snapshotVersion,A=y.withLastLimboFreeSnapshotVersion(x);f.Ms=f.Ms.insert(m,A)}}}(r.localStore,i))}async function zj(t,e){const n=pe(t);if(!n.currentUser.isEqual(e)){Y(ng,"User change. New user:",e.toKey());const r=await BT(n.localStore,e);n.currentUser=e,function(i,o){i.mu.forEach(l=>{l.forEach(u=>{u.reject(new H(M.CANCELLED,o))})}),i.mu.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Sl(n,r.Ls)}}function qj(t,e){const n=pe(t),r=n.Au.get(e);if(r&&r.hu)return Ie().add(r.key);{let s=Ie();const i=n.Iu.get(e);if(!i)return s;for(const o of i){const l=n.Tu.get(o);s=s.unionWith(l.view.nu)}return s}}function iI(t){const e=pe(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=tI.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=qj.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=Uj.bind(null,e),e.Pu.H_=bj.bind(null,e.eventManager),e.Pu.yu=Aj.bind(null,e.eventManager),e}function Wj(t){const e=pe(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=Fj.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=$j.bind(null,e),e}class Pc{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=xd(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,n){return null}Mu(e,n){return null}vu(e){return Q2(this.persistence,new H2,e.initialUser,this.serializer)}Cu(e){return new $T(zm.mi,this.serializer)}Du(e){return new nj}async terminate(){var e,n;(e=this.gcScheduler)==null||e.stop(),(n=this.indexBackfillerScheduler)==null||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Pc.provider={build:()=>new Pc};class Hj extends Pc{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,n){je(this.persistence.referenceDelegate instanceof kc,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new R2(r,e.asyncQueue,n)}Cu(e){const n=this.cacheSizeBytes!==void 0?sn.withCacheSize(this.cacheSizeBytes):sn.DEFAULT;return new $T(r=>kc.mi(r,n),this.serializer)}}class dp{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>W_(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=zj.bind(null,this.syncEngine),await Ij(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new Nj}()}createDatastore(e){const n=xd(e.databaseInfo.databaseId),r=function(i){return new aj(i)}(e.databaseInfo);return function(i,o,l,u){return new dj(i,o,l,u)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,s,i,o,l){return new fj(r,s,i,o,l)}(this.localStore,this.datastore,e.asyncQueue,n=>W_(this.syncEngine,n,0),function(){return U_.v()?new U_:new rj}())}createSyncEngine(e,n){return function(s,i,o,l,u,d,f){const p=new Pj(s,i,o,l,u,d);return f&&(p.gu=!0),p}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(s){const i=pe(s);Y(vi,"RemoteStore shutting down."),i.Ea.add(5),await Il(i),i.Aa.shutdown(),i.Ra.set("Unknown")}(this.remoteStore),(e=this.datastore)==null||e.terminate(),(n=this.eventManager)==null||n.terminate()}}dp.provider={build:()=>new dp};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sg{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Wr("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ms="FirestoreClient";class Gj{constructor(e,n,r,s,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=s,this.user=qt.UNAUTHENTICATED,this.clientId=ud.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,async o=>{Y(Ms,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(Y(Ms,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new mr;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=Jm(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function Ph(t,e){t.asyncQueue.verifyOperationInProgress(),Y(Ms,"Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async s=>{r.isEqual(s)||(await BT(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function G_(t,e){t.asyncQueue.verifyOperationInProgress();const n=await Kj(t);Y(Ms,"Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>$_(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,s)=>$_(e.remoteStore,s)),t._onlineComponents=e}async function Kj(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){Y(Ms,"Using user provided OfflineComponentProvider");try{await Ph(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(s){return s.name==="FirebaseError"?s.code===M.FAILED_PRECONDITION||s.code===M.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(n))throw n;yi("Error using user provided cache. Falling back to memory cache: "+n),await Ph(t,new Pc)}}else Y(Ms,"Using default OfflineComponentProvider"),await Ph(t,new Hj(void 0));return t._offlineComponents}async function ig(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(Y(Ms,"Using user provided OnlineComponentProvider"),await G_(t,t._uninitializedComponentsProvider._online)):(Y(Ms,"Using default OnlineComponentProvider"),await G_(t,new dp))),t._onlineComponents}function Qj(t){return ig(t).then(e=>e.syncEngine)}function Yj(t){return ig(t).then(e=>e.datastore)}async function jc(t){const e=await ig(t),n=e.eventManager;return n.onListen=jj.bind(null,e.syncEngine),n.onUnlisten=Lj.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=Dj.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=Vj.bind(null,e.syncEngine),n}function Jj(t,e,n={}){const r=new mr;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,l,u,d){const f=new sg({next:m=>{f.Nu(),o.enqueueAndForget(()=>Zm(i,p));const y=m.docs.has(l);!y&&m.fromCache?d.reject(new H(M.UNAVAILABLE,"Failed to get document because the client is offline.")):y&&m.fromCache&&u&&u.source==="server"?d.reject(new H(M.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):d.resolve(m)},error:m=>d.reject(m)}),p=new tg(pd(l.path),f,{includeMetadataChanges:!0,qa:!0});return Xm(i,p)}(await jc(t),t.asyncQueue,e,n,r)),r.promise}function Xj(t,e,n={}){const r=new mr;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,l,u,d){const f=new sg({next:m=>{f.Nu(),o.enqueueAndForget(()=>Zm(i,p)),m.fromCache&&u.source==="server"?d.reject(new H(M.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):d.resolve(m)},error:m=>d.reject(m)}),p=new tg(l,f,{includeMetadataChanges:!0,qa:!0});return Xm(i,p)}(await jc(t),t.asyncQueue,e,n,r)),r.promise}function Zj(t,e,n){const r=new mr;return t.asyncQueue.enqueueAndForget(async()=>{try{const s=await Yj(t);r.resolve(async function(o,l,u){var A;const d=pe(o),{request:f,gt:p,parent:m}=v2(d.serializer,VP(l),u);d.connection.$o||delete f.parent;const y=(await d.Ho("RunAggregationQuery",d.serializer.databaseId,m,f,1)).filter(b=>!!b.result);je(y.length===1,64727);const x=(A=y[0].result)==null?void 0:A.aggregateFields;return Object.keys(x).reduce((b,E)=>(b[p[E]]=x[E],b),{})}(s,e,n))}catch(s){r.reject(s)}}),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oI(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const K_=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aI="firestore.googleapis.com",Q_=!0;class Y_{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new H(M.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=aI,this.ssl=Q_}else this.host=e.host,this.ssl=e.ssl??Q_;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=FT;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<C2)throw new H(M.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}JE("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=oI(e.experimentalLongPollingOptions??{}),function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new H(M.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new H(M.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new H(M.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,s){return r.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Nl{constructor(e,n,r,s){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Y_({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new H(M.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new H(M.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Y_(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new YE;switch(r.type){case"firstParty":return new iP(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new H(M.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=K_.get(n);r&&(Y("ComponentProvider","Removing Datastore"),K_.delete(n),r.terminate())}(this),Promise.resolve()}}function lI(t,e,n,r={}){var d;t=kt(t,Nl);const s=Ii(e),i=t._getSettings(),o={...i,emulatorOptions:t._getEmulatorOptions()},l=`${e}:${n}`;s&&(hm(`https://${l}`),fm("Firestore",!0)),i.host!==aI&&i.host!==l&&yi("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const u={...i,host:l,ssl:s,emulatorOptions:r};if(!fi(u,o)&&(t._setSettings(u),r.mockUserToken)){let f,p;if(typeof r.mockUserToken=="string")f=r.mockUserToken,p=qt.MOCK_USER;else{f=h1(r.mockUserToken,(d=t._app)==null?void 0:d.options.projectId);const m=r.mockUserToken.sub||r.mockUserToken.user_id;if(!m)throw new H(M.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");p=new qt(m)}t._authCredentials=new nP(new QE(f,p))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Er{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new Er(this.firestore,e,this._query)}}class Ze{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Mr(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Ze(this.firestore,e,this._key)}toJSON(){return{type:Ze._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,n,r){if(xl(n,Ze._jsonSchema))return new Ze(e,r||null,new te(Ue.fromString(n.referencePath)))}}Ze._jsonSchemaVersion="firestore/documentReference/1.0",Ze._jsonSchema={type:gt("string",Ze._jsonSchemaVersion),referencePath:gt("string")};class Mr extends Er{constructor(e,n,r){super(e,n,pd(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Ze(this.firestore,null,new te(e))}withConverter(e){return new Mr(this.firestore,e,this._path)}}function fe(t,e,...n){if(t=De(t),Pm("collection","path",e),t instanceof Nl){const r=Ue.fromString(e,...n);return u_(r),new Mr(t,null,r)}{if(!(t instanceof Ze||t instanceof Mr))throw new H(M.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Ue.fromString(e,...n));return u_(r),new Mr(t.firestore,null,r)}}function vr(t,e){if(t=kt(t,Nl),Pm("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new H(M.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new Er(t,null,function(r){return new bi(Ue.emptyPath(),r)}(e))}function G(t,e,...n){if(t=De(t),arguments.length===1&&(e=ud.newId()),Pm("doc","path",e),t instanceof Nl){const r=Ue.fromString(e,...n);return l_(r),new Ze(t,null,new te(r))}{if(!(t instanceof Ze||t instanceof Mr))throw new H(M.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Ue.fromString(e,...n));return l_(r),new Ze(t.firestore,t instanceof Mr?t.converter:null,new te(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const J_="AsyncQueue";class X_{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new qT(this,"async_queue_retry"),this._c=()=>{const r=Rh();r&&Y(J_,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const n=Rh();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const n=Rh();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const n=new mr;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!Uo(e))throw e;Y(J_,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const n=this.ac.then(()=>(this.rc=!0,e().catch(r=>{throw this.nc=r,this.rc=!1,Wr("INTERNAL UNHANDLED ERROR: ",Z_(r)),r}).then(r=>(this.rc=!1,r))));return this.ac=n,n}enqueueAfterDelay(e,n,r){this.uc(),this.oc.indexOf(e)>-1&&(n=0);const s=Ym.createAndSchedule(this,e,n,r,i=>this.hc(i));return this.tc.push(s),s}uc(){this.nc&&ae(47125,{Pc:Z_(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const n of this.tc)if(n.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.tc)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const n=this.tc.indexOf(e);this.tc.splice(n,1)}}function Z_(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ew(t){return function(n,r){if(typeof n!="object"||n===null)return!1;const s=n;for(const i of r)if(i in s&&typeof s[i]=="function")return!0;return!1}(t,["next","error","complete"])}class On extends Nl{constructor(e,n,r,s){super(e,n,r,s),this.type="firestore",this._queue=new X_,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new X_(e),this._firestoreClient=void 0,await e}}}function Fe(t,e){const n=typeof t=="object"?t:gl(),r=typeof t=="string"?t:Sc,s=Ni(n,"firestore").getImmediate({identifier:r});if(!s._initialized){const i=J0("firestore");i&&lI(s,...i)}return s}function ki(t){if(t._terminated)throw new H(M.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||eD(t),t._firestoreClient}function eD(t){var r,s,i;const e=t._freezeSettings(),n=function(l,u,d,f){return new EP(l,u,d,f.host,f.ssl,f.experimentalForceLongPolling,f.experimentalAutoDetectLongPolling,oI(f.experimentalLongPollingOptions),f.useFetchStreams,f.isUsingEmulator)}(t._databaseId,((r=t._app)==null?void 0:r.options.appId)||"",t._persistenceKey,e);t._componentsProvider||(s=e.localCache)!=null&&s._offlineComponentProvider&&((i=e.localCache)!=null&&i._onlineComponentProvider)&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new Gj(t._authCredentials,t._appCheckCredentials,t._queue,n,t._componentsProvider&&function(l){const u=l==null?void 0:l._online.build();return{_offline:l==null?void 0:l._offline.build(u),_online:u}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uI{constructor(e="count",n){this._internalFieldPath=n,this.type="AggregateField",this.aggregateType=e}}class cI{constructor(e,n,r){this._userDataWriter=n,this._data=r,this.type="AggregateQuerySnapshot",this.query=e}data(){return this._userDataWriter.convertObjectMap(this._data)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vn{constructor(e){this._byteString=e}static fromBase64String(e){try{return new vn(Rt.fromBase64String(e))}catch(n){throw new H(M.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new vn(Rt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:vn._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(xl(e,vn._jsonSchema))return vn.fromBase64String(e.bytes)}}vn._jsonSchemaVersion="firestore/bytes/1.0",vn._jsonSchema={type:gt("string",vn._jsonSchemaVersion),bytes:gt("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ri{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new H(M.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new At(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}function og(){return new Ri(Yf)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bl{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jn{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new H(M.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new H(M.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Te(this._lat,e._lat)||Te(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Jn._jsonSchemaVersion}}static fromJSON(e){if(xl(e,Jn._jsonSchema))return new Jn(e.latitude,e.longitude)}}Jn._jsonSchemaVersion="firestore/geoPoint/1.0",Jn._jsonSchema={type:gt("string",Jn._jsonSchemaVersion),latitude:gt("number"),longitude:gt("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xn{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,s){if(r.length!==s.length)return!1;for(let i=0;i<r.length;++i)if(r[i]!==s[i])return!1;return!0}(this._values,e._values)}toJSON(){return{type:Xn._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(xl(e,Xn._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(n=>typeof n=="number"))return new Xn(e.vectorValues);throw new H(M.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Xn._jsonSchemaVersion="firestore/vectorValue/1.0",Xn._jsonSchema={type:gt("string",Xn._jsonSchemaVersion),vectorValues:gt("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tD=/^__.*__$/;class nD{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new zs(e,this.data,this.fieldMask,n,this.fieldTransforms):new El(e,this.data,n,this.fieldTransforms)}}class dI{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new zs(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function hI(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ae(40011,{Ac:t})}}class ag{constructor(e,n,r,s,i,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.Rc(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new ag({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var s;const n=(s=this.path)==null?void 0:s.child(e),r=this.Vc({path:n,fc:!1});return r.gc(e),r}yc(e){var s;const n=(s=this.path)==null?void 0:s.child(e),r=this.Vc({path:n,fc:!1});return r.Rc(),r}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Dc(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(hI(this.Ac)&&tD.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class rD{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||xd(e)}Cc(e,n,r,s=!1){return new ag({Ac:e,methodName:n,Dc:r,path:At.emptyPath(),fc:!1,bc:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Al(t){const e=t._freezeSettings(),n=xd(t._databaseId);return new rD(t._databaseId,!!e.ignoreUndefinedProperties,n)}function lg(t,e,n,r,s,i={}){const o=t.Cc(i.merge||i.mergeFields?2:0,e,n,s);cg("Data must be an object, but it was:",o,r);const l=mI(r,o);let u,d;if(i.merge)u=new wn(o.fieldMask),d=o.fieldTransforms;else if(i.mergeFields){const f=[];for(const p of i.mergeFields){const m=hp(e,p,n);if(!o.contains(m))throw new H(M.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);yI(f,m)||f.push(m)}u=new wn(f),d=o.fieldTransforms.filter(p=>u.covers(p.field))}else u=null,d=o.fieldTransforms;return new nD(new ln(l),u,d)}class Cl extends bl{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Cl}}class ug extends bl{_toFieldTransform(e){return new KP(e.path,new sl)}isEqual(e){return e instanceof ug}}function fI(t,e,n,r){const s=t.Cc(1,e,n);cg("Data must be an object, but it was:",s,r);const i=[],o=ln.empty();Bs(r,(u,d)=>{const f=dg(e,u,n);d=De(d);const p=s.yc(f);if(d instanceof Cl)i.push(f);else{const m=kl(d,p);m!=null&&(i.push(f),o.set(f,m))}});const l=new wn(i);return new dI(o,l,s.fieldTransforms)}function pI(t,e,n,r,s,i){const o=t.Cc(1,e,n),l=[hp(e,r,n)],u=[s];if(i.length%2!=0)throw new H(M.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let m=0;m<i.length;m+=2)l.push(hp(e,i[m])),u.push(i[m+1]);const d=[],f=ln.empty();for(let m=l.length-1;m>=0;--m)if(!yI(d,l[m])){const y=l[m];let x=u[m];x=De(x);const A=o.yc(y);if(x instanceof Cl)d.push(y);else{const b=kl(x,A);b!=null&&(d.push(y),f.set(y,b))}}const p=new wn(d);return new dI(f,p,o.fieldTransforms)}function sD(t,e,n,r=!1){return kl(n,t.Cc(r?4:3,e))}function kl(t,e){if(gI(t=De(t)))return cg("Unsupported field value:",e,t),mI(t,e);if(t instanceof bl)return function(r,s){if(!hI(s.Ac))throw s.Sc(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Sc(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return function(r,s){const i=[];let o=0;for(const l of r){let u=kl(l,s.wc(o));u==null&&(u={nullValue:"NULL_VALUE"}),i.push(u),o++}return{arrayValue:{values:i}}}(t,e)}return function(r,s){if((r=De(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return WP(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=$e.fromDate(r);return{timestampValue:Cc(s.serializer,i)}}if(r instanceof $e){const i=new $e(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Cc(s.serializer,i)}}if(r instanceof Jn)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof vn)return{bytesValue:PT(s.serializer,r._byteString)};if(r instanceof Ze){const i=s.databaseId,o=r.firestore._databaseId;if(!o.isEqual(i))throw s.Sc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:$m(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof Xn)return function(o,l){return{mapValue:{fields:{[oT]:{stringValue:aT},[Nc]:{arrayValue:{values:o.toArray().map(d=>{if(typeof d!="number")throw l.Sc("VectorValues must only contain numeric values.");return Mm(l.serializer,d)})}}}}}}(r,s);throw s.Sc(`Unsupported field value: ${cd(r)}`)}(t,e)}function mI(t,e){const n={};return eT(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Bs(t,(r,s)=>{const i=kl(s,e.mc(r));i!=null&&(n[r]=i)}),{mapValue:{fields:n}}}function gI(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof $e||t instanceof Jn||t instanceof vn||t instanceof Ze||t instanceof bl||t instanceof Xn)}function cg(t,e,n){if(!gI(n)||!XE(n)){const r=cd(n);throw r==="an object"?e.Sc(t+" a custom object"):e.Sc(t+" "+r)}}function hp(t,e,n){if((e=De(e))instanceof Ri)return e._internalPath;if(typeof e=="string")return dg(t,e);throw Dc("Field path arguments must be of type string or ",t,!1,void 0,n)}const iD=new RegExp("[~\\*/\\[\\]]");function dg(t,e,n){if(e.search(iD)>=0)throw Dc(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new Ri(...e.split("."))._internalPath}catch{throw Dc(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Dc(t,e,n,r,s){const i=r&&!r.isEmpty(),o=s!==void 0;let l=`Function ${e}() called with invalid data`;n&&(l+=" (via `toFirestore()`)"),l+=". ";let u="";return(i||o)&&(u+=" (found",i&&(u+=` in field ${r}`),o&&(u+=` in document ${s}`),u+=")"),new H(M.INVALID_ARGUMENT,l+t+u)}function yI(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vI{constructor(e,n,r,s,i){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Ze(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new oD(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(Id("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class oD extends vI{data(){return super.data()}}function Id(t,e){return typeof e=="string"?dg(t,e):e instanceof Ri?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _I(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new H(M.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class hg{}class fg extends hg{}function Ye(t,e,...n){let r=[];e instanceof hg&&r.push(e),r=r.concat(n),function(i){const o=i.filter(u=>u instanceof Sd).length,l=i.filter(u=>u instanceof Rl).length;if(o>1||o>0&&l>0)throw new H(M.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const s of r)t=s._apply(t);return t}class Rl extends fg{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new Rl(e,n,r)}_apply(e){const n=this._parse(e);return wI(e._query,n),new Er(e.firestore,e.converter,tp(e._query,n))}_parse(e){const n=Al(e.firestore);return function(i,o,l,u,d,f,p){let m;if(d.isKeyField()){if(f==="array-contains"||f==="array-contains-any")throw new H(M.INVALID_ARGUMENT,`Invalid Query. You can't perform '${f}' queries on documentId().`);if(f==="in"||f==="not-in"){nw(p,f);const x=[];for(const A of p)x.push(tw(u,i,A));m={arrayValue:{values:x}}}else m=tw(u,i,p)}else f!=="in"&&f!=="not-in"&&f!=="array-contains-any"||nw(p,f),m=sD(l,o,p,f==="in"||f==="not-in");return mt.create(d,f,m)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function cn(t,e,n){const r=e,s=Id("where",t);return Rl._create(s,r,n)}class Sd extends hg{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new Sd(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:tr.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(s,i){let o=s;const l=i.getFlattenedFilters();for(const u of l)wI(o,u),o=tp(o,u)}(e._query,n),new Er(e.firestore,e.converter,tp(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Nd extends fg{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new Nd(e,n)}_apply(e){const n=function(s,i,o){if(s.startAt!==null)throw new H(M.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new H(M.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new rl(i,o)}(e._query,this._field,this._direction);return new Er(e.firestore,e.converter,function(s,i){const o=s.explicitOrderBy.concat([i]);return new bi(s.path,s.collectionGroup,o,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)}(e._query,n))}}function Ln(t,e="asc"){const n=e,r=Id("orderBy",t);return Nd._create(r,n)}function tw(t,e,n){if(typeof(n=De(n))=="string"){if(n==="")throw new H(M.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!mT(e)&&n.indexOf("/")!==-1)throw new H(M.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(Ue.fromString(n));if(!te.isDocumentKey(r))throw new H(M.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return y_(t,new te(r))}if(n instanceof Ze)return y_(t,n._key);throw new H(M.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${cd(n)}.`)}function nw(t,e){if(!Array.isArray(t)||t.length===0)throw new H(M.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function wI(t,e){const n=function(s,i){for(const o of s)for(const l of o.getFlattenedFilters())if(i.indexOf(l.op)>=0)return l.op;return null}(t.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new H(M.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new H(M.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class xI{convertValue(e,n="none"){switch(Ls(e)){case 0:return null;case 1:return e.booleanValue;case 2:return ut(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(Os(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw ae(62114,{value:e})}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return Bs(e,(s,i)=>{r[s]=this.convertValue(i,n)}),r}convertVectorValue(e){var r,s,i;const n=(i=(s=(r=e.fields)==null?void 0:r[Nc].arrayValue)==null?void 0:s.values)==null?void 0:i.map(o=>ut(o.doubleValue));return new Xn(n)}convertGeoPoint(e){return new Jn(ut(e.latitude),ut(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=fd(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(tl(e));default:return null}}convertTimestamp(e){const n=Ds(e);return new $e(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=Ue.fromString(e);je(UT(r),9688,{name:e});const s=new Io(r.get(1),r.get(3)),i=new te(r.popFirst(5));return s.isEqual(n)||Wr(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pg(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}function EI(){return new uI("count")}class to{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Cs extends vI{constructor(e,n,r,s,i,o){super(e,n,r,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new Ra(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(Id("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new H(M.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,n={};return n.type=Cs._jsonSchemaVersion,n.bundle="",n.bundleSource="DocumentSnapshot",n.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?n:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),n.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),n)}}Cs._jsonSchemaVersion="firestore/documentSnapshot/1.0",Cs._jsonSchema={type:gt("string",Cs._jsonSchemaVersion),bundleSource:gt("string","DocumentSnapshot"),bundleName:gt("string"),bundle:gt("string")};class Ra extends Cs{data(e={}){return super.data(e)}}class ks{constructor(e,n,r,s){this._firestore=e,this._userDataWriter=n,this._snapshot=s,this.metadata=new to(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new Ra(this._firestore,this._userDataWriter,r.key,r,new to(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new H(M.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let o=0;return s._snapshot.docChanges.map(l=>{const u=new Ra(s._firestore,s._userDataWriter,l.doc.key,l.doc,new to(s._snapshot.mutatedKeys.has(l.doc.key),s._snapshot.fromCache),s.query.converter);return l.doc,{type:"added",doc:u,oldIndex:-1,newIndex:o++}})}{let o=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(l=>i||l.type!==3).map(l=>{const u=new Ra(s._firestore,s._userDataWriter,l.doc.key,l.doc,new to(s._snapshot.mutatedKeys.has(l.doc.key),s._snapshot.fromCache),s.query.converter);let d=-1,f=-1;return l.type!==0&&(d=o.indexOf(l.doc.key),o=o.delete(l.doc.key)),l.type!==1&&(o=o.add(l.doc),f=o.indexOf(l.doc.key)),{type:aD(l.type),doc:u,oldIndex:d,newIndex:f}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new H(M.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=ks._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=ud.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const n=[],r=[],s=[];return this.docs.forEach(i=>{i._document!==null&&(n.push(i._document),r.push(this._userDataWriter.convertObjectMap(i._document.data.value.mapValue.fields,"previous")),s.push(i.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function aD(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ae(61501,{type:t})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function be(t){t=kt(t,Ze);const e=kt(t.firestore,On);return Jj(ki(e),t._key).then(n=>TI(e,t,n))}ks._jsonSchemaVersion="firestore/querySnapshot/1.0",ks._jsonSchema={type:gt("string",ks._jsonSchemaVersion),bundleSource:gt("string","QuerySnapshot"),bundleName:gt("string"),bundle:gt("string")};class bd extends xI{constructor(e){super(),this.firestore=e}convertBytes(e){return new vn(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Ze(this.firestore,null,n)}}function et(t){t=kt(t,Er);const e=kt(t.firestore,On),n=ki(e),r=new bd(e);return _I(t._query),Xj(n,t._query).then(s=>new ks(e,r,t,s))}function Et(t,e,n){t=kt(t,Ze);const r=kt(t.firestore,On),s=pg(t.converter,e,n);return $o(r,[lg(Al(r),"setDoc",t._key,s,t.converter!==null,n).toMutation(t._key,en.none())])}function mg(t,e,n,...r){t=kt(t,Ze);const s=kt(t.firestore,On),i=Al(s);let o;return o=typeof(e=De(e))=="string"||e instanceof Ri?pI(i,"updateDoc",t._key,e,n,r):fI(i,"updateDoc",t._key,e),$o(s,[o.toMutation(t._key,en.exists(!0))])}function Ot(t){return $o(kt(t.firestore,On),[new _d(t._key,en.none())])}function Dr(t,e){const n=kt(t.firestore,On),r=G(t),s=pg(t.converter,e);return $o(n,[lg(Al(t.firestore),"addDoc",r._key,s,t.converter!==null,{}).toMutation(r._key,en.exists(!1))]).then(()=>r)}function _t(t,...e){var u,d,f;t=De(t);let n={includeMetadataChanges:!1,source:"default"},r=0;typeof e[r]!="object"||ew(e[r])||(n=e[r++]);const s={includeMetadataChanges:n.includeMetadataChanges,source:n.source};if(ew(e[r])){const p=e[r];e[r]=(u=p.next)==null?void 0:u.bind(p),e[r+1]=(d=p.error)==null?void 0:d.bind(p),e[r+2]=(f=p.complete)==null?void 0:f.bind(p)}let i,o,l;if(t instanceof Ze)o=kt(t.firestore,On),l=pd(t._key.path),i={next:p=>{e[r]&&e[r](TI(o,t,p))},error:e[r+1],complete:e[r+2]};else{const p=kt(t,Er);o=kt(p.firestore,On),l=p._query;const m=new bd(o);i={next:y=>{e[r]&&e[r](new ks(o,m,p,y))},error:e[r+1],complete:e[r+2]},_I(t._query)}return function(m,y,x,A){const b=new sg(A),E=new tg(y,b,x);return m.asyncQueue.enqueueAndForget(async()=>Xm(await jc(m),E)),()=>{b.Nu(),m.asyncQueue.enqueueAndForget(async()=>Zm(await jc(m),E))}}(ki(o),l,s,i)}function $o(t,e){return function(r,s){const i=new mr;return r.asyncQueue.enqueueAndForget(async()=>Mj(await Qj(r),s,i)),i.promise}(ki(t),e)}function TI(t,e,n){const r=n.docs.get(e._key),s=new bd(t);return new Cs(t,s,e._key,r,new to(n.hasPendingWrites,n.fromCache),e.converter)}function Oc(t){return II(t,{count:EI()})}function II(t,e){const n=kt(t.firestore,On),r=ki(n),s=wP(e,(i,o)=>new n2(o,i.aggregateType,i._internalFieldPath));return Zj(r,t._query,s).then(i=>function(l,u,d){const f=new bd(l);return new cI(u,f,d)}(n,t,i))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SI{constructor(e,n){this._firestore=e,this._commitHandler=n,this._mutations=[],this._committed=!1,this._dataReader=Al(e)}set(e,n,r){this._verifyNotCommitted();const s=jh(e,this._firestore),i=pg(s.converter,n,r),o=lg(this._dataReader,"WriteBatch.set",s._key,i,s.converter!==null,r);return this._mutations.push(o.toMutation(s._key,en.none())),this}update(e,n,r,...s){this._verifyNotCommitted();const i=jh(e,this._firestore);let o;return o=typeof(n=De(n))=="string"||n instanceof Ri?pI(this._dataReader,"WriteBatch.update",i._key,n,r,s):fI(this._dataReader,"WriteBatch.update",i._key,n),this._mutations.push(o.toMutation(i._key,en.exists(!0))),this}delete(e){this._verifyNotCommitted();const n=jh(e,this._firestore);return this._mutations=this._mutations.concat(new _d(n._key,en.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new H(M.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function jh(t,e){if((t=De(t)).firestore!==e)throw new H(M.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fp(){return new Cl("deleteField")}function ke(){return new ug("serverTimestamp")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NI(t){return ki(t=kt(t,On)),new SI(t,e=>$o(t,e))}(function(e,n=!0){(function(s){Vo=s})(Oo),er(new Dn("firestore",(r,{instanceIdentifier:s,options:i})=>{const o=r.getProvider("app").getImmediate(),l=new On(new rP(r.getProvider("auth-internal")),new oP(o,r.getProvider("app-check-internal")),function(d,f){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new H(M.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Io(d.options.projectId,f)}(o,s),o);return i={useFetchStreams:n,...i},l._setSettings(i),l},"PUBLIC").setMultipleInstances(!0)),mn(i_,o_,e),mn(i_,o_,"esm2020")})();const lD=Object.freeze(Object.defineProperty({__proto__:null,AbstractUserDataWriter:xI,AggregateField:uI,AggregateQuerySnapshot:cI,Bytes:vn,CollectionReference:Mr,DocumentReference:Ze,DocumentSnapshot:Cs,FieldPath:Ri,FieldValue:bl,Firestore:On,FirestoreError:H,GeoPoint:Jn,Query:Er,QueryCompositeFilterConstraint:Sd,QueryConstraint:fg,QueryDocumentSnapshot:Ra,QueryFieldFilterConstraint:Rl,QueryOrderByConstraint:Nd,QuerySnapshot:ks,SnapshotMetadata:to,Timestamp:$e,VectorValue:Xn,WriteBatch:SI,_AutoId:ud,_ByteString:Rt,_DatabaseId:Io,_DocumentKey:te,_EmptyAuthCredentialsProvider:YE,_FieldPath:At,_cast:kt,_logWarn:yi,_validateIsNotUsedTogether:JE,addDoc:Dr,collection:fe,collectionGroup:vr,connectFirestoreEmulator:lI,count:EI,deleteDoc:Ot,deleteField:fp,doc:G,documentId:og,ensureFirestoreConfigured:ki,executeWrite:$o,getAggregateFromServer:II,getCountFromServer:Oc,getDoc:be,getDocs:et,getFirestore:Fe,onSnapshot:_t,orderBy:Ln,query:Ye,serverTimestamp:ke,setDoc:Et,updateDoc:mg,where:cn,writeBatch:NI},Symbol.toStringTag,{value:"Module"}));var uD="firebase",cD="12.1.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */mn(uD,cD,"app");const bI="@firebase/installations",gg="0.6.19";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AI=1e4,CI=`w:${gg}`,kI="FIS_v2",dD="https://firebaseinstallations.googleapis.com/v1",hD=60*60*1e3,fD="installations",pD="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mD={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},_i=new Si(fD,pD,mD);function RI(t){return t instanceof nr&&t.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PI({projectId:t}){return`${dD}/projects/${t}/installations`}function jI(t){return{token:t.token,requestStatus:2,expiresIn:yD(t.expiresIn),creationTime:Date.now()}}async function DI(t,e){const r=(await e.json()).error;return _i.create("request-failed",{requestName:t,serverCode:r.code,serverMessage:r.message,serverStatus:r.status})}function OI({apiKey:t}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}function gD(t,{refreshToken:e}){const n=OI(t);return n.append("Authorization",vD(e)),n}async function LI(t){const e=await t();return e.status>=500&&e.status<600?t():e}function yD(t){return Number(t.replace("s","000"))}function vD(t){return`${kI} ${t}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _D({appConfig:t,heartbeatServiceProvider:e},{fid:n}){const r=PI(t),s=OI(t),i=e.getImmediate({optional:!0});if(i){const d=await i.getHeartbeatsHeader();d&&s.append("x-firebase-client",d)}const o={fid:n,authVersion:kI,appId:t.appId,sdkVersion:CI},l={method:"POST",headers:s,body:JSON.stringify(o)},u=await LI(()=>fetch(r,l));if(u.ok){const d=await u.json();return{fid:d.fid||n,registrationStatus:2,refreshToken:d.refreshToken,authToken:jI(d.authToken)}}else throw await DI("Create Installation",u)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VI(t){return new Promise(e=>{setTimeout(e,t)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wD(t){return btoa(String.fromCharCode(...t)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xD=/^[cdef][\w-]{21}$/,pp="";function ED(){try{const t=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(t),t[0]=112+t[0]%16;const n=TD(t);return xD.test(n)?n:pp}catch{return pp}}function TD(t){return wD(t).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ad(t){return`${t.appName}!${t.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MI=new Map;function UI(t,e){const n=Ad(t);FI(n,e),ID(n,e)}function FI(t,e){const n=MI.get(t);if(n)for(const r of n)r(e)}function ID(t,e){const n=SD();n&&n.postMessage({key:t,fid:e}),ND()}let ii=null;function SD(){return!ii&&"BroadcastChannel"in self&&(ii=new BroadcastChannel("[Firebase] FID Change"),ii.onmessage=t=>{FI(t.data.key,t.data.fid)}),ii}function ND(){MI.size===0&&ii&&(ii.close(),ii=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bD="firebase-installations-database",AD=1,wi="firebase-installations-store";let Dh=null;function yg(){return Dh||(Dh=id(bD,AD,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(wi)}}})),Dh}async function Lc(t,e){const n=Ad(t),s=(await yg()).transaction(wi,"readwrite"),i=s.objectStore(wi),o=await i.get(n);return await i.put(e,n),await s.done,(!o||o.fid!==e.fid)&&UI(t,e.fid),e}async function $I(t){const e=Ad(t),r=(await yg()).transaction(wi,"readwrite");await r.objectStore(wi).delete(e),await r.done}async function Cd(t,e){const n=Ad(t),s=(await yg()).transaction(wi,"readwrite"),i=s.objectStore(wi),o=await i.get(n),l=e(o);return l===void 0?await i.delete(n):await i.put(l,n),await s.done,l&&(!o||o.fid!==l.fid)&&UI(t,l.fid),l}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vg(t){let e;const n=await Cd(t.appConfig,r=>{const s=CD(r),i=kD(t,s);return e=i.registrationPromise,i.installationEntry});return n.fid===pp?{installationEntry:await e}:{installationEntry:n,registrationPromise:e}}function CD(t){const e=t||{fid:ED(),registrationStatus:0};return BI(e)}function kD(t,e){if(e.registrationStatus===0){if(!navigator.onLine){const s=Promise.reject(_i.create("app-offline"));return{installationEntry:e,registrationPromise:s}}const n={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},r=RD(t,n);return{installationEntry:n,registrationPromise:r}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:PD(t)}:{installationEntry:e}}async function RD(t,e){try{const n=await _D(t,e);return Lc(t.appConfig,n)}catch(n){throw RI(n)&&n.customData.serverCode===409?await $I(t.appConfig):await Lc(t.appConfig,{fid:e.fid,registrationStatus:0}),n}}async function PD(t){let e=await rw(t.appConfig);for(;e.registrationStatus===1;)await VI(100),e=await rw(t.appConfig);if(e.registrationStatus===0){const{installationEntry:n,registrationPromise:r}=await vg(t);return r||n}return e}function rw(t){return Cd(t,e=>{if(!e)throw _i.create("installation-not-found");return BI(e)})}function BI(t){return jD(t)?{fid:t.fid,registrationStatus:0}:t}function jD(t){return t.registrationStatus===1&&t.registrationTime+AI<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function DD({appConfig:t,heartbeatServiceProvider:e},n){const r=OD(t,n),s=gD(t,n),i=e.getImmediate({optional:!0});if(i){const d=await i.getHeartbeatsHeader();d&&s.append("x-firebase-client",d)}const o={installation:{sdkVersion:CI,appId:t.appId}},l={method:"POST",headers:s,body:JSON.stringify(o)},u=await LI(()=>fetch(r,l));if(u.ok){const d=await u.json();return jI(d)}else throw await DI("Generate Auth Token",u)}function OD(t,{fid:e}){return`${PI(t)}/${e}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _g(t,e=!1){let n;const r=await Cd(t.appConfig,i=>{if(!zI(i))throw _i.create("not-registered");const o=i.authToken;if(!e&&MD(o))return i;if(o.requestStatus===1)return n=LD(t,e),i;{if(!navigator.onLine)throw _i.create("app-offline");const l=FD(i);return n=VD(t,l),l}});return n?await n:r.authToken}async function LD(t,e){let n=await sw(t.appConfig);for(;n.authToken.requestStatus===1;)await VI(100),n=await sw(t.appConfig);const r=n.authToken;return r.requestStatus===0?_g(t,e):r}function sw(t){return Cd(t,e=>{if(!zI(e))throw _i.create("not-registered");const n=e.authToken;return $D(n)?{...e,authToken:{requestStatus:0}}:e})}async function VD(t,e){try{const n=await DD(t,e),r={...e,authToken:n};return await Lc(t.appConfig,r),n}catch(n){if(RI(n)&&(n.customData.serverCode===401||n.customData.serverCode===404))await $I(t.appConfig);else{const r={...e,authToken:{requestStatus:0}};await Lc(t.appConfig,r)}throw n}}function zI(t){return t!==void 0&&t.registrationStatus===2}function MD(t){return t.requestStatus===2&&!UD(t)}function UD(t){const e=Date.now();return e<t.creationTime||t.creationTime+t.expiresIn<e+hD}function FD(t){const e={requestStatus:1,requestTime:Date.now()};return{...t,authToken:e}}function $D(t){return t.requestStatus===1&&t.requestTime+AI<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function BD(t){const e=t,{installationEntry:n,registrationPromise:r}=await vg(e);return r?r.catch(console.error):_g(e).catch(console.error),n.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function zD(t,e=!1){const n=t;return await qD(n),(await _g(n,e)).token}async function qD(t){const{registrationPromise:e}=await vg(t);e&&await e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WD(t){if(!t||!t.options)throw Oh("App Configuration");if(!t.name)throw Oh("App Name");const e=["projectId","apiKey","appId"];for(const n of e)if(!t.options[n])throw Oh(n);return{appName:t.name,projectId:t.options.projectId,apiKey:t.options.apiKey,appId:t.options.appId}}function Oh(t){return _i.create("missing-app-config-values",{valueName:t})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qI="installations",HD="installations-internal",GD=t=>{const e=t.getProvider("app").getImmediate(),n=WD(e),r=Ni(e,"heartbeat");return{app:e,appConfig:n,heartbeatServiceProvider:r,_delete:()=>Promise.resolve()}},KD=t=>{const e=t.getProvider("app").getImmediate(),n=Ni(e,qI).getImmediate();return{getId:()=>BD(n),getToken:s=>zD(n,s)}};function QD(){er(new Dn(qI,GD,"PUBLIC")),er(new Dn(HD,KD,"PRIVATE"))}QD();mn(bI,gg);mn(bI,gg,"esm2020");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YD="/firebase-messaging-sw.js",JD="/firebase-cloud-messaging-push-scope",WI="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",XD="https://fcmregistrations.googleapis.com/v1",HI="google.c.a.c_id",ZD="google.c.a.c_l",eO="google.c.a.ts",tO="google.c.a.e",iw=1e4;var ow;(function(t){t[t.DATA_MESSAGE=1]="DATA_MESSAGE",t[t.DISPLAY_NOTIFICATION=3]="DISPLAY_NOTIFICATION"})(ow||(ow={}));/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file except
 * in compliance with the License. You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software distributed under the License
 * is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express
 * or implied. See the License for the specific language governing permissions and limitations under
 * the License.
 */var al;(function(t){t.PUSH_RECEIVED="push-received",t.NOTIFICATION_CLICKED="notification-clicked"})(al||(al={}));/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ar(t){const e=new Uint8Array(t);return btoa(String.fromCharCode(...e)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function nO(t){const e="=".repeat((4-t.length%4)%4),n=(t+e).replace(/\-/g,"+").replace(/_/g,"/"),r=atob(n),s=new Uint8Array(r.length);for(let i=0;i<r.length;++i)s[i]=r.charCodeAt(i);return s}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lh="fcm_token_details_db",rO=5,aw="fcm_token_object_Store";async function sO(t){if("databases"in indexedDB&&!(await indexedDB.databases()).map(i=>i.name).includes(Lh))return null;let e=null;return(await id(Lh,rO,{upgrade:async(r,s,i,o)=>{if(s<2||!r.objectStoreNames.contains(aw))return;const l=o.objectStore(aw),u=await l.index("fcmSenderId").get(t);if(await l.clear(),!!u){if(s===2){const d=u;if(!d.auth||!d.p256dh||!d.endpoint)return;e={token:d.fcmToken,createTime:d.createTime??Date.now(),subscriptionOptions:{auth:d.auth,p256dh:d.p256dh,endpoint:d.endpoint,swScope:d.swScope,vapidKey:typeof d.vapidKey=="string"?d.vapidKey:Ar(d.vapidKey)}}}else if(s===3){const d=u;e={token:d.fcmToken,createTime:d.createTime,subscriptionOptions:{auth:Ar(d.auth),p256dh:Ar(d.p256dh),endpoint:d.endpoint,swScope:d.swScope,vapidKey:Ar(d.vapidKey)}}}else if(s===4){const d=u;e={token:d.fcmToken,createTime:d.createTime,subscriptionOptions:{auth:Ar(d.auth),p256dh:Ar(d.p256dh),endpoint:d.endpoint,swScope:d.swScope,vapidKey:Ar(d.vapidKey)}}}}}})).close(),await Th(Lh),await Th("fcm_vapid_details_db"),await Th("undefined"),iO(e)?e:null}function iO(t){if(!t||!t.subscriptionOptions)return!1;const{subscriptionOptions:e}=t;return typeof t.createTime=="number"&&t.createTime>0&&typeof t.token=="string"&&t.token.length>0&&typeof e.auth=="string"&&e.auth.length>0&&typeof e.p256dh=="string"&&e.p256dh.length>0&&typeof e.endpoint=="string"&&e.endpoint.length>0&&typeof e.swScope=="string"&&e.swScope.length>0&&typeof e.vapidKey=="string"&&e.vapidKey.length>0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oO="firebase-messaging-database",aO=1,ll="firebase-messaging-store";let Vh=null;function GI(){return Vh||(Vh=id(oO,aO,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(ll)}}})),Vh}async function lO(t){const e=KI(t),r=await(await GI()).transaction(ll).objectStore(ll).get(e);if(r)return r;{const s=await sO(t.appConfig.senderId);if(s)return await wg(t,s),s}}async function wg(t,e){const n=KI(t),s=(await GI()).transaction(ll,"readwrite");return await s.objectStore(ll).put(e,n),await s.done,e}function KI({appConfig:t}){return t.appId}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uO={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."},Gt=new Si("messaging","Messaging",uO);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function cO(t,e){const n=await Eg(t),r=QI(e),s={method:"POST",headers:n,body:JSON.stringify(r)};let i;try{i=await(await fetch(xg(t.appConfig),s)).json()}catch(o){throw Gt.create("token-subscribe-failed",{errorInfo:o==null?void 0:o.toString()})}if(i.error){const o=i.error.message;throw Gt.create("token-subscribe-failed",{errorInfo:o})}if(!i.token)throw Gt.create("token-subscribe-no-token");return i.token}async function dO(t,e){const n=await Eg(t),r=QI(e.subscriptionOptions),s={method:"PATCH",headers:n,body:JSON.stringify(r)};let i;try{i=await(await fetch(`${xg(t.appConfig)}/${e.token}`,s)).json()}catch(o){throw Gt.create("token-update-failed",{errorInfo:o==null?void 0:o.toString()})}if(i.error){const o=i.error.message;throw Gt.create("token-update-failed",{errorInfo:o})}if(!i.token)throw Gt.create("token-update-no-token");return i.token}async function hO(t,e){const r={method:"DELETE",headers:await Eg(t)};try{const i=await(await fetch(`${xg(t.appConfig)}/${e}`,r)).json();if(i.error){const o=i.error.message;throw Gt.create("token-unsubscribe-failed",{errorInfo:o})}}catch(s){throw Gt.create("token-unsubscribe-failed",{errorInfo:s==null?void 0:s.toString()})}}function xg({projectId:t}){return`${XD}/projects/${t}/registrations`}async function Eg({appConfig:t,installations:e}){const n=await e.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t.apiKey,"x-goog-firebase-installations-auth":`FIS ${n}`})}function QI({p256dh:t,auth:e,endpoint:n,vapidKey:r}){const s={web:{endpoint:n,auth:e,p256dh:t}};return r!==WI&&(s.web.applicationPubKey=r),s}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fO=7*24*60*60*1e3;async function pO(t){const e=await gO(t.swRegistration,t.vapidKey),n={vapidKey:t.vapidKey,swScope:t.swRegistration.scope,endpoint:e.endpoint,auth:Ar(e.getKey("auth")),p256dh:Ar(e.getKey("p256dh"))},r=await lO(t.firebaseDependencies);if(r){if(yO(r.subscriptionOptions,n))return Date.now()>=r.createTime+fO?mO(t,{token:r.token,createTime:Date.now(),subscriptionOptions:n}):r.token;try{await hO(t.firebaseDependencies,r.token)}catch(s){console.warn(s)}return lw(t.firebaseDependencies,n)}else return lw(t.firebaseDependencies,n)}async function mO(t,e){try{const n=await dO(t.firebaseDependencies,e),r={...e,token:n,createTime:Date.now()};return await wg(t.firebaseDependencies,r),n}catch(n){throw n}}async function lw(t,e){const r={token:await cO(t,e),createTime:Date.now(),subscriptionOptions:e};return await wg(t,r),r.token}async function gO(t,e){const n=await t.pushManager.getSubscription();return n||t.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:nO(e)})}function yO(t,e){const n=e.vapidKey===t.vapidKey,r=e.endpoint===t.endpoint,s=e.auth===t.auth,i=e.p256dh===t.p256dh;return n&&r&&s&&i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uw(t){const e={from:t.from,collapseKey:t.collapse_key,messageId:t.fcmMessageId};return vO(e,t),_O(e,t),wO(e,t),e}function vO(t,e){if(!e.notification)return;t.notification={};const n=e.notification.title;n&&(t.notification.title=n);const r=e.notification.body;r&&(t.notification.body=r);const s=e.notification.image;s&&(t.notification.image=s);const i=e.notification.icon;i&&(t.notification.icon=i)}function _O(t,e){e.data&&(t.data=e.data)}function wO(t,e){var s,i,o,l;if(!e.fcmOptions&&!((s=e.notification)!=null&&s.click_action))return;t.fcmOptions={};const n=((i=e.fcmOptions)==null?void 0:i.link)??((o=e.notification)==null?void 0:o.click_action);n&&(t.fcmOptions.link=n);const r=(l=e.fcmOptions)==null?void 0:l.analytics_label;r&&(t.fcmOptions.analyticsLabel=r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xO(t){return typeof t=="object"&&!!t&&HI in t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EO(t){if(!t||!t.options)throw Mh("App Configuration Object");if(!t.name)throw Mh("App Name");const e=["projectId","apiKey","appId","messagingSenderId"],{options:n}=t;for(const r of e)if(!n[r])throw Mh(r);return{appName:t.name,projectId:n.projectId,apiKey:n.apiKey,appId:n.appId,senderId:n.messagingSenderId}}function Mh(t){return Gt.create("missing-app-config-values",{valueName:t})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TO{constructor(e,n,r){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;const s=EO(e);this.firebaseDependencies={app:e,appConfig:s,installations:n,analyticsProvider:r}}_delete(){return Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function IO(t){try{t.swRegistration=await navigator.serviceWorker.register(YD,{scope:JD}),t.swRegistration.update().catch(()=>{}),await SO(t.swRegistration)}catch(e){throw Gt.create("failed-service-worker-registration",{browserErrorMessage:e==null?void 0:e.message})}}async function SO(t){return new Promise((e,n)=>{const r=setTimeout(()=>n(new Error(`Service worker not registered after ${iw} ms`)),iw),s=t.installing||t.waiting;t.active?(clearTimeout(r),e()):s?s.onstatechange=i=>{var o;((o=i.target)==null?void 0:o.state)==="activated"&&(s.onstatechange=null,clearTimeout(r),e())}:(clearTimeout(r),n(new Error("No incoming service worker found.")))})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function NO(t,e){if(!e&&!t.swRegistration&&await IO(t),!(!e&&t.swRegistration)){if(!(e instanceof ServiceWorkerRegistration))throw Gt.create("invalid-sw-registration");t.swRegistration=e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function bO(t,e){e?t.vapidKey=e:t.vapidKey||(t.vapidKey=WI)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function YI(t,e){if(!navigator)throw Gt.create("only-available-in-window");if(Notification.permission==="default"&&await Notification.requestPermission(),Notification.permission!=="granted")throw Gt.create("permission-blocked");return await bO(t,e==null?void 0:e.vapidKey),await NO(t,e==null?void 0:e.serviceWorkerRegistration),pO(t)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function AO(t,e,n){const r=CO(e);(await t.firebaseDependencies.analyticsProvider.get()).logEvent(r,{message_id:n[HI],message_name:n[ZD],message_time:n[eO],message_device_time:Math.floor(Date.now()/1e3)})}function CO(t){switch(t){case al.NOTIFICATION_CLICKED:return"notification_open";case al.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function kO(t,e){const n=e.data;if(!n.isFirebaseMessaging)return;t.onMessageHandler&&n.messageType===al.PUSH_RECEIVED&&(typeof t.onMessageHandler=="function"?t.onMessageHandler(uw(n)):t.onMessageHandler.next(uw(n)));const r=n.data;xO(r)&&r[tO]==="1"&&await AO(t,n.messageType,r)}const cw="@firebase/messaging",dw="0.12.23";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RO=t=>{const e=new TO(t.getProvider("app").getImmediate(),t.getProvider("installations-internal").getImmediate(),t.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",n=>kO(e,n)),e},PO=t=>{const e=t.getProvider("messaging").getImmediate();return{getToken:r=>YI(e,r)}};function jO(){er(new Dn("messaging",RO,"PUBLIC")),er(new Dn("messaging-internal",PO,"PRIVATE")),mn(cw,dw),mn(cw,dw,"esm2020")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function JI(){try{await tE()}catch{return!1}return typeof window<"u"&&eE()&&E1()&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DO(t,e){if(!navigator)throw Gt.create("only-available-in-window");return t.onMessageHandler=e,()=>{t.onMessageHandler=null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OO(t=gl()){return JI().then(e=>{if(!e)throw Gt.create("unsupported-browser")},e=>{throw Gt.create("indexed-db-unsupported")}),Ni(De(t),"messaging").getImmediate()}async function LO(t,e){return t=De(t),YI(t,e)}function VO(t,e){return t=De(t),DO(t,e)}jO();const Tg={apiKey:"AIzaSyAvTkBdah-m0JBKF2hPh2ra95ZrFfFXPZs",authDomain:"immanuel-app.firebaseapp.com",projectId:"immanuel-app",storageBucket:"immanuel-app.firebasestorage.app",messagingSenderId:"815824103273",appId:"1:815824103273:web:3817385bebff5f704a3ff8",measurementId:"G-P6WR1NQRB8"};function MO(t){const e=Object.entries(t).filter(([,n])=>!n||String(n).trim()==="").map(([n])=>n);if(e.length){const n=Object.fromEntries(Object.entries(t).map(([r,s])=>[r,s&&(typeof s=="string"?s.slice(0,6)+"…":s)]));throw console.error("[firebase] Missing config keys:",e,`
Loaded values:`,n),new Error("Firebase configuration is incomplete. Missing: "+e.join(", "))}}MO(Tg);const ne=bC().length?gl():sE(Tg),ul=Ge(ne),Ig=Fe(ne),UO=new Cn;UO.setCustomParameters({prompt:"select_account"});typeof window<"u"&&(window.__FIREBASE_CONFIG__=Tg);async function kd(){try{return await JI()?OO(ne):null}catch{return null}}const XI=k.createContext(void 0);function FO({children:t}){const e=k.useMemo(()=>Ge(ne),[]),n=k.useMemo(()=>Fe(ne),[]),[r,s]=k.useState(e.currentUser),[i,o]=k.useState(!0),[l,u]=k.useState(!1);async function d(A){if(!A){u(!1);return}try{const b=A.uid,v=(await be(G(n,"admins",b))).exists();let w=!1;try{const R=Ye(vr(n,"groupAdmins"),cn("uid","==",b));w=!(await et(R)).empty}catch{w=!1}u(v||w)}catch{u(!1)}}k.useEffect(()=>{const A=Mn(e,async b=>{s(b),await d(b),o(!1)});return()=>A()},[e]);const f=async(A,b)=>{await CE(e,A,b),await d(e.currentUser)},p=async()=>{const A=new Cn;await km(e,A),await d(e.currentUser)},m=async()=>{await Hf(e),u(!1)},y=async()=>{await d(e.currentUser)},x=k.useMemo(()=>({user:r,loading:i,isAdmin:l,login:f,signInWithGoogle:p,logout:m,refresh:y}),[r,i,l]);return c.jsx(XI.Provider,{value:x,children:t})}function Rd(){const t=k.useContext(XI);if(!t)throw new Error("useAuth must be used within AuthProvider");return t}function sr({label:t="Loading..."}){return c.jsxs("div",{className:"flex items-center gap-3 text-slate-500 py-6",children:[c.jsxs("svg",{className:"animate-spin h-5 w-5",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[c.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),c.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"})]}),c.jsx("span",{children:t})]})}function Nn({children:t}){const e=Ge(ne),[n,r]=B.useState(!1),[s,i]=B.useState(e.currentUser);return B.useEffect(()=>{const o=Mn(e,l=>{i(l),r(!0)});return()=>o()},[e]),n?s?c.jsx(c.Fragment,{children:t}):c.jsx(fr,{to:"/login",replace:!0}):c.jsx("div",{className:"max-w-xl mx-auto p-6",children:c.jsx(sr,{label:"Checking authentication…"})})}function $O(){var l;const t=Ge(ne),e=Fe(ne),[n,r]=k.useState(!0),[s,i]=k.useState(null),o=(l=t.currentUser)==null?void 0:l.uid;return k.useEffect(()=>{let u=!0;async function d(){if(!o){i(null),r(!1);return}r(!0);try{const f=G(e,"users",o),p=await be(f);if(p.exists()){if(!u)return;i(p.data()||{})}else{await Et(f,{createdAt:ke()},{merge:!0});const m=await be(f);if(!u)return;i(m.data()||{})}}finally{r(!1)}}return d(),()=>{u=!1}},[e,o]),{loading:n,profile:s,uid:o}}function BO(t){return t?!!(t.displayName&&String(t.displayName).trim().length>1):!1}function Jt({children:t}){const e=Ge(ne),{loading:n,profile:r}=$O(),[s,i]=B.useState(!1),o=e.currentUser,l=Vn();if(k.useEffect(()=>{const f=Mn(e,()=>i(!0));return()=>f()},[e]),!s||n)return c.jsx("div",{className:"max-w-xl mx-auto p-6",children:c.jsx(sr,{label:"Loading your profile…"})});if(!o)return c.jsx(fr,{to:"/login",replace:!0});const u=BO(r),d=l.pathname==="/welcome";return!u&&!d?c.jsx(fr,{to:"/welcome",replace:!0}):u&&d?c.jsx(fr,{to:"/dashboard",replace:!0}):c.jsx(c.Fragment,{children:t})}function zO({label:t="Checking admin access…"}){return c.jsx("div",{className:"max-w-xl mx-auto p-6 text-slate-700",children:t})}function Ys({children:t}){const e=Ge(ne),n=Fe(ne),[r,s]=B.useState(!1),[i,o]=B.useState(null),[l,u]=B.useState(null);return B.useEffect(()=>{const d=Mn(e,async f=>{if(s(!0),!f){o(!1);return}try{const p=await be(G(n,"admins",f.uid));o(p.exists())}catch(p){u((p==null?void 0:p.message)||String(p)),o(!1)}});return()=>d()},[e,n]),!r||i===null?c.jsx(zO,{}):e.currentUser?i?c.jsx(c.Fragment,{children:t}):c.jsx(fr,{to:"/dashboard",replace:!0}):c.jsx(fr,{to:"/login",replace:!0})}function qO({label:t="Checking access…"}){return c.jsx("div",{className:"max-w-xl mx-auto p-6 text-slate-700",children:t})}function Uh({children:t}){const{slug:e}=Ti(),n=e,r=Ge(ne),s=Fe(ne),[i,o]=B.useState(!1),[l,u]=B.useState(null);return B.useEffect(()=>{const d=Mn(r,async f=>{if(o(!0),!f||!n){u(!1);return}try{if((await be(G(s,"admins",f.uid))).exists()){u(!0);return}const m=await be(G(s,`groups/${n}/groupAdmins/${f.uid}`));u(m.exists())}catch{u(!1)}});return()=>d()},[r,s,n]),!i||l===null?c.jsx(qO,{}):l?c.jsx(c.Fragment,{children:t}):c.jsx(fr,{to:"/dashboard",replace:!0})}function ZI({group:t,isMember:e,footer:n}){const r=t.name||t.title||hw(t.id),s=t.description||"",i=t.parent?`Parent: ${hw(t.parent)}`:null;return c.jsxs("div",{className:"rounded-xl border border-border bg-card p-4 flex flex-col justify-between shadow-sm",children:[c.jsxs("div",{children:[c.jsxs("div",{className:"flex items-start justify-between gap-2",children:[c.jsx("h3",{className:"text-lg font-semibold text-accent",children:r}),e&&c.jsx("span",{className:"px-2 py-0.5 rounded-full text-xs bg-emerald-100 text-emerald-700 border border-emerald-200",children:"Member"})]}),i&&c.jsx("p",{className:"text-xs text-text2 mt-1",children:i}),s&&c.jsx("p",{className:"text-sm text-text2 mt-3",children:s})]}),c.jsxs("div",{className:"mt-4 flex items-center gap-2",children:[e?c.jsx(we,{to:`/groups/${t.id}`,className:"inline-flex items-center rounded-lg bg-slate-900 text-white px-3 py-1.5 text-sm hover:bg-slate-800",children:"View"}):c.jsx("button",{type:"button",disabled:!0,className:"inline-flex items-center rounded-lg bg-slate-200 text-slate-500 px-3 py-1.5 text-sm cursor-not-allowed",title:"Join this group to view",children:"View"}),n]})]})}function hw(t){return t.replace(/[-_]/g," ").replace(/\b\w/g,e=>e.toUpperCase())}function WO({groupId:t,className:e=""}){var m;const n=k.useMemo(()=>Ge(ne),[]),r=k.useMemo(()=>Fe(ne),[]),[s,i]=k.useState("checking"),[o,l]=k.useState(((m=n.currentUser)==null?void 0:m.uid)??null),[u,d]=k.useState(!1);k.useEffect(()=>{const y=Mn(n,x=>{l((x==null?void 0:x.uid)??null)});return()=>y()},[n]),k.useEffect(()=>{let y=!0;async function x(){if(!o){i("none");return}try{const A=await be(G(r,`users/${o}/memberships/${t}`));if(!y)return;if(A.exists()){i("member");return}const b=fe(r,`users/${o}/memberships`),E=Ye(b,cn("groupId","==",t)),v=await et(E);if(!y)return;if(!v.empty){i("member");return}const w=await be(G(r,`users/${o}/membershipRequests/${t}`));if(!y)return;i(w.exists()?"pending":"none")}catch(A){console.warn("Unable to determine membership status; defaulting to 'none'.",A),y&&i("none")}}return x(),()=>{y=!1}},[r,o,t]);async function f(){if(o){d(!0);try{await Et(G(r,`users/${o}/membershipRequests/${t}`),{groupId:t,requestedAt:ke()},{merge:!0}),i("pending");try{await Et(G(r,`groups/${t}/membershipRequests/${o}`),{uid:o,requestedAt:ke()},{merge:!0})}catch(y){console.warn("Could not mirror to group joinRequests; ensure rules allow create.",y)}}finally{d(!1)}}}async function p(){if(o){d(!0);try{await Ot(G(r,`users/${o}/membershipRequests/${t}`));try{await Ot(G(r,`groups/${t}/membershipRequests/${o}`))}catch{}i("none")}finally{d(!1)}}}return s==="checking"?c.jsx("button",{className:`text-xs px-3 py-1.5 rounded-lg border border-border bg-muted text-text2 ${e}`,disabled:!0,children:"Checking…"}):s==="member"?c.jsx("button",{className:`text-xs px-3 py-1.5 rounded-lg border border-border bg-muted text-text2 ${e}`,disabled:!0,children:"Member"}):s==="pending"?c.jsx("button",{onClick:p,className:`text-xs px-3 py-1.5 rounded-lg bg-slate-100 text-slate-900 hover:bg-slate-200 disabled:opacity-60 ${e}`,disabled:u,title:"Click to cancel your join request",children:"Pending — Cancel"}):c.jsx("button",{onClick:f,className:`text-xs px-3 py-1.5 rounded-lg bg-slate-100 text-slate-900 hover:bg-slate-200 disabled:opacity-60 ${e}`,disabled:u||!o,title:o?void 0:"Sign in to request",children:"Request to Join"})}function HO(){const t=k.useMemo(()=>Fe(ne),[]),e=Ge(ne),[n,r]=k.useState([]),[s,i]=k.useState(new Set),[o,l]=k.useState(!0);k.useEffect(()=>{let d=!1;async function f(){try{const m=(await et(Ye(fe(t,"groups"),Ln("name")))).docs.map(y=>({id:y.id,...y.data()}));if(d||r(m),e.currentUser){const y=e.currentUser.uid,x=await et(fe(t,`users/${y}/memberships`));d||i(new Set(x.docs.map(A=>A.id)))}}finally{d||l(!1)}}return f(),()=>{d=!0}},[t,e.currentUser]);const u=k.useMemo(()=>n.filter(d=>!s.has(d.id)),[n,s]);return o?c.jsx("div",{className:"container py-8",children:c.jsx("div",{className:"max-w-5xl mx-auto p-6",children:c.jsx(sr,{label:"Loading groups…"})})}):c.jsx("div",{className:"container py-8 md:py-12",children:c.jsxs("div",{className:"max-w-5xl mx-auto",children:[c.jsx("h1",{className:"text-2xl font-semibold text-accent mb-4",children:"Explore Groups"}),u.length>0?c.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:u.map(d=>c.jsx(ZI,{group:d,isMember:!1,footer:c.jsx(WO,{groupId:d.id})},d.id))}):c.jsx("div",{className:"rounded-xl border border-border bg-card p-6",children:c.jsx("p",{className:"text-text2",children:"You’ve already joined all available groups."})})]})})}function GO(){var Hs;const{slug:t=""}=Ti(),e=B.useMemo(()=>Fe(ne),[]),n=Ge(ne),[r,s]=B.useState(null),[i,o]=B.useState(!1),[l,u]=B.useState(!1),[d,f]=B.useState(!0),[p,m]=B.useState([]),[y,x]=B.useState([]),[A,b]=B.useState([]),[E,v]=B.useState(""),[w,R]=B.useState(!1),[D,L]=B.useState(!1),[S,_]=B.useState(null),[I,N]=B.useState([]),[P,j]=B.useState(""),[C,lt]=B.useState(!1),[Tt,Un]=B.useState({}),[Q,$]=B.useState(""),[K,J]=B.useState(""),[_e,he]=B.useState(""),[se,it]=B.useState(null),[It,Ke]=B.useState(""),[Oe,St]=B.useState(""),[z,Z]=B.useState(""),[ge,le]=B.useState(!1),[Se,ce]=B.useState(null),[ee,Je]=B.useState(""),[ve,Ve]=B.useState({}),[ze,yt]=B.useState(""),[Yt,Fn]=B.useState(!1),[Jr,Tr]=B.useState(""),[Pl,dt]=B.useState(!1),ht=((Hs=n.currentUser)==null?void 0:Hs.uid)||null,$n=B.useMemo(()=>y.find(F=>F.uid===ht)||null,[y,ht]),[jl,Pi]=B.useState(!1);B.useEffect(()=>{Pi(!!($n!=null&&$n.muted))},[$n==null?void 0:$n.muted]);const Dl=B.useMemo(()=>Object.values(ve).some(Boolean),[ve]);function qs(F,ie){return[F,ie].sort().join("_")}async function ji(F){try{return(await be(F)).exists()}catch{return!1}}B.useEffect(()=>{let F=!1;async function ie(){try{if(!t)return;try{const ue=await be(G(e,"groups",t));ue.exists()&&!F&&s({id:ue.id,...ue.data()})}catch(ue){console.error("Failed to load group doc",ue)}let ye=!1,oe=!1;const Re=n.currentUser;if(Re){const ue=Re.uid;if(await ji(G(e,"admins",ue)))ye=!0,oe=!0;else if(await ji(G(e,`groups/${t}/groupAdmins/${ue}`)))ye=!0,oe=!0;else if(await ji(G(e,`users/${ue}/memberships/${t}`)))ye=!0;else try{ye=(await et(fe(e,`users/${ue}/memberships`))).docs.some(Oi=>{const Xr=Oi.data();return(Xr==null?void 0:Xr.groupId)===t||(Xr==null?void 0:Xr.groupSlug)===t})}catch(rn){console.warn("Membership scan failed",rn)}}F||(u(oe),o(ye))}finally{F||f(!1)}}return ie(),()=>{F=!0}},[e,n.currentUser,t]),B.useEffect(()=>{if(!i||!t)return;const F=_t(fe(e,`groups/${t}/resources`),oe=>{const Re=oe.docs.map(ue=>{var de,Mt,Ir;return{id:ue.id,title:((de=ue.data())==null?void 0:de.title)||ue.id,url:((Mt=ue.data())==null?void 0:Mt.url)||"#",note:((Ir=ue.data())==null?void 0:Ir.note)||""}});m(Re)}),ie=_t(fe(e,`groups/${t}/members`),oe=>{const Re=oe.docs.map(ue=>({uid:ue.id,...ue.data()}));x(Re)}),ye=_t(Ye(fe(e,`groups/${t}/messages`),Ln("createdAt","asc")),async oe=>{const Re=oe.docs.map(de=>{var Mt,Ir,rn,Oi;return{id:de.id,uid:(Mt=de.data())==null?void 0:Mt.uid,displayName:(Ir=de.data())==null?void 0:Ir.displayName,text:(rn=de.data())==null?void 0:rn.text,createdAt:(Oi=de.data())==null?void 0:Oi.createdAt}}),ue=await Promise.all(Re.map(async de=>{var Mt;try{const rn=((Mt=(await Oc(fe(e,`groups/${t}/messages/${de.id}/replies`))).data())==null?void 0:Mt.count)??0;return{...de,replyCount:Number(rn)}}catch{return{...de,replyCount:0}}}));b(ue)});return()=>{F(),ie(),ye()}},[e,t,i]),B.useEffect(()=>{if(!i||!t||!n.currentUser)return;const F=n.currentUser.uid,ie=_t(Ye(fe(e,`users/${F}/threadReads`),cn("groupId","==",t)),ye=>{const oe={};ye.forEach(Re=>{const ue=Re.data(),de=(ue==null?void 0:ue.messageId)||"";de&&(oe[de]={lastReplyCount:ue.lastReplyCount,lastViewedAt:ue.lastViewedAt})}),Un(oe)});return()=>ie()},[e,t,i,n.currentUser]);async function Ol(F){var oe;F.preventDefault(),ce(null);const ie=Q.trim(),ye=K.trim();if(!ie||!ye){ce("Please enter a title and URL.");return}le(!0);try{await Dr(fe(e,`groups/${t}/resources`),{title:ie,url:ye,note:_e.trim()||"",createdAt:ke(),createdBy:((oe=n.currentUser)==null?void 0:oe.uid)||null}),$(""),J(""),he("")}catch(Re){const ue=(Re==null?void 0:Re.message)||"Could not add resource.";ce(ue)}finally{le(!1)}}async function Bo(){var ye;if(!se)return;ce(null);const F=It.trim(),ie=Oe.trim();if(!F||!ie){ce("Please enter a title and URL.");return}le(!0);try{await mg(G(e,`groups/${t}/resources/${se}`),{title:F,url:ie,note:z.trim()||"",updatedAt:ke(),updatedBy:((ye=n.currentUser)==null?void 0:ye.uid)||null}),it(null),Ke(""),St(""),Z("")}catch(oe){const Re=(oe==null?void 0:oe.message)||"Could not save changes.";ce(Re)}finally{le(!1)}}function jd(F){it(F.id),Ke(F.title),St(F.url),Z(F.note||""),ce(null)}async function Dd(F){if(ce(null),!!window.confirm("Delete this resource?"))try{await Ot(G(e,`groups/${t}/resources/${F}`))}catch(ie){const ye=(ie==null?void 0:ie.message)||"Could not delete resource.";ce(ye)}}async function zo(F){F.preventDefault();const ie=E.trim();if(!(!ie||!n.currentUser)){R(!0);try{await Dr(fe(e,`groups/${t}/messages`),{uid:n.currentUser.uid,displayName:n.currentUser.displayName||"Member",text:ie,createdAt:ke()}),v("")}finally{R(!1)}}}async function Ll(F){window.confirm("Delete this message?")&&await Ot(G(e,`groups/${t}/messages/${F}`))}const ir=B.useRef(null);async function Ws(F){var ye;_(F),L(!0);try{if(n.currentUser){const oe=n.currentUser.uid,Re=await Oc(fe(e,`groups/${t}/messages/${F.id}/replies`)),ue=Number(((ye=Re.data())==null?void 0:ye.count)||0);await Et(G(e,`users/${oe}/threadReads/${t}__${F.id}`),{groupId:t,messageId:F.id,lastReplyCount:ue,lastViewedAt:ke()},{merge:!0})}}catch{}ir.current&&(ir.current(),ir.current=null);const ie=_t(Ye(fe(e,`groups/${t}/messages/${F.id}/replies`),Ln("createdAt","asc")),oe=>{const Re=oe.docs.map(ue=>{const de=ue.data();return{id:ue.id,uid:(de==null?void 0:de.uid)||"",displayName:(de==null?void 0:de.displayName)||void 0,text:(de==null?void 0:de.text)||"",createdAt:de==null?void 0:de.createdAt}});N(Re)});ir.current=ie}function Di(){L(!1),_(null),N([]),ir.current&&(ir.current(),ir.current=null)}async function qo(F){if(F.preventDefault(),!S||!n.currentUser)return;const ie=P.trim();if(ie){lt(!0);try{await Dr(fe(e,`groups/${t}/messages/${S.id}/replies`),{uid:n.currentUser.uid,displayName:n.currentUser.displayName||"Member",text:ie,createdAt:ke()}),j("")}catch(ye){alert(ye&&ye.message||"Could not post reply. Check Firestore rules and your connection.")}finally{lt(!1)}}}const or=B.useMemo(()=>{var ye;const F=(ye=n.currentUser)==null?void 0:ye.uid,ie=ee.trim().toLowerCase();return y.filter(oe=>oe.uid!==F).filter(oe=>{if(!ie)return!0;const Re=(oe.displayName||"").toLowerCase(),ue=(oe.email||"").toLowerCase();return Re.includes(ie)||ue.includes(ie)||oe.uid.toLowerCase().includes(ie)})},[y,ee,n.currentUser]);async function Vl(F){var Re,ue;F.preventDefault(),Tr(""),dt(!1);const ie=(Re=n.currentUser)==null?void 0:Re.uid;if(!ie){Tr("You must be signed in.");return}const ye=ze.trim();if(!ye){Tr("Enter a message.");return}const oe=Object.entries(ve).filter(([,de])=>de).map(([de])=>de);if(oe.length===0){Tr("Select at least one member.");return}Fn(!0);try{for(const de of oe){const Mt=qs(ie,de);await Dr(fe(e,`groups/${t}/directMessages/${Mt}/messages`),{text:ye,from:ie,to:de,displayName:((ue=n.currentUser)==null?void 0:ue.displayName)||"Member",createdAt:ke()}),await Et(G(e,`groups/${t}/directMessages/${Mt}`),{users:[ie,de].sort(),lastText:ye,lastAt:ke(),lastSender:ie},{merge:!0})}yt(""),Ve({}),dt(!0),window.setTimeout(()=>dt(!1),2e3)}catch(de){const Mt=(de==null?void 0:de.message)||"Failed to send DM(s).";Tr(Mt)}finally{Fn(!1)}}return d?c.jsx("div",{className:"container py-8",children:c.jsx("div",{className:"max-w-5xl mx-auto p-6",children:c.jsx(sr,{label:"Loading group…"})})}):r?i?c.jsx("div",{className:"container py-8 md:py-12",children:c.jsxs("div",{className:"max-w-5xl mx-auto",children:[c.jsxs("div",{className:"flex items-start justify-between gap-3",children:[c.jsxs("div",{children:[c.jsx("h1",{className:"text-2xl font-semibold text-accent",children:r.name||t}),l&&c.jsx(we,{to:`/admin/groups/${t}/edit`,className:"inline-flex items-center gap-1 rounded-lg border border-border px-3 py-1.5 text-sm hover:bg-muted",children:"Edit settings"}),r.description&&c.jsx("p",{className:"text-sm text-text2 mt-2",children:r.description})]}),ht&&c.jsx("div",{className:"mt-1",children:c.jsxs("label",{className:"inline-flex items-center gap-2 text-sm",children:[c.jsx("input",{type:"checkbox",checked:jl,onChange:async F=>{const ie=F.target.checked;Pi(ie);try{await Et(G(e,`groups/${t}/members/${ht}`),{muted:ie},{merge:!0})}catch{Pi(!ie),alert("Could not update notification setting.")}}}),c.jsx("span",{children:"Mute notifications for this group"})]})})]}),c.jsxs("section",{className:"mt-6 rounded-xl border border-border bg-card p-5",children:[c.jsx("div",{className:"flex items-center justify-between",children:c.jsx("h2",{className:"text-lg font-semibold text-accent",children:"Resources"})}),l&&c.jsxs("form",{onSubmit:Ol,className:"mt-3 grid gap-2 sm:grid-cols-6",children:[c.jsx("input",{className:"sm:col-span-2 rounded-lg border border-border bg-background px-3 py-2 text-sm outline-none",placeholder:"Title",value:Q,onChange:F=>$(F.target.value)}),c.jsx("input",{className:"sm:col-span-3 rounded-lg border border-border bg-background px-3 py-2 text-sm outline-none",placeholder:"https://...",value:K,onChange:F=>J(F.target.value)}),c.jsx("div",{className:"sm:col-span-6",children:c.jsx("textarea",{className:"w-full rounded-lg border border-border bg-background px-3 py-2 text-sm outline-none",placeholder:"Optional note (description)…",value:_e,onChange:F=>he(F.target.value)})}),c.jsxs("div",{className:"sm:col-span-6",children:[c.jsx("button",{className:"rounded-lg bg-[#919FAA] hover:opacity-90 px-4 py-2 text-white text-sm",disabled:ge,children:ge?"Saving…":"Add resource"}),Se&&c.jsx("span",{className:"ml-3 text-sm text-rose-700",children:Se})]})]}),c.jsxs("ul",{className:"mt-3 divide-y divide-border",children:[p.map(F=>c.jsxs("li",{className:"py-2 flex items-center justify-between gap-3",children:[c.jsxs("div",{children:[c.jsx("a",{href:F.url,target:"_blank",rel:"noreferrer",className:"text-sm text-accent underline underline-offset-2 break-all",children:F.title}),F.note&&c.jsx("p",{className:"text-xs text-text2 mt-1",children:F.note})]}),l&&c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("button",{type:"button",onClick:()=>jd(F),className:"text-xs rounded-lg border border-border px-2 py-1 hover:bg-muted",children:"Edit"}),c.jsx("button",{type:"button",onClick:()=>Dd(F.id),className:"text-xs rounded-lg border border-rose-300 text-rose-700 px-2 py-1 hover:bg-rose-50",children:"Remove"})]})]},F.id)),p.length===0&&c.jsx("li",{className:"py-2 text-sm text-text2",children:"No resources yet."})]}),se&&c.jsxs("form",{onSubmit:F=>{F.preventDefault(),Bo()},className:"mt-3 grid gap-2 sm:grid-cols-6",children:[c.jsx("input",{className:"sm:col-span-2 rounded-lg border border-border bg-background px-3 py-2 text-sm outline-none",placeholder:"Title",value:It,onChange:F=>Ke(F.target.value)}),c.jsx("input",{className:"sm:col-span-3 rounded-lg border border-border bg-background px-3 py-2 text-sm outline-none",placeholder:"https://...",value:Oe,onChange:F=>St(F.target.value)}),c.jsx("div",{className:"sm:col-span-6",children:c.jsx("textarea",{className:"w-full rounded-lg border border-border bg-background px-3 py-2 text-sm outline-none",placeholder:"Optional note (description)…",value:z,onChange:F=>Z(F.target.value)})}),c.jsxs("div",{className:"sm:col-span-6 flex items-center gap-2",children:[c.jsx("button",{className:"rounded-lg bg-[#919FAA] hover:opacity-90 px-4 py-2 text-white text-sm",disabled:ge,children:ge?"Saving…":"Save changes"}),c.jsx("button",{type:"button",onClick:()=>{it(null),Ke(""),St(""),Z("")},className:"text-sm rounded-lg border border-border px-3 py-2 hover:bg-muted",children:"Cancel"}),Se&&c.jsx("span",{className:"text-sm text-rose-700",children:Se})]})]})]}),c.jsxs("section",{className:"mt-6 rounded-xl border border-border bg-card p-5 relative",children:[c.jsx("h2",{className:"text-lg font-semibold text-accent",children:"Messages"}),c.jsx("div",{className:"mt-3 space-y-2 max-h-80 overflow-auto pr-1",children:A.length>0?A.map(F=>{var Re,ue;const ie=((Re=Tt[F.id])==null?void 0:Re.lastReplyCount)||0,ye=F.replyCount||0,oe=ye>ie;return c.jsx("div",{className:"rounded-lg border border-slate-700 px-3 py-2",children:c.jsxs("div",{className:"flex items-start justify-between gap-2",children:[c.jsxs("div",{children:[c.jsx("p",{className:"text-sm",children:c.jsx("span",{className:"font-medium",children:F.displayName||"Member"})}),c.jsx("p",{className:"text-sm text-slate-200 whitespace-pre-wrap",children:F.text})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[oe&&ye>0&&c.jsx("span",{className:"text-[10px] px-2 py-0.5 rounded-full font-medium",style:{backgroundColor:"#919FAA",color:"#ffffff"},children:"New replies"}),c.jsx("button",{onClick:()=>{Ws(F)},className:"text-xs rounded-lg border border-border px-2 py-1 hover:bg-muted",title:"View thread / Reply",children:ye>0?`View thread (${ye})`:"Reply"}),(l||((ue=n.currentUser)==null?void 0:ue.uid)===F.uid)&&c.jsx("button",{onClick:()=>{Ll(F.id)},className:"text-xs rounded-lg border border-rose-300 text-rose-700 px-2 py-1 hover:bg-rose-50 h-fit",children:"Delete"})]})]})},F.id)}):c.jsx("p",{className:"text-sm text-text2",children:"No messages yet."})}),c.jsxs("form",{onSubmit:zo,className:"mt-3 flex gap-2",children:[c.jsx("input",{type:"text",value:E,onChange:F=>v(F.target.value),placeholder:"Write a message…",className:"flex-1 rounded-lg border border-border bg-background px-3 py-2 text-sm outline-none"}),c.jsx("button",{type:"submit",disabled:w||!E.trim(),className:"rounded-lg bg-slate-900 text-white px-3 py-1.5 text-sm hover:bg-slate-800 disabled:opacity-60",children:w?"Sending…":"Send"})]}),D&&S&&c.jsxs("div",{className:"fixed inset-0 z-50",children:[c.jsx("button",{className:"absolute inset-0 bg-black/60",onClick:Di,"aria-label":"Close thread overlay"}),c.jsxs("div",{className:"absolute right-0 top-0 h-full w-full sm:w-[28rem] bg-slate-900 text-white border-l border-slate-800 shadow-xl p-4 overflow-y-auto",children:[c.jsxs("div",{className:"flex items-start justify-between gap-2",children:[c.jsxs("div",{className:"pr-6",children:[c.jsx("p",{className:"text-sm",children:c.jsx("span",{className:"font-medium",children:S.displayName||"Member"})}),c.jsx("p",{className:"text-sm text-slate-200 whitespace-pre-wrap",children:S.text})]}),c.jsx("button",{onClick:Di,className:"p-2 rounded-md hover:bg-muted","aria-label":"Close thread",children:"✕"})]}),c.jsx("div",{className:"mt-4 space-y-2",children:I.length===0?c.jsx("p",{className:"text-sm text-slate-200",children:"No replies yet."}):I.map(F=>c.jsxs("div",{className:"rounded-lg border border-slate-700 px-3 py-2",children:[c.jsx("p",{className:"text-sm",children:c.jsx("span",{className:"font-medium",children:F.displayName||"Member"})}),c.jsx("p",{className:"text-sm text-slate-200 whitespace-pre-wrap",children:F.text})]},F.id))}),c.jsxs("form",{onSubmit:qo,className:"mt-3 flex gap-2 sticky bottom-2 pt-2 bg-slate-900",children:[c.jsx("input",{type:"text",value:P,onChange:F=>j(F.target.value),placeholder:"Write a reply…",className:"flex-1 rounded-lg border border-slate-700 bg-slate-800 px-3 py-2 text-sm outline-none text-white placeholder:text-slate-400"}),c.jsx("button",{type:"submit",disabled:C||!P.trim(),className:"rounded-lg bg-slate-100 text-slate-900 px-3 py-1.5 text-sm hover:bg-white disabled:opacity-60",children:C?"Sending…":"Reply"})]})]})]})]}),c.jsxs("section",{className:"mt-6 rounded-xl border border-border bg-card p-5",children:[c.jsx("h2",{className:"text-lg font-semibold text-accent",children:"Direct Messages"}),c.jsx("p",{className:"text-sm text-text2 mt-1",children:"Select one or more members and send a private message."}),c.jsxs("div",{className:"mt-3 grid gap-2 sm:grid-cols-6",children:[c.jsx("input",{type:"text",value:ee,onChange:F=>Je(F.target.value),placeholder:"Search members…",className:"sm:col-span-3 rounded-lg border border-border bg-background px-3 py-2 text-sm outline-none","aria-label":"Filter members for DM"}),c.jsx("div",{className:"sm:col-span-3 max-h-48 overflow-auto rounded-lg border border-border bg-background p-2",children:or.length===0?c.jsx("p",{className:"text-xs text-text2",children:"No members to message."}):c.jsx("ul",{className:"space-y-1",children:or.map(F=>c.jsxs("li",{className:"flex items-center gap-2",children:[c.jsx("input",{id:`dm-${F.uid}`,type:"checkbox",checked:!!ve[F.uid],onChange:ie=>Ve(ye=>({...ye,[F.uid]:ie.target.checked})),className:"h-4 w-4"}),c.jsxs("label",{htmlFor:`dm-${F.uid}`,className:"text-sm",children:[F.displayName||F.uid,F.email?` • ${F.email}`:""]})]},F.uid))})})]}),c.jsxs("form",{onSubmit:Vl,className:"mt-3 grid gap-2 sm:grid-cols-6",children:[c.jsx("textarea",{value:ze,onChange:F=>yt(F.target.value),placeholder:"Write a private message…",className:"sm:col-span-5 min-h-[3.25rem] rounded-lg border border-border bg-background px-3 py-2 text-sm outline-none"}),c.jsx("div",{className:"sm:col-span-1",children:c.jsx("button",{type:"submit",disabled:Yt||!Dl||!ze.trim(),className:"w-full rounded-lg bg-slate-900 text-white px-4 py-2 text-sm hover:bg-slate-800 disabled:opacity-60",title:Dl?void 0:"Select at least one member",children:Yt?"Sending…":"Send DM"})})]}),Jr&&c.jsx("p",{className:"mt-2 text-sm text-rose-700",children:Jr}),Pl&&c.jsx("p",{className:"mt-2 text-sm text-emerald-700",children:"Message sent."})]}),c.jsxs("section",{className:"mt-6 rounded-xl border border-border bg-card p-5",children:[c.jsx("h2",{className:"text-lg font-semibold text-accent",children:"Team"}),y.length>0?c.jsx("ul",{className:"mt-3 grid grid-cols-1 sm:grid-cols-2 gap-2",children:y.map(F=>c.jsxs("li",{className:"rounded-lg border border-border px-3 py-2",children:[c.jsx("p",{className:"text-sm",children:F.displayName||F.uid}),F.role&&c.jsx("p",{className:"text-xs text-text2",children:F.role}),F.email&&c.jsx("p",{className:"text-xs text-text2",children:F.email}),"muted"in F&&c.jsx("p",{className:"text-[11px] text-text2 mt-1",children:F.muted?"Muted":"Notifications on"})]},F.uid))}):c.jsx("p",{className:"text-sm text-text2 mt-2",children:"No members are listed for this group yet."})]})]})}):c.jsx("div",{className:"container py-8",children:c.jsxs("div",{className:"max-w-3xl mx-auto rounded-xl border border-border bg-card p-6",children:[c.jsx("h1",{className:"text-xl font-semibold text-accent mb-2",children:r.name||t}),c.jsx("p",{className:"text-sm text-text2 mb-4",children:"Membership is required to view this group."}),c.jsx("p",{className:"text-sm text-text2",children:"Request to join from the Explore page."})]})}):c.jsx("div",{className:"container py-8",children:c.jsx("div",{className:"max-w-5xl mx-auto p-6",children:c.jsx("p",{className:"text-text2",children:"Group not found."})})})}const eS="/assets/Header_Logo-CWkkS3_r.png";function KO(){const[t,e]=k.useState(!1);return k.useEffect(()=>{const n=window.matchMedia&&window.matchMedia("(display-mode: standalone)"),r=navigator.standalone===!0,s=()=>e(!!(n&&n.matches||r));return s(),n&&n.addEventListener&&n.addEventListener("change",s),()=>{n&&n.removeEventListener&&n.removeEventListener("change",s)}},[]),t}function QO(){const t=KO();return c.jsxs(c.Fragment,{children:[t&&c.jsx("style",{children:`
          [data-app-header]{
            padding-top: env(safe-area-inset-top);
            padding-top: constant(safe-area-inset-top);
          }
        `}),c.jsx("header",{"data-app-header":!0,className:"w-full border-b border-border bg-[var(--bg)]",children:c.jsx("div",{className:"container py-2 md:py-3 flex items-center",children:c.jsx(we,{to:"/login","aria-label":"Immanuel Members Home",className:"shrink-0",children:c.jsx("img",{src:eS,alt:"Immanuel Downtown",className:"h-14 sm:h-12 md:h-14 lg:h-16 w-auto object-contain"})})})})]})}function fw(t){return t&&t.trim().split(/\s+/)[0]||null}function YO(){const[t,e]=k.useState(!1);return k.useEffect(()=>{const n=window.matchMedia&&window.matchMedia("(display-mode: standalone)"),r=navigator.standalone===!0,s=()=>e(!!(n&&n.matches||r));return s(),n&&n.addEventListener&&n.addEventListener("change",s),()=>{n&&n.removeEventListener&&n.removeEventListener("change",s)}},[]),t}function JO(){const{user:t,isAdmin:e}=Rd(),n=Vn(),[r,s]=k.useState(""),[i,o]=k.useState(!1),l=YO(),u="inline-flex items-center justify-center min-h-[2.25rem] px-3 py-2 rounded-lg text-sm leading-tight text-center whitespace-normal md:whitespace-nowrap",d=f=>`${u} ${f?"bg-muted text-accent":"text-text hover:text-accent"}`;return k.useEffect(()=>{let f=!0;async function p(){if(!t){f&&s("");return}const m=fw(t.displayName);if(m){f&&s(m);return}try{const y=await be(G(Ig,"users",t.uid));if(y.exists()){const x=y.data(),A=(x==null?void 0:x.name)||[x==null?void 0:x.firstName,x==null?void 0:x.lastName].filter(Boolean).join(" ").trim(),b=fw(A);if(b){f&&s(b);return}}}catch{}f&&s("there")}return p(),()=>{f=!1}},[t]),k.useEffect(()=>{o(!1)},[n.pathname]),c.jsxs(c.Fragment,{children:[l&&c.jsx("style",{children:`
          [data-app-header] {
            padding-top: env(safe-area-inset-top);
            /* Safari < 11.2 fallback (rare now) */
            padding-top: constant(safe-area-inset-top);
          }
        `}),c.jsxs("header",{"data-app-header":!0,className:"w-full border-b border-border bg-[var(--bg)]",children:[c.jsxs("div",{className:"container py-2 md:py-3 grid grid-cols-2 md:grid-cols-3 grid-rows-2 md:grid-rows-1 items-center gap-x-3 gap-y-2",children:[c.jsx("div",{className:"col-start-1 row-start-1 md:col-span-1 flex items-center min-w-0",children:c.jsx(we,{to:"/dashboard","aria-label":"Immanuel Members Home",className:"shrink-0",children:c.jsx("img",{src:eS,alt:"Immanuel Downtown",className:"h-14 sm:h-12 md:h-14 lg:h-16 w-auto object-contain"})})}),c.jsx("div",{className:"col-start-2 row-start-1 md:hidden flex justify-end",children:c.jsx("button",{"aria-label":"Open menu","aria-expanded":i,className:"p-2 rounded-md border border-border/70 bg-surface/40 hover:bg-surface/60 active:scale-[0.98] transition",onClick:()=>o(f=>!f),children:c.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none","aria-hidden":"true",children:c.jsx("path",{d:"M4 6h16M4 12h16M4 18h16",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})})})}),c.jsxs("nav",{className:"col-span-2 row-start-2 md:row-start-1 md:col-span-1 flex justify-center gap-4 text-sm",children:[c.jsx(mu,{to:"/dashboard",className:({isActive:f})=>d(f),children:"Dashboard"}),c.jsx(mu,{to:"/sunday-resources",className:({isActive:f})=>d(f),children:"Sunday White Papers"}),c.jsx(mu,{to:"/groups",className:({isActive:f})=>d(f),children:"Groups"}),e&&c.jsx(mu,{to:"/admin",className:({isActive:f})=>d(f),children:"Admin"})]}),c.jsx("div",{className:"hidden md:flex md:col-start-3 md:row-start-1 justify-end items-center gap-2",children:t?c.jsxs(c.Fragment,{children:[c.jsxs("span",{className:"text-sm text-text2",children:["Hi",r?`, ${r}`:""]}),c.jsx(we,{to:"/profile",className:"btn btn-outline btn-md",children:"Profile"}),c.jsx("button",{className:"btn btn-outline btn-md",onClick:()=>Hf(ul),children:"Sign out"})]}):n.pathname!=="/login"&&c.jsx(we,{to:"/login",className:"btn btn-outline btn-md",children:"Sign in"})})]}),i&&c.jsxs("div",{className:"fixed inset-0 z-50",children:[c.jsx("button",{"aria-label":"Close menu",className:"absolute inset-0 bg-black/40",onClick:()=>o(!1)}),c.jsxs("div",{className:"absolute top-2 right-2 w-64 rounded-xl border border-border bg-[var(--bg)] shadow-xl p-3",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("div",{className:"text-sm text-text2",children:"Menu"}),c.jsx("button",{className:"p-2 rounded-md hover:bg-surface/60",onClick:()=>o(!1),"aria-label":"Close",children:c.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",children:c.jsx("path",{d:"M6 6l12 12M18 6l-12 12",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})})})]}),c.jsx("div",{className:"mt-2 border-t border-border/60 pt-2 grid gap-2",children:t?c.jsxs(c.Fragment,{children:[c.jsx(we,{to:"/profile",className:"btn btn-outline btn-sm",onClick:()=>o(!1),children:"Profile"}),e&&c.jsx(we,{to:"/admin",className:"btn btn-outline btn-sm",onClick:()=>o(!1),children:"Admin"}),c.jsx("button",{className:"btn btn-outline btn-sm",onClick:()=>{o(!1),Hf(ul)},children:"Sign out"})]}):n.pathname!=="/login"&&c.jsx(we,{to:"/login",className:"btn btn-outline btn-sm",onClick:()=>o(!1),children:"Sign in"})})]})]})]})]})}function XO(){const t=Ge(ne),e=Yr(),[n,r]=k.useState(""),[s,i]=k.useState(""),[o,l]=k.useState(!1),[u,d]=k.useState(!1),[f,p]=k.useState(!1),[m,y]=k.useState(null);k.useEffect(()=>Mn(t,E=>{E&&e("/dashboard",{replace:!0})}),[t,e]);async function x(){y(null),d(!0);try{const b=new Cn;await km(t,b),e("/dashboard",{replace:!0})}catch{y("Google sign-in was cancelled or failed.")}finally{d(!1)}}async function A(b){if(b.preventDefault(),y(null),!n||!s){y("Please enter your email and password.");return}p(!0);try{await CE(t,n,s),e("/dashboard",{replace:!0})}catch(E){const v=String((E==null?void 0:E.code)||"");let w="Could not sign in with email and password.";v==="auth/invalid-email"?w="Please enter a valid email address.":(v==="auth/user-not-found"||v==="auth/wrong-password")&&(w="Email or password is incorrect."),y(w)}finally{p(!1)}}return c.jsx("div",{className:"container py-8 md:py-12",children:c.jsxs("div",{className:"mx-auto max-w-md rounded-xl border border-border bg-card p-6 shadow",children:[c.jsx("h1",{className:"text-2xl font-semibold text-accent mb-1",children:"Welcome back"}),c.jsx("p",{className:"text-sm text-text2 mb-6",children:"Sign in to continue."}),m&&c.jsx("div",{className:"mb-4 rounded-lg border border-red-300 bg-red-50 px-3 py-2 text-sm text-red-700",children:m}),c.jsxs("form",{onSubmit:A,className:"grid gap-3 mb-4",children:[c.jsxs("label",{className:"grid gap-1",children:[c.jsx("span",{className:"text-sm",children:"Email"}),c.jsx("input",{type:"email",value:n,onChange:b=>r(b.target.value),placeholder:"you@example.com",autoComplete:"email",className:"rounded-lg border border-border bg-background px-3 py-2 outline-none",required:!0})]}),c.jsxs("label",{className:"grid gap-1",children:[c.jsx("span",{className:"text-sm",children:"Password"}),c.jsxs("div",{className:"flex gap-2",children:[c.jsx("input",{type:o?"text":"password",value:s,onChange:b=>i(b.target.value),placeholder:"••••••••",autoComplete:"current-password",className:"flex-1 rounded-lg border border-border bg-background px-3 py-2 outline-none",required:!0}),c.jsx("button",{type:"button",onClick:()=>l(b=>!b),className:"rounded-lg border border-border px-3 py-2 text-sm",children:o?"Hide":"Show"})]})]}),c.jsx("button",{type:"submit",disabled:f,className:"rounded-lg bg-[#919FAA] hover:opacity-90 px-4 py-2 text-white disabled:opacity-60",children:f?"Signing in…":"Sign in"})]}),c.jsx("button",{type:"button",onClick:x,disabled:u,className:"btn btn-outline w-full",children:u?"Please wait…":"Sign in with Google"}),c.jsx("div",{className:"mt-2",children:c.jsx(we,{to:"/signup",className:"btn btn-outline w-full",children:"Create account"})}),c.jsx("div",{className:"mt-6 text-center",children:c.jsx(we,{to:"/forgot",className:"text-sm text-accent underline underline-offset-2",children:"Forgot password?"})})]})})}function ZO(t){const e=t.trim().split(/\s+/).filter(Boolean);return e.length===0?{firstName:"",lastName:""}:e.length===1?{firstName:e[0],lastName:""}:{firstName:e[0],lastName:e.slice(1).join(" ")}}function eL(){const t=Ge(ne),e=Yr(),[n,r]=k.useState(""),[s,i]=k.useState(""),[o,l]=k.useState(""),[u,d]=k.useState(""),[f,p]=k.useState(""),[m,y]=k.useState(!1),[x,A]=k.useState(null),[b,E]=k.useState(!1);k.useEffect(()=>Mn(t,D=>{D&&e("/dashboard",{replace:!0})}),[t,e]);async function v(R){R.preventDefault(),A(null);const D=n.trim(),L=s.trim();if(!D){A("Please enter your first name.");return}if(!o||!u){A("Please enter an email and password.");return}if(u!==f){A("Passwords do not match.");return}const S=(D+" "+L).trim();E(!0);try{const _=await Bk(t,o,u);_.user&&await kE(_.user,{displayName:S});try{localStorage.setItem("signupName",S),localStorage.setItem("signupFirstName",D),localStorage.setItem("signupLastName",L)}catch{}e("/welcome",{replace:!0,state:{name:S,firstName:D,lastName:L}})}catch(_){const I=String((_==null?void 0:_.code)||"");let N="Could not create account.";I==="auth/email-already-in-use"?N="That email is already in use.":I==="auth/invalid-email"?N="Please enter a valid email address.":I==="auth/weak-password"&&(N="Password should be at least 6 characters."),A(N)}finally{E(!1)}}async function w(){var R;A(null),E(!0);try{const D=new Cn,S=((R=(await km(t,D)).user)==null?void 0:R.displayName)||"",{firstName:_,lastName:I}=ZO(S);try{S&&(localStorage.setItem("signupName",S),localStorage.setItem("signupFirstName",_),localStorage.setItem("signupLastName",I))}catch{}e("/welcome",{replace:!0,state:{name:S,firstName:_,lastName:I}})}catch{A("Google sign-in was cancelled or failed.")}finally{E(!1)}}return c.jsx("div",{className:"container py-8 md:py-12",children:c.jsxs("div",{className:"mx-auto max-w-md rounded-xl border border-border bg-card p-6 shadow",children:[c.jsx("h1",{className:"text-2xl font-semibold text-accent mb-1",children:"Create your account"}),c.jsx("p",{className:"text-sm text-text2 mb-6",children:"Join Immanuel Downtown to access your dashboard and groups."}),x&&c.jsx("div",{className:"mb-4 rounded-lg border border-red-300 bg-red-50 px-3 py-2 text-sm text-red-700",children:x}),c.jsxs("form",{onSubmit:v,className:"grid gap-3",children:[c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[c.jsxs("label",{className:"grid gap-1",children:[c.jsx("span",{className:"text-sm",children:"First name"}),c.jsx("input",{type:"text",value:n,onChange:R=>r(R.target.value),placeholder:"Jordan",autoComplete:"given-name",required:!0,className:"rounded-lg border border-border bg-background px-3 py-2 outline-none"})]}),c.jsxs("label",{className:"grid gap-1",children:[c.jsx("span",{className:"text-sm",children:"Last name"}),c.jsx("input",{type:"text",value:s,onChange:R=>i(R.target.value),placeholder:"Smith",autoComplete:"family-name",className:"rounded-lg border border-border bg-background px-3 py-2 outline-none"})]})]}),c.jsxs("label",{className:"grid gap-1",children:[c.jsx("span",{className:"text-sm",children:"Email"}),c.jsx("input",{type:"email",value:o,onChange:R=>l(R.target.value),placeholder:"you@example.com",autoComplete:"email",required:!0,className:"rounded-lg border border-border bg-background px-3 py-2 outline-none"})]}),c.jsxs("label",{className:"grid gap-1",children:[c.jsx("span",{className:"text-sm",children:"Password"}),c.jsxs("div",{className:"flex gap-2",children:[c.jsx("input",{type:m?"text":"password",value:u,onChange:R=>d(R.target.value),placeholder:"••••••••",autoComplete:"new-password",required:!0,className:"flex-1 rounded-lg border border-border bg-background px-3 py-2 outline-none"}),c.jsx("button",{type:"button",onClick:()=>y(R=>!R),className:"rounded-lg border border-border px-3 py-2 text-sm",children:m?"Hide":"Show"})]})]}),c.jsxs("label",{className:"grid gap-1",children:[c.jsx("span",{className:"text-sm",children:"Confirm password"}),c.jsx("input",{type:m?"text":"password",value:f,onChange:R=>p(R.target.value),placeholder:"••••••••",autoComplete:"new-password",required:!0,className:"rounded-lg border border-border bg-background px-3 py-2 outline-none"})]}),c.jsx("button",{type:"submit",disabled:b,className:"mt-2 rounded-lg bg-accent px-4 py-2 text-white hover:opacity-90 disabled:opacity-60",children:b?"Creating…":"Create account"})]}),c.jsx("div",{className:"mt-4",children:c.jsx("button",{type:"button",onClick:w,disabled:b,className:"w-full rounded-lg border border-border px-4 py-2 text-sm hover:bg-muted disabled:opacity-60",children:"Continue with Google"})}),c.jsxs("div",{className:"mt-4 text-sm text-text2",children:["Already have an account?"," ",c.jsx(we,{to:"/login",className:"text-accent underline underline-offset-2",children:"Sign in"})]})]})})}function tL(){const t=k.useMemo(()=>Fe(ne),[]),{user:e,loading:n}=Rd(),r=(e==null?void 0:e.uid)??null,[s,i]=k.useState(null);if(k.useEffect(()=>{if(!r){i([]);return}const l=Ye(fe(t,`users/${r}/notifications`),Ln("createdAt","desc")),u=_t(l,d=>{const f=d.docs.map(p=>({id:p.id,...p.data()}));i(f.filter(p=>!p.read))},d=>{console.error("Notifications listener error:",(d==null?void 0:d.message)||d),i([])});return()=>u()},[t,r]),s===null||n)return c.jsxs("div",{className:"p-1",children:[c.jsx("h2",{className:"text-xl font-semibold text-accent",children:"Notifications"}),c.jsx("div",{className:"mt-2",children:c.jsx(sr,{label:"Loading notifications…"})})]});async function o(l){if(r)try{await mg(G(t,`users/${r}/notifications/${l}`),{read:!0,readAt:ke()})}catch{}}return c.jsxs("div",{children:[c.jsx("h2",{className:"text-xl font-semibold text-accent",children:"Notifications"}),s.length===0?c.jsx("p",{className:"text-text2 mt-2",children:"You have no new notifications."}):c.jsx("ul",{className:"mt-3 space-y-2",children:s.map(l=>{const u=c.jsxs("div",{className:"flex items-center justify-between gap-2",children:[c.jsxs("div",{children:[c.jsx("p",{className:"text-sm",children:l.text}),l.groupName&&c.jsxs("p",{className:"text-xs text-text2",children:["Group: ",l.groupName]})]}),c.jsx("span",{className:"text-[10px] px-1.5 py-0.5 rounded-full bg-emerald-100 text-emerald-700 border border-emerald-200",children:"new"})]});return c.jsx("li",{className:"rounded-lg border border-border bg-card px-3 py-2 ring-1 ring-emerald-300/40",children:l.href?c.jsx(we,{to:l.href,onClick:()=>o(l.id),className:"block hover:opacity-90",children:u}):c.jsx("button",{onClick:()=>o(l.id),className:"block w-full text-left hover:opacity-90",children:u})},l.id)})})]})}const pw="https://calendar.google.com/calendar/embed?src=immanueldowntown@gmail.com",nL="America/New_York";function rL(){const{isAdmin:t}=Rd(),e=k.useMemo(()=>Ge(ne),[]),n=k.useMemo(()=>Fe(ne),[]),[r,s]=k.useState(!1),i=k.useRef(!1),o=k.useRef(!1),l=k.useRef(new Map),u=k.useRef(new Map);k.useEffect(()=>{let p=!1;const m=[],y=()=>{p||s(i.current||o.current)},x=()=>{l.current.forEach(b=>{try{b()}catch{}}),l.current.clear(),u.current.clear(),i.current=!1,y()};async function A(){const b=e.currentUser;if(!b)return;const E=b.uid;let v=!1;try{v=(await be(G(n,"admins",E))).exists()}catch{v=!1}if(v)try{const w=vr(n,"membershipRequests");m.push(_t(w,R=>{i.current=R.size>0,y()},()=>{i.current=!1,y()}))}catch{i.current=!1,y()}else try{const w=Ye(vr(n,"groupAdmins"),cn(og(),"==",E));m.push(_t(w,R=>{const D=new Set;R.forEach(S=>{var I;const _=(I=S.ref.parent.parent)==null?void 0:I.id;_&&D.add(_)});for(const[S,_]of l.current.entries())if(!D.has(S)){try{_()}catch{}l.current.delete(S),u.current.delete(S)}D.forEach(S=>{if(l.current.has(S))return;const _=fe(n,`groups/${S}/membershipRequests`),I=_t(_,N=>{u.current.set(S,N.size);let P=!1;for(const j of u.current.values())if((j??0)>0){P=!0;break}i.current=P,y()},()=>{u.current.set(S,0);let N=!1;for(const P of u.current.values())if((P??0)>0){N=!0;break}i.current=N,y()});l.current.set(S,I)});let L=!1;for(const S of u.current.values())if((S??0)>0){L=!0;break}i.current=L,y()},()=>{x()}))}catch{x()}if(v){const w=R=>{try{const D=_t(R,L=>{o.current=L.size>0,y()},()=>{});m.push(D)}catch{}};w(Ye(fe(n,"users"),cn("reviewed","==",!1))),w(Ye(fe(n,"users"),cn("status","==","pending"))),w(Ye(fe(n,"users"),cn("needsReview","==",!0)))}}return A(),()=>{p=!0,m.forEach(b=>{try{b()}catch{}}),x()}},[e,n]);const d=`${pw}${pw.includes("?")?"&":"?"}ctz=${encodeURIComponent(nL)}`,f=r?"text-sm px-3 py-1.5 rounded-lg bg-amber-100 text-amber-900 border border-amber-300 hover:bg-amber-200":"text-sm px-3 py-1.5 rounded-lg bg-slate-100 text-slate-900 hover:bg-slate-200";return c.jsxs("div",{className:"container py-8 md:py-10",children:[c.jsx("div",{className:"text-center mb-6",children:c.jsx("h1",{className:"text-2xl md:text-3xl font-semibold",children:"Welcome!"})}),t&&c.jsxs("section",{className:"mb-6 border border-border p-5 rounded-xl flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("h2",{className:"text-xl font-semibold text-accent",children:"Admin Tools"}),c.jsx("p",{className:"text-sm text-text2",children:r?"Attention needed: pending requests or new users.":"You have admin privileges."})]}),c.jsx(we,{to:"/admin/groups",className:f,title:r?"Pending requests or new users need review":"Open Admin Console",children:"Admin Console"})]}),c.jsxs("section",{className:"border border-border p-5 rounded-xl",children:[c.jsx("h2",{className:"text-xl font-semibold text-accent",children:"General Announcements"}),c.jsxs("ul",{className:"mt-3 space-y-2 text-text",children:[c.jsx("li",{children:"• Welcome to the Community Portal. Check your groups for updates. "}),c.jsx("li",{children:'• Notifications are now working. Open your profile and click on "Enable notification" to be kept up to speed on announcements and new resources and communications in your groups.'}),c.jsx("li",{children:"• We are working on getting Direct Messaging working so everyone can communicate easily in one place."}),c.jsx("li",{children:"• We are still in development. If you find bugs, or have features you'd like to see added, send Sam a DM."})]}),c.jsx("div",{className:"mt-6 pt-5 border-t border-border",children:c.jsx("div",{className:"mt-2",children:c.jsx(tL,{})})})]}),c.jsxs("section",{className:"mt-8 border border-border p-5 rounded-xl",children:[c.jsx("h2",{className:"text-xl font-semibold text-accent",children:"Calendar"}),c.jsx("p",{className:"text-text2 text-sm mt-1",children:"Synced from church Google Calendar."}),c.jsx("div",{className:"mt-4 w-full",children:d?c.jsx("iframe",{className:"w-full h-[440px] sm:h-[520px] md:h-[720px] rounded border-0",src:d,title:"Church Calendar",loading:"lazy",referrerPolicy:"no-referrer-when-downgrade"}):c.jsx("div",{className:"w-full h-[440px] sm:h-[520px] md:h-[720px] flex items-center justify-center text-center p-6 text-sm text-text2 rounded bg-surface/50",children:c.jsxs("div",{children:[c.jsx("div",{className:"font-medium text-text mb-1",children:"Calendar not configured"}),c.jsxs("div",{children:["Set ",c.jsx("code",{className:"px-1 py-0.5 rounded bg-surface/50",children:"VITE_GCAL_EMBED_URL"})," in your env. In Google Calendar → ",c.jsx("em",{children:"Settings → Integrate calendar"}),", copy the ",c.jsx("strong",{children:"Embed code"})," ",c.jsx("code",{children:"src"})," URL and paste it there."]})]})})})]})]})}function sL(){const t=Ge(ne),e=k.useMemo(()=>Fe(ne),[]),[n,r]=k.useState(null),[s,i]=k.useState(!0);return k.useEffect(()=>{if(!t.currentUser)return;const o=t.currentUser.uid,l=_t(fe(e,`users/${o}/memberships`),async u=>{const d=u.docs.map(p=>p.id);if(d.length===0){r([]),i(!1);return}const f=await Promise.all(d.map(async p=>{const m=await be(G(e,"groups",p));if(m.exists()){const y=m.data();return{id:m.id,...y}}return null}));r(f.filter(Boolean)),i(!1)});return()=>l()},[t.currentUser,e]),s?c.jsx("div",{className:"container py-8",children:c.jsx("div",{className:"max-w-5xl mx-auto p-6",children:c.jsx(sr,{label:"Loading your groups…"})})}):c.jsx("div",{className:"container py-8 md:py-12",children:c.jsxs("div",{className:"max-w-5xl mx-auto",children:[c.jsx("h1",{className:"text-2xl font-semibold text-accent mb-4",children:"Your Groups"}),n&&n.length>0?c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:n.map(o=>c.jsx(ZI,{group:o,isMember:!0},o.id))}),c.jsx("div",{className:"mt-6",children:c.jsx(we,{to:"/groups/explore",className:"inline-flex rounded-lg border border-border px-3 py-1.5 text-sm hover:bg-muted",children:"Other Available Groups"})})]}):c.jsxs("div",{className:"rounded-xl border border-border bg-card p-6",children:[c.jsx("p",{className:"text-text2",children:"You haven’t joined any groups yet."}),c.jsx(we,{to:"/groups/explore",className:"inline-flex mt-3 rounded-lg bg-slate-900 text-white px-3 py-1.5 text-sm hover:bg-slate-800",children:"View More Groups"})]})]})})}function iL(){return c.jsxs("div",{className:"container py-10",children:[c.jsx("h1",{className:"text-2xl font-semibold text-accent",children:"Forums"}),c.jsx("p",{className:"text-text2 mt-2",children:"Community discussions coming soon."})]})}function oL(){Ge(ne);const t=Fe(ne),[e,n]=k.useState([]),[r,s]=k.useState(""),[i,o]=k.useState([]);k.useEffect(()=>{const p=Ye(vr(t,"resources"),Ln("createdAt","desc"));return _t(p,y=>{n(y.docs.map(x=>({id:x.id,...x.data(),__path:x.ref.path})))})},[t]);const l=k.useMemo(()=>{const p=new Set;return e.forEach(m=>(m.tags||[]).forEach(y=>p.add(y))),Array.from(p).sort()},[e]),u=p=>{o(m=>m.includes(p)?m.filter(y=>y!==p):[...m,p])},d=p=>{try{const m=p!=null&&p.toDate?p.toDate():p instanceof Date?p:null;if(!m)return!1;const y=7*24*60*60*1e3;return Date.now()-m.getTime()<y}catch{return!1}},f=k.useMemo(()=>{const p=r.trim().toLowerCase();return e.filter(m=>{const y=p.length===0||(m.title||"").toLowerCase().includes(p)||(m.description||"").toLowerCase().includes(p)||(m.url||"").toLowerCase().includes(p),x=i.length===0||i.every(A=>(m.tags||[]).includes(A));return y&&x})},[e,r,i]);return c.jsxs("div",{className:"container py-10",children:[c.jsx("h1",{className:"text-2xl font-semibold text-accent",children:"Resources"}),c.jsx("p",{className:"text-text2 mt-2",children:"Documents, links, and media you have access to."}),c.jsxs("div",{className:"mt-6 flex flex-col gap-3",children:[c.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[c.jsx("input",{className:"rounded-lg border border-slate-300 bg-white px-3 py-2 text-sm outline-none",placeholder:"Search by title, description, or URL",value:r,onChange:p=>s(p.target.value)}),i.length>0&&c.jsx("button",{type:"button",className:"rounded-lg border border-slate-300 px-3 py-2 text-sm hover:bg-slate-100",onClick:()=>o([]),children:"Clear tags"})]}),l.length>0&&c.jsx("div",{className:"flex flex-wrap gap-2",children:l.map(p=>c.jsxs("button",{type:"button",onClick:()=>u(p),className:`text-xs rounded-full px-3 py-1 border ${i.includes(p)?"border-slate-700 bg-slate-800 text-white":"border-slate-300 bg-white text-slate-700 hover:bg-slate-50"}`,"aria-pressed":i.includes(p),children:["#",p]},p))}),c.jsxs("ul",{className:"divide-y divide-slate-200 rounded-2xl border border-slate-200 bg-white/70",children:[f.map(p=>c.jsx("li",{className:"p-4 flex items-start justify-between gap-3",children:c.jsxs("div",{className:"min-w-0",children:[c.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[c.jsx("a",{href:p.url,target:"_blank",rel:"noreferrer",className:"text-sm text-accent underline underline-offset-2 break-all",children:p.title||p.url}),d(p.createdAt)&&c.jsx("span",{className:"text-[10px] uppercase tracking-wide rounded-full bg-green-100 text-green-800 px-2 py-0.5",children:"New"})]}),p.description&&c.jsx("p",{className:"mt-1 text-sm text-slate-600 whitespace-pre-wrap break-words",children:p.description}),p.tags&&p.tags.length>0&&c.jsx("div",{className:"mt-2 flex flex-wrap gap-1.5",children:p.tags.map(m=>c.jsxs("button",{type:"button",onClick:()=>u(m),className:`text-[11px] rounded-full px-2.5 py-1 border ${i.includes(m)?"border-slate-700 bg-slate-800 text-white":"border-slate-300 bg-white text-slate-700 hover:bg-slate-50"}`,"aria-pressed":i.includes(m),title:`Filter by #${m}`,children:["#",m]},m))})]})},p.__path||p.id)),f.length===0&&c.jsx("li",{className:"p-4 text-sm text-slate-600",children:"No resources match your filters."})]})]})]})}function aL(){return c.jsxs("div",{className:"container py-10",children:[c.jsx("h1",{className:"text-2xl font-semibold text-accent",children:"Events"}),c.jsx("p",{className:"text-text2 mt-2",children:"Calendar and upcoming gatherings."})]})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lL="type.googleapis.com/google.protobuf.Int64Value",uL="type.googleapis.com/google.protobuf.UInt64Value";function tS(t,e){const n={};for(const r in t)t.hasOwnProperty(r)&&(n[r]=e(t[r]));return n}function Vc(t){if(t==null)return null;if(t instanceof Number&&(t=t.valueOf()),typeof t=="number"&&isFinite(t)||t===!0||t===!1||Object.prototype.toString.call(t)==="[object String]")return t;if(t instanceof Date)return t.toISOString();if(Array.isArray(t))return t.map(e=>Vc(e));if(typeof t=="function"||typeof t=="object")return tS(t,e=>Vc(e));throw new Error("Data cannot be encoded in JSON: "+t)}function Co(t){if(t==null)return t;if(t["@type"])switch(t["@type"]){case lL:case uL:{const e=Number(t.value);if(isNaN(e))throw new Error("Data cannot be decoded from JSON: "+t);return e}default:throw new Error("Data cannot be decoded from JSON: "+t)}return Array.isArray(t)?t.map(e=>Co(e)):typeof t=="function"||typeof t=="object"?tS(t,e=>Co(e)):t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sg="functions";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mw={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class dn extends nr{constructor(e,n,r){super(`${Sg}/${e}`,n||""),this.details=r,Object.setPrototypeOf(this,dn.prototype)}}function cL(t){if(t>=200&&t<300)return"ok";switch(t){case 0:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 500:return"internal";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}function Mc(t,e){let n=cL(t),r=n,s;try{const i=e&&e.error;if(i){const o=i.status;if(typeof o=="string"){if(!mw[o])return new dn("internal","internal");n=mw[o],r=o}const l=i.message;typeof l=="string"&&(r=l),s=i.details,s!==void 0&&(s=Co(s))}}catch{}return n==="ok"?null:new dn(n,r,s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dL{constructor(e,n,r,s){this.app=e,this.auth=null,this.messaging=null,this.appCheck=null,this.serverAppAppCheckToken=null,an(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.auth=n.getImmediate({optional:!0}),this.messaging=r.getImmediate({optional:!0}),this.auth||n.get().then(i=>this.auth=i,()=>{}),this.messaging||r.get().then(i=>this.messaging=i,()=>{}),this.appCheck||s==null||s.get().then(i=>this.appCheck=i,()=>{})}async getAuthToken(){if(this.auth)try{const e=await this.auth.getToken();return e==null?void 0:e.accessToken}catch{return}}async getMessagingToken(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return await this.messaging.getToken()}catch{return}}async getAppCheckToken(e){if(this.serverAppAppCheckToken)return this.serverAppAppCheckToken;if(this.appCheck){const n=e?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return n.error?null:n.token}return null}async getContext(e){const n=await this.getAuthToken(),r=await this.getMessagingToken(),s=await this.getAppCheckToken(e);return{authToken:n,messagingToken:r,appCheckToken:s}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mp="us-central1",hL=/^data: (.*?)(?:\n|$)/;function fL(t){let e=null;return{promise:new Promise((n,r)=>{e=setTimeout(()=>{r(new dn("deadline-exceeded","deadline-exceeded"))},t)}),cancel:()=>{e&&clearTimeout(e)}}}class pL{constructor(e,n,r,s,i=mp,o=(...l)=>fetch(...l)){this.app=e,this.fetchImpl=o,this.emulatorOrigin=null,this.contextProvider=new dL(e,n,r,s),this.cancelAllRequests=new Promise(l=>{this.deleteService=()=>Promise.resolve(l())});try{const l=new URL(i);this.customDomain=l.origin+(l.pathname==="/"?"":l.pathname),this.region=mp}catch{this.customDomain=null,this.region=i}}_delete(){return this.deleteService()}_url(e){const n=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${n}/${this.region}/${e}`:this.customDomain!==null?`${this.customDomain}/${e}`:`https://${this.region}-${n}.cloudfunctions.net/${e}`}}function mL(t,e,n){const r=Ii(e);t.emulatorOrigin=`http${r?"s":""}://${e}:${n}`,r&&(hm(t.emulatorOrigin),fm("Functions",!0))}function gL(t,e,n){const r=s=>vL(t,e,s,{});return r.stream=(s,i)=>wL(t,e,s,i),r}async function yL(t,e,n,r){n["Content-Type"]="application/json";let s;try{s=await r(t,{method:"POST",body:JSON.stringify(e),headers:n})}catch{return{status:0,json:null}}let i=null;try{i=await s.json()}catch{}return{status:s.status,json:i}}async function nS(t,e){const n={},r=await t.contextProvider.getContext(e.limitedUseAppCheckTokens);return r.authToken&&(n.Authorization="Bearer "+r.authToken),r.messagingToken&&(n["Firebase-Instance-ID-Token"]=r.messagingToken),r.appCheckToken!==null&&(n["X-Firebase-AppCheck"]=r.appCheckToken),n}function vL(t,e,n,r){const s=t._url(e);return _L(t,s,n,r)}async function _L(t,e,n,r){n=Vc(n);const s={data:n},i=await nS(t,r),o=r.timeout||7e4,l=fL(o),u=await Promise.race([yL(e,s,i,t.fetchImpl),l.promise,t.cancelAllRequests]);if(l.cancel(),!u)throw new dn("cancelled","Firebase Functions instance was deleted.");const d=Mc(u.status,u.json);if(d)throw d;if(!u.json)throw new dn("internal","Response is not valid JSON object.");let f=u.json.data;if(typeof f>"u"&&(f=u.json.result),typeof f>"u")throw new dn("internal","Response is missing data field.");return{data:Co(f)}}function wL(t,e,n,r){const s=t._url(e);return xL(t,s,n,r||{})}async function xL(t,e,n,r){var m;n=Vc(n);const s={data:n},i=await nS(t,r);i["Content-Type"]="application/json",i.Accept="text/event-stream";let o;try{o=await t.fetchImpl(e,{method:"POST",body:JSON.stringify(s),headers:i,signal:r==null?void 0:r.signal})}catch(y){if(y instanceof Error&&y.name==="AbortError"){const A=new dn("cancelled","Request was cancelled.");return{data:Promise.reject(A),stream:{[Symbol.asyncIterator](){return{next(){return Promise.reject(A)}}}}}}const x=Mc(0,null);return{data:Promise.reject(x),stream:{[Symbol.asyncIterator](){return{next(){return Promise.reject(x)}}}}}}let l,u;const d=new Promise((y,x)=>{l=y,u=x});(m=r==null?void 0:r.signal)==null||m.addEventListener("abort",()=>{const y=new dn("cancelled","Request was cancelled.");u(y)});const f=o.body.getReader(),p=EL(f,l,u,r==null?void 0:r.signal);return{stream:{[Symbol.asyncIterator](){const y=p.getReader();return{async next(){const{value:x,done:A}=await y.read();return{value:x,done:A}},async return(){return await y.cancel(),{done:!0,value:void 0}}}}},data:d}}function EL(t,e,n,r){const s=(o,l)=>{const u=o.match(hL);if(!u)return;const d=u[1];try{const f=JSON.parse(d);if("result"in f){e(Co(f.result));return}if("message"in f){l.enqueue(Co(f.message));return}if("error"in f){const p=Mc(0,f);l.error(p),n(p);return}}catch(f){if(f instanceof dn){l.error(f),n(f);return}}},i=new TextDecoder;return new ReadableStream({start(o){let l="";return u();async function u(){if(r!=null&&r.aborted){const d=new dn("cancelled","Request was cancelled");return o.error(d),n(d),Promise.resolve()}try{const{value:d,done:f}=await t.read();if(f){l.trim()&&s(l.trim(),o),o.close();return}if(r!=null&&r.aborted){const m=new dn("cancelled","Request was cancelled");o.error(m),n(m),await t.cancel();return}l+=i.decode(d,{stream:!0});const p=l.split(`
`);l=p.pop()||"";for(const m of p)m.trim()&&s(m.trim(),o);return u()}catch(d){const f=d instanceof dn?d:Mc(0,null);o.error(f),n(f)}}},cancel(){return t.cancel()}})}const gw="@firebase/functions",yw="0.13.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TL="auth-internal",IL="app-check-internal",SL="messaging-internal";function NL(t){const e=(n,{instanceIdentifier:r})=>{const s=n.getProvider("app").getImmediate(),i=n.getProvider(TL),o=n.getProvider(SL),l=n.getProvider(IL);return new pL(s,i,o,l,r)};er(new Dn(Sg,e,"PUBLIC").setMultipleInstances(!0)),mn(gw,yw,t),mn(gw,yw,"esm2020")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ng(t=gl(),e=mp){const r=Ni(De(t),Sg).getImmediate({identifier:e}),s=J0("functions");return s&&bL(r,...s),r}function bL(t,e,n){mL(De(t),e,n)}function Pd(t,e,n){return gL(De(t),e)}NL();function AL(t){return t?"present":"missing"}async function CL(){const t=await(async()=>{try{return!!await Promise.resolve(kd())}catch{return!1}})(),e=await navigator.serviceWorker.getRegistration("/sw.js"),s={permission:typeof Notification<"u"?Notification.permission:"unavailable",swRegistered:!!e,swScope:(e==null?void 0:e.scope)||null,messagingSupported:t,vapidKey:AL("BOhz8CwPpf6kstE2HWU-Pyb4bkPGM6OpdVzU3PYrhyMSGZKyds6UzoSlQN1lRYxrmtf-HGQwSw5DivQ0SjkdxCI")};return console.table(s),s}async function rS(){try{return!!await Promise.resolve(kd())}catch(t){return console.warn("[push] getMessagingIfSupported threw:",t),!1}}async function kL(t){console.groupCollapsed("[push] enroll start");try{if(await CL(),!await rS())return console.warn("[push] messaging not supported in this environment"),null;let e=Notification.permission;if(e!=="granted"&&(e=await Notification.requestPermission()),console.log("[push] permission after request:",e),e!=="granted")return console.warn("[push] user did not grant permission"),null;let n=await navigator.serviceWorker.getRegistration("/sw.js");if(n)console.log("[push] using existing SW at",n.scope);else{console.log("[push] registering /sw.js");try{n=await navigator.serviceWorker.register("/sw.js"),console.log("[push] /sw.js registered at",n.scope)}catch(o){return console.warn("[push] failed to register /sw.js:",o),null}}const r=await Promise.resolve(kd());if(!r)return console.warn("[push] getMessagingIfSupported returned null"),null;const s="BOhz8CwPpf6kstE2HWU-Pyb4bkPGM6OpdVzU3PYrhyMSGZKyds6UzoSlQN1lRYxrmtf-HGQwSw5DivQ0SjkdxCI";let i=null;try{i=await LO(r,{vapidKey:s,serviceWorkerRegistration:n})}catch(o){return console.warn("[push] getToken() threw:",o),null}if(!i)return console.warn("[push] getToken() returned null/empty"),null;console.log("[push] obtained token (truncated):",i.slice(0,10)+"...");try{const o=G(Ig,`users/${t}/pushTokens/${i}`);await Et(o,{token:i,createdAt:ke(),userAgent:navigator.userAgent||""},{merge:!0}),console.log("[push] token saved to Firestore (client)")}catch(o){console.warn("[push] failed to write token to Firestore (client):",o)}try{await Pd(Ng(ne,"us-central1"),"registerPushToken")({token:i}),console.log("[push] token saved via callable (server)")}catch(o){console.warn("[push] registerPushToken callable failed (non-fatal):",o)}return i}finally{console.groupEnd()}}async function RL(t){if(!await rS())return()=>{};const e=await Promise.resolve(kd());return e?VO(e,r=>{try{t(r)}catch(s){console.warn("[push] handler error:",s)}}):()=>{}}function PL(){const t=Ge(),e=t.currentUser,[n,r]=k.useState(null),[s,i]=k.useState(null);k.useEffect(()=>{if(!e)return;const l=G(Ig,"users",e.uid),u=_t(l,d=>r(d.data()),d=>console.warn("Profile onSnapshot error:",d));return()=>u()},[e]),k.useEffect(()=>{if(!e)return;let l=null,u=!1;return(async()=>{try{const d=await RL(f=>{console.log("[push] Foreground message:",f);const p=(f==null?void 0:f.data)||{};i({title:p.title||"Notification",body:p.body||""}),setTimeout(()=>i(null),6e3)});u?typeof d=="function"&&d():l=typeof d=="function"?d:null}catch(d){console.warn("listenForegroundMessages failed:",d)}})(),()=>{if(u=!0,typeof l=="function")try{l()}catch{}}},[e]);const o=async()=>{try{const l=t.currentUser;if(!l)return;const u=await kL(l.uid);alert(u?"Notifications enabled on this device.":"Notifications not enabled (permission denied or unsupported).")}catch(l){console.error("Notification setup failed",l),alert("Could not enable notifications.")}};return c.jsx("div",{className:"container py-8",children:c.jsxs("div",{className:"max-w-3xl mx-auto rounded-xl border border-border bg-card p-6",children:[c.jsx("h1",{className:"text-xl font-semibold text-accent mb-4",children:"Profile"}),e&&c.jsxs("div",{className:"mb-4 text-sm text-text",children:[c.jsxs("p",{children:[c.jsx("span",{className:"font-medium",children:"Email:"})," ",e.email]}),c.jsxs("p",{children:[c.jsx("span",{className:"font-medium",children:"UID:"})," ",e.uid]})]}),n&&c.jsx("div",{className:"mb-6 text-sm text-text2",children:n.displayName&&c.jsxs("p",{children:[c.jsx("span",{className:"font-medium text-text",children:"Display Name:"})," ",n.displayName]})}),s&&c.jsxs("div",{className:"mb-4 rounded-lg border border-border bg-card p-3",children:[c.jsx("div",{className:"text-sm font-semibold text-accent",children:s.title}),c.jsx("div",{className:"text-sm text-text2",children:s.body})]}),c.jsxs("section",{className:"mt-2 rounded-xl border border-border bg-card p-5",children:[c.jsx("h2",{className:"text-lg font-semibold text-accent",children:"Notifications"}),c.jsx("p",{className:"text-sm text-text2 mt-1",children:"Enable push notifications on this device to get updates."}),c.jsx("div",{className:"mt-3 flex gap-3",children:c.jsx("button",{type:"button",onClick:o,className:"rounded-lg px-4 py-2 text-white text-sm",style:{backgroundColor:"#919FAA"},children:"Enable notifications on this device"})})]})]})})}function jL(){return c.jsxs("div",{className:"container py-10",children:[c.jsx("h1",{className:"text-2xl font-semibold text-accent",children:"Settings"}),c.jsx("p",{className:"text-text2 mt-2",children:"Preferences and app settings."})]})}function DL(){const[t,e]=k.useState(""),[n,r]=k.useState(!1),[s,i]=k.useState(null),[o,l]=k.useState(!1);async function u(d){d.preventDefault(),i(null),r(!0);try{await Mk(ul,t),l(!0)}catch(f){i((f==null?void 0:f.message)||"Failed to send reset email")}finally{r(!1)}}return c.jsx("div",{className:"flex flex-col items-center min-h-screen bg-[var(--bg)] text-white pt-[15vh]",children:c.jsxs("div",{className:"w-full max-w-sm",children:[c.jsx("h1",{className:"text-2xl font-bold mb-2 text-center",children:"Forgot password"}),c.jsx("p",{className:"mb-6 text-center text-text2",children:"Enter your account email and we’ll send you a reset link."}),o?c.jsxs("div",{className:"border border-border p-4 text-center",children:[c.jsx("p",{className:"text-accent",children:"Check your email"}),c.jsxs("p",{className:"text-text2 text-sm mt-1",children:["If an account exists for ",c.jsx("span",{className:"text-text",children:t}),", you’ll receive a password reset link shortly."]}),c.jsx(we,{to:"/login",className:"btn btn-outline mt-4 w-full",children:"Back to sign in"})]}):c.jsxs("form",{onSubmit:u,className:"space-y-3",children:[c.jsx("input",{type:"email",className:"input w-full",placeholder:"Email",value:t,onChange:d=>e(d.target.value),required:!0,autoComplete:"email"}),s&&c.jsx("div",{className:"text-red-400 text-sm",children:s}),c.jsx("button",{className:"btn btn-primary w-full",disabled:n,children:n?"Sending…":"Send reset link"}),c.jsx("div",{className:"text-center",children:c.jsx(we,{to:"/login",className:"text-sm underline text-text2",children:"Back to sign in"})})]})]})})}function OL(){const[t]=t1(),e=Yr(),n=t.get("oobCode")||"",[r,s]=k.useState(null),[i,o]=k.useState(""),[l,u]=k.useState(""),[d,f]=k.useState(!0),[p,m]=k.useState(null),[y,x]=k.useState(!1);k.useEffect(()=>{async function b(){try{const E=await $k(ul,n);s(E)}catch(E){m((E==null?void 0:E.message)||"Invalid or expired reset link.")}finally{f(!1)}}n?b():(m("Missing reset code."),f(!1))},[n]);async function A(b){if(b.preventDefault(),m(null),i.length<6){m("Password must be at least 6 characters.");return}if(i!==l){m("Passwords do not match.");return}try{await Uk(ul,n,i),x(!0),setTimeout(()=>e("/login",{replace:!0}),1200)}catch(E){m((E==null?void 0:E.message)||"Failed to reset password.")}}return d?c.jsx("div",{className:"container py-20",children:"Checking reset link…"}):c.jsx("div",{className:"flex flex-col items-center min-h-screen bg-[var(--bg)] text-white pt-[15vh]",children:c.jsxs("div",{className:"w-full max-w-sm",children:[c.jsx("h1",{className:"text-2xl font-bold mb-2 text-center",children:"Reset password"}),p&&c.jsxs("div",{className:"border border-border p-4 text-center",children:[c.jsx("p",{className:"text-red-400 text-sm",children:p}),c.jsx(we,{to:"/forgot",className:"btn btn-outline mt-4 w-full",children:"Request a new link"})]}),!p&&!y&&c.jsxs(c.Fragment,{children:[c.jsxs("p",{className:"mb-6 text-center text-text2",children:["Resetting password for ",r]}),c.jsxs("form",{onSubmit:A,className:"space-y-3",children:[c.jsx("input",{type:"password",className:"input w-full",placeholder:"New password",value:i,onChange:b=>o(b.target.value),required:!0,autoComplete:"new-password"}),c.jsx("input",{type:"password",className:"input w-full",placeholder:"Confirm new password",value:l,onChange:b=>u(b.target.value),required:!0,autoComplete:"new-password"}),c.jsx("button",{className:"btn btn-primary w-full",children:"Set new password"})]})]}),y&&c.jsxs("div",{className:"border border-border p-4 text-center",children:[c.jsx("p",{className:"text-accent",children:"Password updated!"}),c.jsx("p",{className:"text-text2 text-sm mt-1",children:"Taking you back to sign in…"})]})]})})}const no=[{id:"downtown",name:"Downtown"}];function LL(t){const e=t.trim().split(/\s+/).filter(Boolean);return e.length===0?{firstName:"",lastName:""}:e.length===1?{firstName:e[0],lastName:""}:{firstName:e[0],lastName:e.slice(1).join(" ")}}function VL(t){if(!t)return"";const e=String(t).trim();return no.some(n=>n.id.toLowerCase()===e.toLowerCase())?no.find(n=>n.id.toLowerCase()===e.toLowerCase()).id:no.some(n=>n.name.toLowerCase()===e.toLowerCase())?no.find(n=>n.name.toLowerCase()===e.toLowerCase()).id:""}function ML(){const t=Yr(),e=Vn(),n=Ge(ne),r=Fe(ne),[s,i]=B.useState(!1),[o,l]=B.useState(n.currentUser),[u,d]=B.useState(""),[f,p]=B.useState(!1),[m,y]=B.useState(""),[x,A]=B.useState(""),[b,E]=B.useState(!1),[v,w]=B.useState(null);B.useEffect(()=>{const D=Mn(n,async L=>{var _;if(l(L),!L){i(!0);return}let S=L.displayName||((_=e.state)==null?void 0:_.name)||"";if(!S)try{const I=localStorage.getItem("signupName");I&&(S=I)}catch{}try{const I=await be(G(r,"users",L.uid)),N=I.exists()?I.data():null;!S&&(N!=null&&N.displayName)&&(S=String(N.displayName)),N!=null&&N.phone&&y(String(N.phone)),N!=null&&N.campus&&A(VL(String(N.campus)))}catch{}d(S||""),p(!!S),i(!0)});return()=>D()},[n,r,e.state]);async function R(){var I;if(w(null),!o){w("You are not signed in.");return}const D=u.trim();if(!f&&!D){w("Please enter your name.");return}const L=f?(o==null?void 0:o.displayName)||u:D,{firstName:S,lastName:_}=LL(L);E(!0);try{if(!f){if(!n.currentUser)throw new Error("No current user.");await kE(n.currentUser,{displayName:L})}await Et(G(r,"users",o.uid),{displayName:L,firstName:S,lastName:_,phone:m.trim()||null,campus:x||null,campusName:((I=no.find(N=>N.id===x))==null?void 0:I.name)||null,updatedAt:ke(),onboardedAt:ke()},{merge:!0});try{localStorage.removeItem("signupName"),localStorage.removeItem("signupFirstName"),localStorage.removeItem("signupLastName")}catch{}t("/dashboard",{replace:!0})}catch(N){w((N==null?void 0:N.message)||"Could not save your profile.")}finally{E(!1)}}return s?o?c.jsx("div",{className:"container py-8 md:py-12",children:c.jsxs("div",{className:"mx-auto max-w-md rounded-xl border border-border bg-card p-6 shadow",children:[c.jsx("h1",{className:"text-2xl font-semibold text-accent mb-2",children:"Welcome!"}),c.jsx("p",{className:"text-sm text-text2 mb-4",children:"Let’s finish setting up your profile."}),f?c.jsxs("div",{className:"mb-4",children:[c.jsx("label",{className:"text-sm block text-text2",children:"Name"}),c.jsx("div",{className:"mt-1 rounded-lg border border-border bg-muted px-3 py-2 text-sm",children:u}),c.jsx("p",{className:"mt-1 text-xs text-text2",children:"Pulled from your sign-up. You can edit this later in Profile."})]}):c.jsxs("label",{className:"mb-4 block",children:[c.jsx("span",{className:"text-sm",children:"Name"}),c.jsx("input",{type:"text",value:u,onChange:D=>d(D.target.value),placeholder:"First Last",className:"mt-1 w-full rounded-lg border border-border bg-background px-3 py-2 text-sm outline-none"})]}),c.jsxs("label",{className:"mb-4 block",children:[c.jsx("span",{className:"text-sm",children:"Phone (optional)"}),c.jsx("input",{type:"tel",value:m,onChange:D=>y(D.target.value),placeholder:"(555) 555-5555",className:"mt-1 w-full rounded-lg border border-border bg-background px-3 py-2 text-sm outline-none"})]}),c.jsxs("label",{className:"mb-4 block",children:[c.jsx("span",{className:"text-sm",children:"Campus (optional)"}),c.jsxs("select",{value:x,onChange:D=>A(D.target.value),className:"mt-1 w-full rounded-lg border border-border bg-background px-3 py-2 text-sm outline-none",children:[c.jsx("option",{value:"",children:"Select a campus (optional)"}),no.map(D=>c.jsx("option",{value:D.id,children:D.name},D.id))]})]}),v&&c.jsx("p",{className:"text-sm text-rose-700 mb-2",children:v}),c.jsx("button",{onClick:R,disabled:b,className:"px-4 py-2 rounded-lg bg-slate-900 text-white hover:bg-slate-800 disabled:opacity-60",children:b?"Saving…":"Save and continue"})]})}):c.jsx("div",{className:"container py-8",children:c.jsx("div",{className:"mx-auto max-w-md rounded-xl border border-border bg-card p-6",children:c.jsx("p",{className:"text-sm text-text2",children:"You are not signed in."})})}):c.jsx("div",{className:"container py-8",children:c.jsx("div",{className:"mx-auto max-w-md",children:c.jsx(sr,{label:"Loading your account…"})})})}const UL="modulepreload",FL=function(t){return"/"+t},vw={},$L=function(e,n,r){let s=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));s=Promise.allSettled(n.map(u=>{if(u=FL(u),u in vw)return;vw[u]=!0;const d=u.endsWith(".css"),f=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${f}`))return;const p=document.createElement("link");if(p.rel=d?"stylesheet":UL,d||(p.as="script"),p.crossOrigin="",p.href=u,l&&p.setAttribute("nonce",l),document.head.appendChild(p),d)return new Promise((m,y)=>{p.addEventListener("load",m),p.addEventListener("error",()=>y(new Error(`Unable to preload CSS for ${u}`)))})}))}function i(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return s.then(o=>{for(const l of o||[])l.status==="rejected"&&i(l.reason);return e().catch(i)})};function BL(){const t=B.useMemo(()=>Fe(ne),[]),{user:e}=Rd(),[n,r]=B.useState(null),[s,i]=B.useState(null),[o,l]=B.useState(""),[u,d]=B.useState(""),[f,p]=B.useState(""),[m,y]=B.useState(null),[x,A]=B.useState(!1);B.useEffect(()=>{let w;if(e!=null&&e.uid){const R=G(t,"admins",e.uid);$L(async()=>{const{onSnapshot:D}=await Promise.resolve().then(()=>lD);return{onSnapshot:D}},void 0).then(({onSnapshot:D})=>{w=D(R,L=>r(L.exists()))})}else r(!1);return()=>{w&&w()}},[t,e==null?void 0:e.uid]),B.useEffect(()=>{const w=Ye(fe(t,"sundayResources"),Ln("createdAt","desc")),R=_t(w,D=>{const L=D.docs.map(S=>({id:S.id,...S.data()}));i(L)});return()=>R()},[t]);async function b(w){if(w.preventDefault(),!!n){if(y(null),!o.trim()||!u.trim()){y("Title and URL are required.");return}try{A(!0),await Dr(fe(t,"sundayResources"),{title:o.trim(),url:u.trim(),note:f.trim()||null,createdAt:ke(),createdBy:(e==null?void 0:e.uid)??null,createdByName:(e==null?void 0:e.displayName)??null}),l(""),d(""),p("")}catch(R){y((R==null?void 0:R.message)||"Failed to add resource.")}finally{A(!1)}}}async function E(w){if(n)try{await Ot(G(t,"sundayResources",w))}catch{}}const v=n===!0;return s===null||n===null?c.jsx("div",{className:"container py-8 md:py-12",children:c.jsxs("div",{className:"max-w-4xl mx-auto",children:[c.jsx("h1",{className:"text-2xl font-semibold text-accent",children:"Sunday White Papers"}),c.jsx("div",{className:"mt-4",children:c.jsx(sr,{label:"Loading…"})})]})}):c.jsx("div",{className:"container py-8 md:py-12",children:c.jsxs("div",{className:"max-w-4xl mx-auto",children:[c.jsx("h1",{className:"text-2xl font-semibold text-accent",children:"Sunday White Papers"}),c.jsx("p",{className:"text-text2 mt-2",children:"A curated library of Sunday white papers and study resources."}),v&&c.jsxs("section",{className:"mt-6 rounded-xl border border-border bg-card p-5",children:[c.jsx("h2",{className:"text-lg font-semibold text-accent",children:"Add a resource"}),m&&c.jsx("p",{className:"text-red-500 text-sm mt-2",children:m}),c.jsxs("form",{onSubmit:b,className:"mt-3 grid grid-cols-1 md:grid-cols-12 gap-3",children:[c.jsx("input",{type:"text",value:o,onChange:w=>l(w.target.value),placeholder:"Title",className:"md:col-span-3 rounded-lg border border-border bg-muted px-3 py-2 text-sm text-text focus:outline-none focus:ring-2 focus:ring-accent/30"}),c.jsx("input",{type:"url",value:u,onChange:w=>d(w.target.value),placeholder:"URL (Google Drive, video, article…)",className:"md:col-span-6 rounded-lg border border-border bg-muted px-3 py-2 text-sm text-text focus:outline-none focus:ring-2 focus:ring-accent/30"}),c.jsx("input",{type:"text",value:f,onChange:w=>p(w.target.value),placeholder:"Note (optional)",className:"md:col-span-3 rounded-lg border border-border bg-muted px-3 py-2 text-sm text-text focus:outline-none focus:ring-2 focus:ring-accent/30"}),c.jsx("div",{className:"md:col-span-12 flex justify-end",children:c.jsx("button",{type:"submit",disabled:x,className:"text-sm px-3 py-1.5 rounded-lg bg-slate-900 text-white hover:bg-slate-800 disabled:opacity-60",children:x?"Adding…":"Add resource"})})]})]}),c.jsxs("section",{className:"mt-6 rounded-xl border border-border bg-card p-5",children:[c.jsx("h2",{className:"text-lg font-semibold text-accent",children:"Resources"}),s.length===0?c.jsx("p",{className:"text-text2 text-sm mt-2",children:"No resources yet."}):c.jsx("ul",{className:"mt-3 space-y-2",children:s.map(w=>c.jsx("li",{className:"rounded-lg border border-border bg-muted px-3 py-2",children:c.jsxs("div",{className:"flex items-center justify-between gap-3",children:[c.jsxs("div",{className:"min-w-0",children:[c.jsx("p",{className:"text-sm font-medium truncate",children:c.jsx("a",{href:w.url,target:"_blank",rel:"noopener noreferrer",className:"hover:underline",children:w.title})}),w.note&&c.jsx("p",{className:"text-xs text-text2 mt-0.5",children:w.note})]}),c.jsxs("div",{className:"flex items-center gap-2 shrink-0",children:[c.jsx(we,{to:w.url,target:"_blank",className:"text-xs px-2 py-1 rounded-md border border-border hover:bg-muted/70",children:"Open"}),v&&c.jsx("button",{onClick:()=>E(w.id),className:"text-xs px-2 py-1 rounded-md border border-border hover:bg-muted/70",title:"Delete",children:"Delete"})]})]})},w.id))})]})]})})}function zL(t,e){return[t,e].sort().join("_")}function qL(){var b;const{slug:t="",otherUid:e=""}=Ti(),n=B.useMemo(()=>Fe(ne),[]),r=Ge(ne),[s,i]=B.useState(!0),[o,l]=B.useState(""),[u,d]=B.useState([]),[f,p]=B.useState(""),m=((b=r.currentUser)==null?void 0:b.uid)||"",y=B.useMemo(()=>m?zL(m,e):"",[m,e]);B.useEffect(()=>{let E=!1,v;async function w(){try{i(!0);try{const D=await be(G(n,"groups",t));if(D.exists()){const L=D.data();E||l((L==null?void 0:L.name)||t)}else E||l(t)}catch{E||l(t)}if(!m||!y)return;const R=Ye(fe(n,`groups/${t}/directMessages/${y}/messages`),Ln("createdAt","asc"));v=_t(R,D=>{const L=D.docs.map(S=>({id:S.id,...S.data()}));E||d(L)})}finally{E||i(!1)}}return w().catch(()=>{}),()=>{E=!0,v&&v()}},[n,t,m,y]);async function x(E){var v;if(E.preventDefault(),!(!f.trim()||!m||!y))try{await Dr(fe(n,`groups/${t}/directMessages/${y}/messages`),{text:f.trim(),from:m,to:e,displayName:((v=r.currentUser)==null?void 0:v.displayName)||"Member",createdAt:ke()}),p("")}catch(w){alert((w==null?void 0:w.message)||"Failed to send")}}async function A(E,v){v===m&&confirm("Delete this message?")&&await Ot(G(n,`groups/${t}/directMessages/${y}/messages/${E}`))}return s?c.jsx("div",{className:"max-w-4xl mx-auto p-6",children:c.jsx(sr,{label:"Loading direct messages…"})}):c.jsx("div",{className:"container py-6",children:c.jsxs("div",{className:"max-w-4xl mx-auto rounded-xl border border-border bg-card p-5",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("h1",{className:"text-lg font-semibold text-accent",children:"Direct Messages"}),c.jsx(we,{to:`/groups/${t}`,className:"text-sm text-text2 underline",children:"Back to group"})]}),c.jsxs("p",{className:"text-sm text-text2 mt-1",children:["Group: ",o]}),c.jsx("div",{className:"mt-4 max-h-[60vh] overflow-auto space-y-2 pr-1",children:u.length===0?c.jsx("p",{className:"text-sm text-text2",children:"No messages yet."}):u.map(E=>c.jsx("div",{className:"rounded-lg px-3 py-2 border "+(E.from===m?"border-slate-300 bg-white":"border-slate-700 bg-slate-800 text-white"),children:c.jsxs("div",{className:"flex items-start justify-between gap-2",children:[c.jsxs("div",{children:[c.jsx("p",{className:"text-xs opacity-70",children:E.displayName||E.from}),c.jsx("p",{className:"text-sm whitespace-pre-wrap",children:E.text})]}),E.from===m&&c.jsx("button",{onClick:()=>A(E.id,E.from),className:"text-xs rounded-lg border border-rose-300 text-rose-700 px-2 py-1 hover:bg-rose-50 h-fit",children:"Delete"})]})},E.id))}),c.jsxs("form",{onSubmit:x,className:"mt-3 flex gap-2",children:[c.jsx("input",{type:"text",value:f,onChange:E=>p(E.target.value),placeholder:"Write a message…",className:"flex-1 rounded-lg border border-border bg-background px-3 py-2 text-sm outline-none"}),c.jsx("button",{type:"submit",disabled:!f.trim(),className:"rounded-lg bg-slate-900 text-white px-3 py-1.5 text-sm hover:bg-slate-800 disabled:opacity-60",children:"Send"})]})]})})}const Eu=14;function _w(t){try{return t?t.toDate?t.toDate():t instanceof Date?t:null:null}catch{return null}}function ww(t,e){if(!t)return!1;const n=e*24*60*60*1e3;return Date.now()-t.getTime()<=n}function WL(){const t=k.useMemo(()=>Fe(ne),[]),e=Ge(ne),[n,r]=k.useState(!0),[s,i]=k.useState(!1),[o,l]=k.useState([]),[u,d]=k.useState(!1),[f,p]=k.useState([]);return k.useEffect(()=>{let m=!1;async function y(){var x;try{r(!0);const A=e.currentUser;if(!A){m||(i(!1),l([]));return}const b=A.uid,v=(await be(G(t,"admins",b))).exists();m||i(v);let w=[];if(v)w=(await et(Ye(fe(t,"groups"),Ln("name")))).docs.map(L=>L.id);else{const L=(await et(Ye(vr(t,"groupAdmins"),cn(og(),"==",b)))).docs.map(S=>{var _;return((_=S.ref.parent.parent)==null?void 0:_.id)||""}).filter(Boolean);L.length?w=L:w=(await et(Ye(vr(t,"groupAdmins"),cn("uid","==",b)))).docs.map(_=>{var I;return((I=_.ref.parent.parent)==null?void 0:I.id)||""}).filter(Boolean)}const R=[];for(const D of w)try{const S=(await be(G(t,"groups",D))).data()||{};let _=0;try{const I=await Oc(fe(t,`groups/${D}/membershipRequests`));_=Number(((x=I.data())==null?void 0:x.count)||0)}catch{}R.push({id:D,name:S.name||D,parent:S.parent||null,pendingRequests:_})}catch{}m||l(R)}finally{m||r(!1)}}return y(),()=>{m=!0}},[t,e.currentUser]),k.useEffect(()=>{let m=!1;async function y(){try{d(!0);const x={};for(const b of o){try{(await et(fe(t,`groups/${b.id}/members`))).forEach(v=>{const w=v.data(),R=v.id;x[R]||(x[R]={uid:R,name:w==null?void 0:w.displayName,email:w==null?void 0:w.email,groups:[],latestJoinAt:null}),x[R].groups.push({id:b.id,name:b.name||b.id});const D=_w(w==null?void 0:w.joinedAt);if(D){const L=x[R].latestJoinAt;(!L||D>L)&&(x[R].latestJoinAt=D)}})}catch{}if(m)return}let A=Object.values(x).sort((b,E)=>(b.name||b.uid).localeCompare(E.name||E.uid));if(s){const b=[];for(const E of A){try{const w=(await be(G(t,"users",E.uid))).data()||{},R=!!(w!=null&&w.isCommunityApproved),D=_w(w==null?void 0:w.createdAt),L=ww(D,Eu);(!R||L)&&b.push(E)}catch{}if(m)return}A=b}else A=A.filter(b=>ww(b.latestJoinAt||null,Eu));m||p(A)}finally{m||d(!1)}}return o.length?y():p([]),()=>{m=!0}},[t,o,s]),n?c.jsx("div",{className:"max-w-5xl mx-auto p-6",children:c.jsx(sr,{label:"Loading admin groups…"})}):c.jsxs("div",{className:"max-w-5xl mx-auto p-6",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("h1",{className:"text-2xl font-semibold text-slate-900",children:s?"All Groups":"Your Groups"}),c.jsx("p",{className:"text-slate-600 mt-2",children:s?"You are a super admin.":"You are a group admin."})]}),c.jsxs("div",{className:"flex items-center gap-3",children:[s&&c.jsx(we,{to:"/admin/groups/new",className:"text-sm px-3 py-2 rounded-lg bg-slate-900 text-white hover:bg-slate-800",title:"Create a new group",children:"New Group"}),c.jsx(we,{to:"/admin/users",className:"text-sm text-slate-700 underline",children:"Users"})]})]}),o.length===0?c.jsx("p",{className:"text-slate-600 mt-4",children:"No groups to manage."}):c.jsx("ul",{className:"mt-4 divide-y divide-slate-200 rounded-xl border border-slate-200 bg-white/70",children:o.map(m=>{const y=m.pendingRequests||0,x="text-sm px-3 py-1.5 rounded-lg text-center leading-tight min-w-[9rem] whitespace-normal md:whitespace-nowrap",A=y>0?`${x} bg-amber-100 text-amber-900 border border-amber-300 hover:bg-amber-200`:`${x} bg-slate-100 text-slate-900 hover:bg-slate-200`;return c.jsxs("li",{className:"p-4 flex items-center justify-between",children:[c.jsxs("div",{className:"min-w-0",children:[c.jsx("div",{className:"font-medium text-slate-900 truncate",children:m.name||m.id}),m.parent&&c.jsxs("div",{className:"text-xs text-slate-500 truncate",children:["Parent: ",m.parent]})]}),c.jsxs("div",{className:"flex gap-2 shrink-0",children:[c.jsx(we,{to:`/admin/groups/${m.id}/requests`,className:A,title:y>0?`${y} pending`:void 0,children:y>0?`View Requests (${y})`:"View Requests"}),c.jsx(we,{to:`/admin/groups/${m.id}/members`,className:"text-sm px-3 py-1.5 rounded-lg bg-slate-100 text-slate-900 hover:bg-slate-200 whitespace-normal md:whitespace-nowrap leading-tight min-w-[8rem]",children:"Members"}),c.jsx(we,{to:`/groups/${m.id}`,className:"text-sm px-3 py-1.5 rounded-lg bg-slate-100 text-slate-900 hover:bg-slate-200 whitespace-normal md:whitespace-nowrap leading-tight min-w-[8rem]",children:"Open Group"})]})]},m.id)})}),c.jsxs("section",{className:"mt-8 rounded-xl border border-slate-200 bg-white/70 p-5",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("h2",{className:"text-lg font-semibold text-slate-900",children:"Users"}),c.jsx(we,{to:"/admin/users",className:"text-sm text-slate-700 underline",children:"Open full users page"})]}),u?c.jsx("p",{className:"text-sm text-slate-600 mt-3",children:"Loading users…"}):f.length===0?c.jsx("p",{className:"text-sm text-slate-600 mt-3",children:s?`No new or unapproved users in the last ${Eu} days.`:`No recently joined users (last ${Eu} days) in your groups.`}):c.jsx("ul",{className:"mt-3 divide-y divide-slate-200",children:f.map(m=>c.jsx("li",{className:"py-3",children:c.jsxs("div",{className:"flex items-start justify-between gap-3",children:[c.jsxs("div",{className:"min-w-0",children:[c.jsx("div",{className:"text-sm font-medium text-slate-900 break-all",children:m.name||m.uid}),m.email&&c.jsx("div",{className:"text-xs text-slate-600 break-all",children:m.email}),c.jsx("div",{className:"mt-1 flex flex-wrap gap-1",children:m.groups.map(y=>c.jsx(we,{to:`/admin/groups/${y.id}/members`,className:"text-xs rounded-full bg-slate-100 px-2 py-0.5 text-slate-800 hover:bg-slate-200",title:"Manage members",children:y.name},y.id))})]}),c.jsx(we,{to:`/admin/users?uid=${encodeURIComponent(m.uid)}`,className:"text-xs rounded-lg border border-slate-300 px-2 py-1 hover:bg-slate-100 shrink-0",children:"View"})]})},m.uid))})]})]})}const sS=Ng(ne,"us-central1");async function xw(t,e,n){const s=await Pd(sS,"setUserDisabled")({targetUid:t,disabled:e,reason:n});return(s==null?void 0:s.data)??null}async function HL(t,e=!1){const r=await Pd(sS,"deleteUserAccount")({targetUid:t,hardDelete:e});return(r==null?void 0:r.data)??null}function GL(){const t=k.useMemo(()=>Fe(ne),[]),e=Ge(ne),[n,r]=k.useState(!0),[s,i]=k.useState(!1),[o,l]=k.useState([]),[u,d]=k.useState(""),[f,p]=k.useState(""),{search:m}=Vn();k.useEffect(()=>{const w=new URLSearchParams(m).get("uid")||"";w&&d(w)},[m]),k.useEffect(()=>{let v=!1;async function w(){try{r(!0);const R=e.currentUser;if(!R){v||(l([]),i(!1));return}const L=(await be(G(t,"admins",R.uid))).exists();v||i(L);const _=(await et(fe(t,"users"))).docs.map(I=>{const N=I.data();return{uid:I.id,displayName:(N==null?void 0:N.displayName)||(N==null?void 0:N.name)||"",email:(N==null?void 0:N.email)||"",status:(N==null?void 0:N.status)||"active",isCommunityApproved:!!(N!=null&&N.isCommunityApproved),groups:[]}});for(const I of _){try{const N=await et(fe(t,`users/${I.uid}/memberships`)),P=[];for(const j of N.docs){const C=j.id;try{const Tt=(await be(G(t,"groups",C))).data()||{};P.push({id:C,name:(Tt==null?void 0:Tt.name)||C})}catch{P.push({id:C,name:C})}}I.groups=P.sort((j,C)=>j.name.localeCompare(C.name))}catch{I.groups=[]}if(v)return}_.sort((I,N)=>(I.displayName||I.email||I.uid).localeCompare(N.displayName||N.email||N.uid)),v||l(_)}finally{v||r(!1)}}return w(),()=>{v=!0}},[t,e.currentUser]);const y=o.filter(v=>{const w=u.trim().toLowerCase();return w?v.uid.toLowerCase().includes(w)||(v.displayName||"").toLowerCase().includes(w)||(v.email||"").toLowerCase().includes(w)||v.groups.some(R=>R.name.toLowerCase().includes(w)||R.id.toLowerCase().includes(w)):!0});async function x(v){if(!s)return;const w=window.prompt("Reason for inactivation? (optional)")||void 0;p(`disable:${v}`);try{await xw(v,!0,w),l(R=>R.map(D=>D.uid===v?{...D,status:"inactive"}:D))}catch{alert("Failed to inactivate user.")}finally{p("")}}async function A(v){if(s&&window.confirm("Reactivate this user?")){p(`enable:${v}`);try{await xw(v,!1),l(w=>w.map(R=>R.uid===v?{...R,status:"active"}:R))}catch{alert("Failed to reactivate user.")}finally{p("")}}}async function b(v){if(!(!s||!window.confirm("Delete this user? This will remove their authentication account and related data.")||!(window.prompt('Type "DELETE" to confirm.')==="DELETE"))){p(`delete:${v}`);try{await HL(v,!1),l(D=>D.filter(L=>L.uid!==v))}catch{alert("Failed to delete user.")}finally{p("")}}}async function E(v,w){var R;if(s){p(`approve:${v}`);try{const D=((R=e.currentUser)==null?void 0:R.uid)||"",L=w?{isCommunityApproved:!0,dmApprovedAt:ke(),dmApprovedBy:D}:{isCommunityApproved:!1,dmApprovedAt:fp(),dmApprovedBy:fp()};await Et(G(t,"users",v),L,{merge:!0}),l(S=>S.map(_=>_.uid===v?{..._,isCommunityApproved:w}:_))}catch{alert("Failed to update approval.")}finally{p("")}}}return n?c.jsx("div",{className:"max-w-5xl mx-auto p-6",children:c.jsx(sr,{label:"Loading users…"})}):c.jsxs("div",{className:"max-w-5xl mx-auto p-6",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("h1",{className:"text-2xl font-semibold text-slate-900",children:"Users"}),c.jsx("input",{value:u,onChange:v=>d(v.target.value),placeholder:"Search users…",className:"rounded-lg border border-slate-300 bg-white/80 px-3 py-2 text-sm outline-none w-56","aria-label":"Search users"})]}),c.jsxs("div",{className:"mt-4 rounded-xl border border-slate-200 bg-white/70 overflow-hidden",children:[c.jsxs("div",{className:"grid grid-cols-12 gap-2 px-4 py-2 text-xs font-medium text-slate-600",children:[c.jsx("div",{className:"col-span-4",children:"Name"}),c.jsx("div",{className:"col-span-3",children:"Email"}),c.jsx("div",{className:"col-span-3",children:"Groups"}),c.jsx("div",{className:"col-span-2 text-right",children:"Actions"})]}),c.jsx("div",{className:"divide-y divide-slate-200",children:y.length===0?c.jsx("div",{className:"px-4 py-4 text-sm text-slate-600",children:"No users found."}):y.map(v=>c.jsxs("div",{className:"grid grid-cols-12 gap-2 px-4 py-3 items-start",children:[c.jsxs("div",{className:"col-span-4 min-w-0",children:[c.jsx("div",{className:"text-sm text-slate-900 truncate",children:v.displayName||v.uid}),v.email&&c.jsx("div",{className:"text-xs text-slate-600 truncate",children:v.email}),c.jsxs("div",{className:"text-[11px] text-slate-500 mt-0.5",children:["Status: ",v.status||"active"]}),c.jsxs("div",{className:"text-[11px] text-slate-500 mt-0.5",children:["DM access: ",c.jsx("b",{children:v.isCommunityApproved?"Approved":"Not approved"})]})]}),c.jsx("div",{className:"col-span-3 min-w-0",children:c.jsxs("div",{className:"flex flex-wrap gap-1",children:[v.groups.map(w=>c.jsx(we,{to:`/admin/groups/${w.id}/members`,className:"text-xs rounded-full bg-slate-100 px-2 py-0.5 text-slate-800 hover:bg-slate-200",title:"Manage members",children:w.name},w.id)),v.groups.length===0&&c.jsx("span",{className:"text-xs text-slate-600",children:"—"})]})}),c.jsx("div",{className:"col-span-3 min-w-0",children:c.jsx("span",{className:"text-xs break-all",children:v.uid})}),c.jsx("div",{className:"col-span-2 text-right",children:c.jsxs("div",{className:"inline-flex flex-col gap-1 items-end",children:[c.jsxs("label",{className:"inline-flex items-center gap-2 text-xs select-none",children:[c.jsx("input",{type:"checkbox",checked:!!v.isCommunityApproved,onChange:w=>void E(v.uid,w.target.checked),disabled:!s||!!f}),c.jsx("span",{children:"Approved for DMs"})]}),c.jsx(we,{to:`/admin/users?uid=${encodeURIComponent(v.uid)}`,className:"text-xs rounded-lg border border-slate-300 px-2 py-1 hover:bg-slate-100",children:"View"}),s&&c.jsxs("div",{className:"flex flex-wrap gap-1 justify-end",children:[v.status==="inactive"?c.jsx("button",{onClick:()=>A(v.uid),disabled:!!f,className:"text-xs rounded-lg px-2 py-1 text-white",style:{backgroundColor:"#919FAA",opacity:f?.6:1},children:f===`enable:${v.uid}`?"Working…":"Reactivate"}):c.jsx("button",{onClick:()=>x(v.uid),disabled:!!f,className:"text-xs rounded-lg px-2 py-1 text-white",style:{backgroundColor:"#919FAA",opacity:f?.6:1},children:f===`disable:${v.uid}`?"Working…":"Inactivate"}),c.jsx("button",{onClick:()=>b(v.uid),disabled:!!f,className:"text-xs rounded-lg px-2 py-1 bg-rose-100 text-rose-800 hover:bg-rose-200",style:{opacity:f?.6:1},title:"Soft delete (Auth account removed; user doc marked deleted)",children:f===`delete:${v.uid}`?"Deleting…":"Delete"})]})]})})]},v.uid))})]})]})}function KL(){const{slug:t}=Ti(),e=Fe(ne),[n,r]=k.useState(""),[s,i]=k.useState([]),[o,l]=k.useState(!0),[u,d]=k.useState(""),f=t;k.useEffect(()=>{let y=!0;async function x(){if(f){l(!0);try{const A=G(e,"groups",f),b=await be(A);r(b.exists()&&b.data().name||QL(f));const E=fe(e,`groups/${f}/membershipRequests`),v=await et(E);if(!y)return;const w=[];v.forEach(R=>w.push(R.data())),i(w)}finally{l(!1)}}}return x(),()=>{y=!1}},[e,f]);async function p(y){d(y.uid);try{await Et(G(e,`users/${y.uid}/memberships/${f}`),{groupId:f,approvedAt:ke(),approvedBy:"admin"},{merge:!0}),await Et(G(e,`groups/${f}/members/${y.uid}`),{uid:y.uid,displayName:y.displayName||"Member",joinedAt:ke()},{merge:!0}),await Promise.all([Ot(G(e,`groups/${f}/membershipRequests/${y.uid}`)),Ot(G(e,`users/${y.uid}/membershipRequests/${f}`))]),i(x=>x.filter(A=>A.uid!==y.uid))}finally{d("")}}async function m(y){d(y.uid);try{await Promise.all([Ot(G(e,`groups/${f}/membershipRequests/${y.uid}`)),Ot(G(e,`users/${y.uid}/membershipRequests/${f}`))]),i(x=>x.filter(A=>A.uid!==y.uid))}finally{d("")}}return f?c.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[c.jsx("div",{className:"mb-4",children:c.jsxs(we,{to:"/admin",className:"inline-flex items-center gap-2 rounded-lg border border-border px-3 py-1.5 text-sm hover:bg-muted",children:[c.jsx("span",{"aria-hidden":!0,children:"←"}),c.jsx("span",{children:"Return to Admin Console"})]})}),c.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("h1",{className:"text-2xl font-semibold text-slate-900",children:"Pending Requests"}),c.jsxs("p",{className:"text-slate-600",children:["Group: ",n]})]}),c.jsx(we,{to:`/groups/${f}`,className:"text-sm text-slate-700 underline",children:"Back to group"})]}),o?c.jsx("p",{className:"text-slate-600",children:"Loading…"}):s.length===0?c.jsx("p",{className:"text-slate-600",children:"No pending requests."}):c.jsx("ul",{className:"divide-y divide-slate-200 rounded-xl border border-slate-200 bg-white/70",children:s.map(y=>c.jsxs("li",{className:"p-4 flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("div",{className:"font-medium text-slate-900",children:y.displayName||y.uid}),c.jsx("div",{className:"text-xs text-slate-500 truncate",children:y.uid})]}),c.jsxs("div",{className:"flex gap-2",children:[c.jsx("button",{onClick:()=>p(y),disabled:!!u,className:"text-xs px-3 py-1.5 rounded-lg bg-green-600 text-white hover:bg-green-700 disabled:opacity-60",children:u===y.uid?"Working…":"Approve"}),c.jsx("button",{onClick:()=>m(y),disabled:!!u,className:"text-xs px-3 py-1.5 rounded-lg bg-rose-100 text-rose-800 hover:bg-rose-200 disabled:opacity-60",children:"Deny"})]})]},y.uid))})]}):c.jsx("div",{className:"p-6",children:"Missing group slug."})}function QL(t){return t.replace(/[-_]/g," ").replace(/\b\w/g,e=>e.toUpperCase())}function YL(){const{slug:t}=Ti(),e=k.useMemo(()=>Fe(ne),[]),n=Ge(ne),[r,s]=k.useState(""),[i,o]=k.useState([]),[l,u]=k.useState({}),[d,f]=k.useState(!0),[p,m]=k.useState(""),[y,x]=k.useState(""),[A,b]=k.useState(!1),[E,v]=k.useState(""),[w,R]=k.useState([]),[D,L]=k.useState(""),[S,_]=k.useState(""),I=(t||"").trim();k.useEffect(()=>{let Q=!0;async function $(){if(I){f(!0),x("");try{const J=G(e,"groups",I),_e=await be(J);s(_e.exists()&&_e.data().name||JL(I));const he=n.currentUser;if(he){const Oe=he.uid;if((await be(G(e,"admins",Oe))).exists())b(!0);else{const z=await be(G(e,`groups/${I}/groupAdmins/${Oe}`));b(z.exists())}}else b(!1);const se=await et(fe(e,`groups/${I}/members`));if(!Q)return;const it=[],It=await et(fe(e,`groups/${I}/groupAdmins`)),Ke={};It.forEach(Oe=>{Ke[Oe.id]=!0}),u(Ke),se.forEach(Oe=>it.push({uid:Oe.id,...Oe.data()})),it.sort((Oe,St)=>(Oe.displayName||Oe.uid).localeCompare(St.displayName||St.uid)),o(it)}catch(J){x((J==null?void 0:J.message)||"Failed to load members.")}finally{f(!1)}}}$();async function K(){try{const _e=(await et(fe(e,"users"))).docs.map(he=>{const se=he.data();return{uid:he.id,displayName:(se==null?void 0:se.displayName)||(se==null?void 0:se.name)||"",email:(se==null?void 0:se.email)||""}});_e.sort((he,se)=>(he.displayName||he.email||he.uid).localeCompare(se.displayName||se.email||se.uid)),R(_e)}catch{R([])}}return K(),()=>{Q=!1}},[e,I]);async function N(Q,$,K){var _e,he;const J=Q.trim();if(J){x(""),m("add");try{const se=NI(e),it=G(e,`groups/${I}/members/${J}`);{const Ke={uid:J,displayName:$||J,role:"member",joinedAt:ke(),addedBy:((_e=n.currentUser)==null?void 0:_e.uid)||"unknown"};K&&(Ke.email=K),se.set(it,Ke,{merge:!0})}const It=G(e,`users/${J}/memberships/${I}`);se.set(It,{groupId:I,approvedAt:ke(),approvedBy:((he=n.currentUser)==null?void 0:he.uid)||"admin"},{merge:!0}),await se.commit(),o(Ke=>{const Oe=[...Ke.filter(St=>St.uid!==J),{uid:J,displayName:$||J,email:K}];return Oe.sort((St,z)=>(St.displayName||St.uid).localeCompare(z.displayName||z.uid)),Oe}),v(""),_("")}catch(se){x((se==null?void 0:se.message)||"Failed to add member. Check Firestore rules.")}finally{m("")}}}async function P(){await N(E)}async function j(Q){if(Q.preventDefault(),!S)return;const $=w.find(K=>K.uid===S);await N(S,$==null?void 0:$.displayName,$==null?void 0:$.email)}async function C(Q){var $;m(`admin:${Q}`),x("");try{await Et(G(e,`groups/${I}/groupAdmins/${Q}`),{uid:Q,grantedBy:(($=n.currentUser)==null?void 0:$.uid)||"unknown",createdAt:ke()},{merge:!0}),u(K=>({...K,[Q]:!0}))}catch(K){x((K==null?void 0:K.message)||"Failed to grant admin.")}finally{m("")}}async function lt(Q){m(`admin:${Q}`),x("");try{await Ot(G(e,`groups/${I}/groupAdmins/${Q}`)),u($=>{const K={...$};return delete K[Q],K})}catch($){x(($==null?void 0:$.message)||"Failed to remove admin.")}finally{m("")}}async function Tt(Q){m(Q),x("");try{await Ot(G(e,`groups/${I}/members/${Q}`)),await Ot(G(e,`users/${Q}/memberships/${I}`)),o($=>$.filter(K=>K.uid!==Q))}catch($){x(($==null?void 0:$.message)||"Failed to remove member.")}finally{m("")}}if(!I)return c.jsx("div",{className:"p-6",children:"Missing group slug."});const Un=k.useMemo(()=>{const Q=D.trim().toLowerCase();return Q?w.filter($=>{const K=($.displayName||"").toLowerCase(),J=($.email||"").toLowerCase();return K.includes(Q)||J.includes(Q)||$.uid.toLowerCase().includes(Q)}):w},[w,D]);return c.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[c.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("h1",{className:"text-2xl font-semibold text-slate-900",children:"Group Members"}),c.jsxs("p",{className:"text-slate-600",children:["Group: ",r]})]}),c.jsx(we,{to:"/admin/groups",className:"text-sm text-slate-700 underline",children:"Back to groups"})]}),y&&c.jsx("div",{className:"mb-3 rounded-lg border border-rose-200 bg-rose-50 px-3 py-2 text-sm text-rose-800",children:y}),c.jsxs("div",{className:"rounded-xl border border-slate-200 bg-white/70 p-4 mb-6",children:[c.jsx("h2",{className:"font-medium text-slate-900",children:"Add Member (by Name)"}),c.jsxs("form",{onSubmit:j,className:"mt-2 grid gap-2 sm:grid-cols-6",children:[c.jsx("input",{value:D,onChange:Q=>L(Q.target.value),placeholder:"Search users by name, email, or UID…",className:"sm:col-span-2 rounded-lg border border-slate-300 px-3 py-2 text-sm","aria-label":"Filter users",disabled:!A}),c.jsxs("select",{className:"sm:col-span-3 rounded-lg border border-slate-300 px-2 py-2 text-sm",value:S,onChange:Q=>_(Q.target.value),"aria-label":"Select user to add",disabled:!A,children:[c.jsx("option",{value:"",children:"Select a user…"}),Un.map(Q=>c.jsx("option",{value:Q.uid,children:(Q.displayName||"Unnamed")+(Q.email?` • ${Q.email}`:"")},Q.uid))]}),c.jsx("div",{className:"sm:col-span-1",children:c.jsx("button",{type:"submit",disabled:!S||!!p||!A,className:"rounded-lg bg-slate-900 text-white px-4 py-2 text-sm hover:bg-slate-800 disabled:opacity-60",children:p==="add"?"Adding…":"Add to group"})})]}),c.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Admins: choose a user to add them to this group."})]}),c.jsxs("div",{className:"rounded-xl border border-slate-200 bg-white/70 p-4 mb-6",children:[c.jsx("h2",{className:"font-medium text-slate-900",children:"Add Member (by UID)"}),c.jsxs("div",{className:"mt-2 flex gap-2",children:[c.jsx("input",{value:E,onChange:Q=>v(Q.target.value),placeholder:"Paste a user's UID",className:"flex-1 rounded-lg border border-slate-300 px-3 py-2 text-sm",disabled:!A}),c.jsx("button",{onClick:P,disabled:!E.trim()||!!p||!A,className:"text-sm px-3 py-2 rounded-lg bg-slate-900 text-white hover:bg-slate-800 disabled:opacity-60",children:p==="add"?"Adding…":"Add"})]}),c.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Tip: you can find a user's UID in Firebase → Authentication."})]}),d?c.jsx("p",{className:"text-slate-600",children:"Loading…"}):i.length===0?c.jsx("p",{className:"text-slate-600",children:"No members yet."}):c.jsx("ul",{className:"divide-y divide-slate-200 rounded-xl border border-slate-200 bg-white/70",children:i.map(Q=>c.jsxs("li",{className:"p-4 flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("div",{className:"font-medium text-slate-900",children:Q.displayName||Q.uid}),c.jsx("div",{className:"text-xs text-slate-500 truncate",children:Q.uid})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[l[Q.uid]?c.jsx("button",{onClick:()=>lt(Q.uid),disabled:!!p||!A,className:"text-xs px-3 py-1.5 rounded-lg bg-amber-100 text-amber-800 hover:bg-amber-200 disabled:opacity-60",children:p===`admin:${Q.uid}`?"Updating…":"Remove admin"}):c.jsx("button",{onClick:()=>C(Q.uid),disabled:!!p||!A,className:"text-xs px-3 py-1.5 rounded-lg bg-slate-900 text-white hover:bg-slate-800 disabled:opacity-60",children:p===`admin:${Q.uid}`?"Updating…":"Make admin"}),c.jsx("button",{onClick:()=>Tt(Q.uid),disabled:!!p||!A,className:"text-xs px-3 py-1.5 rounded-lg bg-rose-100 text-rose-800 hover:bg-rose-200 disabled:opacity-60",children:p===Q.uid?"Removing…":"Remove"})]})]},Q.uid))})]})}function JL(t){return t.replace(/[-_]/g," ").replace(/\b\w/g,e=>e.toUpperCase())}function XL(){const{slug:t}=Ti(),e=Fe(ne),n=t,[r,s]=k.useState([]),[i,o]=k.useState(!0);return k.useEffect(()=>{let l=!0;async function u(){if(n){o(!0);try{const d=fe(e,`groups/${n}/groupEvents`),f=Ye(d,Ln("at","desc")),p=await et(f);if(!l)return;const m=[];p.forEach(y=>m.push({id:y.id,...y.data()})),s(m)}finally{o(!1)}}}return u(),()=>{l=!1}},[e,n]),c.jsxs("div",{className:"max-w-4xl mx-auto p-6",children:[c.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("h1",{className:"text-2xl font-semibold text-slate-900",children:"Audit Log"}),c.jsx("p",{className:"text-slate-600",children:"Recent events for this group."})]}),c.jsx(we,{to:"/admin/groups",className:"text-sm text-slate-700 underline",children:"Back to groups"})]}),i?c.jsx("p",{className:"text-slate-600",children:"Loading…"}):r.length===0?c.jsx("p",{className:"text-slate-600",children:"No events yet."}):c.jsx("ul",{className:"divide-y divide-slate-200 rounded-xl border border-slate-200 bg-white/70",children:r.map(l=>{var u;return c.jsxs("li",{className:"p-4",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("div",{className:"font-medium text-slate-900",children:l.type.replace(/_/g," ")}),c.jsx("div",{className:"text-xs text-slate-500",children:(u=l.at)!=null&&u.toDate?l.at.toDate().toLocaleString():"—"})]}),c.jsx("div",{className:"text-xs text-slate-600 mt-1",children:l.uid&&c.jsxs(c.Fragment,{children:["User: ",c.jsx("code",{children:l.uid})]})}),l.payload&&c.jsx("pre",{className:"mt-2 text-xs bg-slate-50 rounded-lg p-2 overflow-auto",children:JSON.stringify(l.payload,null,2)})]},l.id)})})]})}function ZL(){const t=Ng(ne),e=Fe(ne),[n,r]=k.useState(""),[s,i]=k.useState(""),[o,l]=k.useState([]),[u,d]=k.useState(!1),[f,p]=k.useState(null);k.useEffect(()=>{async function y(){const x=await et(fe(e,"groups")),A=[];x.forEach(b=>A.push({id:b.id,...b.data()})),A.sort((b,E)=>(b.name||b.id).localeCompare(E.name||E.id)),l(A)}y()},[e]);async function m(){d(!0),p(null);try{const x=await Pd(t,"grantGroupAdminByEmail")({email:n,groupId:s});p(`✅ Granted admin to ${n} (uid=${x.data.uid})`),r("")}catch(y){p(`❌ ${(y==null?void 0:y.message)||"Failed"}`)}finally{d(!1)}}return c.jsxs("div",{className:"max-w-xl mx-auto p-6",children:[c.jsx("h1",{className:"text-2xl font-semibold text-slate-900",children:"Grant Group Admin (by email)"}),c.jsxs("div",{className:"mt-4 grid gap-3 rounded-2xl border border-slate-200 bg-white/70 p-4",children:[c.jsxs("label",{className:"block text-sm",children:[c.jsx("span",{className:"font-medium text-slate-700",children:"User email"}),c.jsx("input",{value:n,onChange:y=>r(y.target.value),placeholder:"user@example.com",className:"mt-1 w-full rounded-lg border border-slate-300 px-3 py-2 text-sm"})]}),c.jsxs("label",{className:"block text-sm",children:[c.jsx("span",{className:"font-medium text-slate-700",children:"Group"}),c.jsxs("select",{value:s,onChange:y=>i(y.target.value),className:"mt-1 w-full rounded-lg border border-slate-300 bg-white/70 px-3 py-2 text-sm",children:[c.jsx("option",{value:"",children:"Select a group…"}),o.map(y=>c.jsx("option",{value:y.id,children:y.name||y.id},y.id))]})]}),c.jsxs("div",{className:"flex gap-3 items-center",children:[c.jsx("button",{onClick:m,disabled:!n||!s||u,className:"px-4 py-2 rounded-lg bg-slate-900 text-white hover:bg-slate-800 disabled:opacity-60",children:u?"Working…":"Grant admin"}),f&&c.jsx("p",{className:"text-sm text-slate-700",children:f})]})]})]})}function eV(t){return t.toLowerCase().trim().replace(/[^a-z0-9]+/g,"-").replace(/(^-|-$)+/g,"")}function Ew(){const t=Fe(ne),e=Yr(),[n,r]=k.useState(""),[s,i]=k.useState(""),[o,l]=k.useState(""),[u,d]=k.useState(""),[f,p]=k.useState(""),[m,y]=k.useState(""),[x,A]=k.useState(""),[b,E]=k.useState(""),[v,w]=k.useState(!1),[R,D]=k.useState(null),L=k.useMemo(()=>s||eV(n),[s,n]);async function S(){const _=L.trim();if(!n.trim()||!_){D("⚠️ Name and slug are required.");return}w(!0),D(null);try{const I=G(t,"groups",_);if((await be(I)).exists()){D("❌ A group with that slug already exists."),w(!1);return}await Et(I,{id:_,name:n.trim(),slug:_,description:o.trim()||null,parent:u||null,campus:f||null,meetingDay:m||null,meetingTime:x||null,imageUrl:b||null,createdAt:ke(),updatedAt:ke()}),e(`/admin/groups/${_}/edit`,{replace:!0})}catch(I){D("❌ "+((I==null?void 0:I.message)||"Failed to create group."))}finally{w(!1)}}return c.jsxs("div",{className:"max-w-3xl mx-auto p-6",children:[c.jsx("h1",{className:"text-2xl font-semibold text-slate-900",children:"Create Group"}),c.jsxs("div",{className:"mt-4 grid gap-3",children:[c.jsxs(ss,{label:"Name",children:[c.jsx("input",{value:n,onChange:_=>r(_.target.value),className:"w-full rounded-lg border border-slate-300 px-3 py-2 text-sm"}),c.jsxs("p",{className:"mt-1 text-xs text-slate-500",children:["Slug preview: ",c.jsx("code",{children:L||"—"})]})]}),c.jsx(ss,{label:"Slug (optional)",children:c.jsx("input",{value:s,onChange:_=>i(_.target.value),className:"w-full rounded-lg border border-slate-300 px-3 py-2 text-sm",placeholder:"auto from name if blank"})}),c.jsx(ss,{label:"Description",children:c.jsx("textarea",{value:o,onChange:_=>l(_.target.value),rows:4,className:"w-full rounded-lg border border-slate-300 px-3 py-2 text-sm"})}),c.jsxs("div",{className:"grid sm:grid-cols-2 gap-3",children:[c.jsx(ss,{label:"Parent ministry (optional)",children:c.jsx("input",{value:u,onChange:_=>d(_.target.value),className:"w-full rounded-lg border border-slate-300 px-3 py-2 text-sm"})}),c.jsx(ss,{label:"Campus (optional)",children:c.jsx("input",{value:f,onChange:_=>p(_.target.value),className:"w-full rounded-lg border border-slate-300 px-3 py-2 text-sm"})})]}),c.jsxs("div",{className:"grid sm:grid-cols-2 gap-3",children:[c.jsx(ss,{label:"Meeting day (optional)",children:c.jsxs("select",{value:m,onChange:_=>y(_.target.value),className:"w-full rounded-lg border border-slate-300 px-3 py-2 text-sm bg-white/70",children:[c.jsx("option",{value:"",children:"—"}),["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"].map(_=>c.jsx("option",{value:_,children:_},_))]})}),c.jsx(ss,{label:"Meeting time (optional)",children:c.jsx("input",{value:x,onChange:_=>A(_.target.value),className:"w-full rounded-lg border border-slate-300 px-3 py-2 text-sm",placeholder:"e.g., 7:00pm"})})]}),c.jsx(ss,{label:"Image URL (optional)",children:c.jsx("input",{value:b,onChange:_=>E(_.target.value),className:"w-full rounded-lg border border-slate-300 px-3 py-2 text-sm",placeholder:"https://…"})}),R&&c.jsx("p",{className:"text-sm text-slate-700",children:R}),c.jsx("div",{className:"flex gap-3",children:c.jsx("button",{onClick:S,disabled:v,className:"px-4 py-2 rounded-lg bg-slate-900 text-white hover:bg-slate-800 disabled:opacity-60",children:v?"Creating…":"Create group"})})]})]})}function ss({label:t,children:e}){return c.jsxs("label",{className:"block",children:[c.jsx("div",{className:"text-sm font-medium text-slate-700",children:t}),c.jsx("div",{className:"mt-1",children:e})]})}function tV(){const{slug:t}=Ti(),e=Fe(ne),n=Yr(),[r,s]=k.useState(null),[i,o]=k.useState(!0),[l,u]=k.useState(!1),[d,f]=k.useState(null);k.useEffect(()=>{let y=!0;async function x(){if(!t)return;o(!0);const A=await be(G(e,"groups",t));if(!y)return;const b=A.exists()?A.data():{};s({name:(b==null?void 0:b.name)||"",description:(b==null?void 0:b.description)??"",parent:(b==null?void 0:b.parent)??"",campus:(b==null?void 0:b.campus)??"",meetingDay:(b==null?void 0:b.meetingDay)??"",meetingTime:(b==null?void 0:b.meetingTime)??"",meetingFrequency:(b==null?void 0:b.meetingFrequency)??"",imageUrl:(b==null?void 0:b.imageUrl)??""}),o(!1)}return x(),()=>{y=!1}},[e,t]);async function p(){var y,x,A,b,E,v;if(!(!t||!r)){u(!0),f(null);try{const w={...r,name:String((r==null?void 0:r.name)||"").trim(),description:((y=(r==null?void 0:r.description)||"")==null?void 0:y.trim())||null,parent:((x=(r==null?void 0:r.parent)||"")==null?void 0:x.trim())||null,campus:((A=(r==null?void 0:r.campus)||"")==null?void 0:A.trim())||null,meetingDay:((b=(r==null?void 0:r.meetingDay)||"")==null?void 0:b.trim())||null,meetingTime:((E=(r==null?void 0:r.meetingTime)||"")==null?void 0:E.trim())||null,meetingFrequency:(r==null?void 0:r.meetingFrequency)||"",imageUrl:((v=(r==null?void 0:r.imageUrl)||"")==null?void 0:v.trim())||null,updatedAt:ke()};await Et(G(e,"groups",t),w,{merge:!0}),f("✅ Saved")}catch(w){const R=(w==null?void 0:w.message)||"Failed to save.";f(R)}finally{u(!1)}}}async function m(){if(t&&confirm("Delete this group? This cannot be undone."))try{await Ot(G(e,"groups",t)),n("/admin/groups",{replace:!0})}catch(y){const x=(y==null?void 0:y.message)||"Failed to delete.";f(x)}}return i?c.jsx("div",{className:"max-w-3xl mx-auto p-6",children:"Loading…"}):r?c.jsxs("div",{className:"max-w-3xl mx-auto p-6",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("h1",{className:"text-2xl font-semibold text-slate-900",children:"Edit Group"}),c.jsx(we,{to:"/admin/groups",className:"text-sm text-slate-700 underline",children:"Back to groups"})]}),c.jsxs("div",{className:"mt-4 grid gap-3",children:[c.jsx(is,{label:"Name",children:c.jsx("input",{value:(r==null?void 0:r.name)||"",onChange:y=>s(x=>({...x,name:y.target.value})),className:"w-full rounded-lg border border-slate-300 px-3 py-2 text-sm"})}),c.jsx(is,{label:"Description",children:c.jsx("textarea",{value:(r==null?void 0:r.description)||"",onChange:y=>s(x=>({...x,description:y.target.value})),rows:4,className:"w-full rounded-lg border border-slate-300 px-3 py-2 text-sm"})}),c.jsxs("div",{className:"grid sm:grid-cols-2 gap-3",children:[c.jsx(is,{label:"Parent ministry",children:c.jsx("input",{value:(r==null?void 0:r.parent)||"",onChange:y=>s(x=>({...x,parent:y.target.value})),className:"w-full rounded-lg border border-slate-300 px-3 py-2 text-sm"})}),c.jsx(is,{label:"Campus",children:c.jsx("input",{value:(r==null?void 0:r.campus)||"",onChange:y=>s(x=>({...x,campus:y.target.value})),className:"w-full rounded-lg border border-slate-300 px-3 py-2 text-sm"})})]}),c.jsxs("div",{className:"grid sm:grid-cols-3 gap-3",children:[c.jsx(is,{label:"Meeting day",children:c.jsxs("select",{value:(r==null?void 0:r.meetingDay)||"",onChange:y=>s(x=>({...x,meetingDay:y.target.value})),className:"w-full rounded-lg border border-slate-300 px-3 py-2 text-sm bg-white/70",children:[c.jsx("option",{value:"",children:"—"}),["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"].map(y=>c.jsx("option",{value:y,children:y},y))]})}),c.jsx(is,{label:"Meeting time",children:c.jsx("input",{value:(r==null?void 0:r.meetingTime)||"",onChange:y=>s(x=>({...x,meetingTime:y.target.value})),className:"w-full rounded-lg border border-slate-300 px-3 py-2 text-sm",placeholder:"e.g., 7:00pm"})}),c.jsx(is,{label:"Meeting frequency",children:c.jsxs("select",{value:(r==null?void 0:r.meetingFrequency)||"",onChange:y=>s(x=>({...x,meetingFrequency:y.target.value})),className:"w-full rounded-lg border border-slate-300 px-3 py-2 text-sm bg-white/70",children:[c.jsx("option",{value:"",children:"—"}),c.jsx("option",{value:"weekly",children:"Weekly"}),c.jsx("option",{value:"biweekly",children:"Bi‑weekly"}),c.jsx("option",{value:"monthly",children:"Monthly"})]})})]}),c.jsx(is,{label:"Image URL",children:c.jsx("input",{value:(r==null?void 0:r.imageUrl)||"",onChange:y=>s(x=>({...x,imageUrl:y.target.value})),className:"w-full rounded-lg border border-slate-300 px-3 py-2 text-sm",placeholder:"https://…"})}),d&&c.jsx("p",{className:"text-sm text-slate-700",children:d}),c.jsxs("div",{className:"flex gap-3",children:[c.jsx("button",{onClick:p,disabled:l,className:"px-4 py-2 rounded-lg bg-slate-900 text-white hover:bg-slate-800 disabled:opacity-60",children:l?"Saving…":"Save changes"}),c.jsx("button",{onClick:m,className:"px-4 py-2 rounded-lg bg-rose-100 text-rose-800 hover:bg-rose-200",children:"Delete group"})]})]})]}):c.jsx("div",{className:"max-w-3xl mx-auto p-6",children:"Not found."})}function is({label:t,children:e}){return c.jsxs("label",{className:"block",children:[c.jsx("div",{className:"text-sm font-medium text-slate-700",children:t}),c.jsx("div",{className:"mt-1",children:e})]})}function nV(){const t=Fe(ne),e=Ge(ne),[n,r]=k.useState([]),[s,i]=k.useState(!0),[o,l]=k.useState(""),[u,d]=k.useState("");async function f(){i(!0);const y=await et(fe(t,"admins")),x=[];y.forEach(A=>x.push({uid:A.id,...A.data()})),x.sort((A,b)=>A.uid.localeCompare(b.uid)),r(x),i(!1)}k.useEffect(()=>{f()},[]);async function p(){var x;const y=u.trim();if(y){l("add");try{await Et(G(t,"admins",y),{createdAt:ke(),createdBy:((x=e.currentUser)==null?void 0:x.uid)||"unknown"},{merge:!0}),d(""),await f()}finally{l("")}}}async function m(y){l(y);try{await Ot(G(t,"admins",y)),await f()}finally{l("")}}return c.jsxs("div",{className:"max-w-3xl mx-auto p-6",children:[c.jsx("h1",{className:"text-2xl font-semibold text-slate-900",children:"Super Admins"}),c.jsx("p",{className:"text-slate-600 mt-1",children:"Add or remove super admins by UID."}),c.jsxs("div",{className:"mt-4 rounded-2xl border border-slate-200 bg-white/70 p-4",children:[c.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"Add by UID"}),c.jsxs("div",{className:"mt-2 flex gap-2",children:[c.jsx("input",{value:u,onChange:y=>d(y.target.value),placeholder:"Paste UID from Firebase Authentication → Users",className:"flex-1 rounded-lg border border-slate-300 px-3 py-2 text-sm"}),c.jsx("button",{onClick:p,disabled:!u.trim()||!!o,className:"px-3 py-2 rounded-lg text-sm bg-slate-900 text-white hover:bg-slate-800 disabled:opacity-60",children:o==="add"?"Adding…":"Add"})]})]}),c.jsx("div",{className:"mt-4 rounded-2xl border border-slate-200 bg-white/70",children:s?c.jsx("div",{className:"p-4 text-slate-600",children:"Loading…"}):n.length===0?c.jsx("div",{className:"p-4 text-slate-600",children:"No super admins yet."}):c.jsx("ul",{className:"divide-y divide-slate-200",children:n.map(y=>c.jsxs("li",{className:"p-4 flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("div",{className:"font-medium text-slate-900",children:y.uid}),c.jsxs("div",{className:"text-xs text-slate-500",children:["Created by: ",y.createdBy||"—"]})]}),c.jsx("button",{onClick:()=>m(y.uid),disabled:!!o,className:"text-xs px-3 py-1.5 rounded-lg bg-rose-100 text-rose-800 hover:bg-rose-200 disabled:opacity-60",children:o===y.uid?"Removing…":"Remove"})]},y.uid))})})]})}function rV({children:t}){const e=Ge(ne),n=Fe(ne),[r,s]=B.useState(!1),[i,o]=B.useState(null),[l,u]=B.useState(null),[d,f]=B.useState(null);return B.useEffect(()=>{const p=Mn(e,async m=>{if(s(!0),!m){o(null),u(!1);return}o(m.uid);try{const y=await be(G(n,"admins",m.uid));u(y.exists())}catch(y){f((y==null?void 0:y.message)||String(y)),u(!1)}});return()=>p()},[e,n]),!r||l===null?c.jsx("div",{className:"max-w-xl mx-auto p-6",children:"Checking…"}):l?c.jsx(c.Fragment,{children:t}):c.jsxs("div",{className:"max-w-xl mx-auto p-6 rounded-2xl border border-slate-200 bg-white/70",children:[c.jsx("h2",{className:"text-lg font-semibold text-slate-900",children:"AdminRouteDebug"}),c.jsxs("p",{className:"text-sm text-slate-700 mt-2",children:["UID: ",c.jsx("code",{children:i||"—"})]}),c.jsxs("p",{className:"text-sm text-slate-700",children:["admins/UID exists? ",c.jsx("strong",{children:l?"YES":"NO"})]}),!i&&c.jsx("p",{className:"mt-3 text-sm text-rose-700",children:"You are not signed in."}),i&&!l&&c.jsxs("p",{className:"mt-3 text-sm text-amber-700",children:["Signed in, but no document at ",c.jsxs("code",{children:["admins/","{uid}"]}),". Create that doc in Firestore for this project."]}),d&&c.jsxs("p",{className:"mt-3 text-sm text-rose-700",children:["Error reading ",c.jsxs("code",{children:["admins/","{uid}"]}),": ",d]})]})}function Tw(t,e){return[t,e].sort().join("_")}function sV(){var St;const t=B.useMemo(()=>Fe(ne),[]),e=B.useMemo(()=>Ge(ne),[]),[n,r]=B.useState(((St=e.currentUser)==null?void 0:St.uid)??null),[s,i]=B.useState(!1),[o,l]=B.useState(!1);B.useEffect(()=>{const z=Mn(e,async Z=>{var ge;if(r((Z==null?void 0:Z.uid)??null),Z!=null&&Z.uid){try{const le=await be(G(t,"users",Z.uid));i(!!((ge=le.data())!=null&&ge.isCommunityApproved))}catch{i(!1)}try{const le=await be(G(t,"admins",Z.uid));l(le.exists())}catch{l(!1)}}else i(!1),l(!1)});return()=>z()},[e,t]);const[u,d]=B.useState(!1),[f,p]=B.useState("list"),[m,y]=B.useState([]),[x,A]=B.useState(null),[b,E]=B.useState([]),[v,w]=B.useState(""),R=B.useRef(null),[D,L]=B.useState([]),[S,_]=B.useState([]),[I,N]=B.useState({}),[P,j]=B.useState(""),[C,lt]=B.useState(!1),[Tt,Un]=B.useState(""),Q=B.useRef({});async function $(z){var Z,ge,le,Se;if(Q.current[z])return Q.current[z];try{let ce=await be(G(t,"users",z)),ee=((Z=ce.data())==null?void 0:Z.displayName)||((ge=ce.data())==null?void 0:ge.name);ee||(ce=await be(G(t,"admins",z)),ee=((le=ce.data())==null?void 0:le.displayName)||((Se=ce.data())==null?void 0:Se.name));const Je=ee||z;return Q.current[z]=Je,Je}catch{return z}}async function K(z){try{const Z=Ye(vr(t,"messages"),cn("from","==",z)),ge=Ye(vr(t,"messages"),cn("to","==",z)),[le,Se]=await Promise.all([et(Z),et(ge)]),ce=[...le.docs,...Se.docs],ee=[];for(const Je of ce){const ve=Je.data(),Ve=Je.ref.path.split("/");if(Ve.length<6)continue;const ze=Ve[1],yt=Ve[3],Yt=ve.from===z?ve.to:ve.from;if(!Yt)continue;const Fn=[z,Yt].sort(),Jr=G(fe(t,`groups/${ze}/directMessages`),yt);ee.push(Et(Jr,{users:Fn,lastText:ve.text||"",lastAt:ve.createdAt||ke(),lastSender:ve.from||z},{merge:!0}))}await Promise.allSettled(ee)}catch{}}const J=B.useRef([]);function _e(){J.current.forEach(z=>{try{z()}catch{}}),J.current=[]}function he(z,Z){_e();const ge={};Z.forEach(le=>{try{const Se=Ye(fe(t,`groups/${le.id}/directMessages`),cn("users","array-contains",z)),ce=_t(Se,ee=>{ee.docs.forEach(ve=>{const Ve=ve.data(),ze=(Ve==null?void 0:Ve.users)||[],yt=ze.find(Fn=>Fn!==z)||"",Yt={id:ve.id,groupId:le.id,users:ze,lastText:(Ve==null?void 0:Ve.lastText)||"",lastAt:Ve==null?void 0:Ve.lastAt,otherUid:yt,otherName:Q.current[yt]};ge[`${le.id}__${ve.id}`]=Yt});const Je=Object.values(ge).sort((ve,Ve)=>{var Yt,Fn;const ze=(Yt=ve.lastAt)!=null&&Yt.toMillis?ve.lastAt.toMillis():0;return((Fn=Ve.lastAt)!=null&&Fn.toMillis?Ve.lastAt.toMillis():0)-ze});y(Je),Je.forEach(ve=>{ve.otherUid&&!ve.otherName&&$(ve.otherUid).then(Ve=>{y(ze=>ze.map(yt=>yt.id===ve.id&&yt.groupId===ve.groupId?{...yt,otherName:Ve}:yt))})})},ee=>{ee&&ee.code!=="permission-denied"&&console.warn("DM per-group listener error:",ee)});J.current.push(ce)}catch{}})}B.useEffect(()=>{(async()=>{if(n)try{const z=await et(fe(t,`users/${n}/memberships`)),Z=[];for(const Se of z.docs){const ce=Se.id;Z.push({id:ce})}L(Z);const ge={},le=[];for(const Se of Z)try{const ce=await et(fe(t,`groups/${Se.id}/members`));for(const ee of ce.docs){if(ee.id===n||ge[ee.id])continue;ge[ee.id]=!0;let Je,ve;try{const ze=(await be(G(t,"users",ee.id))).data();Je=(ze==null?void 0:ze.displayName)||void 0,ve=(ze==null?void 0:ze.email)||void 0}catch{}le.push({uid:ee.id,displayName:Je,email:ve})}}catch{}_(le)}catch{L([]),_([])}})()},[t,n]),B.useEffect(()=>{if(!n||!s)return;let z=null,Z=!1;return(async()=>{try{try{const ge=Ye(vr(t,"directMessages"),cn("users","array-contains",n),Ln("lastAt","desc"));z=_t(ge,async le=>{const Se=[];for(const ce of le.docs){const ee=ce.data(),Je=ce.ref.path.split("/"),ve=Je.length>=2?Je[1]:"",Ve=(ee==null?void 0:ee.users)||[],ze=Ve.find(Yt=>Yt!==n)||"",yt={id:ce.id,groupId:ve,users:Ve,lastText:(ee==null?void 0:ee.lastText)||"",lastAt:ee==null?void 0:ee.lastAt,otherUid:ze,otherName:Q.current[ze]};Se.push(yt)}for(const ce of Se)ce.otherUid&&!ce.otherName&&$(ce.otherUid).then(ee=>{y(Je=>Je.map(ve=>ve.id===ce.id?{...ve,otherName:ee}:ve))});Z||y(Se),Se.length===0&&await K(n)},le=>{le&&(le.code==="permission-denied"||le.code==="failed-precondition")?he(n,D):console.warn("DM listener error:",le)})}catch{he(n,D)}}catch{}})(),()=>{z&&z(),_e()}},[t,n,s,D]),B.useEffect(()=>{if(!x||!n){R.current&&(R.current(),R.current=null),E([]);return}R.current&&(R.current(),R.current=null);const z=fe(t,`groups/${x.groupId}/directMessages/${x.id}/messages`),Z=Ye(z,Ln("createdAt","asc")),ge=_t(Z,le=>{const Se=le.docs.map(ce=>{const ee=ce.data();return{id:ce.id,text:(ee==null?void 0:ee.text)||"",from:(ee==null?void 0:ee.from)||"",to:(ee==null?void 0:ee.to)||"",displayName:(ee==null?void 0:ee.displayName)||"",createdAt:ee==null?void 0:ee.createdAt}});E(Se),Se.forEach(ce=>{ce.displayName||$(ce.from).then(ee=>{E(Je=>Je.map(ve=>ve.id===ce.id?{...ve,displayName:ee}:ve))})})});return R.current=ge,()=>{R.current&&(R.current(),R.current=null)}},[t,x==null?void 0:x.groupId,x==null?void 0:x.id,n]);async function se(z){var le;if(!n)throw new Error("No user");const Z=m.find(Se=>Se.otherUid===z);if(Z)return{groupId:Z.groupId,pid:Z.id};for(const Se of D)try{if((await be(G(t,`groups/${Se.id}/members`,z))).exists())return{groupId:Se.id,pid:Tw(n,z)}}catch{}const ge=(le=D[0])==null?void 0:le.id;if(!ge)throw new Error("No group memberships found");return{groupId:ge,pid:Tw(n,z)}}async function it(){var ge;if(!x||!n)return;const z=v.trim();if(!z)return;const Z=x.otherUid;try{const le=fe(t,`groups/${x.groupId}/directMessages/${x.id}/messages`);await Dr(le,{text:z,from:n,to:Z,displayName:((ge=e.currentUser)==null?void 0:ge.displayName)||"Member",createdAt:ke()}),await Et(G(fe(t,`groups/${x.groupId}/directMessages`),x.id),{users:[n,Z].sort(),lastText:z,lastAt:ke(),lastSender:n},{merge:!0}),w("")}catch{alert("Could not send message.")}}async function It(){var ge;if(!n)return;const z=Object.entries(I).filter(([,le])=>le).map(([le])=>le),Z=P.trim();if(!(z.length===0||!Z)){lt(!0);try{for(const le of z){const{groupId:Se,pid:ce}=await se(le);await Dr(fe(t,`groups/${Se}/directMessages/${ce}/messages`),{text:Z,from:n,to:le,displayName:((ge=e.currentUser)==null?void 0:ge.displayName)||"Member",createdAt:ke()}),await Et(G(t,`groups/${Se}/directMessages/${ce}`),{users:[n,le].sort(),lastText:Z,lastAt:ke(),lastSender:n},{merge:!0})}j(""),N({}),p("list")}catch{alert("Failed to send message(s).")}finally{lt(!1)}}}async function Ke(z){if(!x||!n)return;const Z=b.find(ge=>ge.id===z);if(Z&&(Z.from===n||o))try{await Ot(G(t,`groups/${x.groupId}/directMessages/${x.id}/messages/${z}`))}catch{alert("Failed to delete message (check rules).")}}if(!n||!s)return null;const Oe=S.filter(z=>{const Z=Tt.trim().toLowerCase();if(!Z)return!0;const ge=(z.displayName||"").toLowerCase(),le=(z.email||"").toLowerCase();return ge.includes(Z)||le.includes(Z)||z.uid.toLowerCase().includes(Z)});return c.jsxs(c.Fragment,{children:[c.jsx("button",{type:"button",onClick:()=>{d(z=>!z),u||p("list")},className:`fixed bottom-4 right-4 z-[1100] shadow-lg rounded-full px-4 py-2 text-white text-sm md:text-[13px] ${u?"hidden md:inline-flex":"inline-flex"}`,style:{backgroundColor:"#919FAA"},"aria-label":u?"Close direct messages":"Open direct messages",children:u?"Close DMs":"Open DMs"}),u&&c.jsxs("div",{className:`fixed z-[1000] bottom-0 inset-x-0 w-full h-[85vh] rounded-t-2xl
                     md:bottom-16 md:left-1/2 md:inset-x-auto md:w-full md:max-w-[780px] md:max-h-[480px] md:rounded-xl md:-translate-x-1/2 md:transform
                     border border-slate-800 bg-slate-900 text-white shadow-xl overflow-hidden
                     flex md:flex-row flex-col`,style:{paddingBottom:"env(safe-area-inset-bottom)"},children:[c.jsxs("div",{className:"md:hidden flex items-center justify-between px-3 py-2 border-b border-slate-800",children:[c.jsx("button",{type:"button",onClick:()=>d(!1),className:"text-xs rounded-md border border-slate-700 px-2 py-1","aria-label":"Close direct messages",children:"Close"}),c.jsx("div",{className:"text-sm font-semibold",children:"Direct Messages"}),f!=="compose"?c.jsx("button",{type:"button",onClick:()=>p("compose"),className:"text-xs rounded-md border border-slate-700 px-2 py-1","aria-label":"New message",children:"New"}):c.jsx("button",{type:"button",onClick:()=>p("list"),className:"text-xs rounded-md border border-slate-700 px-2 py-1","aria-label":"Back to conversations",children:"Back"})]}),f==="list"&&c.jsxs("div",{className:"md:w-64 md:border-r md:border-slate-800 h-[40vh] md:h-full overflow-auto",children:[c.jsxs("div",{className:"hidden md:flex px-3 py-2 text-sm font-semibold items-center justify-between",children:[c.jsx("span",{children:"Conversations"}),c.jsx("button",{type:"button",onClick:()=>p("compose"),className:"text-xs rounded-md border border-slate-700 px-2 py-1 hover:bg-slate-800",title:"New message",children:"New"})]}),m.length===0?c.jsx("div",{className:"px-3 py-2 text-sm text-slate-300",children:"No conversations yet."}):c.jsx("ul",{children:m.map(z=>c.jsx("li",{children:c.jsxs("button",{type:"button",onClick:()=>{A(z),p("chat")},className:`w-full text-left px-3 py-2 text-sm hover:bg-slate-800 ${x&&x.id===z.id&&x.groupId===z.groupId?"bg-slate-800":""}`,children:[c.jsx("div",{className:"font-medium truncate",children:z.otherName||z.otherUid}),c.jsx("div",{className:"text-xs text-slate-300 truncate",children:z.lastText||"…"}),c.jsxs("div",{className:"text-[10px] text-slate-400 mt-0.5",children:["Group: ",z.groupId]})]})},`${z.groupId}__${z.id}`))})]}),c.jsxs("div",{className:"flex-1 h-full flex flex-col",children:[f==="chat"&&x&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"px-3 py-2 border-b border-slate-800 flex items-center gap-2",children:[c.jsx("button",{type:"button",onClick:()=>p("list"),className:"text-xs rounded-md border border-slate-700 px-2 py-1 hover:bg-slate-800 md:hidden",children:"← Back"}),c.jsx("div",{className:"text-sm font-semibold truncate",children:x.otherName||x.otherUid}),c.jsxs("div",{className:"text-xs text-slate-400 ml-auto hidden md:block",children:["Group: ",x.groupId]})]}),c.jsxs("div",{className:"flex-1 overflow-auto p-3 space-y-2",children:[b.map(z=>{const Z=z.from===n;return c.jsxs("div",{className:`max-w-[85%] md:max-w-[80%] rounded-lg px-3 py-2 text-sm relative ${Z?"ml-auto border border-slate-700":"bg-slate-800"}`,children:[c.jsx("div",{className:"text-xs opacity-70 mb-0.5",children:z.displayName||z.from}),c.jsx("div",{children:z.text}),(Z||o)&&c.jsx("button",{type:"button",onClick:()=>void Ke(z.id),className:"absolute -top-2 -right-2 text-[10px] rounded-full border border-slate-700 bg-slate-900 px-1.5 py-0.5 hover:bg-slate-800",title:"Delete message",children:"×"})]},z.id)}),b.length===0&&c.jsx("div",{className:"text-sm text-slate-300",children:"No messages in this conversation yet."})]}),c.jsxs("div",{className:"border-t border-slate-800 p-2 flex gap-2",children:[c.jsx("textarea",{value:v,onChange:z=>w(z.target.value),placeholder:"Write a message…",className:"flex-1 rounded-lg border border-slate-700 bg-slate-800 px-3 py-2 text-sm outline-none text-white placeholder:text-slate-400 h-10 md:h-auto md:min-h-[40px] max-h-28",onKeyDown:z=>{z.key==="Enter"&&!z.shiftKey&&(z.preventDefault(),it())}}),c.jsx("button",{type:"button",onClick:()=>void it(),className:"rounded-lg px-3 py-2 text-white text-sm hover:opacity-90",style:{backgroundColor:"#919FAA"},disabled:!v.trim(),children:"Send"})]})]}),f==="compose"&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"px-3 py-2 border-b border-slate-800 flex items-center gap-2",children:[c.jsx("button",{type:"button",onClick:()=>p("list"),className:"text-xs rounded-md border border-slate-700 px-2 py-1 hover:bg-slate-800",children:"← Back"}),c.jsx("div",{className:"text-sm font-semibold",children:"New message"})]}),c.jsxs("div",{className:"flex-1 p-3 grid grid-cols-1 md:grid-cols-5 gap-3 overflow-auto",children:[c.jsxs("div",{className:"md:col-span-2",children:[c.jsx("label",{className:"text-xs text-slate-300",children:"Recipients"}),c.jsx("input",{value:Tt,onChange:z=>Un(z.target.value),placeholder:"Search by screen name…",className:"mt-1 w-full rounded-lg border border-slate-700 bg-slate-800 px-2 py-1.5 text-sm outline-none"}),c.jsx("div",{className:"mt-2 h-56 md:h-48 overflow-auto rounded-lg border border-slate-700",children:Oe.length===0?c.jsx("div",{className:"px-2 py-2 text-xs text-slate-400",children:"No matching users."}):c.jsx("ul",{className:"p-2 space-y-1",children:Oe.map(z=>c.jsxs("li",{className:"flex items-center gap-2",children:[c.jsx("input",{id:`sel-${z.uid}`,type:"checkbox",className:"h-4 w-4 accent-[#919FAA]",checked:!!I[z.uid],onChange:Z=>N(ge=>({...ge,[z.uid]:Z.target.checked}))}),c.jsxs("label",{htmlFor:`sel-${z.uid}`,className:"text-sm truncate",children:[z.displayName||z.uid,z.email?` • ${z.email}`:""]})]},z.uid))})})]}),c.jsxs("div",{className:"md:col-span-3 flex flex-col",children:[c.jsx("label",{className:"text-xs text-slate-300",children:"Message"}),c.jsx("textarea",{value:P,onChange:z=>j(z.target.value),placeholder:"Write your message…",className:"mt-1 flex-1 rounded-lg border border-slate-700 bg-slate-800 px-3 py-2 text-sm outline-none h-40 md:h-auto"})]})]}),c.jsxs("div",{className:"border-t border-slate-800 p-2 flex items-center justify-end gap-2",children:[c.jsx("button",{type:"button",onClick:()=>p("list"),className:"rounded-lg border border-slate-700 px-3 py-2 text-sm hover:bg-slate-800",children:"Cancel"}),c.jsx("button",{type:"button",onClick:()=>void It(),disabled:C||!P.trim()||!Object.values(I).some(Boolean),className:"rounded-lg px-3 py-2 text-white text-sm hover:opacity-90 disabled:opacity-60",style:{backgroundColor:"#919FAA"},children:C?"Sending…":"Send"})]})]}),f==="list"&&!x&&c.jsxs("div",{className:"hidden md:grid place-items-center flex-1 text-sm text-slate-300",children:["Select a conversation or click ",c.jsx("b",{className:"mx-1",children:"New"})," to start one."]})]})]})]})}function iV(){var d,f,p;const t=Ge(ne),[e,n]=k.useState(!1),[r,s]=k.useState(((d=t.currentUser)==null?void 0:d.uid)||null),[i,o]=k.useState(((f=t.currentUser)==null?void 0:f.email)||null);k.useEffect(()=>{const m=Mn(t,y=>{s((y==null?void 0:y.uid)||null),o((y==null?void 0:y.email)||null),n(!0)});return()=>m()},[t]);const l=(p=ne.options)==null?void 0:p.projectId;return c.jsxs("div",{className:"max-w-xl mx-auto p-6 rounded-2xl border border-slate-200 bg-white/70",children:[c.jsx("h1",{className:"text-lg font-semibold text-slate-900",children:"Auth Debug: WhoAmI"}),c.jsxs("div",{className:"mt-2 text-sm text-slate-700",children:[c.jsxs("div",{children:[c.jsx("span",{className:"font-medium",children:"ready:"})," ",String(e)]}),c.jsxs("div",{children:[c.jsx("span",{className:"font-medium",children:"email:"})," ",i||"—"]}),c.jsxs("div",{children:[c.jsx("span",{className:"font-medium",children:"uid:"})," ",c.jsx("code",{children:r||"—"})]}),c.jsxs("div",{className:"mt-2",children:[c.jsx("span",{className:"font-medium",children:"SDK projectId:"})," ",c.jsx("code",{children:l||"—"})]}),c.jsxs("div",{children:[c.jsx("span",{className:"font-medium",children:"ENV projectId:"})," ",c.jsx("code",{children:String("immanuel-app")})]})]})]})}function oV({children:t}){const e=Vn(),n=e.pathname==="/login"||e.pathname==="/signup"||e.pathname==="/forgot"||e.pathname==="/reset";return c.jsxs(c.Fragment,{children:[n?c.jsx(QO,{}):c.jsx(JO,{}),!n&&c.jsx(sV,{}),t]})}function aV(){return c.jsx(YA,{children:c.jsx(FO,{children:c.jsx(oV,{children:c.jsxs($A,{children:[c.jsx(Pe,{path:"/",element:c.jsx(fr,{to:"/login",replace:!0})}),c.jsx(Pe,{path:"/login",element:c.jsx(XO,{})}),c.jsx(Pe,{path:"/signup",element:c.jsx(eL,{})}),c.jsx(Pe,{path:"/forgot",element:c.jsx(DL,{})}),c.jsx(Pe,{path:"/reset",element:c.jsx(OL,{})}),c.jsx(Pe,{path:"/welcome",element:c.jsx(Nn,{children:c.jsx(ML,{})})}),c.jsx(Pe,{path:"/dashboard",element:c.jsx(Nn,{children:c.jsx(Jt,{children:c.jsx(rL,{})})})}),c.jsx(Pe,{path:"/groups",element:c.jsx(Nn,{children:c.jsx(Jt,{children:c.jsx(sL,{})})})}),c.jsx(Pe,{path:"/forums",element:c.jsx(Nn,{children:c.jsx(Jt,{children:c.jsx(iL,{})})})}),c.jsx(Pe,{path:"/resources",element:c.jsx(Nn,{children:c.jsx(Jt,{children:c.jsx(oL,{})})})}),c.jsx(Pe,{path:"/events",element:c.jsx(Nn,{children:c.jsx(Jt,{children:c.jsx(aL,{})})})}),c.jsx(Pe,{path:"/profile",element:c.jsx(Nn,{children:c.jsx(Jt,{children:c.jsx(PL,{})})})}),c.jsx(Pe,{path:"/settings",element:c.jsx(Nn,{children:c.jsx(Jt,{children:c.jsx(jL,{})})})}),c.jsx(Pe,{path:"/sunday-resources",element:c.jsx(Nn,{children:c.jsx(Jt,{children:c.jsx(BL,{})})})}),c.jsx(Pe,{path:"/groups/explore",element:c.jsx(Nn,{children:c.jsx(Jt,{children:c.jsx(HO,{})})})}),c.jsx(Pe,{path:"/groups/:slug",element:c.jsx(Nn,{children:c.jsx(Jt,{children:c.jsx(GO,{})})})}),c.jsx(Pe,{path:"/groups/:slug/dm/:otherUid",element:c.jsx(Nn,{children:c.jsx(Jt,{children:c.jsx(qL,{})})})}),c.jsx(Pe,{path:"/admin",element:c.jsx(Ys,{children:c.jsx(fr,{to:"/admin/groups",replace:!0})})}),c.jsx(Pe,{path:"/admin/groups",element:c.jsx(Ys,{children:c.jsx(Jt,{children:c.jsx(WL,{})})})}),c.jsx(Pe,{path:"/admin/groups/:slug/requests",element:c.jsx(Uh,{children:c.jsx(Jt,{children:c.jsx(KL,{})})})}),c.jsx(Pe,{path:"/admin/groups/:slug/members",element:c.jsx(Uh,{children:c.jsx(Jt,{children:c.jsx(YL,{})})})}),c.jsx(Pe,{path:"/admin/groups/:slug/events",element:c.jsx(Uh,{children:c.jsx(Jt,{children:c.jsx(XL,{})})})}),c.jsx(Pe,{path:"/admin/super-admins",element:c.jsx(Ys,{children:c.jsx(nV,{})})}),c.jsx(Pe,{path:"/admin/group-admins/by-email",element:c.jsx(Ys,{children:c.jsx(ZL,{})})}),c.jsx(Pe,{path:"/admin/users",element:c.jsx(Ys,{children:c.jsx(GL,{})})}),c.jsx(Pe,{path:"/admin/groups/new",element:c.jsx(Ys,{children:c.jsx(Ew,{})})}),c.jsx(Pe,{path:"/admin/groups/:slug/edit",element:c.jsx(Ys,{children:c.jsx(tV,{})})}),c.jsx(Pe,{path:"/__whoami",element:c.jsx(iV,{})}),c.jsx(Pe,{path:"/__admin/new",element:c.jsx(rV,{children:c.jsx(Ew,{})})}),c.jsx(Pe,{path:"*",element:c.jsx(fr,{to:"/dashboard",replace:!0})})]})})})})}"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/sw.js").catch(t=>{console.error("SW registration failed",t)})});Fh.createRoot(document.getElementById("root")).render(c.jsx(B.StrictMode,{children:c.jsx(aV,{})}));
