function NS(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in t)){const i=Object.getOwnPropertyDescriptor(r,s);i&&Object.defineProperty(t,s,i.get?i:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();function bS(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Nw={exports:{}},$c={},bw={exports:{}},we={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var cl=Symbol.for("react.element"),AS=Symbol.for("react.portal"),CS=Symbol.for("react.fragment"),kS=Symbol.for("react.strict_mode"),RS=Symbol.for("react.profiler"),PS=Symbol.for("react.provider"),jS=Symbol.for("react.context"),DS=Symbol.for("react.forward_ref"),OS=Symbol.for("react.suspense"),VS=Symbol.for("react.memo"),LS=Symbol.for("react.lazy"),py=Symbol.iterator;function MS(t){return t===null||typeof t!="object"?null:(t=py&&t[py]||t["@@iterator"],typeof t=="function"?t:null)}var Aw={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Cw=Object.assign,kw={};function ko(t,e,n){this.props=t,this.context=e,this.refs=kw,this.updater=n||Aw}ko.prototype.isReactComponent={};ko.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};ko.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function Rw(){}Rw.prototype=ko.prototype;function _p(t,e,n){this.props=t,this.context=e,this.refs=kw,this.updater=n||Aw}var wp=_p.prototype=new Rw;wp.constructor=_p;Cw(wp,ko.prototype);wp.isPureReactComponent=!0;var my=Array.isArray,Pw=Object.prototype.hasOwnProperty,xp={current:null},jw={key:!0,ref:!0,__self:!0,__source:!0};function Dw(t,e,n){var r,s={},i=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)Pw.call(e,r)&&!jw.hasOwnProperty(r)&&(s[r]=e[r]);var l=arguments.length-2;if(l===1)s.children=n;else if(1<l){for(var c=Array(l),d=0;d<l;d++)c[d]=arguments[d+2];s.children=c}if(t&&t.defaultProps)for(r in l=t.defaultProps,l)s[r]===void 0&&(s[r]=l[r]);return{$$typeof:cl,type:t,key:i,ref:o,props:s,_owner:xp.current}}function US(t,e){return{$$typeof:cl,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Ep(t){return typeof t=="object"&&t!==null&&t.$$typeof===cl}function FS(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var gy=/\/+/g;function Jd(t,e){return typeof t=="object"&&t!==null&&t.key!=null?FS(""+t.key):e.toString(36)}function Tu(t,e,n,r,s){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case cl:case AS:o=!0}}if(o)return o=t,s=s(o),t=r===""?"."+Jd(o,0):r,my(s)?(n="",t!=null&&(n=t.replace(gy,"$&/")+"/"),Tu(s,e,n,"",function(d){return d})):s!=null&&(Ep(s)&&(s=US(s,n+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(gy,"$&/")+"/")+t)),e.push(s)),1;if(o=0,r=r===""?".":r+":",my(t))for(var l=0;l<t.length;l++){i=t[l];var c=r+Jd(i,l);o+=Tu(i,e,n,c,s)}else if(c=MS(t),typeof c=="function")for(t=c.call(t),l=0;!(i=t.next()).done;)i=i.value,c=r+Jd(i,l++),o+=Tu(i,e,n,c,s);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Xl(t,e,n){if(t==null)return t;var r=[],s=0;return Tu(t,r,"","",function(i){return e.call(n,i,s++)}),r}function $S(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var tn={current:null},Iu={transition:null},BS={ReactCurrentDispatcher:tn,ReactCurrentBatchConfig:Iu,ReactCurrentOwner:xp};function Ow(){throw Error("act(...) is not supported in production builds of React.")}we.Children={map:Xl,forEach:function(t,e,n){Xl(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Xl(t,function(){e++}),e},toArray:function(t){return Xl(t,function(e){return e})||[]},only:function(t){if(!Ep(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};we.Component=ko;we.Fragment=CS;we.Profiler=RS;we.PureComponent=_p;we.StrictMode=kS;we.Suspense=OS;we.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=BS;we.act=Ow;we.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=Cw({},t.props),s=t.key,i=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=xp.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(c in e)Pw.call(e,c)&&!jw.hasOwnProperty(c)&&(r[c]=e[c]===void 0&&l!==void 0?l[c]:e[c])}var c=arguments.length-2;if(c===1)r.children=n;else if(1<c){l=Array(c);for(var d=0;d<c;d++)l[d]=arguments[d+2];r.children=l}return{$$typeof:cl,type:t.type,key:s,ref:i,props:r,_owner:o}};we.createContext=function(t){return t={$$typeof:jS,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:PS,_context:t},t.Consumer=t};we.createElement=Dw;we.createFactory=function(t){var e=Dw.bind(null,t);return e.type=t,e};we.createRef=function(){return{current:null}};we.forwardRef=function(t){return{$$typeof:DS,render:t}};we.isValidElement=Ep;we.lazy=function(t){return{$$typeof:LS,_payload:{_status:-1,_result:t},_init:$S}};we.memo=function(t,e){return{$$typeof:VS,type:t,compare:e===void 0?null:e}};we.startTransition=function(t){var e=Iu.transition;Iu.transition={};try{t()}finally{Iu.transition=e}};we.unstable_act=Ow;we.useCallback=function(t,e){return tn.current.useCallback(t,e)};we.useContext=function(t){return tn.current.useContext(t)};we.useDebugValue=function(){};we.useDeferredValue=function(t){return tn.current.useDeferredValue(t)};we.useEffect=function(t,e){return tn.current.useEffect(t,e)};we.useId=function(){return tn.current.useId()};we.useImperativeHandle=function(t,e,n){return tn.current.useImperativeHandle(t,e,n)};we.useInsertionEffect=function(t,e){return tn.current.useInsertionEffect(t,e)};we.useLayoutEffect=function(t,e){return tn.current.useLayoutEffect(t,e)};we.useMemo=function(t,e){return tn.current.useMemo(t,e)};we.useReducer=function(t,e,n){return tn.current.useReducer(t,e,n)};we.useRef=function(t){return tn.current.useRef(t)};we.useState=function(t){return tn.current.useState(t)};we.useSyncExternalStore=function(t,e,n){return tn.current.useSyncExternalStore(t,e,n)};we.useTransition=function(){return tn.current.useTransition()};we.version="18.3.1";bw.exports=we;var k=bw.exports;const $=bS(k),zS=NS({__proto__:null,default:$},[k]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var qS=k,WS=Symbol.for("react.element"),HS=Symbol.for("react.fragment"),GS=Object.prototype.hasOwnProperty,KS=qS.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,QS={key:!0,ref:!0,__self:!0,__source:!0};function Vw(t,e,n){var r,s={},i=null,o=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)GS.call(e,r)&&!QS.hasOwnProperty(r)&&(s[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:WS,type:t,key:i,ref:o,props:s,_owner:KS.current}}$c.Fragment=HS;$c.jsx=Vw;$c.jsxs=Vw;Nw.exports=$c;var u=Nw.exports,qh={},Lw={exports:{}},Tn={},Mw={exports:{}},Uw={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(B,K){var J=B.length;B.push(K);e:for(;0<J;){var ye=J-1>>>1,de=B[ye];if(0<s(de,K))B[ye]=K,B[J]=de,J=ye;else break e}}function n(B){return B.length===0?null:B[0]}function r(B){if(B.length===0)return null;var K=B[0],J=B.pop();if(J!==K){B[0]=J;e:for(var ye=0,de=B.length,re=de>>>1;ye<re;){var st=2*(ye+1)-1,Et=B[st],Qe=st+1,Oe=B[Qe];if(0>s(Et,J))Qe<de&&0>s(Oe,Et)?(B[ye]=Oe,B[Qe]=J,ye=Qe):(B[ye]=Et,B[st]=J,ye=st);else if(Qe<de&&0>s(Oe,J))B[ye]=Oe,B[Qe]=J,ye=Qe;else break e}}return K}function s(B,K){var J=B.sortIndex-K.sortIndex;return J!==0?J:B.id-K.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var c=[],d=[],f=1,p=null,m=3,y=!1,w=!1,A=!1,b=typeof setTimeout=="function"?setTimeout:null,E=typeof clearTimeout=="function"?clearTimeout:null,v=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function x(B){for(var K=n(d);K!==null;){if(K.callback===null)r(d);else if(K.startTime<=B)r(d),K.sortIndex=K.expirationTime,e(c,K);else break;K=n(d)}}function R(B){if(A=!1,x(B),!w)if(n(c)!==null)w=!0,Un(O);else{var K=n(d);K!==null&&Q(R,K.startTime-B)}}function O(B,K){w=!1,A&&(A=!1,E(_),_=-1),y=!0;var J=m;try{for(x(K),p=n(c);p!==null&&(!(p.expirationTime>K)||B&&!P());){var ye=p.callback;if(typeof ye=="function"){p.callback=null,m=p.priorityLevel;var de=ye(p.expirationTime<=K);K=t.unstable_now(),typeof de=="function"?p.callback=de:p===n(c)&&r(c),x(K)}else r(c);p=n(c)}if(p!==null)var re=!0;else{var st=n(d);st!==null&&Q(R,st.startTime-K),re=!1}return re}finally{p=null,m=J,y=!1}}var L=!1,S=null,_=-1,I=5,N=-1;function P(){return!(t.unstable_now()-N<I)}function j(){if(S!==null){var B=t.unstable_now();N=B;var K=!0;try{K=S(!0,B)}finally{K?C():(L=!1,S=null)}}else L=!1}var C;if(typeof v=="function")C=function(){v(j)};else if(typeof MessageChannel<"u"){var at=new MessageChannel,xt=at.port2;at.port1.onmessage=j,C=function(){xt.postMessage(null)}}else C=function(){b(j,0)};function Un(B){S=B,L||(L=!0,C())}function Q(B,K){_=b(function(){B(t.unstable_now())},K)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(B){B.callback=null},t.unstable_continueExecution=function(){w||y||(w=!0,Un(O))},t.unstable_forceFrameRate=function(B){0>B||125<B?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<B?Math.floor(1e3/B):5},t.unstable_getCurrentPriorityLevel=function(){return m},t.unstable_getFirstCallbackNode=function(){return n(c)},t.unstable_next=function(B){switch(m){case 1:case 2:case 3:var K=3;break;default:K=m}var J=m;m=K;try{return B()}finally{m=J}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(B,K){switch(B){case 1:case 2:case 3:case 4:case 5:break;default:B=3}var J=m;m=B;try{return K()}finally{m=J}},t.unstable_scheduleCallback=function(B,K,J){var ye=t.unstable_now();switch(typeof J=="object"&&J!==null?(J=J.delay,J=typeof J=="number"&&0<J?ye+J:ye):J=ye,B){case 1:var de=-1;break;case 2:de=250;break;case 5:de=1073741823;break;case 4:de=1e4;break;default:de=5e3}return de=J+de,B={id:f++,callback:K,priorityLevel:B,startTime:J,expirationTime:de,sortIndex:-1},J>ye?(B.sortIndex=J,e(d,B),n(c)===null&&B===n(d)&&(A?(E(_),_=-1):A=!0,Q(R,J-ye))):(B.sortIndex=de,e(c,B),w||y||(w=!0,Un(O))),B},t.unstable_shouldYield=P,t.unstable_wrapCallback=function(B){var K=m;return function(){var J=m;m=K;try{return B.apply(this,arguments)}finally{m=J}}}})(Uw);Mw.exports=Uw;var YS=Mw.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var JS=k,xn=YS;function q(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Fw=new Set,Pa={};function xi(t,e){po(t,e),po(t+"Capture",e)}function po(t,e){for(Pa[t]=e,t=0;t<e.length;t++)Fw.add(e[t])}var Ur=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Wh=Object.prototype.hasOwnProperty,XS=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,yy={},vy={};function ZS(t){return Wh.call(vy,t)?!0:Wh.call(yy,t)?!1:XS.test(t)?vy[t]=!0:(yy[t]=!0,!1)}function eN(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function tN(t,e,n,r){if(e===null||typeof e>"u"||eN(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function nn(t,e,n,r,s,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var Vt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Vt[t]=new nn(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Vt[e]=new nn(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Vt[t]=new nn(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Vt[t]=new nn(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Vt[t]=new nn(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Vt[t]=new nn(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Vt[t]=new nn(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Vt[t]=new nn(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Vt[t]=new nn(t,5,!1,t.toLowerCase(),null,!1,!1)});var Tp=/[\-:]([a-z])/g;function Ip(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Tp,Ip);Vt[e]=new nn(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Tp,Ip);Vt[e]=new nn(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Tp,Ip);Vt[e]=new nn(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Vt[t]=new nn(t,1,!1,t.toLowerCase(),null,!1,!1)});Vt.xlinkHref=new nn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Vt[t]=new nn(t,1,!1,t.toLowerCase(),null,!0,!0)});function Sp(t,e,n,r){var s=Vt.hasOwnProperty(e)?Vt[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(tN(e,n,s,r)&&(n=null),r||s===null?ZS(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):s.mustUseProperty?t[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?t.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var Gr=JS.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Zl=Symbol.for("react.element"),zi=Symbol.for("react.portal"),qi=Symbol.for("react.fragment"),Np=Symbol.for("react.strict_mode"),Hh=Symbol.for("react.profiler"),$w=Symbol.for("react.provider"),Bw=Symbol.for("react.context"),bp=Symbol.for("react.forward_ref"),Gh=Symbol.for("react.suspense"),Kh=Symbol.for("react.suspense_list"),Ap=Symbol.for("react.memo"),os=Symbol.for("react.lazy"),zw=Symbol.for("react.offscreen"),_y=Symbol.iterator;function Zo(t){return t===null||typeof t!="object"?null:(t=_y&&t[_y]||t["@@iterator"],typeof t=="function"?t:null)}var nt=Object.assign,Xd;function aa(t){if(Xd===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Xd=e&&e[1]||""}return`
`+Xd+t}var Zd=!1;function eh(t,e){if(!t||Zd)return"";Zd=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(d){var r=d}Reflect.construct(t,[],e)}else{try{e.call()}catch(d){r=d}t.call(e.prototype)}else{try{throw Error()}catch(d){r=d}t()}}catch(d){if(d&&r&&typeof d.stack=="string"){for(var s=d.stack.split(`
`),i=r.stack.split(`
`),o=s.length-1,l=i.length-1;1<=o&&0<=l&&s[o]!==i[l];)l--;for(;1<=o&&0<=l;o--,l--)if(s[o]!==i[l]){if(o!==1||l!==1)do if(o--,l--,0>l||s[o]!==i[l]){var c=`
`+s[o].replace(" at new "," at ");return t.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",t.displayName)),c}while(1<=o&&0<=l);break}}}finally{Zd=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?aa(t):""}function nN(t){switch(t.tag){case 5:return aa(t.type);case 16:return aa("Lazy");case 13:return aa("Suspense");case 19:return aa("SuspenseList");case 0:case 2:case 15:return t=eh(t.type,!1),t;case 11:return t=eh(t.type.render,!1),t;case 1:return t=eh(t.type,!0),t;default:return""}}function Qh(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case qi:return"Fragment";case zi:return"Portal";case Hh:return"Profiler";case Np:return"StrictMode";case Gh:return"Suspense";case Kh:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case Bw:return(t.displayName||"Context")+".Consumer";case $w:return(t._context.displayName||"Context")+".Provider";case bp:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Ap:return e=t.displayName||null,e!==null?e:Qh(t.type)||"Memo";case os:e=t._payload,t=t._init;try{return Qh(t(e))}catch{}}return null}function rN(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Qh(e);case 8:return e===Np?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Rs(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function qw(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function sN(t){var e=qw(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(o){r=""+o,i.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function eu(t){t._valueTracker||(t._valueTracker=sN(t))}function Ww(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=qw(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function Wu(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Yh(t,e){var n=e.checked;return nt({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function wy(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Rs(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function Hw(t,e){e=e.checked,e!=null&&Sp(t,"checked",e,!1)}function Jh(t,e){Hw(t,e);var n=Rs(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Xh(t,e.type,n):e.hasOwnProperty("defaultValue")&&Xh(t,e.type,Rs(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function xy(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Xh(t,e,n){(e!=="number"||Wu(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var la=Array.isArray;function ro(t,e,n,r){if(t=t.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=e.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Rs(n),e=null,s=0;s<t.length;s++){if(t[s].value===n){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function Zh(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(q(91));return nt({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Ey(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(q(92));if(la(n)){if(1<n.length)throw Error(q(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Rs(n)}}function Gw(t,e){var n=Rs(e.value),r=Rs(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function Ty(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function Kw(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ef(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?Kw(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var tu,Qw=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(tu=tu||document.createElement("div"),tu.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=tu.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function ja(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var ga={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},iN=["Webkit","ms","Moz","O"];Object.keys(ga).forEach(function(t){iN.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),ga[e]=ga[t]})});function Yw(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||ga.hasOwnProperty(t)&&ga[t]?(""+e).trim():e+"px"}function Jw(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=Yw(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,s):t[n]=s}}var oN=nt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function tf(t,e){if(e){if(oN[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(q(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(q(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(q(61))}if(e.style!=null&&typeof e.style!="object")throw Error(q(62))}}function nf(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var rf=null;function Cp(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var sf=null,so=null,io=null;function Iy(t){if(t=fl(t)){if(typeof sf!="function")throw Error(q(280));var e=t.stateNode;e&&(e=Hc(e),sf(t.stateNode,t.type,e))}}function Xw(t){so?io?io.push(t):io=[t]:so=t}function Zw(){if(so){var t=so,e=io;if(io=so=null,Iy(t),e)for(t=0;t<e.length;t++)Iy(e[t])}}function ex(t,e){return t(e)}function tx(){}var th=!1;function nx(t,e,n){if(th)return t(e,n);th=!0;try{return ex(t,e,n)}finally{th=!1,(so!==null||io!==null)&&(tx(),Zw())}}function Da(t,e){var n=t.stateNode;if(n===null)return null;var r=Hc(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(q(231,e,typeof n));return n}var of=!1;if(Ur)try{var ea={};Object.defineProperty(ea,"passive",{get:function(){of=!0}}),window.addEventListener("test",ea,ea),window.removeEventListener("test",ea,ea)}catch{of=!1}function aN(t,e,n,r,s,i,o,l,c){var d=Array.prototype.slice.call(arguments,3);try{e.apply(n,d)}catch(f){this.onError(f)}}var ya=!1,Hu=null,Gu=!1,af=null,lN={onError:function(t){ya=!0,Hu=t}};function uN(t,e,n,r,s,i,o,l,c){ya=!1,Hu=null,aN.apply(lN,arguments)}function cN(t,e,n,r,s,i,o,l,c){if(uN.apply(this,arguments),ya){if(ya){var d=Hu;ya=!1,Hu=null}else throw Error(q(198));Gu||(Gu=!0,af=d)}}function Ei(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function rx(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Sy(t){if(Ei(t)!==t)throw Error(q(188))}function dN(t){var e=t.alternate;if(!e){if(e=Ei(t),e===null)throw Error(q(188));return e!==t?null:t}for(var n=t,r=e;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return Sy(s),t;if(i===r)return Sy(s),e;i=i.sibling}throw Error(q(188))}if(n.return!==r.return)n=s,r=i;else{for(var o=!1,l=s.child;l;){if(l===n){o=!0,n=s,r=i;break}if(l===r){o=!0,r=s,n=i;break}l=l.sibling}if(!o){for(l=i.child;l;){if(l===n){o=!0,n=i,r=s;break}if(l===r){o=!0,r=i,n=s;break}l=l.sibling}if(!o)throw Error(q(189))}}if(n.alternate!==r)throw Error(q(190))}if(n.tag!==3)throw Error(q(188));return n.stateNode.current===n?t:e}function sx(t){return t=dN(t),t!==null?ix(t):null}function ix(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=ix(t);if(e!==null)return e;t=t.sibling}return null}var ox=xn.unstable_scheduleCallback,Ny=xn.unstable_cancelCallback,hN=xn.unstable_shouldYield,fN=xn.unstable_requestPaint,ut=xn.unstable_now,pN=xn.unstable_getCurrentPriorityLevel,kp=xn.unstable_ImmediatePriority,ax=xn.unstable_UserBlockingPriority,Ku=xn.unstable_NormalPriority,mN=xn.unstable_LowPriority,lx=xn.unstable_IdlePriority,Bc=null,hr=null;function gN(t){if(hr&&typeof hr.onCommitFiberRoot=="function")try{hr.onCommitFiberRoot(Bc,t,void 0,(t.current.flags&128)===128)}catch{}}var Kn=Math.clz32?Math.clz32:_N,yN=Math.log,vN=Math.LN2;function _N(t){return t>>>=0,t===0?32:31-(yN(t)/vN|0)|0}var nu=64,ru=4194304;function ua(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Qu(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,s=t.suspendedLanes,i=t.pingedLanes,o=n&268435455;if(o!==0){var l=o&~s;l!==0?r=ua(l):(i&=o,i!==0&&(r=ua(i)))}else o=n&~s,o!==0?r=ua(o):i!==0&&(r=ua(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-Kn(e),s=1<<n,r|=t[n],e&=~s;return r}function wN(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function xN(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,i=t.pendingLanes;0<i;){var o=31-Kn(i),l=1<<o,c=s[o];c===-1?(!(l&n)||l&r)&&(s[o]=wN(l,e)):c<=e&&(t.expiredLanes|=l),i&=~l}}function lf(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function ux(){var t=nu;return nu<<=1,!(nu&4194240)&&(nu=64),t}function nh(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function dl(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Kn(e),t[e]=n}function EN(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-Kn(n),i=1<<s;e[s]=0,r[s]=-1,t[s]=-1,n&=~i}}function Rp(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-Kn(n),s=1<<r;s&e|t[r]&e&&(t[r]|=e),n&=~s}}var Ve=0;function cx(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var dx,Pp,hx,fx,px,uf=!1,su=[],vs=null,_s=null,ws=null,Oa=new Map,Va=new Map,ls=[],TN="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function by(t,e){switch(t){case"focusin":case"focusout":vs=null;break;case"dragenter":case"dragleave":_s=null;break;case"mouseover":case"mouseout":ws=null;break;case"pointerover":case"pointerout":Oa.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Va.delete(e.pointerId)}}function ta(t,e,n,r,s,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},e!==null&&(e=fl(e),e!==null&&Pp(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function IN(t,e,n,r,s){switch(e){case"focusin":return vs=ta(vs,t,e,n,r,s),!0;case"dragenter":return _s=ta(_s,t,e,n,r,s),!0;case"mouseover":return ws=ta(ws,t,e,n,r,s),!0;case"pointerover":var i=s.pointerId;return Oa.set(i,ta(Oa.get(i)||null,t,e,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,Va.set(i,ta(Va.get(i)||null,t,e,n,r,s)),!0}return!1}function mx(t){var e=ei(t.target);if(e!==null){var n=Ei(e);if(n!==null){if(e=n.tag,e===13){if(e=rx(n),e!==null){t.blockedOn=e,px(t.priority,function(){hx(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Su(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=cf(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);rf=r,n.target.dispatchEvent(r),rf=null}else return e=fl(n),e!==null&&Pp(e),t.blockedOn=n,!1;e.shift()}return!0}function Ay(t,e,n){Su(t)&&n.delete(e)}function SN(){uf=!1,vs!==null&&Su(vs)&&(vs=null),_s!==null&&Su(_s)&&(_s=null),ws!==null&&Su(ws)&&(ws=null),Oa.forEach(Ay),Va.forEach(Ay)}function na(t,e){t.blockedOn===e&&(t.blockedOn=null,uf||(uf=!0,xn.unstable_scheduleCallback(xn.unstable_NormalPriority,SN)))}function La(t){function e(s){return na(s,t)}if(0<su.length){na(su[0],t);for(var n=1;n<su.length;n++){var r=su[n];r.blockedOn===t&&(r.blockedOn=null)}}for(vs!==null&&na(vs,t),_s!==null&&na(_s,t),ws!==null&&na(ws,t),Oa.forEach(e),Va.forEach(e),n=0;n<ls.length;n++)r=ls[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<ls.length&&(n=ls[0],n.blockedOn===null);)mx(n),n.blockedOn===null&&ls.shift()}var oo=Gr.ReactCurrentBatchConfig,Yu=!0;function NN(t,e,n,r){var s=Ve,i=oo.transition;oo.transition=null;try{Ve=1,jp(t,e,n,r)}finally{Ve=s,oo.transition=i}}function bN(t,e,n,r){var s=Ve,i=oo.transition;oo.transition=null;try{Ve=4,jp(t,e,n,r)}finally{Ve=s,oo.transition=i}}function jp(t,e,n,r){if(Yu){var s=cf(t,e,n,r);if(s===null)hh(t,e,r,Ju,n),by(t,r);else if(IN(s,t,e,n,r))r.stopPropagation();else if(by(t,r),e&4&&-1<TN.indexOf(t)){for(;s!==null;){var i=fl(s);if(i!==null&&dx(i),i=cf(t,e,n,r),i===null&&hh(t,e,r,Ju,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else hh(t,e,r,null,n)}}var Ju=null;function cf(t,e,n,r){if(Ju=null,t=Cp(r),t=ei(t),t!==null)if(e=Ei(t),e===null)t=null;else if(n=e.tag,n===13){if(t=rx(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Ju=t,null}function gx(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(pN()){case kp:return 1;case ax:return 4;case Ku:case mN:return 16;case lx:return 536870912;default:return 16}default:return 16}}var ps=null,Dp=null,Nu=null;function yx(){if(Nu)return Nu;var t,e=Dp,n=e.length,r,s="value"in ps?ps.value:ps.textContent,i=s.length;for(t=0;t<n&&e[t]===s[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===s[i-r];r++);return Nu=s.slice(t,1<r?1-r:void 0)}function bu(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function iu(){return!0}function Cy(){return!1}function In(t){function e(n,r,s,i,o){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(n=t[l],this[l]=n?n(i):i[l]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?iu:Cy,this.isPropagationStopped=Cy,this}return nt(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=iu)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=iu)},persist:function(){},isPersistent:iu}),e}var Ro={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Op=In(Ro),hl=nt({},Ro,{view:0,detail:0}),AN=In(hl),rh,sh,ra,zc=nt({},hl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Vp,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==ra&&(ra&&t.type==="mousemove"?(rh=t.screenX-ra.screenX,sh=t.screenY-ra.screenY):sh=rh=0,ra=t),rh)},movementY:function(t){return"movementY"in t?t.movementY:sh}}),ky=In(zc),CN=nt({},zc,{dataTransfer:0}),kN=In(CN),RN=nt({},hl,{relatedTarget:0}),ih=In(RN),PN=nt({},Ro,{animationName:0,elapsedTime:0,pseudoElement:0}),jN=In(PN),DN=nt({},Ro,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),ON=In(DN),VN=nt({},Ro,{data:0}),Ry=In(VN),LN={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},MN={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},UN={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function FN(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=UN[t])?!!e[t]:!1}function Vp(){return FN}var $N=nt({},hl,{key:function(t){if(t.key){var e=LN[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=bu(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?MN[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Vp,charCode:function(t){return t.type==="keypress"?bu(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?bu(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),BN=In($N),zN=nt({},zc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Py=In(zN),qN=nt({},hl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Vp}),WN=In(qN),HN=nt({},Ro,{propertyName:0,elapsedTime:0,pseudoElement:0}),GN=In(HN),KN=nt({},zc,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),QN=In(KN),YN=[9,13,27,32],Lp=Ur&&"CompositionEvent"in window,va=null;Ur&&"documentMode"in document&&(va=document.documentMode);var JN=Ur&&"TextEvent"in window&&!va,vx=Ur&&(!Lp||va&&8<va&&11>=va),jy=" ",Dy=!1;function _x(t,e){switch(t){case"keyup":return YN.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function wx(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Wi=!1;function XN(t,e){switch(t){case"compositionend":return wx(e);case"keypress":return e.which!==32?null:(Dy=!0,jy);case"textInput":return t=e.data,t===jy&&Dy?null:t;default:return null}}function ZN(t,e){if(Wi)return t==="compositionend"||!Lp&&_x(t,e)?(t=yx(),Nu=Dp=ps=null,Wi=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return vx&&e.locale!=="ko"?null:e.data;default:return null}}var eb={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Oy(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!eb[t.type]:e==="textarea"}function xx(t,e,n,r){Xw(r),e=Xu(e,"onChange"),0<e.length&&(n=new Op("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var _a=null,Ma=null;function tb(t){Px(t,0)}function qc(t){var e=Ki(t);if(Ww(e))return t}function nb(t,e){if(t==="change")return e}var Ex=!1;if(Ur){var oh;if(Ur){var ah="oninput"in document;if(!ah){var Vy=document.createElement("div");Vy.setAttribute("oninput","return;"),ah=typeof Vy.oninput=="function"}oh=ah}else oh=!1;Ex=oh&&(!document.documentMode||9<document.documentMode)}function Ly(){_a&&(_a.detachEvent("onpropertychange",Tx),Ma=_a=null)}function Tx(t){if(t.propertyName==="value"&&qc(Ma)){var e=[];xx(e,Ma,t,Cp(t)),nx(tb,e)}}function rb(t,e,n){t==="focusin"?(Ly(),_a=e,Ma=n,_a.attachEvent("onpropertychange",Tx)):t==="focusout"&&Ly()}function sb(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return qc(Ma)}function ib(t,e){if(t==="click")return qc(e)}function ob(t,e){if(t==="input"||t==="change")return qc(e)}function ab(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Zn=typeof Object.is=="function"?Object.is:ab;function Ua(t,e){if(Zn(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!Wh.call(e,s)||!Zn(t[s],e[s]))return!1}return!0}function My(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Uy(t,e){var n=My(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=My(n)}}function Ix(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?Ix(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function Sx(){for(var t=window,e=Wu();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Wu(t.document)}return e}function Mp(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function lb(t){var e=Sx(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&Ix(n.ownerDocument.documentElement,n)){if(r!==null&&Mp(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!t.extend&&i>r&&(s=r,r=i,i=s),s=Uy(n,i);var o=Uy(n,r);s&&o&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),i>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var ub=Ur&&"documentMode"in document&&11>=document.documentMode,Hi=null,df=null,wa=null,hf=!1;function Fy(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;hf||Hi==null||Hi!==Wu(r)||(r=Hi,"selectionStart"in r&&Mp(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),wa&&Ua(wa,r)||(wa=r,r=Xu(df,"onSelect"),0<r.length&&(e=new Op("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Hi)))}function ou(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Gi={animationend:ou("Animation","AnimationEnd"),animationiteration:ou("Animation","AnimationIteration"),animationstart:ou("Animation","AnimationStart"),transitionend:ou("Transition","TransitionEnd")},lh={},Nx={};Ur&&(Nx=document.createElement("div").style,"AnimationEvent"in window||(delete Gi.animationend.animation,delete Gi.animationiteration.animation,delete Gi.animationstart.animation),"TransitionEvent"in window||delete Gi.transitionend.transition);function Wc(t){if(lh[t])return lh[t];if(!Gi[t])return t;var e=Gi[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in Nx)return lh[t]=e[n];return t}var bx=Wc("animationend"),Ax=Wc("animationiteration"),Cx=Wc("animationstart"),kx=Wc("transitionend"),Rx=new Map,$y="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Us(t,e){Rx.set(t,e),xi(e,[t])}for(var uh=0;uh<$y.length;uh++){var ch=$y[uh],cb=ch.toLowerCase(),db=ch[0].toUpperCase()+ch.slice(1);Us(cb,"on"+db)}Us(bx,"onAnimationEnd");Us(Ax,"onAnimationIteration");Us(Cx,"onAnimationStart");Us("dblclick","onDoubleClick");Us("focusin","onFocus");Us("focusout","onBlur");Us(kx,"onTransitionEnd");po("onMouseEnter",["mouseout","mouseover"]);po("onMouseLeave",["mouseout","mouseover"]);po("onPointerEnter",["pointerout","pointerover"]);po("onPointerLeave",["pointerout","pointerover"]);xi("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));xi("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));xi("onBeforeInput",["compositionend","keypress","textInput","paste"]);xi("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));xi("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));xi("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ca="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),hb=new Set("cancel close invalid load scroll toggle".split(" ").concat(ca));function By(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,cN(r,e,void 0,t),t.currentTarget=null}function Px(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],s=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var o=r.length-1;0<=o;o--){var l=r[o],c=l.instance,d=l.currentTarget;if(l=l.listener,c!==i&&s.isPropagationStopped())break e;By(s,l,d),i=c}else for(o=0;o<r.length;o++){if(l=r[o],c=l.instance,d=l.currentTarget,l=l.listener,c!==i&&s.isPropagationStopped())break e;By(s,l,d),i=c}}}if(Gu)throw t=af,Gu=!1,af=null,t}function He(t,e){var n=e[yf];n===void 0&&(n=e[yf]=new Set);var r=t+"__bubble";n.has(r)||(jx(e,t,2,!1),n.add(r))}function dh(t,e,n){var r=0;e&&(r|=4),jx(n,t,r,e)}var au="_reactListening"+Math.random().toString(36).slice(2);function Fa(t){if(!t[au]){t[au]=!0,Fw.forEach(function(n){n!=="selectionchange"&&(hb.has(n)||dh(n,!1,t),dh(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[au]||(e[au]=!0,dh("selectionchange",!1,e))}}function jx(t,e,n,r){switch(gx(e)){case 1:var s=NN;break;case 4:s=bN;break;default:s=jp}n=s.bind(null,e,n,t),s=void 0,!of||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(e,n,{capture:!0,passive:s}):t.addEventListener(e,n,!0):s!==void 0?t.addEventListener(e,n,{passive:s}):t.addEventListener(e,n,!1)}function hh(t,e,n,r,s){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var l=r.stateNode.containerInfo;if(l===s||l.nodeType===8&&l.parentNode===s)break;if(o===4)for(o=r.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===s||c.nodeType===8&&c.parentNode===s))return;o=o.return}for(;l!==null;){if(o=ei(l),o===null)return;if(c=o.tag,c===5||c===6){r=i=o;continue e}l=l.parentNode}}r=r.return}nx(function(){var d=i,f=Cp(n),p=[];e:{var m=Rx.get(t);if(m!==void 0){var y=Op,w=t;switch(t){case"keypress":if(bu(n)===0)break e;case"keydown":case"keyup":y=BN;break;case"focusin":w="focus",y=ih;break;case"focusout":w="blur",y=ih;break;case"beforeblur":case"afterblur":y=ih;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":y=ky;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":y=kN;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":y=WN;break;case bx:case Ax:case Cx:y=jN;break;case kx:y=GN;break;case"scroll":y=AN;break;case"wheel":y=QN;break;case"copy":case"cut":case"paste":y=ON;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":y=Py}var A=(e&4)!==0,b=!A&&t==="scroll",E=A?m!==null?m+"Capture":null:m;A=[];for(var v=d,x;v!==null;){x=v;var R=x.stateNode;if(x.tag===5&&R!==null&&(x=R,E!==null&&(R=Da(v,E),R!=null&&A.push($a(v,R,x)))),b)break;v=v.return}0<A.length&&(m=new y(m,w,null,n,f),p.push({event:m,listeners:A}))}}if(!(e&7)){e:{if(m=t==="mouseover"||t==="pointerover",y=t==="mouseout"||t==="pointerout",m&&n!==rf&&(w=n.relatedTarget||n.fromElement)&&(ei(w)||w[Fr]))break e;if((y||m)&&(m=f.window===f?f:(m=f.ownerDocument)?m.defaultView||m.parentWindow:window,y?(w=n.relatedTarget||n.toElement,y=d,w=w?ei(w):null,w!==null&&(b=Ei(w),w!==b||w.tag!==5&&w.tag!==6)&&(w=null)):(y=null,w=d),y!==w)){if(A=ky,R="onMouseLeave",E="onMouseEnter",v="mouse",(t==="pointerout"||t==="pointerover")&&(A=Py,R="onPointerLeave",E="onPointerEnter",v="pointer"),b=y==null?m:Ki(y),x=w==null?m:Ki(w),m=new A(R,v+"leave",y,n,f),m.target=b,m.relatedTarget=x,R=null,ei(f)===d&&(A=new A(E,v+"enter",w,n,f),A.target=x,A.relatedTarget=b,R=A),b=R,y&&w)t:{for(A=y,E=w,v=0,x=A;x;x=Ui(x))v++;for(x=0,R=E;R;R=Ui(R))x++;for(;0<v-x;)A=Ui(A),v--;for(;0<x-v;)E=Ui(E),x--;for(;v--;){if(A===E||E!==null&&A===E.alternate)break t;A=Ui(A),E=Ui(E)}A=null}else A=null;y!==null&&zy(p,m,y,A,!1),w!==null&&b!==null&&zy(p,b,w,A,!0)}}e:{if(m=d?Ki(d):window,y=m.nodeName&&m.nodeName.toLowerCase(),y==="select"||y==="input"&&m.type==="file")var O=nb;else if(Oy(m))if(Ex)O=ob;else{O=sb;var L=rb}else(y=m.nodeName)&&y.toLowerCase()==="input"&&(m.type==="checkbox"||m.type==="radio")&&(O=ib);if(O&&(O=O(t,d))){xx(p,O,n,f);break e}L&&L(t,m,d),t==="focusout"&&(L=m._wrapperState)&&L.controlled&&m.type==="number"&&Xh(m,"number",m.value)}switch(L=d?Ki(d):window,t){case"focusin":(Oy(L)||L.contentEditable==="true")&&(Hi=L,df=d,wa=null);break;case"focusout":wa=df=Hi=null;break;case"mousedown":hf=!0;break;case"contextmenu":case"mouseup":case"dragend":hf=!1,Fy(p,n,f);break;case"selectionchange":if(ub)break;case"keydown":case"keyup":Fy(p,n,f)}var S;if(Lp)e:{switch(t){case"compositionstart":var _="onCompositionStart";break e;case"compositionend":_="onCompositionEnd";break e;case"compositionupdate":_="onCompositionUpdate";break e}_=void 0}else Wi?_x(t,n)&&(_="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(_="onCompositionStart");_&&(vx&&n.locale!=="ko"&&(Wi||_!=="onCompositionStart"?_==="onCompositionEnd"&&Wi&&(S=yx()):(ps=f,Dp="value"in ps?ps.value:ps.textContent,Wi=!0)),L=Xu(d,_),0<L.length&&(_=new Ry(_,t,null,n,f),p.push({event:_,listeners:L}),S?_.data=S:(S=wx(n),S!==null&&(_.data=S)))),(S=JN?XN(t,n):ZN(t,n))&&(d=Xu(d,"onBeforeInput"),0<d.length&&(f=new Ry("onBeforeInput","beforeinput",null,n,f),p.push({event:f,listeners:d}),f.data=S))}Px(p,e)})}function $a(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Xu(t,e){for(var n=e+"Capture",r=[];t!==null;){var s=t,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=Da(t,n),i!=null&&r.unshift($a(t,i,s)),i=Da(t,e),i!=null&&r.push($a(t,i,s))),t=t.return}return r}function Ui(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function zy(t,e,n,r,s){for(var i=e._reactName,o=[];n!==null&&n!==r;){var l=n,c=l.alternate,d=l.stateNode;if(c!==null&&c===r)break;l.tag===5&&d!==null&&(l=d,s?(c=Da(n,i),c!=null&&o.unshift($a(n,c,l))):s||(c=Da(n,i),c!=null&&o.push($a(n,c,l)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var fb=/\r\n?/g,pb=/\u0000|\uFFFD/g;function qy(t){return(typeof t=="string"?t:""+t).replace(fb,`
`).replace(pb,"")}function lu(t,e,n){if(e=qy(e),qy(t)!==e&&n)throw Error(q(425))}function Zu(){}var ff=null,pf=null;function mf(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var gf=typeof setTimeout=="function"?setTimeout:void 0,mb=typeof clearTimeout=="function"?clearTimeout:void 0,Wy=typeof Promise=="function"?Promise:void 0,gb=typeof queueMicrotask=="function"?queueMicrotask:typeof Wy<"u"?function(t){return Wy.resolve(null).then(t).catch(yb)}:gf;function yb(t){setTimeout(function(){throw t})}function fh(t,e){var n=e,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){t.removeChild(s),La(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);La(e)}function xs(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function Hy(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Po=Math.random().toString(36).slice(2),dr="__reactFiber$"+Po,Ba="__reactProps$"+Po,Fr="__reactContainer$"+Po,yf="__reactEvents$"+Po,vb="__reactListeners$"+Po,_b="__reactHandles$"+Po;function ei(t){var e=t[dr];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Fr]||n[dr]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=Hy(t);t!==null;){if(n=t[dr])return n;t=Hy(t)}return e}t=n,n=t.parentNode}return null}function fl(t){return t=t[dr]||t[Fr],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Ki(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(q(33))}function Hc(t){return t[Ba]||null}var vf=[],Qi=-1;function Fs(t){return{current:t}}function Ge(t){0>Qi||(t.current=vf[Qi],vf[Qi]=null,Qi--)}function ze(t,e){Qi++,vf[Qi]=t.current,t.current=e}var Ps={},Gt=Fs(Ps),dn=Fs(!1),li=Ps;function mo(t,e){var n=t.type.contextTypes;if(!n)return Ps;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=e[i];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function hn(t){return t=t.childContextTypes,t!=null}function ec(){Ge(dn),Ge(Gt)}function Gy(t,e,n){if(Gt.current!==Ps)throw Error(q(168));ze(Gt,e),ze(dn,n)}function Dx(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(q(108,rN(t)||"Unknown",s));return nt({},n,r)}function tc(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Ps,li=Gt.current,ze(Gt,t),ze(dn,dn.current),!0}function Ky(t,e,n){var r=t.stateNode;if(!r)throw Error(q(169));n?(t=Dx(t,e,li),r.__reactInternalMemoizedMergedChildContext=t,Ge(dn),Ge(Gt),ze(Gt,t)):Ge(dn),ze(dn,n)}var Cr=null,Gc=!1,ph=!1;function Ox(t){Cr===null?Cr=[t]:Cr.push(t)}function wb(t){Gc=!0,Ox(t)}function $s(){if(!ph&&Cr!==null){ph=!0;var t=0,e=Ve;try{var n=Cr;for(Ve=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}Cr=null,Gc=!1}catch(s){throw Cr!==null&&(Cr=Cr.slice(t+1)),ox(kp,$s),s}finally{Ve=e,ph=!1}}return null}var Yi=[],Ji=0,nc=null,rc=0,Nn=[],bn=0,ui=null,kr=1,Rr="";function Js(t,e){Yi[Ji++]=rc,Yi[Ji++]=nc,nc=t,rc=e}function Vx(t,e,n){Nn[bn++]=kr,Nn[bn++]=Rr,Nn[bn++]=ui,ui=t;var r=kr;t=Rr;var s=32-Kn(r)-1;r&=~(1<<s),n+=1;var i=32-Kn(e)+s;if(30<i){var o=s-s%5;i=(r&(1<<o)-1).toString(32),r>>=o,s-=o,kr=1<<32-Kn(e)+s|n<<s|r,Rr=i+t}else kr=1<<i|n<<s|r,Rr=t}function Up(t){t.return!==null&&(Js(t,1),Vx(t,1,0))}function Fp(t){for(;t===nc;)nc=Yi[--Ji],Yi[Ji]=null,rc=Yi[--Ji],Yi[Ji]=null;for(;t===ui;)ui=Nn[--bn],Nn[bn]=null,Rr=Nn[--bn],Nn[bn]=null,kr=Nn[--bn],Nn[bn]=null}var wn=null,vn=null,Ye=!1,Hn=null;function Lx(t,e){var n=Cn(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function Qy(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,wn=t,vn=xs(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,wn=t,vn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=ui!==null?{id:kr,overflow:Rr}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Cn(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,wn=t,vn=null,!0):!1;default:return!1}}function _f(t){return(t.mode&1)!==0&&(t.flags&128)===0}function wf(t){if(Ye){var e=vn;if(e){var n=e;if(!Qy(t,e)){if(_f(t))throw Error(q(418));e=xs(n.nextSibling);var r=wn;e&&Qy(t,e)?Lx(r,n):(t.flags=t.flags&-4097|2,Ye=!1,wn=t)}}else{if(_f(t))throw Error(q(418));t.flags=t.flags&-4097|2,Ye=!1,wn=t}}}function Yy(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;wn=t}function uu(t){if(t!==wn)return!1;if(!Ye)return Yy(t),Ye=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!mf(t.type,t.memoizedProps)),e&&(e=vn)){if(_f(t))throw Mx(),Error(q(418));for(;e;)Lx(t,e),e=xs(e.nextSibling)}if(Yy(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(q(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){vn=xs(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}vn=null}}else vn=wn?xs(t.stateNode.nextSibling):null;return!0}function Mx(){for(var t=vn;t;)t=xs(t.nextSibling)}function go(){vn=wn=null,Ye=!1}function $p(t){Hn===null?Hn=[t]:Hn.push(t)}var xb=Gr.ReactCurrentBatchConfig;function sa(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(q(309));var r=n.stateNode}if(!r)throw Error(q(147,t));var s=r,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var l=s.refs;o===null?delete l[i]:l[i]=o},e._stringRef=i,e)}if(typeof t!="string")throw Error(q(284));if(!n._owner)throw Error(q(290,t))}return t}function cu(t,e){throw t=Object.prototype.toString.call(e),Error(q(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function Jy(t){var e=t._init;return e(t._payload)}function Ux(t){function e(E,v){if(t){var x=E.deletions;x===null?(E.deletions=[v],E.flags|=16):x.push(v)}}function n(E,v){if(!t)return null;for(;v!==null;)e(E,v),v=v.sibling;return null}function r(E,v){for(E=new Map;v!==null;)v.key!==null?E.set(v.key,v):E.set(v.index,v),v=v.sibling;return E}function s(E,v){return E=Ss(E,v),E.index=0,E.sibling=null,E}function i(E,v,x){return E.index=x,t?(x=E.alternate,x!==null?(x=x.index,x<v?(E.flags|=2,v):x):(E.flags|=2,v)):(E.flags|=1048576,v)}function o(E){return t&&E.alternate===null&&(E.flags|=2),E}function l(E,v,x,R){return v===null||v.tag!==6?(v=xh(x,E.mode,R),v.return=E,v):(v=s(v,x),v.return=E,v)}function c(E,v,x,R){var O=x.type;return O===qi?f(E,v,x.props.children,R,x.key):v!==null&&(v.elementType===O||typeof O=="object"&&O!==null&&O.$$typeof===os&&Jy(O)===v.type)?(R=s(v,x.props),R.ref=sa(E,v,x),R.return=E,R):(R=Du(x.type,x.key,x.props,null,E.mode,R),R.ref=sa(E,v,x),R.return=E,R)}function d(E,v,x,R){return v===null||v.tag!==4||v.stateNode.containerInfo!==x.containerInfo||v.stateNode.implementation!==x.implementation?(v=Eh(x,E.mode,R),v.return=E,v):(v=s(v,x.children||[]),v.return=E,v)}function f(E,v,x,R,O){return v===null||v.tag!==7?(v=ai(x,E.mode,R,O),v.return=E,v):(v=s(v,x),v.return=E,v)}function p(E,v,x){if(typeof v=="string"&&v!==""||typeof v=="number")return v=xh(""+v,E.mode,x),v.return=E,v;if(typeof v=="object"&&v!==null){switch(v.$$typeof){case Zl:return x=Du(v.type,v.key,v.props,null,E.mode,x),x.ref=sa(E,null,v),x.return=E,x;case zi:return v=Eh(v,E.mode,x),v.return=E,v;case os:var R=v._init;return p(E,R(v._payload),x)}if(la(v)||Zo(v))return v=ai(v,E.mode,x,null),v.return=E,v;cu(E,v)}return null}function m(E,v,x,R){var O=v!==null?v.key:null;if(typeof x=="string"&&x!==""||typeof x=="number")return O!==null?null:l(E,v,""+x,R);if(typeof x=="object"&&x!==null){switch(x.$$typeof){case Zl:return x.key===O?c(E,v,x,R):null;case zi:return x.key===O?d(E,v,x,R):null;case os:return O=x._init,m(E,v,O(x._payload),R)}if(la(x)||Zo(x))return O!==null?null:f(E,v,x,R,null);cu(E,x)}return null}function y(E,v,x,R,O){if(typeof R=="string"&&R!==""||typeof R=="number")return E=E.get(x)||null,l(v,E,""+R,O);if(typeof R=="object"&&R!==null){switch(R.$$typeof){case Zl:return E=E.get(R.key===null?x:R.key)||null,c(v,E,R,O);case zi:return E=E.get(R.key===null?x:R.key)||null,d(v,E,R,O);case os:var L=R._init;return y(E,v,x,L(R._payload),O)}if(la(R)||Zo(R))return E=E.get(x)||null,f(v,E,R,O,null);cu(v,R)}return null}function w(E,v,x,R){for(var O=null,L=null,S=v,_=v=0,I=null;S!==null&&_<x.length;_++){S.index>_?(I=S,S=null):I=S.sibling;var N=m(E,S,x[_],R);if(N===null){S===null&&(S=I);break}t&&S&&N.alternate===null&&e(E,S),v=i(N,v,_),L===null?O=N:L.sibling=N,L=N,S=I}if(_===x.length)return n(E,S),Ye&&Js(E,_),O;if(S===null){for(;_<x.length;_++)S=p(E,x[_],R),S!==null&&(v=i(S,v,_),L===null?O=S:L.sibling=S,L=S);return Ye&&Js(E,_),O}for(S=r(E,S);_<x.length;_++)I=y(S,E,_,x[_],R),I!==null&&(t&&I.alternate!==null&&S.delete(I.key===null?_:I.key),v=i(I,v,_),L===null?O=I:L.sibling=I,L=I);return t&&S.forEach(function(P){return e(E,P)}),Ye&&Js(E,_),O}function A(E,v,x,R){var O=Zo(x);if(typeof O!="function")throw Error(q(150));if(x=O.call(x),x==null)throw Error(q(151));for(var L=O=null,S=v,_=v=0,I=null,N=x.next();S!==null&&!N.done;_++,N=x.next()){S.index>_?(I=S,S=null):I=S.sibling;var P=m(E,S,N.value,R);if(P===null){S===null&&(S=I);break}t&&S&&P.alternate===null&&e(E,S),v=i(P,v,_),L===null?O=P:L.sibling=P,L=P,S=I}if(N.done)return n(E,S),Ye&&Js(E,_),O;if(S===null){for(;!N.done;_++,N=x.next())N=p(E,N.value,R),N!==null&&(v=i(N,v,_),L===null?O=N:L.sibling=N,L=N);return Ye&&Js(E,_),O}for(S=r(E,S);!N.done;_++,N=x.next())N=y(S,E,_,N.value,R),N!==null&&(t&&N.alternate!==null&&S.delete(N.key===null?_:N.key),v=i(N,v,_),L===null?O=N:L.sibling=N,L=N);return t&&S.forEach(function(j){return e(E,j)}),Ye&&Js(E,_),O}function b(E,v,x,R){if(typeof x=="object"&&x!==null&&x.type===qi&&x.key===null&&(x=x.props.children),typeof x=="object"&&x!==null){switch(x.$$typeof){case Zl:e:{for(var O=x.key,L=v;L!==null;){if(L.key===O){if(O=x.type,O===qi){if(L.tag===7){n(E,L.sibling),v=s(L,x.props.children),v.return=E,E=v;break e}}else if(L.elementType===O||typeof O=="object"&&O!==null&&O.$$typeof===os&&Jy(O)===L.type){n(E,L.sibling),v=s(L,x.props),v.ref=sa(E,L,x),v.return=E,E=v;break e}n(E,L);break}else e(E,L);L=L.sibling}x.type===qi?(v=ai(x.props.children,E.mode,R,x.key),v.return=E,E=v):(R=Du(x.type,x.key,x.props,null,E.mode,R),R.ref=sa(E,v,x),R.return=E,E=R)}return o(E);case zi:e:{for(L=x.key;v!==null;){if(v.key===L)if(v.tag===4&&v.stateNode.containerInfo===x.containerInfo&&v.stateNode.implementation===x.implementation){n(E,v.sibling),v=s(v,x.children||[]),v.return=E,E=v;break e}else{n(E,v);break}else e(E,v);v=v.sibling}v=Eh(x,E.mode,R),v.return=E,E=v}return o(E);case os:return L=x._init,b(E,v,L(x._payload),R)}if(la(x))return w(E,v,x,R);if(Zo(x))return A(E,v,x,R);cu(E,x)}return typeof x=="string"&&x!==""||typeof x=="number"?(x=""+x,v!==null&&v.tag===6?(n(E,v.sibling),v=s(v,x),v.return=E,E=v):(n(E,v),v=xh(x,E.mode,R),v.return=E,E=v),o(E)):n(E,v)}return b}var yo=Ux(!0),Fx=Ux(!1),sc=Fs(null),ic=null,Xi=null,Bp=null;function zp(){Bp=Xi=ic=null}function qp(t){var e=sc.current;Ge(sc),t._currentValue=e}function xf(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function ao(t,e){ic=t,Bp=Xi=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(un=!0),t.firstContext=null)}function Pn(t){var e=t._currentValue;if(Bp!==t)if(t={context:t,memoizedValue:e,next:null},Xi===null){if(ic===null)throw Error(q(308));Xi=t,ic.dependencies={lanes:0,firstContext:t}}else Xi=Xi.next=t;return e}var ti=null;function Wp(t){ti===null?ti=[t]:ti.push(t)}function $x(t,e,n,r){var s=e.interleaved;return s===null?(n.next=n,Wp(e)):(n.next=s.next,s.next=n),e.interleaved=n,$r(t,r)}function $r(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var as=!1;function Hp(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Bx(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Or(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Es(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,be&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,$r(t,n)}return s=r.interleaved,s===null?(e.next=e,Wp(r)):(e.next=s.next,s.next=e),r.interleaved=e,$r(t,n)}function Au(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Rp(t,n)}}function Xy(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=o:i=i.next=o,n=n.next}while(n!==null);i===null?s=i=e:i=i.next=e}else s=i=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function oc(t,e,n,r){var s=t.updateQueue;as=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,l=s.shared.pending;if(l!==null){s.shared.pending=null;var c=l,d=c.next;c.next=null,o===null?i=d:o.next=d,o=c;var f=t.alternate;f!==null&&(f=f.updateQueue,l=f.lastBaseUpdate,l!==o&&(l===null?f.firstBaseUpdate=d:l.next=d,f.lastBaseUpdate=c))}if(i!==null){var p=s.baseState;o=0,f=d=c=null,l=i;do{var m=l.lane,y=l.eventTime;if((r&m)===m){f!==null&&(f=f.next={eventTime:y,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var w=t,A=l;switch(m=e,y=n,A.tag){case 1:if(w=A.payload,typeof w=="function"){p=w.call(y,p,m);break e}p=w;break e;case 3:w.flags=w.flags&-65537|128;case 0:if(w=A.payload,m=typeof w=="function"?w.call(y,p,m):w,m==null)break e;p=nt({},p,m);break e;case 2:as=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,m=s.effects,m===null?s.effects=[l]:m.push(l))}else y={eventTime:y,lane:m,tag:l.tag,payload:l.payload,callback:l.callback,next:null},f===null?(d=f=y,c=p):f=f.next=y,o|=m;if(l=l.next,l===null){if(l=s.shared.pending,l===null)break;m=l,l=m.next,m.next=null,s.lastBaseUpdate=m,s.shared.pending=null}}while(!0);if(f===null&&(c=p),s.baseState=c,s.firstBaseUpdate=d,s.lastBaseUpdate=f,e=s.shared.interleaved,e!==null){s=e;do o|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);di|=o,t.lanes=o,t.memoizedState=p}}function Zy(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(q(191,s));s.call(r)}}}var pl={},fr=Fs(pl),za=Fs(pl),qa=Fs(pl);function ni(t){if(t===pl)throw Error(q(174));return t}function Gp(t,e){switch(ze(qa,e),ze(za,t),ze(fr,pl),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:ef(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=ef(e,t)}Ge(fr),ze(fr,e)}function vo(){Ge(fr),Ge(za),Ge(qa)}function zx(t){ni(qa.current);var e=ni(fr.current),n=ef(e,t.type);e!==n&&(ze(za,t),ze(fr,n))}function Kp(t){za.current===t&&(Ge(fr),Ge(za))}var Xe=Fs(0);function ac(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var mh=[];function Qp(){for(var t=0;t<mh.length;t++)mh[t]._workInProgressVersionPrimary=null;mh.length=0}var Cu=Gr.ReactCurrentDispatcher,gh=Gr.ReactCurrentBatchConfig,ci=0,et=null,yt=null,Nt=null,lc=!1,xa=!1,Wa=0,Eb=0;function Ft(){throw Error(q(321))}function Yp(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Zn(t[n],e[n]))return!1;return!0}function Jp(t,e,n,r,s,i){if(ci=i,et=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Cu.current=t===null||t.memoizedState===null?Nb:bb,t=n(r,s),xa){i=0;do{if(xa=!1,Wa=0,25<=i)throw Error(q(301));i+=1,Nt=yt=null,e.updateQueue=null,Cu.current=Ab,t=n(r,s)}while(xa)}if(Cu.current=uc,e=yt!==null&&yt.next!==null,ci=0,Nt=yt=et=null,lc=!1,e)throw Error(q(300));return t}function Xp(){var t=Wa!==0;return Wa=0,t}function ur(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Nt===null?et.memoizedState=Nt=t:Nt=Nt.next=t,Nt}function jn(){if(yt===null){var t=et.alternate;t=t!==null?t.memoizedState:null}else t=yt.next;var e=Nt===null?et.memoizedState:Nt.next;if(e!==null)Nt=e,yt=t;else{if(t===null)throw Error(q(310));yt=t,t={memoizedState:yt.memoizedState,baseState:yt.baseState,baseQueue:yt.baseQueue,queue:yt.queue,next:null},Nt===null?et.memoizedState=Nt=t:Nt=Nt.next=t}return Nt}function Ha(t,e){return typeof e=="function"?e(t):e}function yh(t){var e=jn(),n=e.queue;if(n===null)throw Error(q(311));n.lastRenderedReducer=t;var r=yt,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var l=o=null,c=null,d=i;do{var f=d.lane;if((ci&f)===f)c!==null&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),r=d.hasEagerState?d.eagerState:t(r,d.action);else{var p={lane:f,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};c===null?(l=c=p,o=r):c=c.next=p,et.lanes|=f,di|=f}d=d.next}while(d!==null&&d!==i);c===null?o=r:c.next=l,Zn(r,e.memoizedState)||(un=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=c,n.lastRenderedState=r}if(t=n.interleaved,t!==null){s=t;do i=s.lane,et.lanes|=i,di|=i,s=s.next;while(s!==t)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function vh(t){var e=jn(),n=e.queue;if(n===null)throw Error(q(311));n.lastRenderedReducer=t;var r=n.dispatch,s=n.pending,i=e.memoizedState;if(s!==null){n.pending=null;var o=s=s.next;do i=t(i,o.action),o=o.next;while(o!==s);Zn(i,e.memoizedState)||(un=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,r]}function qx(){}function Wx(t,e){var n=et,r=jn(),s=e(),i=!Zn(r.memoizedState,s);if(i&&(r.memoizedState=s,un=!0),r=r.queue,Zp(Kx.bind(null,n,r,t),[t]),r.getSnapshot!==e||i||Nt!==null&&Nt.memoizedState.tag&1){if(n.flags|=2048,Ga(9,Gx.bind(null,n,r,s,e),void 0,null),At===null)throw Error(q(349));ci&30||Hx(n,e,s)}return s}function Hx(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=et.updateQueue,e===null?(e={lastEffect:null,stores:null},et.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function Gx(t,e,n,r){e.value=n,e.getSnapshot=r,Qx(e)&&Yx(t)}function Kx(t,e,n){return n(function(){Qx(e)&&Yx(t)})}function Qx(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Zn(t,n)}catch{return!0}}function Yx(t){var e=$r(t,1);e!==null&&Qn(e,t,1,-1)}function ev(t){var e=ur();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ha,lastRenderedState:t},e.queue=t,t=t.dispatch=Sb.bind(null,et,t),[e.memoizedState,t]}function Ga(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=et.updateQueue,e===null?(e={lastEffect:null,stores:null},et.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function Jx(){return jn().memoizedState}function ku(t,e,n,r){var s=ur();et.flags|=t,s.memoizedState=Ga(1|e,n,void 0,r===void 0?null:r)}function Kc(t,e,n,r){var s=jn();r=r===void 0?null:r;var i=void 0;if(yt!==null){var o=yt.memoizedState;if(i=o.destroy,r!==null&&Yp(r,o.deps)){s.memoizedState=Ga(e,n,i,r);return}}et.flags|=t,s.memoizedState=Ga(1|e,n,i,r)}function tv(t,e){return ku(8390656,8,t,e)}function Zp(t,e){return Kc(2048,8,t,e)}function Xx(t,e){return Kc(4,2,t,e)}function Zx(t,e){return Kc(4,4,t,e)}function e0(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function t0(t,e,n){return n=n!=null?n.concat([t]):null,Kc(4,4,e0.bind(null,e,t),n)}function em(){}function n0(t,e){var n=jn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Yp(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function r0(t,e){var n=jn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Yp(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function s0(t,e,n){return ci&21?(Zn(n,e)||(n=ux(),et.lanes|=n,di|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,un=!0),t.memoizedState=n)}function Tb(t,e){var n=Ve;Ve=n!==0&&4>n?n:4,t(!0);var r=gh.transition;gh.transition={};try{t(!1),e()}finally{Ve=n,gh.transition=r}}function i0(){return jn().memoizedState}function Ib(t,e,n){var r=Is(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},o0(t))a0(e,n);else if(n=$x(t,e,n,r),n!==null){var s=Zt();Qn(n,t,r,s),l0(n,e,r)}}function Sb(t,e,n){var r=Is(t),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(o0(t))a0(e,s);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,l=i(o,n);if(s.hasEagerState=!0,s.eagerState=l,Zn(l,o)){var c=e.interleaved;c===null?(s.next=s,Wp(e)):(s.next=c.next,c.next=s),e.interleaved=s;return}}catch{}finally{}n=$x(t,e,s,r),n!==null&&(s=Zt(),Qn(n,t,r,s),l0(n,e,r))}}function o0(t){var e=t.alternate;return t===et||e!==null&&e===et}function a0(t,e){xa=lc=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function l0(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Rp(t,n)}}var uc={readContext:Pn,useCallback:Ft,useContext:Ft,useEffect:Ft,useImperativeHandle:Ft,useInsertionEffect:Ft,useLayoutEffect:Ft,useMemo:Ft,useReducer:Ft,useRef:Ft,useState:Ft,useDebugValue:Ft,useDeferredValue:Ft,useTransition:Ft,useMutableSource:Ft,useSyncExternalStore:Ft,useId:Ft,unstable_isNewReconciler:!1},Nb={readContext:Pn,useCallback:function(t,e){return ur().memoizedState=[t,e===void 0?null:e],t},useContext:Pn,useEffect:tv,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,ku(4194308,4,e0.bind(null,e,t),n)},useLayoutEffect:function(t,e){return ku(4194308,4,t,e)},useInsertionEffect:function(t,e){return ku(4,2,t,e)},useMemo:function(t,e){var n=ur();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=ur();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=Ib.bind(null,et,t),[r.memoizedState,t]},useRef:function(t){var e=ur();return t={current:t},e.memoizedState=t},useState:ev,useDebugValue:em,useDeferredValue:function(t){return ur().memoizedState=t},useTransition:function(){var t=ev(!1),e=t[0];return t=Tb.bind(null,t[1]),ur().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=et,s=ur();if(Ye){if(n===void 0)throw Error(q(407));n=n()}else{if(n=e(),At===null)throw Error(q(349));ci&30||Hx(r,e,n)}s.memoizedState=n;var i={value:n,getSnapshot:e};return s.queue=i,tv(Kx.bind(null,r,i,t),[t]),r.flags|=2048,Ga(9,Gx.bind(null,r,i,n,e),void 0,null),n},useId:function(){var t=ur(),e=At.identifierPrefix;if(Ye){var n=Rr,r=kr;n=(r&~(1<<32-Kn(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Wa++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=Eb++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},bb={readContext:Pn,useCallback:n0,useContext:Pn,useEffect:Zp,useImperativeHandle:t0,useInsertionEffect:Xx,useLayoutEffect:Zx,useMemo:r0,useReducer:yh,useRef:Jx,useState:function(){return yh(Ha)},useDebugValue:em,useDeferredValue:function(t){var e=jn();return s0(e,yt.memoizedState,t)},useTransition:function(){var t=yh(Ha)[0],e=jn().memoizedState;return[t,e]},useMutableSource:qx,useSyncExternalStore:Wx,useId:i0,unstable_isNewReconciler:!1},Ab={readContext:Pn,useCallback:n0,useContext:Pn,useEffect:Zp,useImperativeHandle:t0,useInsertionEffect:Xx,useLayoutEffect:Zx,useMemo:r0,useReducer:vh,useRef:Jx,useState:function(){return vh(Ha)},useDebugValue:em,useDeferredValue:function(t){var e=jn();return yt===null?e.memoizedState=t:s0(e,yt.memoizedState,t)},useTransition:function(){var t=vh(Ha)[0],e=jn().memoizedState;return[t,e]},useMutableSource:qx,useSyncExternalStore:Wx,useId:i0,unstable_isNewReconciler:!1};function qn(t,e){if(t&&t.defaultProps){e=nt({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function Ef(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:nt({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Qc={isMounted:function(t){return(t=t._reactInternals)?Ei(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=Zt(),s=Is(t),i=Or(r,s);i.payload=e,n!=null&&(i.callback=n),e=Es(t,i,s),e!==null&&(Qn(e,t,s,r),Au(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=Zt(),s=Is(t),i=Or(r,s);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=Es(t,i,s),e!==null&&(Qn(e,t,s,r),Au(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Zt(),r=Is(t),s=Or(n,r);s.tag=2,e!=null&&(s.callback=e),e=Es(t,s,r),e!==null&&(Qn(e,t,r,n),Au(e,t,r))}};function nv(t,e,n,r,s,i,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,i,o):e.prototype&&e.prototype.isPureReactComponent?!Ua(n,r)||!Ua(s,i):!0}function u0(t,e,n){var r=!1,s=Ps,i=e.contextType;return typeof i=="object"&&i!==null?i=Pn(i):(s=hn(e)?li:Gt.current,r=e.contextTypes,i=(r=r!=null)?mo(t,s):Ps),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Qc,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=i),e}function rv(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Qc.enqueueReplaceState(e,e.state,null)}function Tf(t,e,n,r){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs={},Hp(t);var i=e.contextType;typeof i=="object"&&i!==null?s.context=Pn(i):(i=hn(e)?li:Gt.current,s.context=mo(t,i)),s.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(Ef(t,e,i,n),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&Qc.enqueueReplaceState(s,s.state,null),oc(t,n,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function _o(t,e){try{var n="",r=e;do n+=nN(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:s,digest:null}}function _h(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function If(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var Cb=typeof WeakMap=="function"?WeakMap:Map;function c0(t,e,n){n=Or(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){dc||(dc=!0,Df=r),If(t,e)},n}function d0(t,e,n){n=Or(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){If(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){If(t,e),typeof r!="function"&&(Ts===null?Ts=new Set([this]):Ts.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function sv(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new Cb;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),t=zb.bind(null,t,e,n),e.then(t,t))}function iv(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function ov(t,e,n,r,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Or(-1,1),e.tag=2,Es(n,e,1))),n.lanes|=1),t)}var kb=Gr.ReactCurrentOwner,un=!1;function Jt(t,e,n,r){e.child=t===null?Fx(e,null,n,r):yo(e,t.child,n,r)}function av(t,e,n,r,s){n=n.render;var i=e.ref;return ao(e,s),r=Jp(t,e,n,r,i,s),n=Xp(),t!==null&&!un?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Br(t,e,s)):(Ye&&n&&Up(e),e.flags|=1,Jt(t,e,r,s),e.child)}function lv(t,e,n,r,s){if(t===null){var i=n.type;return typeof i=="function"&&!lm(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,h0(t,e,i,r,s)):(t=Du(n.type,null,r,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&s)){var o=i.memoizedProps;if(n=n.compare,n=n!==null?n:Ua,n(o,r)&&t.ref===e.ref)return Br(t,e,s)}return e.flags|=1,t=Ss(i,r),t.ref=e.ref,t.return=e,e.child=t}function h0(t,e,n,r,s){if(t!==null){var i=t.memoizedProps;if(Ua(i,r)&&t.ref===e.ref)if(un=!1,e.pendingProps=r=i,(t.lanes&s)!==0)t.flags&131072&&(un=!0);else return e.lanes=t.lanes,Br(t,e,s)}return Sf(t,e,n,r,s)}function f0(t,e,n){var r=e.pendingProps,s=r.children,i=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},ze(eo,gn),gn|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,ze(eo,gn),gn|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,ze(eo,gn),gn|=r}else i!==null?(r=i.baseLanes|n,e.memoizedState=null):r=n,ze(eo,gn),gn|=r;return Jt(t,e,s,n),e.child}function p0(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Sf(t,e,n,r,s){var i=hn(n)?li:Gt.current;return i=mo(e,i),ao(e,s),n=Jp(t,e,n,r,i,s),r=Xp(),t!==null&&!un?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Br(t,e,s)):(Ye&&r&&Up(e),e.flags|=1,Jt(t,e,n,s),e.child)}function uv(t,e,n,r,s){if(hn(n)){var i=!0;tc(e)}else i=!1;if(ao(e,s),e.stateNode===null)Ru(t,e),u0(e,n,r),Tf(e,n,r,s),r=!0;else if(t===null){var o=e.stateNode,l=e.memoizedProps;o.props=l;var c=o.context,d=n.contextType;typeof d=="object"&&d!==null?d=Pn(d):(d=hn(n)?li:Gt.current,d=mo(e,d));var f=n.getDerivedStateFromProps,p=typeof f=="function"||typeof o.getSnapshotBeforeUpdate=="function";p||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==r||c!==d)&&rv(e,o,r,d),as=!1;var m=e.memoizedState;o.state=m,oc(e,r,o,s),c=e.memoizedState,l!==r||m!==c||dn.current||as?(typeof f=="function"&&(Ef(e,n,f,r),c=e.memoizedState),(l=as||nv(e,n,l,r,m,c,d))?(p||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=c),o.props=r,o.state=c,o.context=d,r=l):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,Bx(t,e),l=e.memoizedProps,d=e.type===e.elementType?l:qn(e.type,l),o.props=d,p=e.pendingProps,m=o.context,c=n.contextType,typeof c=="object"&&c!==null?c=Pn(c):(c=hn(n)?li:Gt.current,c=mo(e,c));var y=n.getDerivedStateFromProps;(f=typeof y=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==p||m!==c)&&rv(e,o,r,c),as=!1,m=e.memoizedState,o.state=m,oc(e,r,o,s);var w=e.memoizedState;l!==p||m!==w||dn.current||as?(typeof y=="function"&&(Ef(e,n,y,r),w=e.memoizedState),(d=as||nv(e,n,d,r,m,w,c)||!1)?(f||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,w,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,w,c)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&m===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=w),o.props=r,o.state=w,o.context=c,r=d):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&m===t.memoizedState||(e.flags|=1024),r=!1)}return Nf(t,e,n,r,i,s)}function Nf(t,e,n,r,s,i){p0(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return s&&Ky(e,n,!1),Br(t,e,i);r=e.stateNode,kb.current=e;var l=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=yo(e,t.child,null,i),e.child=yo(e,null,l,i)):Jt(t,e,l,i),e.memoizedState=r.state,s&&Ky(e,n,!0),e.child}function m0(t){var e=t.stateNode;e.pendingContext?Gy(t,e.pendingContext,e.pendingContext!==e.context):e.context&&Gy(t,e.context,!1),Gp(t,e.containerInfo)}function cv(t,e,n,r,s){return go(),$p(s),e.flags|=256,Jt(t,e,n,r),e.child}var bf={dehydrated:null,treeContext:null,retryLane:0};function Af(t){return{baseLanes:t,cachePool:null,transitions:null}}function g0(t,e,n){var r=e.pendingProps,s=Xe.current,i=!1,o=(e.flags&128)!==0,l;if((l=o)||(l=t!==null&&t.memoizedState===null?!1:(s&2)!==0),l?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),ze(Xe,s&1),t===null)return wf(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,i?(r=e.mode,i=e.child,o={mode:"hidden",children:o},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=Xc(o,r,0,null),t=ai(t,r,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=Af(n),e.memoizedState=bf,t):tm(e,o));if(s=t.memoizedState,s!==null&&(l=s.dehydrated,l!==null))return Rb(t,e,o,r,l,s,n);if(i){i=r.fallback,o=e.mode,s=t.child,l=s.sibling;var c={mode:"hidden",children:r.children};return!(o&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=c,e.deletions=null):(r=Ss(s,c),r.subtreeFlags=s.subtreeFlags&14680064),l!==null?i=Ss(l,i):(i=ai(i,o,n,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,o=t.child.memoizedState,o=o===null?Af(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=t.childLanes&~n,e.memoizedState=bf,r}return i=t.child,t=i.sibling,r=Ss(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function tm(t,e){return e=Xc({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function du(t,e,n,r){return r!==null&&$p(r),yo(e,t.child,null,n),t=tm(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function Rb(t,e,n,r,s,i,o){if(n)return e.flags&256?(e.flags&=-257,r=_h(Error(q(422))),du(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=r.fallback,s=e.mode,r=Xc({mode:"visible",children:r.children},s,0,null),i=ai(i,s,o,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&yo(e,t.child,null,o),e.child.memoizedState=Af(o),e.memoizedState=bf,i);if(!(e.mode&1))return du(t,e,o,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var l=r.dgst;return r=l,i=Error(q(419)),r=_h(i,r,void 0),du(t,e,o,r)}if(l=(o&t.childLanes)!==0,un||l){if(r=At,r!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|o)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,$r(t,s),Qn(r,t,s,-1))}return am(),r=_h(Error(q(421))),du(t,e,o,r)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=qb.bind(null,t),s._reactRetry=e,null):(t=i.treeContext,vn=xs(s.nextSibling),wn=e,Ye=!0,Hn=null,t!==null&&(Nn[bn++]=kr,Nn[bn++]=Rr,Nn[bn++]=ui,kr=t.id,Rr=t.overflow,ui=e),e=tm(e,r.children),e.flags|=4096,e)}function dv(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),xf(t.return,e,n)}function wh(t,e,n,r,s){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function y0(t,e,n){var r=e.pendingProps,s=r.revealOrder,i=r.tail;if(Jt(t,e,r.children,n),r=Xe.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&dv(t,n,e);else if(t.tag===19)dv(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(ze(Xe,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)t=n.alternate,t!==null&&ac(t)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),wh(e,!1,s,n,i);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&ac(t)===null){e.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}wh(e,!0,n,null,i);break;case"together":wh(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Ru(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Br(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),di|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(q(153));if(e.child!==null){for(t=e.child,n=Ss(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Ss(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function Pb(t,e,n){switch(e.tag){case 3:m0(e),go();break;case 5:zx(e);break;case 1:hn(e.type)&&tc(e);break;case 4:Gp(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;ze(sc,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(ze(Xe,Xe.current&1),e.flags|=128,null):n&e.child.childLanes?g0(t,e,n):(ze(Xe,Xe.current&1),t=Br(t,e,n),t!==null?t.sibling:null);ze(Xe,Xe.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return y0(t,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),ze(Xe,Xe.current),r)break;return null;case 22:case 23:return e.lanes=0,f0(t,e,n)}return Br(t,e,n)}var v0,Cf,_0,w0;v0=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Cf=function(){};_0=function(t,e,n,r){var s=t.memoizedProps;if(s!==r){t=e.stateNode,ni(fr.current);var i=null;switch(n){case"input":s=Yh(t,s),r=Yh(t,r),i=[];break;case"select":s=nt({},s,{value:void 0}),r=nt({},r,{value:void 0}),i=[];break;case"textarea":s=Zh(t,s),r=Zh(t,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=Zu)}tf(n,r);var o;n=null;for(d in s)if(!r.hasOwnProperty(d)&&s.hasOwnProperty(d)&&s[d]!=null)if(d==="style"){var l=s[d];for(o in l)l.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(Pa.hasOwnProperty(d)?i||(i=[]):(i=i||[]).push(d,null));for(d in r){var c=r[d];if(l=s!=null?s[d]:void 0,r.hasOwnProperty(d)&&c!==l&&(c!=null||l!=null))if(d==="style")if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(n||(n={}),n[o]=c[o])}else n||(i||(i=[]),i.push(d,n)),n=c;else d==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(i=i||[]).push(d,c)):d==="children"?typeof c!="string"&&typeof c!="number"||(i=i||[]).push(d,""+c):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(Pa.hasOwnProperty(d)?(c!=null&&d==="onScroll"&&He("scroll",t),i||l===c||(i=[])):(i=i||[]).push(d,c))}n&&(i=i||[]).push("style",n);var d=i;(e.updateQueue=d)&&(e.flags|=4)}};w0=function(t,e,n,r){n!==r&&(e.flags|=4)};function ia(t,e){if(!Ye)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function $t(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function jb(t,e,n){var r=e.pendingProps;switch(Fp(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return $t(e),null;case 1:return hn(e.type)&&ec(),$t(e),null;case 3:return r=e.stateNode,vo(),Ge(dn),Ge(Gt),Qp(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(uu(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Hn!==null&&(Lf(Hn),Hn=null))),Cf(t,e),$t(e),null;case 5:Kp(e);var s=ni(qa.current);if(n=e.type,t!==null&&e.stateNode!=null)_0(t,e,n,r,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(q(166));return $t(e),null}if(t=ni(fr.current),uu(e)){r=e.stateNode,n=e.type;var i=e.memoizedProps;switch(r[dr]=e,r[Ba]=i,t=(e.mode&1)!==0,n){case"dialog":He("cancel",r),He("close",r);break;case"iframe":case"object":case"embed":He("load",r);break;case"video":case"audio":for(s=0;s<ca.length;s++)He(ca[s],r);break;case"source":He("error",r);break;case"img":case"image":case"link":He("error",r),He("load",r);break;case"details":He("toggle",r);break;case"input":wy(r,i),He("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},He("invalid",r);break;case"textarea":Ey(r,i),He("invalid",r)}tf(n,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var l=i[o];o==="children"?typeof l=="string"?r.textContent!==l&&(i.suppressHydrationWarning!==!0&&lu(r.textContent,l,t),s=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(i.suppressHydrationWarning!==!0&&lu(r.textContent,l,t),s=["children",""+l]):Pa.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&He("scroll",r)}switch(n){case"input":eu(r),xy(r,i,!0);break;case"textarea":eu(r),Ty(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=Zu)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=Kw(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[dr]=e,t[Ba]=r,v0(t,e,!1,!1),e.stateNode=t;e:{switch(o=nf(n,r),n){case"dialog":He("cancel",t),He("close",t),s=r;break;case"iframe":case"object":case"embed":He("load",t),s=r;break;case"video":case"audio":for(s=0;s<ca.length;s++)He(ca[s],t);s=r;break;case"source":He("error",t),s=r;break;case"img":case"image":case"link":He("error",t),He("load",t),s=r;break;case"details":He("toggle",t),s=r;break;case"input":wy(t,r),s=Yh(t,r),He("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=nt({},r,{value:void 0}),He("invalid",t);break;case"textarea":Ey(t,r),s=Zh(t,r),He("invalid",t);break;default:s=r}tf(n,s),l=s;for(i in l)if(l.hasOwnProperty(i)){var c=l[i];i==="style"?Jw(t,c):i==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&Qw(t,c)):i==="children"?typeof c=="string"?(n!=="textarea"||c!=="")&&ja(t,c):typeof c=="number"&&ja(t,""+c):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(Pa.hasOwnProperty(i)?c!=null&&i==="onScroll"&&He("scroll",t):c!=null&&Sp(t,i,c,o))}switch(n){case"input":eu(t),xy(t,r,!1);break;case"textarea":eu(t),Ty(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Rs(r.value));break;case"select":t.multiple=!!r.multiple,i=r.value,i!=null?ro(t,!!r.multiple,i,!1):r.defaultValue!=null&&ro(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=Zu)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return $t(e),null;case 6:if(t&&e.stateNode!=null)w0(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(q(166));if(n=ni(qa.current),ni(fr.current),uu(e)){if(r=e.stateNode,n=e.memoizedProps,r[dr]=e,(i=r.nodeValue!==n)&&(t=wn,t!==null))switch(t.tag){case 3:lu(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&lu(r.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[dr]=e,e.stateNode=r}return $t(e),null;case 13:if(Ge(Xe),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Ye&&vn!==null&&e.mode&1&&!(e.flags&128))Mx(),go(),e.flags|=98560,i=!1;else if(i=uu(e),r!==null&&r.dehydrated!==null){if(t===null){if(!i)throw Error(q(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(q(317));i[dr]=e}else go(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;$t(e),i=!1}else Hn!==null&&(Lf(Hn),Hn=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||Xe.current&1?vt===0&&(vt=3):am())),e.updateQueue!==null&&(e.flags|=4),$t(e),null);case 4:return vo(),Cf(t,e),t===null&&Fa(e.stateNode.containerInfo),$t(e),null;case 10:return qp(e.type._context),$t(e),null;case 17:return hn(e.type)&&ec(),$t(e),null;case 19:if(Ge(Xe),i=e.memoizedState,i===null)return $t(e),null;if(r=(e.flags&128)!==0,o=i.rendering,o===null)if(r)ia(i,!1);else{if(vt!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=ac(t),o!==null){for(e.flags|=128,ia(i,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)i=n,t=r,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,t=o.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return ze(Xe,Xe.current&1|2),e.child}t=t.sibling}i.tail!==null&&ut()>wo&&(e.flags|=128,r=!0,ia(i,!1),e.lanes=4194304)}else{if(!r)if(t=ac(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),ia(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!Ye)return $t(e),null}else 2*ut()-i.renderingStartTime>wo&&n!==1073741824&&(e.flags|=128,r=!0,ia(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(n=i.last,n!==null?n.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=ut(),e.sibling=null,n=Xe.current,ze(Xe,r?n&1|2:n&1),e):($t(e),null);case 22:case 23:return om(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?gn&1073741824&&($t(e),e.subtreeFlags&6&&(e.flags|=8192)):$t(e),null;case 24:return null;case 25:return null}throw Error(q(156,e.tag))}function Db(t,e){switch(Fp(e),e.tag){case 1:return hn(e.type)&&ec(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return vo(),Ge(dn),Ge(Gt),Qp(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Kp(e),null;case 13:if(Ge(Xe),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(q(340));go()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Ge(Xe),null;case 4:return vo(),null;case 10:return qp(e.type._context),null;case 22:case 23:return om(),null;case 24:return null;default:return null}}var hu=!1,qt=!1,Ob=typeof WeakSet=="function"?WeakSet:Set,X=null;function Zi(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){ot(t,e,r)}else n.current=null}function kf(t,e,n){try{n()}catch(r){ot(t,e,r)}}var hv=!1;function Vb(t,e){if(ff=Yu,t=Sx(),Mp(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var o=0,l=-1,c=-1,d=0,f=0,p=t,m=null;t:for(;;){for(var y;p!==n||s!==0&&p.nodeType!==3||(l=o+s),p!==i||r!==0&&p.nodeType!==3||(c=o+r),p.nodeType===3&&(o+=p.nodeValue.length),(y=p.firstChild)!==null;)m=p,p=y;for(;;){if(p===t)break t;if(m===n&&++d===s&&(l=o),m===i&&++f===r&&(c=o),(y=p.nextSibling)!==null)break;p=m,m=p.parentNode}p=y}n=l===-1||c===-1?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(pf={focusedElem:t,selectionRange:n},Yu=!1,X=e;X!==null;)if(e=X,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,X=t;else for(;X!==null;){e=X;try{var w=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(w!==null){var A=w.memoizedProps,b=w.memoizedState,E=e.stateNode,v=E.getSnapshotBeforeUpdate(e.elementType===e.type?A:qn(e.type,A),b);E.__reactInternalSnapshotBeforeUpdate=v}break;case 3:var x=e.stateNode.containerInfo;x.nodeType===1?x.textContent="":x.nodeType===9&&x.documentElement&&x.removeChild(x.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(q(163))}}catch(R){ot(e,e.return,R)}if(t=e.sibling,t!==null){t.return=e.return,X=t;break}X=e.return}return w=hv,hv=!1,w}function Ea(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var i=s.destroy;s.destroy=void 0,i!==void 0&&kf(e,n,i)}s=s.next}while(s!==r)}}function Yc(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function Rf(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function x0(t){var e=t.alternate;e!==null&&(t.alternate=null,x0(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[dr],delete e[Ba],delete e[yf],delete e[vb],delete e[_b])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function E0(t){return t.tag===5||t.tag===3||t.tag===4}function fv(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||E0(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Pf(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=Zu));else if(r!==4&&(t=t.child,t!==null))for(Pf(t,e,n),t=t.sibling;t!==null;)Pf(t,e,n),t=t.sibling}function jf(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(jf(t,e,n),t=t.sibling;t!==null;)jf(t,e,n),t=t.sibling}var Pt=null,Wn=!1;function ns(t,e,n){for(n=n.child;n!==null;)T0(t,e,n),n=n.sibling}function T0(t,e,n){if(hr&&typeof hr.onCommitFiberUnmount=="function")try{hr.onCommitFiberUnmount(Bc,n)}catch{}switch(n.tag){case 5:qt||Zi(n,e);case 6:var r=Pt,s=Wn;Pt=null,ns(t,e,n),Pt=r,Wn=s,Pt!==null&&(Wn?(t=Pt,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Pt.removeChild(n.stateNode));break;case 18:Pt!==null&&(Wn?(t=Pt,n=n.stateNode,t.nodeType===8?fh(t.parentNode,n):t.nodeType===1&&fh(t,n),La(t)):fh(Pt,n.stateNode));break;case 4:r=Pt,s=Wn,Pt=n.stateNode.containerInfo,Wn=!0,ns(t,e,n),Pt=r,Wn=s;break;case 0:case 11:case 14:case 15:if(!qt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&kf(n,e,o),s=s.next}while(s!==r)}ns(t,e,n);break;case 1:if(!qt&&(Zi(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(l){ot(n,e,l)}ns(t,e,n);break;case 21:ns(t,e,n);break;case 22:n.mode&1?(qt=(r=qt)||n.memoizedState!==null,ns(t,e,n),qt=r):ns(t,e,n);break;default:ns(t,e,n)}}function pv(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new Ob),e.forEach(function(r){var s=Wb.bind(null,t,r);n.has(r)||(n.add(r),r.then(s,s))})}}function zn(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=t,o=e,l=o;e:for(;l!==null;){switch(l.tag){case 5:Pt=l.stateNode,Wn=!1;break e;case 3:Pt=l.stateNode.containerInfo,Wn=!0;break e;case 4:Pt=l.stateNode.containerInfo,Wn=!0;break e}l=l.return}if(Pt===null)throw Error(q(160));T0(i,o,s),Pt=null,Wn=!1;var c=s.alternate;c!==null&&(c.return=null),s.return=null}catch(d){ot(s,e,d)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)I0(e,t),e=e.sibling}function I0(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(zn(e,t),lr(t),r&4){try{Ea(3,t,t.return),Yc(3,t)}catch(A){ot(t,t.return,A)}try{Ea(5,t,t.return)}catch(A){ot(t,t.return,A)}}break;case 1:zn(e,t),lr(t),r&512&&n!==null&&Zi(n,n.return);break;case 5:if(zn(e,t),lr(t),r&512&&n!==null&&Zi(n,n.return),t.flags&32){var s=t.stateNode;try{ja(s,"")}catch(A){ot(t,t.return,A)}}if(r&4&&(s=t.stateNode,s!=null)){var i=t.memoizedProps,o=n!==null?n.memoizedProps:i,l=t.type,c=t.updateQueue;if(t.updateQueue=null,c!==null)try{l==="input"&&i.type==="radio"&&i.name!=null&&Hw(s,i),nf(l,o);var d=nf(l,i);for(o=0;o<c.length;o+=2){var f=c[o],p=c[o+1];f==="style"?Jw(s,p):f==="dangerouslySetInnerHTML"?Qw(s,p):f==="children"?ja(s,p):Sp(s,f,p,d)}switch(l){case"input":Jh(s,i);break;case"textarea":Gw(s,i);break;case"select":var m=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var y=i.value;y!=null?ro(s,!!i.multiple,y,!1):m!==!!i.multiple&&(i.defaultValue!=null?ro(s,!!i.multiple,i.defaultValue,!0):ro(s,!!i.multiple,i.multiple?[]:"",!1))}s[Ba]=i}catch(A){ot(t,t.return,A)}}break;case 6:if(zn(e,t),lr(t),r&4){if(t.stateNode===null)throw Error(q(162));s=t.stateNode,i=t.memoizedProps;try{s.nodeValue=i}catch(A){ot(t,t.return,A)}}break;case 3:if(zn(e,t),lr(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{La(e.containerInfo)}catch(A){ot(t,t.return,A)}break;case 4:zn(e,t),lr(t);break;case 13:zn(e,t),lr(t),s=t.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(sm=ut())),r&4&&pv(t);break;case 22:if(f=n!==null&&n.memoizedState!==null,t.mode&1?(qt=(d=qt)||f,zn(e,t),qt=d):zn(e,t),lr(t),r&8192){if(d=t.memoizedState!==null,(t.stateNode.isHidden=d)&&!f&&t.mode&1)for(X=t,f=t.child;f!==null;){for(p=X=f;X!==null;){switch(m=X,y=m.child,m.tag){case 0:case 11:case 14:case 15:Ea(4,m,m.return);break;case 1:Zi(m,m.return);var w=m.stateNode;if(typeof w.componentWillUnmount=="function"){r=m,n=m.return;try{e=r,w.props=e.memoizedProps,w.state=e.memoizedState,w.componentWillUnmount()}catch(A){ot(r,n,A)}}break;case 5:Zi(m,m.return);break;case 22:if(m.memoizedState!==null){gv(p);continue}}y!==null?(y.return=m,X=y):gv(p)}f=f.sibling}e:for(f=null,p=t;;){if(p.tag===5){if(f===null){f=p;try{s=p.stateNode,d?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(l=p.stateNode,c=p.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=Yw("display",o))}catch(A){ot(t,t.return,A)}}}else if(p.tag===6){if(f===null)try{p.stateNode.nodeValue=d?"":p.memoizedProps}catch(A){ot(t,t.return,A)}}else if((p.tag!==22&&p.tag!==23||p.memoizedState===null||p===t)&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===t)break e;for(;p.sibling===null;){if(p.return===null||p.return===t)break e;f===p&&(f=null),p=p.return}f===p&&(f=null),p.sibling.return=p.return,p=p.sibling}}break;case 19:zn(e,t),lr(t),r&4&&pv(t);break;case 21:break;default:zn(e,t),lr(t)}}function lr(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(E0(n)){var r=n;break e}n=n.return}throw Error(q(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(ja(s,""),r.flags&=-33);var i=fv(t);jf(t,i,s);break;case 3:case 4:var o=r.stateNode.containerInfo,l=fv(t);Pf(t,l,o);break;default:throw Error(q(161))}}catch(c){ot(t,t.return,c)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function Lb(t,e,n){X=t,S0(t)}function S0(t,e,n){for(var r=(t.mode&1)!==0;X!==null;){var s=X,i=s.child;if(s.tag===22&&r){var o=s.memoizedState!==null||hu;if(!o){var l=s.alternate,c=l!==null&&l.memoizedState!==null||qt;l=hu;var d=qt;if(hu=o,(qt=c)&&!d)for(X=s;X!==null;)o=X,c=o.child,o.tag===22&&o.memoizedState!==null?yv(s):c!==null?(c.return=o,X=c):yv(s);for(;i!==null;)X=i,S0(i),i=i.sibling;X=s,hu=l,qt=d}mv(t)}else s.subtreeFlags&8772&&i!==null?(i.return=s,X=i):mv(t)}}function mv(t){for(;X!==null;){var e=X;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:qt||Yc(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!qt)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:qn(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&Zy(e,i,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}Zy(e,o,n)}break;case 5:var l=e.stateNode;if(n===null&&e.flags&4){n=l;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var d=e.alternate;if(d!==null){var f=d.memoizedState;if(f!==null){var p=f.dehydrated;p!==null&&La(p)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(q(163))}qt||e.flags&512&&Rf(e)}catch(m){ot(e,e.return,m)}}if(e===t){X=null;break}if(n=e.sibling,n!==null){n.return=e.return,X=n;break}X=e.return}}function gv(t){for(;X!==null;){var e=X;if(e===t){X=null;break}var n=e.sibling;if(n!==null){n.return=e.return,X=n;break}X=e.return}}function yv(t){for(;X!==null;){var e=X;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Yc(4,e)}catch(c){ot(e,n,c)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(c){ot(e,s,c)}}var i=e.return;try{Rf(e)}catch(c){ot(e,i,c)}break;case 5:var o=e.return;try{Rf(e)}catch(c){ot(e,o,c)}}}catch(c){ot(e,e.return,c)}if(e===t){X=null;break}var l=e.sibling;if(l!==null){l.return=e.return,X=l;break}X=e.return}}var Mb=Math.ceil,cc=Gr.ReactCurrentDispatcher,nm=Gr.ReactCurrentOwner,Rn=Gr.ReactCurrentBatchConfig,be=0,At=null,ft=null,Ot=0,gn=0,eo=Fs(0),vt=0,Ka=null,di=0,Jc=0,rm=0,Ta=null,on=null,sm=0,wo=1/0,br=null,dc=!1,Df=null,Ts=null,fu=!1,ms=null,hc=0,Ia=0,Of=null,Pu=-1,ju=0;function Zt(){return be&6?ut():Pu!==-1?Pu:Pu=ut()}function Is(t){return t.mode&1?be&2&&Ot!==0?Ot&-Ot:xb.transition!==null?(ju===0&&(ju=ux()),ju):(t=Ve,t!==0||(t=window.event,t=t===void 0?16:gx(t.type)),t):1}function Qn(t,e,n,r){if(50<Ia)throw Ia=0,Of=null,Error(q(185));dl(t,n,r),(!(be&2)||t!==At)&&(t===At&&(!(be&2)&&(Jc|=n),vt===4&&us(t,Ot)),fn(t,r),n===1&&be===0&&!(e.mode&1)&&(wo=ut()+500,Gc&&$s()))}function fn(t,e){var n=t.callbackNode;xN(t,e);var r=Qu(t,t===At?Ot:0);if(r===0)n!==null&&Ny(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&Ny(n),e===1)t.tag===0?wb(vv.bind(null,t)):Ox(vv.bind(null,t)),gb(function(){!(be&6)&&$s()}),n=null;else{switch(cx(r)){case 1:n=kp;break;case 4:n=ax;break;case 16:n=Ku;break;case 536870912:n=lx;break;default:n=Ku}n=j0(n,N0.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function N0(t,e){if(Pu=-1,ju=0,be&6)throw Error(q(327));var n=t.callbackNode;if(lo()&&t.callbackNode!==n)return null;var r=Qu(t,t===At?Ot:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=fc(t,r);else{e=r;var s=be;be|=2;var i=A0();(At!==t||Ot!==e)&&(br=null,wo=ut()+500,oi(t,e));do try{$b();break}catch(l){b0(t,l)}while(!0);zp(),cc.current=i,be=s,ft!==null?e=0:(At=null,Ot=0,e=vt)}if(e!==0){if(e===2&&(s=lf(t),s!==0&&(r=s,e=Vf(t,s))),e===1)throw n=Ka,oi(t,0),us(t,r),fn(t,ut()),n;if(e===6)us(t,r);else{if(s=t.current.alternate,!(r&30)&&!Ub(s)&&(e=fc(t,r),e===2&&(i=lf(t),i!==0&&(r=i,e=Vf(t,i))),e===1))throw n=Ka,oi(t,0),us(t,r),fn(t,ut()),n;switch(t.finishedWork=s,t.finishedLanes=r,e){case 0:case 1:throw Error(q(345));case 2:Xs(t,on,br);break;case 3:if(us(t,r),(r&130023424)===r&&(e=sm+500-ut(),10<e)){if(Qu(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){Zt(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=gf(Xs.bind(null,t,on,br),e);break}Xs(t,on,br);break;case 4:if(us(t,r),(r&4194240)===r)break;for(e=t.eventTimes,s=-1;0<r;){var o=31-Kn(r);i=1<<o,o=e[o],o>s&&(s=o),r&=~i}if(r=s,r=ut()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Mb(r/1960))-r,10<r){t.timeoutHandle=gf(Xs.bind(null,t,on,br),r);break}Xs(t,on,br);break;case 5:Xs(t,on,br);break;default:throw Error(q(329))}}}return fn(t,ut()),t.callbackNode===n?N0.bind(null,t):null}function Vf(t,e){var n=Ta;return t.current.memoizedState.isDehydrated&&(oi(t,e).flags|=256),t=fc(t,e),t!==2&&(e=on,on=n,e!==null&&Lf(e)),t}function Lf(t){on===null?on=t:on.push.apply(on,t)}function Ub(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!Zn(i(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function us(t,e){for(e&=~rm,e&=~Jc,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Kn(e),r=1<<n;t[n]=-1,e&=~r}}function vv(t){if(be&6)throw Error(q(327));lo();var e=Qu(t,0);if(!(e&1))return fn(t,ut()),null;var n=fc(t,e);if(t.tag!==0&&n===2){var r=lf(t);r!==0&&(e=r,n=Vf(t,r))}if(n===1)throw n=Ka,oi(t,0),us(t,e),fn(t,ut()),n;if(n===6)throw Error(q(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Xs(t,on,br),fn(t,ut()),null}function im(t,e){var n=be;be|=1;try{return t(e)}finally{be=n,be===0&&(wo=ut()+500,Gc&&$s())}}function hi(t){ms!==null&&ms.tag===0&&!(be&6)&&lo();var e=be;be|=1;var n=Rn.transition,r=Ve;try{if(Rn.transition=null,Ve=1,t)return t()}finally{Ve=r,Rn.transition=n,be=e,!(be&6)&&$s()}}function om(){gn=eo.current,Ge(eo)}function oi(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,mb(n)),ft!==null)for(n=ft.return;n!==null;){var r=n;switch(Fp(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&ec();break;case 3:vo(),Ge(dn),Ge(Gt),Qp();break;case 5:Kp(r);break;case 4:vo();break;case 13:Ge(Xe);break;case 19:Ge(Xe);break;case 10:qp(r.type._context);break;case 22:case 23:om()}n=n.return}if(At=t,ft=t=Ss(t.current,null),Ot=gn=e,vt=0,Ka=null,rm=Jc=di=0,on=Ta=null,ti!==null){for(e=0;e<ti.length;e++)if(n=ti[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var o=i.next;i.next=s,r.next=o}n.pending=r}ti=null}return t}function b0(t,e){do{var n=ft;try{if(zp(),Cu.current=uc,lc){for(var r=et.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}lc=!1}if(ci=0,Nt=yt=et=null,xa=!1,Wa=0,nm.current=null,n===null||n.return===null){vt=1,Ka=e,ft=null;break}e:{var i=t,o=n.return,l=n,c=e;if(e=Ot,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var d=c,f=l,p=f.tag;if(!(f.mode&1)&&(p===0||p===11||p===15)){var m=f.alternate;m?(f.updateQueue=m.updateQueue,f.memoizedState=m.memoizedState,f.lanes=m.lanes):(f.updateQueue=null,f.memoizedState=null)}var y=iv(o);if(y!==null){y.flags&=-257,ov(y,o,l,i,e),y.mode&1&&sv(i,d,e),e=y,c=d;var w=e.updateQueue;if(w===null){var A=new Set;A.add(c),e.updateQueue=A}else w.add(c);break e}else{if(!(e&1)){sv(i,d,e),am();break e}c=Error(q(426))}}else if(Ye&&l.mode&1){var b=iv(o);if(b!==null){!(b.flags&65536)&&(b.flags|=256),ov(b,o,l,i,e),$p(_o(c,l));break e}}i=c=_o(c,l),vt!==4&&(vt=2),Ta===null?Ta=[i]:Ta.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var E=c0(i,c,e);Xy(i,E);break e;case 1:l=c;var v=i.type,x=i.stateNode;if(!(i.flags&128)&&(typeof v.getDerivedStateFromError=="function"||x!==null&&typeof x.componentDidCatch=="function"&&(Ts===null||!Ts.has(x)))){i.flags|=65536,e&=-e,i.lanes|=e;var R=d0(i,l,e);Xy(i,R);break e}}i=i.return}while(i!==null)}k0(n)}catch(O){e=O,ft===n&&n!==null&&(ft=n=n.return);continue}break}while(!0)}function A0(){var t=cc.current;return cc.current=uc,t===null?uc:t}function am(){(vt===0||vt===3||vt===2)&&(vt=4),At===null||!(di&268435455)&&!(Jc&268435455)||us(At,Ot)}function fc(t,e){var n=be;be|=2;var r=A0();(At!==t||Ot!==e)&&(br=null,oi(t,e));do try{Fb();break}catch(s){b0(t,s)}while(!0);if(zp(),be=n,cc.current=r,ft!==null)throw Error(q(261));return At=null,Ot=0,vt}function Fb(){for(;ft!==null;)C0(ft)}function $b(){for(;ft!==null&&!hN();)C0(ft)}function C0(t){var e=P0(t.alternate,t,gn);t.memoizedProps=t.pendingProps,e===null?k0(t):ft=e,nm.current=null}function k0(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=Db(n,e),n!==null){n.flags&=32767,ft=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{vt=6,ft=null;return}}else if(n=jb(n,e,gn),n!==null){ft=n;return}if(e=e.sibling,e!==null){ft=e;return}ft=e=t}while(e!==null);vt===0&&(vt=5)}function Xs(t,e,n){var r=Ve,s=Rn.transition;try{Rn.transition=null,Ve=1,Bb(t,e,n,r)}finally{Rn.transition=s,Ve=r}return null}function Bb(t,e,n,r){do lo();while(ms!==null);if(be&6)throw Error(q(327));n=t.finishedWork;var s=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(q(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(EN(t,i),t===At&&(ft=At=null,Ot=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||fu||(fu=!0,j0(Ku,function(){return lo(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=Rn.transition,Rn.transition=null;var o=Ve;Ve=1;var l=be;be|=4,nm.current=null,Vb(t,n),I0(n,t),lb(pf),Yu=!!ff,pf=ff=null,t.current=n,Lb(n),fN(),be=l,Ve=o,Rn.transition=i}else t.current=n;if(fu&&(fu=!1,ms=t,hc=s),i=t.pendingLanes,i===0&&(Ts=null),gN(n.stateNode),fn(t,ut()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(dc)throw dc=!1,t=Df,Df=null,t;return hc&1&&t.tag!==0&&lo(),i=t.pendingLanes,i&1?t===Of?Ia++:(Ia=0,Of=t):Ia=0,$s(),null}function lo(){if(ms!==null){var t=cx(hc),e=Rn.transition,n=Ve;try{if(Rn.transition=null,Ve=16>t?16:t,ms===null)var r=!1;else{if(t=ms,ms=null,hc=0,be&6)throw Error(q(331));var s=be;for(be|=4,X=t.current;X!==null;){var i=X,o=i.child;if(X.flags&16){var l=i.deletions;if(l!==null){for(var c=0;c<l.length;c++){var d=l[c];for(X=d;X!==null;){var f=X;switch(f.tag){case 0:case 11:case 15:Ea(8,f,i)}var p=f.child;if(p!==null)p.return=f,X=p;else for(;X!==null;){f=X;var m=f.sibling,y=f.return;if(x0(f),f===d){X=null;break}if(m!==null){m.return=y,X=m;break}X=y}}}var w=i.alternate;if(w!==null){var A=w.child;if(A!==null){w.child=null;do{var b=A.sibling;A.sibling=null,A=b}while(A!==null)}}X=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,X=o;else e:for(;X!==null;){if(i=X,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Ea(9,i,i.return)}var E=i.sibling;if(E!==null){E.return=i.return,X=E;break e}X=i.return}}var v=t.current;for(X=v;X!==null;){o=X;var x=o.child;if(o.subtreeFlags&2064&&x!==null)x.return=o,X=x;else e:for(o=v;X!==null;){if(l=X,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:Yc(9,l)}}catch(O){ot(l,l.return,O)}if(l===o){X=null;break e}var R=l.sibling;if(R!==null){R.return=l.return,X=R;break e}X=l.return}}if(be=s,$s(),hr&&typeof hr.onPostCommitFiberRoot=="function")try{hr.onPostCommitFiberRoot(Bc,t)}catch{}r=!0}return r}finally{Ve=n,Rn.transition=e}}return!1}function _v(t,e,n){e=_o(n,e),e=c0(t,e,1),t=Es(t,e,1),e=Zt(),t!==null&&(dl(t,1,e),fn(t,e))}function ot(t,e,n){if(t.tag===3)_v(t,t,n);else for(;e!==null;){if(e.tag===3){_v(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Ts===null||!Ts.has(r))){t=_o(n,t),t=d0(e,t,1),e=Es(e,t,1),t=Zt(),e!==null&&(dl(e,1,t),fn(e,t));break}}e=e.return}}function zb(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=Zt(),t.pingedLanes|=t.suspendedLanes&n,At===t&&(Ot&n)===n&&(vt===4||vt===3&&(Ot&130023424)===Ot&&500>ut()-sm?oi(t,0):rm|=n),fn(t,e)}function R0(t,e){e===0&&(t.mode&1?(e=ru,ru<<=1,!(ru&130023424)&&(ru=4194304)):e=1);var n=Zt();t=$r(t,e),t!==null&&(dl(t,e,n),fn(t,n))}function qb(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),R0(t,n)}function Wb(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(q(314))}r!==null&&r.delete(e),R0(t,n)}var P0;P0=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||dn.current)un=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return un=!1,Pb(t,e,n);un=!!(t.flags&131072)}else un=!1,Ye&&e.flags&1048576&&Vx(e,rc,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Ru(t,e),t=e.pendingProps;var s=mo(e,Gt.current);ao(e,n),s=Jp(null,e,r,t,s,n);var i=Xp();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,hn(r)?(i=!0,tc(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,Hp(e),s.updater=Qc,e.stateNode=s,s._reactInternals=e,Tf(e,r,t,n),e=Nf(null,e,r,!0,i,n)):(e.tag=0,Ye&&i&&Up(e),Jt(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Ru(t,e),t=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=Gb(r),t=qn(r,t),s){case 0:e=Sf(null,e,r,t,n);break e;case 1:e=uv(null,e,r,t,n);break e;case 11:e=av(null,e,r,t,n);break e;case 14:e=lv(null,e,r,qn(r.type,t),n);break e}throw Error(q(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:qn(r,s),Sf(t,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:qn(r,s),uv(t,e,r,s,n);case 3:e:{if(m0(e),t===null)throw Error(q(387));r=e.pendingProps,i=e.memoizedState,s=i.element,Bx(t,e),oc(e,r,null,n);var o=e.memoizedState;if(r=o.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=_o(Error(q(423)),e),e=cv(t,e,r,n,s);break e}else if(r!==s){s=_o(Error(q(424)),e),e=cv(t,e,r,n,s);break e}else for(vn=xs(e.stateNode.containerInfo.firstChild),wn=e,Ye=!0,Hn=null,n=Fx(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(go(),r===s){e=Br(t,e,n);break e}Jt(t,e,r,n)}e=e.child}return e;case 5:return zx(e),t===null&&wf(e),r=e.type,s=e.pendingProps,i=t!==null?t.memoizedProps:null,o=s.children,mf(r,s)?o=null:i!==null&&mf(r,i)&&(e.flags|=32),p0(t,e),Jt(t,e,o,n),e.child;case 6:return t===null&&wf(e),null;case 13:return g0(t,e,n);case 4:return Gp(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=yo(e,null,r,n):Jt(t,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:qn(r,s),av(t,e,r,s,n);case 7:return Jt(t,e,e.pendingProps,n),e.child;case 8:return Jt(t,e,e.pendingProps.children,n),e.child;case 12:return Jt(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,i=e.memoizedProps,o=s.value,ze(sc,r._currentValue),r._currentValue=o,i!==null)if(Zn(i.value,o)){if(i.children===s.children&&!dn.current){e=Br(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var l=i.dependencies;if(l!==null){o=i.child;for(var c=l.firstContext;c!==null;){if(c.context===r){if(i.tag===1){c=Or(-1,n&-n),c.tag=2;var d=i.updateQueue;if(d!==null){d=d.shared;var f=d.pending;f===null?c.next=c:(c.next=f.next,f.next=c),d.pending=c}}i.lanes|=n,c=i.alternate,c!==null&&(c.lanes|=n),xf(i.return,n,e),l.lanes|=n;break}c=c.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(q(341));o.lanes|=n,l=o.alternate,l!==null&&(l.lanes|=n),xf(o,n,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}Jt(t,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,ao(e,n),s=Pn(s),r=r(s),e.flags|=1,Jt(t,e,r,n),e.child;case 14:return r=e.type,s=qn(r,e.pendingProps),s=qn(r.type,s),lv(t,e,r,s,n);case 15:return h0(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:qn(r,s),Ru(t,e),e.tag=1,hn(r)?(t=!0,tc(e)):t=!1,ao(e,n),u0(e,r,s),Tf(e,r,s,n),Nf(null,e,r,!0,t,n);case 19:return y0(t,e,n);case 22:return f0(t,e,n)}throw Error(q(156,e.tag))};function j0(t,e){return ox(t,e)}function Hb(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Cn(t,e,n,r){return new Hb(t,e,n,r)}function lm(t){return t=t.prototype,!(!t||!t.isReactComponent)}function Gb(t){if(typeof t=="function")return lm(t)?1:0;if(t!=null){if(t=t.$$typeof,t===bp)return 11;if(t===Ap)return 14}return 2}function Ss(t,e){var n=t.alternate;return n===null?(n=Cn(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Du(t,e,n,r,s,i){var o=2;if(r=t,typeof t=="function")lm(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case qi:return ai(n.children,s,i,e);case Np:o=8,s|=8;break;case Hh:return t=Cn(12,n,e,s|2),t.elementType=Hh,t.lanes=i,t;case Gh:return t=Cn(13,n,e,s),t.elementType=Gh,t.lanes=i,t;case Kh:return t=Cn(19,n,e,s),t.elementType=Kh,t.lanes=i,t;case zw:return Xc(n,s,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case $w:o=10;break e;case Bw:o=9;break e;case bp:o=11;break e;case Ap:o=14;break e;case os:o=16,r=null;break e}throw Error(q(130,t==null?t:typeof t,""))}return e=Cn(o,n,e,s),e.elementType=t,e.type=r,e.lanes=i,e}function ai(t,e,n,r){return t=Cn(7,t,r,e),t.lanes=n,t}function Xc(t,e,n,r){return t=Cn(22,t,r,e),t.elementType=zw,t.lanes=n,t.stateNode={isHidden:!1},t}function xh(t,e,n){return t=Cn(6,t,null,e),t.lanes=n,t}function Eh(t,e,n){return e=Cn(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function Kb(t,e,n,r,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=nh(0),this.expirationTimes=nh(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=nh(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function um(t,e,n,r,s,i,o,l,c){return t=new Kb(t,e,n,l,c),e===1?(e=1,i===!0&&(e|=8)):e=0,i=Cn(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Hp(i),t}function Qb(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:zi,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function D0(t){if(!t)return Ps;t=t._reactInternals;e:{if(Ei(t)!==t||t.tag!==1)throw Error(q(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(hn(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(q(171))}if(t.tag===1){var n=t.type;if(hn(n))return Dx(t,n,e)}return e}function O0(t,e,n,r,s,i,o,l,c){return t=um(n,r,!0,t,s,i,o,l,c),t.context=D0(null),n=t.current,r=Zt(),s=Is(n),i=Or(r,s),i.callback=e??null,Es(n,i,s),t.current.lanes=s,dl(t,s,r),fn(t,r),t}function Zc(t,e,n,r){var s=e.current,i=Zt(),o=Is(s);return n=D0(n),e.context===null?e.context=n:e.pendingContext=n,e=Or(i,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Es(s,e,o),t!==null&&(Qn(t,s,o,i),Au(t,s,o)),o}function pc(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function wv(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function cm(t,e){wv(t,e),(t=t.alternate)&&wv(t,e)}function Yb(){return null}var V0=typeof reportError=="function"?reportError:function(t){console.error(t)};function dm(t){this._internalRoot=t}ed.prototype.render=dm.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(q(409));Zc(t,e,null,null)};ed.prototype.unmount=dm.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;hi(function(){Zc(null,t,null,null)}),e[Fr]=null}};function ed(t){this._internalRoot=t}ed.prototype.unstable_scheduleHydration=function(t){if(t){var e=fx();t={blockedOn:null,target:t,priority:e};for(var n=0;n<ls.length&&e!==0&&e<ls[n].priority;n++);ls.splice(n,0,t),n===0&&mx(t)}};function hm(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function td(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function xv(){}function Jb(t,e,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var d=pc(o);i.call(d)}}var o=O0(e,r,t,0,null,!1,!1,"",xv);return t._reactRootContainer=o,t[Fr]=o.current,Fa(t.nodeType===8?t.parentNode:t),hi(),o}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var l=r;r=function(){var d=pc(c);l.call(d)}}var c=um(t,0,!1,null,null,!1,!1,"",xv);return t._reactRootContainer=c,t[Fr]=c.current,Fa(t.nodeType===8?t.parentNode:t),hi(function(){Zc(e,c,n,r)}),c}function nd(t,e,n,r,s){var i=n._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var l=s;s=function(){var c=pc(o);l.call(c)}}Zc(e,o,t,s)}else o=Jb(n,e,t,s,r);return pc(o)}dx=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=ua(e.pendingLanes);n!==0&&(Rp(e,n|1),fn(e,ut()),!(be&6)&&(wo=ut()+500,$s()))}break;case 13:hi(function(){var r=$r(t,1);if(r!==null){var s=Zt();Qn(r,t,1,s)}}),cm(t,1)}};Pp=function(t){if(t.tag===13){var e=$r(t,134217728);if(e!==null){var n=Zt();Qn(e,t,134217728,n)}cm(t,134217728)}};hx=function(t){if(t.tag===13){var e=Is(t),n=$r(t,e);if(n!==null){var r=Zt();Qn(n,t,e,r)}cm(t,e)}};fx=function(){return Ve};px=function(t,e){var n=Ve;try{return Ve=t,e()}finally{Ve=n}};sf=function(t,e,n){switch(e){case"input":if(Jh(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var s=Hc(r);if(!s)throw Error(q(90));Ww(r),Jh(r,s)}}}break;case"textarea":Gw(t,n);break;case"select":e=n.value,e!=null&&ro(t,!!n.multiple,e,!1)}};ex=im;tx=hi;var Xb={usingClientEntryPoint:!1,Events:[fl,Ki,Hc,Xw,Zw,im]},oa={findFiberByHostInstance:ei,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Zb={bundleType:oa.bundleType,version:oa.version,rendererPackageName:oa.rendererPackageName,rendererConfig:oa.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Gr.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=sx(t),t===null?null:t.stateNode},findFiberByHostInstance:oa.findFiberByHostInstance||Yb,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var pu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!pu.isDisabled&&pu.supportsFiber)try{Bc=pu.inject(Zb),hr=pu}catch{}}Tn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Xb;Tn.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!hm(e))throw Error(q(200));return Qb(t,e,null,n)};Tn.createRoot=function(t,e){if(!hm(t))throw Error(q(299));var n=!1,r="",s=V0;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=um(t,1,!1,null,null,n,!1,r,s),t[Fr]=e.current,Fa(t.nodeType===8?t.parentNode:t),new dm(e)};Tn.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(q(188)):(t=Object.keys(t).join(","),Error(q(268,t)));return t=sx(e),t=t===null?null:t.stateNode,t};Tn.flushSync=function(t){return hi(t)};Tn.hydrate=function(t,e,n){if(!td(e))throw Error(q(200));return nd(null,t,e,!0,n)};Tn.hydrateRoot=function(t,e,n){if(!hm(t))throw Error(q(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",o=V0;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=O0(e,null,t,1,n??null,s,!1,i,o),t[Fr]=e.current,Fa(t),r)for(t=0;t<r.length;t++)n=r[t],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new ed(e)};Tn.render=function(t,e,n){if(!td(e))throw Error(q(200));return nd(null,t,e,!1,n)};Tn.unmountComponentAtNode=function(t){if(!td(t))throw Error(q(40));return t._reactRootContainer?(hi(function(){nd(null,null,t,!1,function(){t._reactRootContainer=null,t[Fr]=null})}),!0):!1};Tn.unstable_batchedUpdates=im;Tn.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!td(n))throw Error(q(200));if(t==null||t._reactInternals===void 0)throw Error(q(38));return nd(t,e,n,!1,r)};Tn.version="18.3.1-next-f1338f8080-20240426";function L0(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(L0)}catch(t){console.error(t)}}L0(),Lw.exports=Tn;var eA=Lw.exports,Ev=eA;qh.createRoot=Ev.createRoot,qh.hydrateRoot=Ev.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Qa(){return Qa=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Qa.apply(this,arguments)}var gs;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(gs||(gs={}));const Tv="popstate";function tA(t){t===void 0&&(t={});function e(r,s){let{pathname:i,search:o,hash:l}=r.location;return Mf("",{pathname:i,search:o,hash:l},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function n(r,s){return typeof s=="string"?s:mc(s)}return rA(e,n,null,t)}function tt(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function M0(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function nA(){return Math.random().toString(36).substr(2,8)}function Iv(t,e){return{usr:t.state,key:t.key,idx:e}}function Mf(t,e,n,r){return n===void 0&&(n=null),Qa({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?jo(e):e,{state:n,key:e&&e.key||r||nA()})}function mc(t){let{pathname:e="/",search:n="",hash:r=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function jo(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substr(r),t=t.substr(0,r)),t&&(e.pathname=t)}return e}function rA(t,e,n,r){r===void 0&&(r={});let{window:s=document.defaultView,v5Compat:i=!1}=r,o=s.history,l=gs.Pop,c=null,d=f();d==null&&(d=0,o.replaceState(Qa({},o.state,{idx:d}),""));function f(){return(o.state||{idx:null}).idx}function p(){l=gs.Pop;let b=f(),E=b==null?null:b-d;d=b,c&&c({action:l,location:A.location,delta:E})}function m(b,E){l=gs.Push;let v=Mf(A.location,b,E);d=f()+1;let x=Iv(v,d),R=A.createHref(v);try{o.pushState(x,"",R)}catch(O){if(O instanceof DOMException&&O.name==="DataCloneError")throw O;s.location.assign(R)}i&&c&&c({action:l,location:A.location,delta:1})}function y(b,E){l=gs.Replace;let v=Mf(A.location,b,E);d=f();let x=Iv(v,d),R=A.createHref(v);o.replaceState(x,"",R),i&&c&&c({action:l,location:A.location,delta:0})}function w(b){let E=s.location.origin!=="null"?s.location.origin:s.location.href,v=typeof b=="string"?b:mc(b);return v=v.replace(/ $/,"%20"),tt(E,"No window.location.(origin|href) available to create URL for href: "+v),new URL(v,E)}let A={get action(){return l},get location(){return t(s,o)},listen(b){if(c)throw new Error("A history only accepts one active listener");return s.addEventListener(Tv,p),c=b,()=>{s.removeEventListener(Tv,p),c=null}},createHref(b){return e(s,b)},createURL:w,encodeLocation(b){let E=w(b);return{pathname:E.pathname,search:E.search,hash:E.hash}},push:m,replace:y,go(b){return o.go(b)}};return A}var Sv;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(Sv||(Sv={}));function sA(t,e,n){return n===void 0&&(n="/"),iA(t,e,n)}function iA(t,e,n,r){let s=typeof e=="string"?jo(e):e,i=xo(s.pathname||"/",n);if(i==null)return null;let o=U0(t);oA(o);let l=null;for(let c=0;l==null&&c<o.length;++c){let d=yA(i);l=mA(o[c],d)}return l}function U0(t,e,n,r){e===void 0&&(e=[]),n===void 0&&(n=[]),r===void 0&&(r="");let s=(i,o,l)=>{let c={relativePath:l===void 0?i.path||"":l,caseSensitive:i.caseSensitive===!0,childrenIndex:o,route:i};c.relativePath.startsWith("/")&&(tt(c.relativePath.startsWith(r),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(r.length));let d=Ns([r,c.relativePath]),f=n.concat(c);i.children&&i.children.length>0&&(tt(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+d+'".')),U0(i.children,e,f,d)),!(i.path==null&&!i.index)&&e.push({path:d,score:fA(d,i.index),routesMeta:f})};return t.forEach((i,o)=>{var l;if(i.path===""||!((l=i.path)!=null&&l.includes("?")))s(i,o);else for(let c of F0(i.path))s(i,o,c)}),e}function F0(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,s=n.endsWith("?"),i=n.replace(/\?$/,"");if(r.length===0)return s?[i,""]:[i];let o=F0(r.join("/")),l=[];return l.push(...o.map(c=>c===""?i:[i,c].join("/"))),s&&l.push(...o),l.map(c=>t.startsWith("/")&&c===""?"/":c)}function oA(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:pA(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const aA=/^:[\w-]+$/,lA=3,uA=2,cA=1,dA=10,hA=-2,Nv=t=>t==="*";function fA(t,e){let n=t.split("/"),r=n.length;return n.some(Nv)&&(r+=hA),e&&(r+=uA),n.filter(s=>!Nv(s)).reduce((s,i)=>s+(aA.test(i)?lA:i===""?cA:dA),r)}function pA(t,e){return t.length===e.length&&t.slice(0,-1).every((r,s)=>r===e[s])?t[t.length-1]-e[e.length-1]:0}function mA(t,e,n){let{routesMeta:r}=t,s={},i="/",o=[];for(let l=0;l<r.length;++l){let c=r[l],d=l===r.length-1,f=i==="/"?e:e.slice(i.length)||"/",p=Uf({path:c.relativePath,caseSensitive:c.caseSensitive,end:d},f),m=c.route;if(!p)return null;Object.assign(s,p.params),o.push({params:s,pathname:Ns([i,p.pathname]),pathnameBase:xA(Ns([i,p.pathnameBase])),route:m}),p.pathnameBase!=="/"&&(i=Ns([i,p.pathnameBase]))}return o}function Uf(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=gA(t.path,t.caseSensitive,t.end),s=e.match(n);if(!s)return null;let i=s[0],o=i.replace(/(.)\/+$/,"$1"),l=s.slice(1);return{params:r.reduce((d,f,p)=>{let{paramName:m,isOptional:y}=f;if(m==="*"){let A=l[p]||"";o=i.slice(0,i.length-A.length).replace(/(.)\/+$/,"$1")}const w=l[p];return y&&!w?d[m]=void 0:d[m]=(w||"").replace(/%2F/g,"/"),d},{}),pathname:i,pathnameBase:o,pattern:t}}function gA(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),M0(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let r=[],s="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,l,c)=>(r.push({paramName:l,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(r.push({paramName:"*"}),s+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?s+="\\/*$":t!==""&&t!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),r]}function yA(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return M0(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function xo(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}function vA(t,e){e===void 0&&(e="/");let{pathname:n,search:r="",hash:s=""}=typeof t=="string"?jo(t):t;return{pathname:n?n.startsWith("/")?n:_A(n,e):e,search:EA(r),hash:TA(s)}}function _A(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(s=>{s===".."?n.length>1&&n.pop():s!=="."&&n.push(s)}),n.length>1?n.join("/"):"/"}function Th(t,e,n,r){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function wA(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function fm(t,e){let n=wA(t);return e?n.map((r,s)=>s===n.length-1?r.pathname:r.pathnameBase):n.map(r=>r.pathnameBase)}function pm(t,e,n,r){r===void 0&&(r=!1);let s;typeof t=="string"?s=jo(t):(s=Qa({},t),tt(!s.pathname||!s.pathname.includes("?"),Th("?","pathname","search",s)),tt(!s.pathname||!s.pathname.includes("#"),Th("#","pathname","hash",s)),tt(!s.search||!s.search.includes("#"),Th("#","search","hash",s)));let i=t===""||s.pathname==="",o=i?"/":s.pathname,l;if(o==null)l=n;else{let p=e.length-1;if(!r&&o.startsWith("..")){let m=o.split("/");for(;m[0]==="..";)m.shift(),p-=1;s.pathname=m.join("/")}l=p>=0?e[p]:"/"}let c=vA(s,l),d=o&&o!=="/"&&o.endsWith("/"),f=(i||o===".")&&n.endsWith("/");return!c.pathname.endsWith("/")&&(d||f)&&(c.pathname+="/"),c}const Ns=t=>t.join("/").replace(/\/\/+/g,"/"),xA=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),EA=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,TA=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function IA(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const $0=["post","put","patch","delete"];new Set($0);const SA=["get",...$0];new Set(SA);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Ya(){return Ya=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Ya.apply(this,arguments)}const rd=k.createContext(null),B0=k.createContext(null),Kr=k.createContext(null),sd=k.createContext(null),Qr=k.createContext({outlet:null,matches:[],isDataRoute:!1}),z0=k.createContext(null);function NA(t,e){let{relative:n}=e===void 0?{}:e;Do()||tt(!1);let{basename:r,navigator:s}=k.useContext(Kr),{hash:i,pathname:o,search:l}=id(t,{relative:n}),c=o;return r!=="/"&&(c=o==="/"?r:Ns([r,o])),s.createHref({pathname:c,search:l,hash:i})}function Do(){return k.useContext(sd)!=null}function Ln(){return Do()||tt(!1),k.useContext(sd).location}function q0(t){k.useContext(Kr).static||k.useLayoutEffect(t)}function Yr(){let{isDataRoute:t}=k.useContext(Qr);return t?UA():bA()}function bA(){Do()||tt(!1);let t=k.useContext(rd),{basename:e,future:n,navigator:r}=k.useContext(Kr),{matches:s}=k.useContext(Qr),{pathname:i}=Ln(),o=JSON.stringify(fm(s,n.v7_relativeSplatPath)),l=k.useRef(!1);return q0(()=>{l.current=!0}),k.useCallback(function(d,f){if(f===void 0&&(f={}),!l.current)return;if(typeof d=="number"){r.go(d);return}let p=pm(d,JSON.parse(o),i,f.relative==="path");t==null&&e!=="/"&&(p.pathname=p.pathname==="/"?e:Ns([e,p.pathname])),(f.replace?r.replace:r.push)(p,f.state,f)},[e,r,o,i,t])}function Ti(){let{matches:t}=k.useContext(Qr),e=t[t.length-1];return e?e.params:{}}function id(t,e){let{relative:n}=e===void 0?{}:e,{future:r}=k.useContext(Kr),{matches:s}=k.useContext(Qr),{pathname:i}=Ln(),o=JSON.stringify(fm(s,r.v7_relativeSplatPath));return k.useMemo(()=>pm(t,JSON.parse(o),i,n==="path"),[t,o,i,n])}function AA(t,e){return CA(t,e)}function CA(t,e,n,r){Do()||tt(!1);let{navigator:s}=k.useContext(Kr),{matches:i}=k.useContext(Qr),o=i[i.length-1],l=o?o.params:{};o&&o.pathname;let c=o?o.pathnameBase:"/";o&&o.route;let d=Ln(),f;if(e){var p;let b=typeof e=="string"?jo(e):e;c==="/"||(p=b.pathname)!=null&&p.startsWith(c)||tt(!1),f=b}else f=d;let m=f.pathname||"/",y=m;if(c!=="/"){let b=c.replace(/^\//,"").split("/");y="/"+m.replace(/^\//,"").split("/").slice(b.length).join("/")}let w=sA(t,{pathname:y}),A=DA(w&&w.map(b=>Object.assign({},b,{params:Object.assign({},l,b.params),pathname:Ns([c,s.encodeLocation?s.encodeLocation(b.pathname).pathname:b.pathname]),pathnameBase:b.pathnameBase==="/"?c:Ns([c,s.encodeLocation?s.encodeLocation(b.pathnameBase).pathname:b.pathnameBase])})),i,n,r);return e&&A?k.createElement(sd.Provider,{value:{location:Ya({pathname:"/",search:"",hash:"",state:null,key:"default"},f),navigationType:gs.Pop}},A):A}function kA(){let t=MA(),e=IA(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return k.createElement(k.Fragment,null,k.createElement("h2",null,"Unexpected Application Error!"),k.createElement("h3",{style:{fontStyle:"italic"}},e),n?k.createElement("pre",{style:s},n):null,null)}const RA=k.createElement(kA,null);class PA extends k.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?k.createElement(Qr.Provider,{value:this.props.routeContext},k.createElement(z0.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function jA(t){let{routeContext:e,match:n,children:r}=t,s=k.useContext(rd);return s&&s.static&&s.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=n.route.id),k.createElement(Qr.Provider,{value:e},r)}function DA(t,e,n,r){var s;if(e===void 0&&(e=[]),n===void 0&&(n=null),r===void 0&&(r=null),t==null){var i;if(!n)return null;if(n.errors)t=n.matches;else if((i=r)!=null&&i.v7_partialHydration&&e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let o=t,l=(s=n)==null?void 0:s.errors;if(l!=null){let f=o.findIndex(p=>p.route.id&&(l==null?void 0:l[p.route.id])!==void 0);f>=0||tt(!1),o=o.slice(0,Math.min(o.length,f+1))}let c=!1,d=-1;if(n&&r&&r.v7_partialHydration)for(let f=0;f<o.length;f++){let p=o[f];if((p.route.HydrateFallback||p.route.hydrateFallbackElement)&&(d=f),p.route.id){let{loaderData:m,errors:y}=n,w=p.route.loader&&m[p.route.id]===void 0&&(!y||y[p.route.id]===void 0);if(p.route.lazy||w){c=!0,d>=0?o=o.slice(0,d+1):o=[o[0]];break}}}return o.reduceRight((f,p,m)=>{let y,w=!1,A=null,b=null;n&&(y=l&&p.route.id?l[p.route.id]:void 0,A=p.route.errorElement||RA,c&&(d<0&&m===0?(FA("route-fallback"),w=!0,b=null):d===m&&(w=!0,b=p.route.hydrateFallbackElement||null)));let E=e.concat(o.slice(0,m+1)),v=()=>{let x;return y?x=A:w?x=b:p.route.Component?x=k.createElement(p.route.Component,null):p.route.element?x=p.route.element:x=f,k.createElement(jA,{match:p,routeContext:{outlet:f,matches:E,isDataRoute:n!=null},children:x})};return n&&(p.route.ErrorBoundary||p.route.errorElement||m===0)?k.createElement(PA,{location:n.location,revalidation:n.revalidation,component:A,error:y,children:v(),routeContext:{outlet:null,matches:E,isDataRoute:!0}}):v()},null)}var W0=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(W0||{}),H0=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(H0||{});function OA(t){let e=k.useContext(rd);return e||tt(!1),e}function VA(t){let e=k.useContext(B0);return e||tt(!1),e}function LA(t){let e=k.useContext(Qr);return e||tt(!1),e}function G0(t){let e=LA(),n=e.matches[e.matches.length-1];return n.route.id||tt(!1),n.route.id}function MA(){var t;let e=k.useContext(z0),n=VA(),r=G0();return e!==void 0?e:(t=n.errors)==null?void 0:t[r]}function UA(){let{router:t}=OA(W0.UseNavigateStable),e=G0(H0.UseNavigateStable),n=k.useRef(!1);return q0(()=>{n.current=!0}),k.useCallback(function(s,i){i===void 0&&(i={}),n.current&&(typeof s=="number"?t.navigate(s):t.navigate(s,Ya({fromRouteId:e},i)))},[t,e])}const bv={};function FA(t,e,n){bv[t]||(bv[t]=!0)}function $A(t,e){t==null||t.v7_startTransition,t==null||t.v7_relativeSplatPath}function pr(t){let{to:e,replace:n,state:r,relative:s}=t;Do()||tt(!1);let{future:i,static:o}=k.useContext(Kr),{matches:l}=k.useContext(Qr),{pathname:c}=Ln(),d=Yr(),f=pm(e,fm(l,i.v7_relativeSplatPath),c,s==="path"),p=JSON.stringify(f);return k.useEffect(()=>d(JSON.parse(p),{replace:n,state:r,relative:s}),[d,p,s,n,r]),null}function Pe(t){tt(!1)}function BA(t){let{basename:e="/",children:n=null,location:r,navigationType:s=gs.Pop,navigator:i,static:o=!1,future:l}=t;Do()&&tt(!1);let c=e.replace(/^\/*/,"/"),d=k.useMemo(()=>({basename:c,navigator:i,static:o,future:Ya({v7_relativeSplatPath:!1},l)}),[c,l,i,o]);typeof r=="string"&&(r=jo(r));let{pathname:f="/",search:p="",hash:m="",state:y=null,key:w="default"}=r,A=k.useMemo(()=>{let b=xo(f,c);return b==null?null:{location:{pathname:b,search:p,hash:m,state:y,key:w},navigationType:s}},[c,f,p,m,y,w,s]);return A==null?null:k.createElement(Kr.Provider,{value:d},k.createElement(sd.Provider,{children:n,value:A}))}function zA(t){let{children:e,location:n}=t;return AA(Ff(e),n)}new Promise(()=>{});function Ff(t,e){e===void 0&&(e=[]);let n=[];return k.Children.forEach(t,(r,s)=>{if(!k.isValidElement(r))return;let i=[...e,s];if(r.type===k.Fragment){n.push.apply(n,Ff(r.props.children,i));return}r.type!==Pe&&tt(!1),!r.props.index||!r.props.children||tt(!1);let o={id:r.props.id||i.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(o.children=Ff(r.props.children,i)),n.push(o)}),n}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function gc(){return gc=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},gc.apply(this,arguments)}function K0(t,e){if(t==null)return{};var n={},r=Object.keys(t),s,i;for(i=0;i<r.length;i++)s=r[i],!(e.indexOf(s)>=0)&&(n[s]=t[s]);return n}function qA(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function WA(t,e){return t.button===0&&(!e||e==="_self")&&!qA(t)}function $f(t){return t===void 0&&(t=""),new URLSearchParams(typeof t=="string"||Array.isArray(t)||t instanceof URLSearchParams?t:Object.keys(t).reduce((e,n)=>{let r=t[n];return e.concat(Array.isArray(r)?r.map(s=>[n,s]):[[n,r]])},[]))}function HA(t,e){let n=$f(t);return e&&e.forEach((r,s)=>{n.has(s)||e.getAll(s).forEach(i=>{n.append(s,i)})}),n}const GA=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],KA=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],QA="6";try{window.__reactRouterVersion=QA}catch{}const YA=k.createContext({isTransitioning:!1}),JA="startTransition",Av=zS[JA];function XA(t){let{basename:e,children:n,future:r,window:s}=t,i=k.useRef();i.current==null&&(i.current=tA({window:s,v5Compat:!0}));let o=i.current,[l,c]=k.useState({action:o.action,location:o.location}),{v7_startTransition:d}=r||{},f=k.useCallback(p=>{d&&Av?Av(()=>c(p)):c(p)},[c,d]);return k.useLayoutEffect(()=>o.listen(f),[o,f]),k.useEffect(()=>$A(r),[r]),k.createElement(BA,{basename:e,children:n,location:l.location,navigationType:l.action,navigator:o,future:r})}const ZA=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",e1=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,_e=k.forwardRef(function(e,n){let{onClick:r,relative:s,reloadDocument:i,replace:o,state:l,target:c,to:d,preventScrollReset:f,viewTransition:p}=e,m=K0(e,GA),{basename:y}=k.useContext(Kr),w,A=!1;if(typeof d=="string"&&e1.test(d)&&(w=d,ZA))try{let x=new URL(window.location.href),R=d.startsWith("//")?new URL(x.protocol+d):new URL(d),O=xo(R.pathname,y);R.origin===x.origin&&O!=null?d=O+R.search+R.hash:A=!0}catch{}let b=NA(d,{relative:s}),E=n1(d,{replace:o,state:l,target:c,preventScrollReset:f,relative:s,viewTransition:p});function v(x){r&&r(x),x.defaultPrevented||E(x)}return k.createElement("a",gc({},m,{href:w||b,onClick:A||i?r:v,ref:n,target:c}))}),mu=k.forwardRef(function(e,n){let{"aria-current":r="page",caseSensitive:s=!1,className:i="",end:o=!1,style:l,to:c,viewTransition:d,children:f}=e,p=K0(e,KA),m=id(c,{relative:p.relative}),y=Ln(),w=k.useContext(B0),{navigator:A,basename:b}=k.useContext(Kr),E=w!=null&&s1(m)&&d===!0,v=A.encodeLocation?A.encodeLocation(m).pathname:m.pathname,x=y.pathname,R=w&&w.navigation&&w.navigation.location?w.navigation.location.pathname:null;s||(x=x.toLowerCase(),R=R?R.toLowerCase():null,v=v.toLowerCase()),R&&b&&(R=xo(R,b)||R);const O=v!=="/"&&v.endsWith("/")?v.length-1:v.length;let L=x===v||!o&&x.startsWith(v)&&x.charAt(O)==="/",S=R!=null&&(R===v||!o&&R.startsWith(v)&&R.charAt(v.length)==="/"),_={isActive:L,isPending:S,isTransitioning:E},I=L?r:void 0,N;typeof i=="function"?N=i(_):N=[i,L?"active":null,S?"pending":null,E?"transitioning":null].filter(Boolean).join(" ");let P=typeof l=="function"?l(_):l;return k.createElement(_e,gc({},p,{"aria-current":I,className:N,ref:n,style:P,to:c,viewTransition:d}),typeof f=="function"?f(_):f)});var Bf;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(Bf||(Bf={}));var Cv;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(Cv||(Cv={}));function t1(t){let e=k.useContext(rd);return e||tt(!1),e}function n1(t,e){let{target:n,replace:r,state:s,preventScrollReset:i,relative:o,viewTransition:l}=e===void 0?{}:e,c=Yr(),d=Ln(),f=id(t,{relative:o});return k.useCallback(p=>{if(WA(p,n)){p.preventDefault();let m=r!==void 0?r:mc(d)===mc(f);c(t,{replace:m,state:s,preventScrollReset:i,relative:o,viewTransition:l})}},[d,c,f,r,s,n,t,i,o,l])}function r1(t){let e=k.useRef($f(t)),n=k.useRef(!1),r=Ln(),s=k.useMemo(()=>HA(r.search,n.current?null:e.current),[r.search]),i=Yr(),o=k.useCallback((l,c)=>{const d=$f(typeof l=="function"?l(s):l);n.current=!0,i("?"+d,c)},[i,s]);return[s,o]}function s1(t,e){e===void 0&&(e={});let n=k.useContext(YA);n==null&&tt(!1);let{basename:r}=t1(Bf.useViewTransitionState),s=id(t,{relative:e.relative});if(!n.isTransitioning)return!1;let i=xo(n.currentLocation.pathname,r)||n.currentLocation.pathname,o=xo(n.nextLocation.pathname,r)||n.nextLocation.pathname;return Uf(s.pathname,o)!=null||Uf(s.pathname,i)!=null}const i1=()=>{};var kv={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Q0=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},o1=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[n++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[n++],o=t[n++],l=t[n++],c=((s&7)<<18|(i&63)<<12|(o&63)<<6|l&63)-65536;e[r++]=String.fromCharCode(55296+(c>>10)),e[r++]=String.fromCharCode(56320+(c&1023))}else{const i=t[n++],o=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},Y0={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const i=t[s],o=s+1<t.length,l=o?t[s+1]:0,c=s+2<t.length,d=c?t[s+2]:0,f=i>>2,p=(i&3)<<4|l>>4;let m=(l&15)<<2|d>>6,y=d&63;c||(y=64,o||(m=64)),r.push(n[f],n[p],n[m],n[y])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(Q0(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):o1(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const i=n[t.charAt(s++)],l=s<t.length?n[t.charAt(s)]:0;++s;const d=s<t.length?n[t.charAt(s)]:64;++s;const p=s<t.length?n[t.charAt(s)]:64;if(++s,i==null||l==null||d==null||p==null)throw new a1;const m=i<<2|l>>4;if(r.push(m),d!==64){const y=l<<4&240|d>>2;if(r.push(y),p!==64){const w=d<<6&192|p;r.push(w)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class a1 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const l1=function(t){const e=Q0(t);return Y0.encodeByteArray(e,!0)},yc=function(t){return l1(t).replace(/\./g,"")},J0=function(t){try{return Y0.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function u1(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const c1=()=>u1().__FIREBASE_DEFAULTS__,d1=()=>{if(typeof process>"u"||typeof kv>"u")return;const t=kv.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},h1=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&J0(t[1]);return e&&JSON.parse(e)},od=()=>{try{return i1()||c1()||d1()||h1()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},X0=t=>{var e,n;return(n=(e=od())==null?void 0:e.emulatorHosts)==null?void 0:n[t]},Z0=t=>{const e=X0(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},eE=()=>{var t;return(t=od())==null?void 0:t.config},tE=t=>{var e;return(e=od())==null?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f1{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ii(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function mm(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function p1(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",s=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}},...t};return[yc(JSON.stringify(n)),yc(JSON.stringify(o)),""].join(".")}const Sa={};function m1(){const t={prod:[],emulator:[]};for(const e of Object.keys(Sa))Sa[e]?t.emulator.push(e):t.prod.push(e);return t}function g1(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let Rv=!1;function gm(t,e){if(typeof window>"u"||typeof document>"u"||!Ii(window.location.host)||Sa[t]===e||Sa[t]||Rv)return;Sa[t]=e;function n(m){return`__firebase__banner__${m}`}const r="__firebase__banner",i=m1().prod.length>0;function o(){const m=document.getElementById(r);m&&m.remove()}function l(m){m.style.display="flex",m.style.background="#7faaf0",m.style.position="fixed",m.style.bottom="5px",m.style.left="5px",m.style.padding=".5em",m.style.borderRadius="5px",m.style.alignItems="center"}function c(m,y){m.setAttribute("width","24"),m.setAttribute("id",y),m.setAttribute("height","24"),m.setAttribute("viewBox","0 0 24 24"),m.setAttribute("fill","none"),m.style.marginLeft="-6px"}function d(){const m=document.createElement("span");return m.style.cursor="pointer",m.style.marginLeft="16px",m.style.fontSize="24px",m.innerHTML=" &times;",m.onclick=()=>{Rv=!0,o()},m}function f(m,y){m.setAttribute("id",y),m.innerText="Learn more",m.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",m.setAttribute("target","__blank"),m.style.paddingLeft="5px",m.style.textDecoration="underline"}function p(){const m=g1(r),y=n("text"),w=document.getElementById(y)||document.createElement("span"),A=n("learnmore"),b=document.getElementById(A)||document.createElement("a"),E=n("preprendIcon"),v=document.getElementById(E)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(m.created){const x=m.element;l(x),f(b,A);const R=d();c(v,E),x.append(v,w,b,R),document.body.appendChild(x)}i?(w.innerText="Preview backend disconnected.",v.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(v.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,w.innerText="Preview backend running in this workspace."),w.setAttribute("id",y)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",p):p()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kt(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function y1(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Kt())}function v1(){var e;const t=(e=od())==null?void 0:e.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function _1(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function w1(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function x1(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function E1(){const t=Kt();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function T1(){return!v1()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function nE(){try{return typeof indexedDB=="object"}catch{return!1}}function rE(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var i;e(((i=s.error)==null?void 0:i.message)||"")}}catch(n){e(n)}})}function I1(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const S1="FirebaseError";class nr extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=S1,Object.setPrototypeOf(this,nr.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Si.prototype.create)}}class Si{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?N1(i,r):"Error",l=`${this.serviceName}: ${o} (${s}).`;return new nr(s,l,r)}}function N1(t,e){return t.replace(b1,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const b1=/\{\$([^}]+)}/g;function A1(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function fi(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const s of n){if(!r.includes(s))return!1;const i=t[s],o=e[s];if(Pv(i)&&Pv(o)){if(!fi(i,o))return!1}else if(i!==o)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function Pv(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ml(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function da(t){const e={};return t.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[s,i]=r.split("=");e[decodeURIComponent(s)]=decodeURIComponent(i)}}),e}function ha(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}function C1(t,e){const n=new k1(t,e);return n.subscribe.bind(n)}class k1{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let s;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");R1(e,["next","error","complete"])?s=e:s={next:e,error:n,complete:r},s.next===void 0&&(s.next=Ih),s.error===void 0&&(s.error=Ih),s.complete===void 0&&(s.complete=Ih);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function R1(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function Ih(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function De(t){return t&&t._delegate?t._delegate:t}class Dn{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zs="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P1{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new f1;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),r=(e==null?void 0:e.optional)??!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(s){if(r)return null;throw s}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(D1(e))try{this.getOrInitializeService({instanceIdentifier:Zs})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=Zs){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Zs){return this.instances.has(e)}getOptions(e=Zs){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[i,o]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(i);r===l&&o.resolve(s)}return s}onInit(e,n){const r=this.normalizeInstanceIdentifier(n),s=this.onInitCallbacks.get(r)??new Set;s.add(e),this.onInitCallbacks.set(r,s);const i=this.instances.get(r);return i&&e(i,r),()=>{s.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const s of r)try{s(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:j1(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Zs){return this.component?this.component.multipleInstances?e:Zs:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function j1(t){return t===Zs?void 0:t}function D1(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O1{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new P1(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var xe;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(xe||(xe={}));const V1={debug:xe.DEBUG,verbose:xe.VERBOSE,info:xe.INFO,warn:xe.WARN,error:xe.ERROR,silent:xe.SILENT},L1=xe.INFO,M1={[xe.DEBUG]:"log",[xe.VERBOSE]:"log",[xe.INFO]:"info",[xe.WARN]:"warn",[xe.ERROR]:"error"},U1=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),s=M1[e];if(s)console[s](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class ym{constructor(e){this.name=e,this._logLevel=L1,this._logHandler=U1,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in xe))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?V1[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,xe.DEBUG,...e),this._logHandler(this,xe.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,xe.VERBOSE,...e),this._logHandler(this,xe.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,xe.INFO,...e),this._logHandler(this,xe.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,xe.WARN,...e),this._logHandler(this,xe.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,xe.ERROR,...e),this._logHandler(this,xe.ERROR,...e)}}const F1=(t,e)=>e.some(n=>t instanceof n);let jv,Dv;function $1(){return jv||(jv=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function B1(){return Dv||(Dv=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const sE=new WeakMap,zf=new WeakMap,iE=new WeakMap,Sh=new WeakMap,vm=new WeakMap;function z1(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{n(Vr(t.result)),s()},o=()=>{r(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&sE.set(n,t)}).catch(()=>{}),vm.set(e,t),e}function q1(t){if(zf.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{n(),s()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)});zf.set(t,e)}let qf={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return zf.get(t);if(e==="objectStoreNames")return t.objectStoreNames||iE.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Vr(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function W1(t){qf=t(qf)}function H1(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(Nh(this),e,...n);return iE.set(r,e.sort?e.sort():[e]),Vr(r)}:B1().includes(t)?function(...e){return t.apply(Nh(this),e),Vr(sE.get(this))}:function(...e){return Vr(t.apply(Nh(this),e))}}function G1(t){return typeof t=="function"?H1(t):(t instanceof IDBTransaction&&q1(t),F1(t,$1())?new Proxy(t,qf):t)}function Vr(t){if(t instanceof IDBRequest)return z1(t);if(Sh.has(t))return Sh.get(t);const e=G1(t);return e!==t&&(Sh.set(t,e),vm.set(e,t)),e}const Nh=t=>vm.get(t);function ad(t,e,{blocked:n,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(t,e),l=Vr(o);return r&&o.addEventListener("upgradeneeded",c=>{r(Vr(o.result),c.oldVersion,c.newVersion,Vr(o.transaction),c)}),n&&o.addEventListener("blocked",c=>n(c.oldVersion,c.newVersion,c)),l.then(c=>{i&&c.addEventListener("close",()=>i()),s&&c.addEventListener("versionchange",d=>s(d.oldVersion,d.newVersion,d))}).catch(()=>{}),l}function bh(t,{blocked:e}={}){const n=indexedDB.deleteDatabase(t);return e&&n.addEventListener("blocked",r=>e(r.oldVersion,r)),Vr(n).then(()=>{})}const K1=["get","getKey","getAll","getAllKeys","count"],Q1=["put","add","delete","clear"],Ah=new Map;function Ov(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Ah.get(e))return Ah.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=Q1.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||K1.includes(n)))return;const i=async function(o,...l){const c=this.transaction(o,s?"readwrite":"readonly");let d=c.store;return r&&(d=d.index(l.shift())),(await Promise.all([d[n](...l),s&&c.done]))[0]};return Ah.set(e,i),i}W1(t=>({...t,get:(e,n,r)=>Ov(e,n)||t.get(e,n,r),has:(e,n)=>!!Ov(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y1{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(J1(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function J1(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Wf="@firebase/app",Vv="0.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zr=new ym("@firebase/app"),X1="@firebase/app-compat",Z1="@firebase/analytics-compat",eC="@firebase/analytics",tC="@firebase/app-check-compat",nC="@firebase/app-check",rC="@firebase/auth",sC="@firebase/auth-compat",iC="@firebase/database",oC="@firebase/data-connect",aC="@firebase/database-compat",lC="@firebase/functions",uC="@firebase/functions-compat",cC="@firebase/installations",dC="@firebase/installations-compat",hC="@firebase/messaging",fC="@firebase/messaging-compat",pC="@firebase/performance",mC="@firebase/performance-compat",gC="@firebase/remote-config",yC="@firebase/remote-config-compat",vC="@firebase/storage",_C="@firebase/storage-compat",wC="@firebase/firestore",xC="@firebase/ai",EC="@firebase/firestore-compat",TC="firebase",IC="12.1.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hf="[DEFAULT]",SC={[Wf]:"fire-core",[X1]:"fire-core-compat",[eC]:"fire-analytics",[Z1]:"fire-analytics-compat",[nC]:"fire-app-check",[tC]:"fire-app-check-compat",[rC]:"fire-auth",[sC]:"fire-auth-compat",[iC]:"fire-rtdb",[oC]:"fire-data-connect",[aC]:"fire-rtdb-compat",[lC]:"fire-fn",[uC]:"fire-fn-compat",[cC]:"fire-iid",[dC]:"fire-iid-compat",[hC]:"fire-fcm",[fC]:"fire-fcm-compat",[pC]:"fire-perf",[mC]:"fire-perf-compat",[gC]:"fire-rc",[yC]:"fire-rc-compat",[vC]:"fire-gcs",[_C]:"fire-gcs-compat",[wC]:"fire-fst",[EC]:"fire-fst-compat",[xC]:"fire-vertex","fire-js":"fire-js",[TC]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ja=new Map,NC=new Map,Gf=new Map;function Lv(t,e){try{t.container.addComponent(e)}catch(n){zr.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function er(t){const e=t.name;if(Gf.has(e))return zr.debug(`There were multiple attempts to register component ${e}.`),!1;Gf.set(e,t);for(const n of Ja.values())Lv(n,t);for(const n of NC.values())Lv(n,t);return!0}function Ni(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function an(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bC={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},bs=new Si("app","Firebase",bC);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AC{constructor(e,n,r){this._isDeleted=!1,this._options={...e},this._config={...n},this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Dn("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw bs.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Oo=IC;function oE(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r={name:Hf,automaticDataCollectionEnabled:!0,...e},s=r.name;if(typeof s!="string"||!s)throw bs.create("bad-app-name",{appName:String(s)});if(n||(n=eE()),!n)throw bs.create("no-options");const i=Ja.get(s);if(i){if(fi(n,i.options)&&fi(r,i.config))return i;throw bs.create("duplicate-app",{appName:s})}const o=new O1(s);for(const c of Gf.values())o.addComponent(c);const l=new AC(n,r,o);return Ja.set(s,l),l}function gl(t=Hf){const e=Ja.get(t);if(!e&&t===Hf&&eE())return oE();if(!e)throw bs.create("no-app",{appName:t});return e}function CC(){return Array.from(Ja.values())}function pn(t,e,n){let r=SC[t]??t;n&&(r+=`-${n}`);const s=r.match(/\s|\//),i=e.match(/\s|\//);if(s||i){const o=[`Unable to register library "${r}" with version "${e}":`];s&&o.push(`library name "${r}" contains illegal characters (whitespace or "/")`),s&&i&&o.push("and"),i&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),zr.warn(o.join(" "));return}er(new Dn(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kC="firebase-heartbeat-database",RC=1,Xa="firebase-heartbeat-store";let Ch=null;function aE(){return Ch||(Ch=ad(kC,RC,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Xa)}catch(n){console.warn(n)}}}}).catch(t=>{throw bs.create("idb-open",{originalErrorMessage:t.message})})),Ch}async function PC(t){try{const n=(await aE()).transaction(Xa),r=await n.objectStore(Xa).get(lE(t));return await n.done,r}catch(e){if(e instanceof nr)zr.warn(e.message);else{const n=bs.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});zr.warn(n.message)}}}async function Mv(t,e){try{const r=(await aE()).transaction(Xa,"readwrite");await r.objectStore(Xa).put(e,lE(t)),await r.done}catch(n){if(n instanceof nr)zr.warn(n.message);else{const r=bs.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});zr.warn(r.message)}}}function lE(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jC=1024,DC=30;class OC{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new LC(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=Uv();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)==null?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats.length>DC){const o=MC(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){zr.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=Uv(),{heartbeatsToSend:r,unsentEntries:s}=VC(this._heartbeatsCache.heartbeats),i=yc(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(n){return zr.warn(n),""}}}function Uv(){return new Date().toISOString().substring(0,10)}function VC(t,e=jC){const n=[];let r=t.slice();for(const s of t){const i=n.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),Fv(n)>e){i.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),Fv(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class LC{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return nE()?rE().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await PC(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return Mv(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return Mv(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function Fv(t){return yc(JSON.stringify({version:2,heartbeats:t})).length}function MC(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let r=1;r<t.length;r++)t[r].date<n&&(n=t[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UC(t){er(new Dn("platform-logger",e=>new Y1(e),"PRIVATE")),er(new Dn("heartbeat",e=>new OC(e),"PRIVATE")),pn(Wf,Vv,t),pn(Wf,Vv,"esm2020"),pn("fire-js","")}UC("");function uE(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const FC=uE,cE=new Si("auth","Firebase",uE());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vc=new ym("@firebase/auth");function $C(t,...e){vc.logLevel<=xe.WARN&&vc.warn(`Auth (${Oo}): ${t}`,...e)}function Ou(t,...e){vc.logLevel<=xe.ERROR&&vc.error(`Auth (${Oo}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function En(t,...e){throw wm(t,...e)}function Yn(t,...e){return wm(t,...e)}function _m(t,e,n){const r={...FC(),[e]:n};return new Si("auth","Firebase",r).create(e,{appName:t.name})}function Lr(t){return _m(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function BC(t,e,n){const r=n;if(!(e instanceof r))throw r.name!==e.constructor.name&&En(t,"argument-error"),_m(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function wm(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return cE.create(t,...e)}function ne(t,e,...n){if(!t)throw wm(e,...n)}function Pr(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Ou(e),new Error(e)}function qr(t,e){t||Pr(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kf(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.href)||""}function zC(){return $v()==="http:"||$v()==="https:"}function $v(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qC(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(zC()||w1()||"connection"in navigator)?navigator.onLine:!0}function WC(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yl{constructor(e,n){this.shortDelay=e,this.longDelay=n,qr(n>e,"Short delay should be less than long delay!"),this.isMobile=y1()||x1()}get(){return qC()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xm(t,e){qr(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dE{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Pr("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Pr("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Pr("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HC={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GC=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],KC=new yl(3e4,6e4);function xr(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function rr(t,e,n,r,s={}){return hE(t,s,async()=>{let i={},o={};r&&(e==="GET"?o=r:i={body:JSON.stringify(r)});const l=ml({key:t.config.apiKey,...o}).slice(1),c=await t._getAdditionalHeaders();c["Content-Type"]="application/json",t.languageCode&&(c["X-Firebase-Locale"]=t.languageCode);const d={method:e,headers:c,...i};return _1()||(d.referrerPolicy="no-referrer"),t.emulatorConfig&&Ii(t.emulatorConfig.host)&&(d.credentials="include"),dE.fetch()(await fE(t,t.config.apiHost,n,l),d)})}async function hE(t,e,n){t._canInitEmulator=!1;const r={...HC,...e};try{const s=new YC(t),i=await Promise.race([n(),s.promise]);s.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw gu(t,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const l=i.ok?o.errorMessage:o.error.message,[c,d]=l.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw gu(t,"credential-already-in-use",o);if(c==="EMAIL_EXISTS")throw gu(t,"email-already-in-use",o);if(c==="USER_DISABLED")throw gu(t,"user-disabled",o);const f=r[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw _m(t,f,d);En(t,f)}}catch(s){if(s instanceof nr)throw s;En(t,"network-request-failed",{message:String(s)})}}async function vl(t,e,n,r,s={}){const i=await rr(t,e,n,r,s);return"mfaPendingCredential"in i&&En(t,"multi-factor-auth-required",{_serverResponse:i}),i}async function fE(t,e,n,r){const s=`${e}${n}?${r}`,i=t,o=i.config.emulator?xm(t.config,s):`${t.config.apiScheme}://${s}`;return GC.includes(n)&&(await i._persistenceManagerAvailable,i._getPersistenceType()==="COOKIE")?i._getPersistence()._getFinalTarget(o).toString():o}function QC(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class YC{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(Yn(this.auth,"network-request-failed")),KC.get())})}}function gu(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const s=Yn(t,e,r);return s.customData._tokenResponse=n,s}function Bv(t){return t!==void 0&&t.enterprise!==void 0}class JC{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return QC(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function XC(t,e){return rr(t,"GET","/v2/recaptchaConfig",xr(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ZC(t,e){return rr(t,"POST","/v1/accounts:delete",e)}async function _c(t,e){return rr(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Na(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function ek(t,e=!1){const n=De(t),r=await n.getIdToken(e),s=Em(r);ne(s&&s.exp&&s.auth_time&&s.iat,n.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,o=i==null?void 0:i.sign_in_provider;return{claims:s,token:r,authTime:Na(kh(s.auth_time)),issuedAtTime:Na(kh(s.iat)),expirationTime:Na(kh(s.exp)),signInProvider:o||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function kh(t){return Number(t)*1e3}function Em(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return Ou("JWT malformed, contained fewer than 3 sections"),null;try{const s=J0(n);return s?JSON.parse(s):(Ou("Failed to decode base64 JWT payload"),null)}catch(s){return Ou("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function zv(t){const e=Em(t);return ne(e,"internal-error"),ne(typeof e.exp<"u","internal-error"),ne(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Eo(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof nr&&tk(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function tk({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nk{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qf{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=Na(this.lastLoginAt),this.creationTime=Na(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function wc(t){var p;const e=t.auth,n=await t.getIdToken(),r=await Eo(t,_c(e,{idToken:n}));ne(r==null?void 0:r.users.length,e,"internal-error");const s=r.users[0];t._notifyReloadListener(s);const i=(p=s.providerUserInfo)!=null&&p.length?pE(s.providerUserInfo):[],o=sk(t.providerData,i),l=t.isAnonymous,c=!(t.email&&s.passwordHash)&&!(o!=null&&o.length),d=l?c:!1,f={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new Qf(s.createdAt,s.lastLoginAt),isAnonymous:d};Object.assign(t,f)}async function rk(t){const e=De(t);await wc(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function sk(t,e){return[...t.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function pE(t){return t.map(({providerId:e,...n})=>({providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ik(t,e){const n=await hE(t,{},async()=>{const r=ml({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=t.config,o=await fE(t,s,"/v1/token",`key=${i}`),l=await t._getAdditionalHeaders();l["Content-Type"]="application/x-www-form-urlencoded";const c={method:"POST",headers:l,body:r};return t.emulatorConfig&&Ii(t.emulatorConfig.host)&&(c.credentials="include"),dE.fetch()(o,c)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function ok(t,e){return rr(t,"POST","/v2/accounts:revokeToken",xr(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uo{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){ne(e.idToken,"internal-error"),ne(typeof e.idToken<"u","internal-error"),ne(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):zv(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){ne(e.length!==0,"internal-error");const n=zv(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(ne(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:s,expiresIn:i}=await ik(e,n);this.updateTokensAndExpiration(r,s,Number(i))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:s,expirationTime:i}=n,o=new uo;return r&&(ne(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),s&&(ne(typeof s=="string","internal-error",{appName:e}),o.accessToken=s),i&&(ne(typeof i=="number","internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new uo,this.toJSON())}_performRefresh(){return Pr("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rs(t,e){ne(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Gn{constructor({uid:e,auth:n,stsTokenManager:r,...s}){this.providerId="firebase",this.proactiveRefresh=new nk(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new Qf(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const n=await Eo(this,this.stsTokenManager.getToken(this.auth,e));return ne(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return ek(this,e)}reload(){return rk(this)}_assign(e){this!==e&&(ne(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>({...n})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new Gn({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return n.metadata._copy(this.metadata),n}_onReload(e){ne(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await wc(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(an(this.auth.app))return Promise.reject(Lr(this.auth));const e=await this.getIdToken();return await Eo(this,ZC(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){const r=n.displayName??void 0,s=n.email??void 0,i=n.phoneNumber??void 0,o=n.photoURL??void 0,l=n.tenantId??void 0,c=n._redirectEventId??void 0,d=n.createdAt??void 0,f=n.lastLoginAt??void 0,{uid:p,emailVerified:m,isAnonymous:y,providerData:w,stsTokenManager:A}=n;ne(p&&A,e,"internal-error");const b=uo.fromJSON(this.name,A);ne(typeof p=="string",e,"internal-error"),rs(r,e.name),rs(s,e.name),ne(typeof m=="boolean",e,"internal-error"),ne(typeof y=="boolean",e,"internal-error"),rs(i,e.name),rs(o,e.name),rs(l,e.name),rs(c,e.name),rs(d,e.name),rs(f,e.name);const E=new Gn({uid:p,auth:e,email:s,emailVerified:m,displayName:r,isAnonymous:y,photoURL:o,phoneNumber:i,tenantId:l,stsTokenManager:b,createdAt:d,lastLoginAt:f});return w&&Array.isArray(w)&&(E.providerData=w.map(v=>({...v}))),c&&(E._redirectEventId=c),E}static async _fromIdTokenResponse(e,n,r=!1){const s=new uo;s.updateFromServerResponse(n);const i=new Gn({uid:n.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await wc(i),i}static async _fromGetAccountInfoResponse(e,n,r){const s=n.users[0];ne(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?pE(s.providerUserInfo):[],o=!(s.email&&s.passwordHash)&&!(i!=null&&i.length),l=new uo;l.updateFromIdToken(r);const c=new Gn({uid:s.localId,auth:e,stsTokenManager:l,isAnonymous:o}),d={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new Qf(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(i!=null&&i.length)};return Object.assign(c,d),c}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qv=new Map;function jr(t){qr(t instanceof Function,"Expected a class definition");let e=qv.get(t);return e?(qr(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,qv.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mE{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}mE.type="NONE";const Wv=mE;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vu(t,e,n){return`firebase:${t}:${e}:${n}`}class co{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:s,name:i}=this.auth;this.fullUserKey=Vu(this.userKey,s.apiKey,i),this.fullPersistenceKey=Vu("persistence",s.apiKey,i),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const n=await _c(this.auth,{idToken:e}).catch(()=>{});return n?Gn._fromGetAccountInfoResponse(this.auth,n,e):null}return Gn._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new co(jr(Wv),e,r);const s=(await Promise.all(n.map(async d=>{if(await d._isAvailable())return d}))).filter(d=>d);let i=s[0]||jr(Wv);const o=Vu(r,e.config.apiKey,e.name);let l=null;for(const d of n)try{const f=await d._get(o);if(f){let p;if(typeof f=="string"){const m=await _c(e,{idToken:f}).catch(()=>{});if(!m)break;p=await Gn._fromGetAccountInfoResponse(e,m,f)}else p=Gn._fromJSON(e,f);d!==i&&(l=p),i=d;break}}catch{}const c=s.filter(d=>d._shouldAllowMigration);return!i._shouldAllowMigration||!c.length?new co(i,e,r):(i=c[0],l&&await i._set(o,l.toJSON()),await Promise.all(n.map(async d=>{if(d!==i)try{await d._remove(o)}catch{}})),new co(i,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hv(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(_E(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(gE(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(xE(e))return"Blackberry";if(EE(e))return"Webos";if(yE(e))return"Safari";if((e.includes("chrome/")||vE(e))&&!e.includes("edge/"))return"Chrome";if(wE(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function gE(t=Kt()){return/firefox\//i.test(t)}function yE(t=Kt()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function vE(t=Kt()){return/crios\//i.test(t)}function _E(t=Kt()){return/iemobile/i.test(t)}function wE(t=Kt()){return/android/i.test(t)}function xE(t=Kt()){return/blackberry/i.test(t)}function EE(t=Kt()){return/webos/i.test(t)}function Tm(t=Kt()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function ak(t=Kt()){var e;return Tm(t)&&!!((e=window.navigator)!=null&&e.standalone)}function lk(){return E1()&&document.documentMode===10}function TE(t=Kt()){return Tm(t)||wE(t)||EE(t)||xE(t)||/windows phone/i.test(t)||_E(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IE(t,e=[]){let n;switch(t){case"Browser":n=Hv(Kt());break;case"Worker":n=`${Hv(Kt())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${Oo}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uk{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=i=>new Promise((o,l)=>{try{const c=e(i);o(c)}catch(c){l(c)}});r.onAbort=n,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const s of n)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ck(t,e={}){return rr(t,"GET","/v2/passwordPolicy",xr(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dk=6;class hk{constructor(e){var r;const n=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=n.minPasswordLength??dk,n.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=n.maxPasswordLength),n.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=n.containsLowercaseCharacter),n.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=n.containsUppercaseCharacter),n.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=n.containsNumericCharacter),n.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=n.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((r=e.allowedNonAlphanumericCharacters)==null?void 0:r.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const n={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,n),this.validatePasswordCharacterOptions(e,n),n.isValid&&(n.isValid=n.meetsMinPasswordLength??!0),n.isValid&&(n.isValid=n.meetsMaxPasswordLength??!0),n.isValid&&(n.isValid=n.containsLowercaseLetter??!0),n.isValid&&(n.isValid=n.containsUppercaseLetter??!0),n.isValid&&(n.isValid=n.containsNumericCharacter??!0),n.isValid&&(n.isValid=n.containsNonAlphanumericCharacter??!0),n}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),s&&(n.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fk{constructor(e,n,r,s){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Gv(this),this.idTokenSubscription=new Gv(this),this.beforeStateQueue=new uk(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=cE,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(i=>this._resolvePersistenceManagerAvailable=i)}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=jr(n)),this._initializationPromise=this.queue(async()=>{var r,s,i;if(!this._deleted&&(this.persistenceManager=await co.create(this,e),(r=this._resolvePersistenceManagerAvailable)==null||r.call(this),!this._deleted)){if((s=this._popupRedirectResolver)!=null&&s._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((i=this.currentUser)==null?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await _c(this,{idToken:e}),r=await Gn._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var i;if(an(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(l=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(l,l))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let r=n,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(i=this.redirectUser)==null?void 0:i._redirectEventId,l=r==null?void 0:r._redirectEventId,c=await this.tryRedirectSignIn(e);(!o||o===l)&&(c!=null&&c.user)&&(r=c.user,s=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(r)}catch(o){r=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return ne(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await wc(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=WC()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(an(this.app))return Promise.reject(Lr(this));const n=e?De(e):null;return n&&ne(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&ne(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return an(this.app)?Promise.reject(Lr(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return an(this.app)?Promise.reject(Lr(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(jr(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await ck(this),n=new hk(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Si("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await ok(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&jr(e)||this._popupRedirectResolver;ne(n,this,"argument-error"),this.redirectPersistenceManager=await co.create(this,[jr(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)==null?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)==null?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((n=this.currentUser)==null?void 0:n.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,s){if(this._deleted)return()=>{};const i=typeof n=="function"?n:n.next.bind(n);let o=!1;const l=this._isInitialized?Promise.resolve():this._initializationPromise;if(ne(l,this,"internal-error"),l.then(()=>{o||i(this.currentUser)}),typeof n=="function"){const c=e.addObserver(n,r,s);return()=>{o=!0,c()}}else{const c=e.addObserver(n);return()=>{o=!0,c()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return ne(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=IE(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var s;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const n=await((s=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:s.getHeartbeatsHeader());n&&(e["X-Firebase-Client"]=n);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){var n;if(an(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((n=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:n.getToken());return e!=null&&e.error&&$C(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function Er(t){return De(t)}class Gv{constructor(e){this.auth=e,this.observer=null,this.addObserver=C1(n=>this.observer=n)}get next(){return ne(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ld={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function pk(t){ld=t}function SE(t){return ld.loadJS(t)}function mk(){return ld.recaptchaEnterpriseScript}function gk(){return ld.gapiScript}function yk(t){return`__${t}${Math.floor(Math.random()*1e6)}`}class vk{constructor(){this.enterprise=new _k}ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}class _k{ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}const wk="recaptcha-enterprise",NE="NO_RECAPTCHA";class xk{constructor(e){this.type=wk,this.auth=Er(e)}async verify(e="verify",n=!1){async function r(i){if(!n){if(i.tenantId==null&&i._agentRecaptchaConfig!=null)return i._agentRecaptchaConfig.siteKey;if(i.tenantId!=null&&i._tenantRecaptchaConfigs[i.tenantId]!==void 0)return i._tenantRecaptchaConfigs[i.tenantId].siteKey}return new Promise(async(o,l)=>{XC(i,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(c=>{if(c.recaptchaKey===void 0)l(new Error("recaptcha Enterprise site key undefined"));else{const d=new JC(c);return i.tenantId==null?i._agentRecaptchaConfig=d:i._tenantRecaptchaConfigs[i.tenantId]=d,o(d.siteKey)}}).catch(c=>{l(c)})})}function s(i,o,l){const c=window.grecaptcha;Bv(c)?c.enterprise.ready(()=>{c.enterprise.execute(i,{action:e}).then(d=>{o(d)}).catch(()=>{o(NE)})}):l(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new vk().execute("siteKey",{action:"verify"}):new Promise((i,o)=>{r(this.auth).then(l=>{if(!n&&Bv(window.grecaptcha))s(l,i,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let c=mk();c.length!==0&&(c+=l),SE(c).then(()=>{s(l,i,o)}).catch(d=>{o(d)})}}).catch(l=>{o(l)})})}}async function Kv(t,e,n,r=!1,s=!1){const i=new xk(t);let o;if(s)o=NE;else try{o=await i.verify(n)}catch{o=await i.verify(n,!0)}const l={...e};if(n==="mfaSmsEnrollment"||n==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in l){const c=l.phoneEnrollmentInfo.phoneNumber,d=l.phoneEnrollmentInfo.recaptchaToken;Object.assign(l,{phoneEnrollmentInfo:{phoneNumber:c,recaptchaToken:d,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in l){const c=l.phoneSignInInfo.recaptchaToken;Object.assign(l,{phoneSignInInfo:{recaptchaToken:c,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return l}return r?Object.assign(l,{captchaResp:o}):Object.assign(l,{captchaResponse:o}),Object.assign(l,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(l,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),l}async function xc(t,e,n,r,s){var i;if((i=t._getRecaptchaConfig())!=null&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const o=await Kv(t,e,n,n==="getOobCode");return r(t,o)}else return r(t,e).catch(async o=>{if(o.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const l=await Kv(t,e,n,n==="getOobCode");return r(t,l)}else return Promise.reject(o)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ek(t,e){const n=Ni(t,"auth");if(n.isInitialized()){const s=n.getImmediate(),i=n.getOptions();if(fi(i,e??{}))return s;En(s,"already-initialized")}return n.initialize({options:e})}function Tk(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(jr);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function Ik(t,e,n){const r=Er(t);ne(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!1,i=bE(e),{host:o,port:l}=Sk(e),c=l===null?"":`:${l}`,d={url:`${i}//${o}${c}/`},f=Object.freeze({host:o,port:l,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!r._canInitEmulator){ne(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),ne(fi(d,r.config.emulator)&&fi(f,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=d,r.emulatorConfig=f,r.settings.appVerificationDisabledForTesting=!0,Ii(o)?(mm(`${i}//${o}${c}`),gm("Auth",!0)):Nk()}function bE(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function Sk(t){const e=bE(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const i=s[1];return{host:i,port:Qv(r.substr(i.length+1))}}else{const[i,o]=r.split(":");return{host:i,port:Qv(o)}}}function Qv(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function Nk(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Im{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return Pr("not implemented")}_getIdTokenResponse(e){return Pr("not implemented")}_linkToIdToken(e,n){return Pr("not implemented")}_getReauthenticationResolver(e){return Pr("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function AE(t,e){return rr(t,"POST","/v1/accounts:resetPassword",xr(t,e))}async function bk(t,e){return rr(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ak(t,e){return vl(t,"POST","/v1/accounts:signInWithPassword",xr(t,e))}async function Ck(t,e){return rr(t,"POST","/v1/accounts:sendOobCode",xr(t,e))}async function kk(t,e){return Ck(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Rk(t,e){return vl(t,"POST","/v1/accounts:signInWithEmailLink",xr(t,e))}async function Pk(t,e){return vl(t,"POST","/v1/accounts:signInWithEmailLink",xr(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Za extends Im{constructor(e,n,r,s=null){super("password",r),this._email=e,this._password=n,this._tenantId=s}static _fromEmailAndPassword(e,n){return new Za(e,n,"password")}static _fromEmailAndCode(e,n,r=null){return new Za(e,n,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n!=null&&n.email&&(n!=null&&n.password)){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return xc(e,n,"signInWithPassword",Ak);case"emailLink":return Rk(e,{email:this._email,oobCode:this._password});default:En(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const r={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return xc(e,r,"signUpPassword",bk);case"emailLink":return Pk(e,{idToken:n,email:this._email,oobCode:this._password});default:En(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ho(t,e){return vl(t,"POST","/v1/accounts:signInWithIdp",xr(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jk="http://localhost";class pi extends Im{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new pi(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):En("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s,...i}=n;if(!r||!s)return null;const o=new pi(r,s);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return ho(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,ho(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,ho(e,n)}buildRequest(){const e={requestUri:jk,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=ml(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dk(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function Ok(t){const e=da(ha(t)).link,n=e?da(ha(e)).deep_link_id:null,r=da(ha(t)).deep_link_id;return(r?da(ha(r)).link:null)||r||n||e||t}class Sm{constructor(e){const n=da(ha(e)),r=n.apiKey??null,s=n.oobCode??null,i=Dk(n.mode??null);ne(r&&s&&i,"argument-error"),this.apiKey=r,this.operation=i,this.code=s,this.continueUrl=n.continueUrl??null,this.languageCode=n.lang??null,this.tenantId=n.tenantId??null}static parseLink(e){const n=Ok(e);try{return new Sm(n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vo{constructor(){this.providerId=Vo.PROVIDER_ID}static credential(e,n){return Za._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const r=Sm.parseLink(n);return ne(r,"argument-error"),Za._fromEmailAndCode(e,r.code,r.tenantId)}}Vo.PROVIDER_ID="password";Vo.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Vo.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nm{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _l extends Nm{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cs extends _l{constructor(){super("facebook.com")}static credential(e){return pi._fromParams({providerId:cs.PROVIDER_ID,signInMethod:cs.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return cs.credentialFromTaggedObject(e)}static credentialFromError(e){return cs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return cs.credential(e.oauthAccessToken)}catch{return null}}}cs.FACEBOOK_SIGN_IN_METHOD="facebook.com";cs.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class An extends _l{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return pi._fromParams({providerId:An.PROVIDER_ID,signInMethod:An.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return An.credentialFromTaggedObject(e)}static credentialFromError(e){return An.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return An.credential(n,r)}catch{return null}}}An.GOOGLE_SIGN_IN_METHOD="google.com";An.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ds extends _l{constructor(){super("github.com")}static credential(e){return pi._fromParams({providerId:ds.PROVIDER_ID,signInMethod:ds.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ds.credentialFromTaggedObject(e)}static credentialFromError(e){return ds.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ds.credential(e.oauthAccessToken)}catch{return null}}}ds.GITHUB_SIGN_IN_METHOD="github.com";ds.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hs extends _l{constructor(){super("twitter.com")}static credential(e,n){return pi._fromParams({providerId:hs.PROVIDER_ID,signInMethod:hs.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return hs.credentialFromTaggedObject(e)}static credentialFromError(e){return hs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return hs.credential(n,r)}catch{return null}}}hs.TWITTER_SIGN_IN_METHOD="twitter.com";hs.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Vk(t,e){return vl(t,"POST","/v1/accounts:signUp",xr(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mi{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,s=!1){const i=await Gn._fromIdTokenResponse(e,r,s),o=Yv(r);return new mi({user:i,providerId:o,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const s=Yv(r);return new mi({user:e,providerId:s,_tokenResponse:r,operationType:n})}}function Yv(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ec extends nr{constructor(e,n,r,s){super(n.code,n.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,Ec.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,s){return new Ec(e,n,r,s)}}function CE(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?Ec._fromErrorAndOperation(t,i,e,r):i})}async function Lk(t,e,n=!1){const r=await Eo(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return mi._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Mk(t,e,n=!1){const{auth:r}=t;if(an(r.app))return Promise.reject(Lr(r));const s="reauthenticate";try{const i=await Eo(t,CE(r,s,e,t),n);ne(i.idToken,r,"internal-error");const o=Em(i.idToken);ne(o,r,"internal-error");const{sub:l}=o;return ne(t.uid===l,r,"user-mismatch"),mi._forOperation(t,s,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&En(r,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function kE(t,e,n=!1){if(an(t.app))return Promise.reject(Lr(t));const r="signIn",s=await CE(t,r,e),i=await mi._fromIdTokenResponse(t,r,s);return n||await t._updateCurrentUser(i.user),i}async function Uk(t,e){return kE(Er(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bm{constructor(e,n){this.factorId=e,this.uid=n.mfaEnrollmentId,this.enrollmentTime=new Date(n.enrolledAt).toUTCString(),this.displayName=n.displayName}static _fromServerResponse(e,n){return"phoneInfo"in n?Am._fromServerResponse(e,n):"totpInfo"in n?Cm._fromServerResponse(e,n):En(e,"internal-error")}}class Am extends bm{constructor(e){super("phone",e),this.phoneNumber=e.phoneInfo}static _fromServerResponse(e,n){return new Am(n)}}class Cm extends bm{constructor(e){super("totp",e)}static _fromServerResponse(e,n){return new Cm(n)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function km(t){const e=Er(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function Fk(t,e,n){const r=Er(t);await xc(r,{requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"},"getOobCode",kk)}async function $k(t,e,n){await AE(De(t),{oobCode:e,newPassword:n}).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&km(t),r})}async function Bk(t,e){const n=De(t),r=await AE(n,{oobCode:e}),s=r.requestType;switch(ne(s,n,"internal-error"),s){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":ne(r.newEmail,n,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":ne(r.mfaInfo,n,"internal-error");default:ne(r.email,n,"internal-error")}let i=null;return r.mfaInfo&&(i=bm._fromServerResponse(Er(n),r.mfaInfo)),{data:{email:(r.requestType==="VERIFY_AND_CHANGE_EMAIL"?r.newEmail:r.email)||null,previousEmail:(r.requestType==="VERIFY_AND_CHANGE_EMAIL"?r.email:r.newEmail)||null,multiFactorInfo:i},operation:s}}async function zk(t,e){const{data:n}=await Bk(De(t),e);return n.email}async function qk(t,e,n){if(an(t.app))return Promise.reject(Lr(t));const r=Er(t),o=await xc(r,{returnSecureToken:!0,email:e,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",Vk).catch(c=>{throw c.code==="auth/password-does-not-meet-requirements"&&km(t),c}),l=await mi._fromIdTokenResponse(r,"signIn",o);return await r._updateCurrentUser(l.user),l}function RE(t,e,n){return an(t.app)?Promise.reject(Lr(t)):Uk(De(t),Vo.credential(e,n)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&km(t),r})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Wk(t,e){return rr(t,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function PE(t,{displayName:e,photoURL:n}){if(e===void 0&&n===void 0)return;const r=De(t),i={idToken:await r.getIdToken(),displayName:e,photoUrl:n,returnSecureToken:!0},o=await Eo(r,Wk(r.auth,i));r.displayName=o.displayName||null,r.photoURL=o.photoUrl||null;const l=r.providerData.find(({providerId:c})=>c==="password");l&&(l.displayName=r.displayName,l.photoURL=r.photoURL),await r._updateTokensIfNecessary(o)}function Hk(t,e,n,r){return De(t).onIdTokenChanged(e,n,r)}function Gk(t,e,n){return De(t).beforeAuthStateChanged(e,n)}function Mn(t,e,n,r){return De(t).onAuthStateChanged(e,n,r)}function Yf(t){return De(t).signOut()}const Tc="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jE{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(Tc,"1"),this.storage.removeItem(Tc),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kk=1e3,Qk=10;class DE extends jE{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=TE(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),s=this.localCache[n];r!==s&&e(n,s,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,l,c)=>{this.notifyListeners(o,c)});return}const r=e.key;n?this.detachListener():this.stopPolling();const s=()=>{const o=this.storage.getItem(r);!n&&this.localCache[r]===o||this.notifyListeners(r,o)},i=this.storage.getItem(r);lk()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,Qk):s()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},Kk)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}DE.type="LOCAL";const Yk=DE;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OE extends jE{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}OE.type="SESSION";const VE=OE;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jk(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ud{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(s=>s.isListeningto(e));if(n)return n;const r=new ud(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:s,data:i}=n.data,o=this.handlersMap[s];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const l=Array.from(o).map(async d=>d(n.origin,i)),c=await Jk(l);n.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:c})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}ud.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rm(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xk{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,o;return new Promise((l,c)=>{const d=Rm("",20);s.port1.start();const f=setTimeout(()=>{c(new Error("unsupported_event"))},r);o={messageChannel:s,onMessage(p){const m=p;if(m.data.eventId===d)switch(m.data.status){case"ack":clearTimeout(f),i=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),l(m.data.response);break;default:clearTimeout(f),clearTimeout(i),c(new Error("invalid_response"));break}}},this.handlers.add(o),s.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:d,data:n},[s.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mr(){return window}function Zk(t){mr().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LE(){return typeof mr().WorkerGlobalScope<"u"&&typeof mr().importScripts=="function"}async function eR(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function tR(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)==null?void 0:t.controller)||null}function nR(){return LE()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ME="firebaseLocalStorageDb",rR=1,Ic="firebaseLocalStorage",UE="fbase_key";class wl{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function cd(t,e){return t.transaction([Ic],e?"readwrite":"readonly").objectStore(Ic)}function sR(){const t=indexedDB.deleteDatabase(ME);return new wl(t).toPromise()}function Jf(){const t=indexedDB.open(ME,rR);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(Ic,{keyPath:UE})}catch(s){n(s)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(Ic)?e(r):(r.close(),await sR(),e(await Jf()))})})}async function Jv(t,e,n){const r=cd(t,!0).put({[UE]:e,value:n});return new wl(r).toPromise()}async function iR(t,e){const n=cd(t,!1).get(e),r=await new wl(n).toPromise();return r===void 0?null:r.value}function Xv(t,e){const n=cd(t,!0).delete(e);return new wl(n).toPromise()}const oR=800,aR=3;class FE{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Jf(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>aR)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return LE()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=ud._getInstance(nR()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var n,r;if(this.activeServiceWorker=await eR(),!this.activeServiceWorker)return;this.sender=new Xk(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(n=e[0])!=null&&n.fulfilled&&(r=e[0])!=null&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||tR()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Jf();return await Jv(e,Tc,"1"),await Xv(e,Tc),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>Jv(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>iR(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>Xv(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=cd(s,!1).getAll();return new wl(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),n.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),n.push(s));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),oR)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}FE.type="LOCAL";const lR=FE;new yl(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $E(t,e){return e?jr(e):(ne(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pm extends Im{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return ho(e,this._buildIdpRequest())}_linkToIdToken(e,n){return ho(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return ho(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function uR(t){return kE(t.auth,new Pm(t),t.bypassAuthState)}function cR(t){const{auth:e,user:n}=t;return ne(n,e,"internal-error"),Mk(n,new Pm(t),t.bypassAuthState)}async function dR(t){const{auth:e,user:n}=t;return ne(n,e,"internal-error"),Lk(n,new Pm(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BE{constructor(e,n,r,s,i=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:s,tenantId:i,error:o,type:l}=e;if(o){this.reject(o);return}const c={auth:this.auth,requestUri:n,sessionId:r,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(l)(c))}catch(d){this.reject(d)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return uR;case"linkViaPopup":case"linkViaRedirect":return dR;case"reauthViaPopup":case"reauthViaRedirect":return cR;default:En(this.auth,"internal-error")}}resolve(e){qr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){qr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hR=new yl(2e3,1e4);async function jm(t,e,n){if(an(t.app))return Promise.reject(Yn(t,"operation-not-supported-in-this-environment"));const r=Er(t);BC(t,e,Nm);const s=$E(r,n);return new ri(r,"signInViaPopup",e,s).executeNotNull()}class ri extends BE{constructor(e,n,r,s,i){super(e,n,s,i),this.provider=r,this.authWindow=null,this.pollId=null,ri.currentPopupAction&&ri.currentPopupAction.cancel(),ri.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return ne(e,this.auth,"internal-error"),e}async onExecution(){qr(this.filter.length===1,"Popup operations only handle one event");const e=Rm();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(Yn(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(Yn(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,ri.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if((r=(n=this.authWindow)==null?void 0:n.window)!=null&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Yn(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,hR.get())};e()}}ri.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fR="pendingRedirect",Lu=new Map;class pR extends BE{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=Lu.get(this.auth._key());if(!e){try{const r=await mR(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}Lu.set(this.auth._key(),e)}return this.bypassAuthState||Lu.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function mR(t,e){const n=vR(e),r=yR(t);if(!await r._isAvailable())return!1;const s=await r._get(n)==="true";return await r._remove(n),s}function gR(t,e){Lu.set(t._key(),e)}function yR(t){return jr(t._redirectPersistence)}function vR(t){return Vu(fR,t.config.apiKey,t.name)}async function _R(t,e,n=!1){if(an(t.app))return Promise.reject(Lr(t));const r=Er(t),s=$E(r,e),o=await new pR(r,s,n).execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wR=10*60*1e3;class xR{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!ER(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!zE(e)){const s=((r=e.error.code)==null?void 0:r.split("auth/")[1])||"internal-error";n.onError(Yn(this.auth,s))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=wR&&this.cachedEventUids.clear(),this.cachedEventUids.has(Zv(e))}saveEventToCache(e){this.cachedEventUids.add(Zv(e)),this.lastProcessedEventTime=Date.now()}}function Zv(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function zE({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function ER(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return zE(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function TR(t,e={}){return rr(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IR=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,SR=/^https?/;async function NR(t){if(t.config.emulator)return;const{authorizedDomains:e}=await TR(t);for(const n of e)try{if(bR(n))return}catch{}En(t,"unauthorized-domain")}function bR(t){const e=Kf(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!SR.test(n))return!1;if(IR.test(t))return r===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AR=new yl(3e4,6e4);function e_(){const t=mr().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function CR(t){return new Promise((e,n)=>{var s,i,o;function r(){e_(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{e_(),n(Yn(t,"network-request-failed"))},timeout:AR.get()})}if((i=(s=mr().gapi)==null?void 0:s.iframes)!=null&&i.Iframe)e(gapi.iframes.getContext());else if((o=mr().gapi)!=null&&o.load)r();else{const l=yk("iframefcb");return mr()[l]=()=>{gapi.load?r():n(Yn(t,"network-request-failed"))},SE(`${gk()}?onload=${l}`).catch(c=>n(c))}}).catch(e=>{throw Mu=null,e})}let Mu=null;function kR(t){return Mu=Mu||CR(t),Mu}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RR=new yl(5e3,15e3),PR="__/auth/iframe",jR="emulator/auth/iframe",DR={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},OR=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function VR(t){const e=t.config;ne(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?xm(e,jR):`https://${t.config.authDomain}/${PR}`,r={apiKey:e.apiKey,appName:t.name,v:Oo},s=OR.get(t.config.apiHost);s&&(r.eid=s);const i=t._getFrameworks();return i.length&&(r.fw=i.join(",")),`${n}?${ml(r).slice(1)}`}async function LR(t){const e=await kR(t),n=mr().gapi;return ne(n,t,"internal-error"),e.open({where:document.body,url:VR(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:DR,dontclear:!0},r=>new Promise(async(s,i)=>{await r.restyle({setHideOnLeave:!1});const o=Yn(t,"network-request-failed"),l=mr().setTimeout(()=>{i(o)},RR.get());function c(){mr().clearTimeout(l),s(r)}r.ping(c).then(c,()=>{i(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MR={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},UR=500,FR=600,$R="_blank",BR="http://localhost";class t_{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function zR(t,e,n,r=UR,s=FR){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let l="";const c={...MR,width:r.toString(),height:s.toString(),top:i,left:o},d=Kt().toLowerCase();n&&(l=vE(d)?$R:n),gE(d)&&(e=e||BR,c.scrollbars="yes");const f=Object.entries(c).reduce((m,[y,w])=>`${m}${y}=${w},`,"");if(ak(d)&&l!=="_self")return qR(e||"",l),new t_(null);const p=window.open(e||"",l,f);ne(p,t,"popup-blocked");try{p.focus()}catch{}return new t_(p)}function qR(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WR="__/auth/handler",HR="emulator/auth/handler",GR=encodeURIComponent("fac");async function n_(t,e,n,r,s,i){ne(t.config.authDomain,t,"auth-domain-config-required"),ne(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:Oo,eventId:s};if(e instanceof Nm){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",A1(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[f,p]of Object.entries({}))o[f]=p}if(e instanceof _l){const f=e.getScopes().filter(p=>p!=="");f.length>0&&(o.scopes=f.join(","))}t.tenantId&&(o.tid=t.tenantId);const l=o;for(const f of Object.keys(l))l[f]===void 0&&delete l[f];const c=await t._getAppCheckToken(),d=c?`#${GR}=${encodeURIComponent(c)}`:"";return`${KR(t)}?${ml(l).slice(1)}${d}`}function KR({config:t}){return t.emulator?xm(t,HR):`https://${t.authDomain}/${WR}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rh="webStorageSupport";class QR{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=VE,this._completeRedirectFn=_R,this._overrideRedirectResult=gR}async _openPopup(e,n,r,s){var o;qr((o=this.eventManagers[e._key()])==null?void 0:o.manager,"_initialize() not called before _openPopup()");const i=await n_(e,n,r,Kf(),s);return zR(e,i,Rm())}async _openRedirect(e,n,r,s){await this._originValidation(e);const i=await n_(e,n,r,Kf(),s);return Zk(i),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:s,promise:i}=this.eventManagers[n];return s?Promise.resolve(s):(qr(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await LR(e),r=new xR(e);return n.register("authEvent",s=>(ne(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(Rh,{type:Rh},s=>{var o;const i=(o=s==null?void 0:s[0])==null?void 0:o[Rh];i!==void 0&&n(!!i),En(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=NR(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return TE()||yE()||Tm()}}const YR=QR;var r_="@firebase/auth",s_="1.11.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JR{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){ne(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XR(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function ZR(t){er(new Dn("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:o,authDomain:l}=r.options;ne(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const c={apiKey:o,authDomain:l,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:IE(t)},d=new fk(r,s,i,c);return Tk(d,n),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),er(new Dn("auth-internal",e=>{const n=Er(e.getProvider("auth").getImmediate());return(r=>new JR(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),pn(r_,s_,XR(t)),pn(r_,s_,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eP=5*60,tP=tE("authIdTokenMaxAge")||eP;let i_=null;const nP=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>tP)return;const s=n==null?void 0:n.token;i_!==s&&(i_=s,await fetch(t,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function Ke(t=gl()){const e=Ni(t,"auth");if(e.isInitialized())return e.getImmediate();const n=Ek(t,{popupRedirectResolver:YR,persistence:[lR,Yk,VE]}),r=tE("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(r,location.origin);if(location.origin===i.origin){const o=nP(i.toString());Gk(n,o,()=>o(n.currentUser)),Hk(n,l=>o(l))}}const s=X0("auth");return s&&Ik(n,`http://${s}`),n}function rP(){var t;return((t=document.getElementsByTagName("head"))==null?void 0:t[0])??document}pk({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=s=>{const i=Yn("internal-error");i.customData=s,n(i)},r.type="text/javascript",r.charset="UTF-8",rP().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});ZR("Browser");var o_=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var As,qE;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(S,_){function I(){}I.prototype=_.prototype,S.D=_.prototype,S.prototype=new I,S.prototype.constructor=S,S.C=function(N,P,j){for(var C=Array(arguments.length-2),at=2;at<arguments.length;at++)C[at-2]=arguments[at];return _.prototype[P].apply(N,C)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,n),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(S,_,I){I||(I=0);var N=Array(16);if(typeof _=="string")for(var P=0;16>P;++P)N[P]=_.charCodeAt(I++)|_.charCodeAt(I++)<<8|_.charCodeAt(I++)<<16|_.charCodeAt(I++)<<24;else for(P=0;16>P;++P)N[P]=_[I++]|_[I++]<<8|_[I++]<<16|_[I++]<<24;_=S.g[0],I=S.g[1],P=S.g[2];var j=S.g[3],C=_+(j^I&(P^j))+N[0]+3614090360&4294967295;_=I+(C<<7&4294967295|C>>>25),C=j+(P^_&(I^P))+N[1]+3905402710&4294967295,j=_+(C<<12&4294967295|C>>>20),C=P+(I^j&(_^I))+N[2]+606105819&4294967295,P=j+(C<<17&4294967295|C>>>15),C=I+(_^P&(j^_))+N[3]+3250441966&4294967295,I=P+(C<<22&4294967295|C>>>10),C=_+(j^I&(P^j))+N[4]+4118548399&4294967295,_=I+(C<<7&4294967295|C>>>25),C=j+(P^_&(I^P))+N[5]+1200080426&4294967295,j=_+(C<<12&4294967295|C>>>20),C=P+(I^j&(_^I))+N[6]+2821735955&4294967295,P=j+(C<<17&4294967295|C>>>15),C=I+(_^P&(j^_))+N[7]+4249261313&4294967295,I=P+(C<<22&4294967295|C>>>10),C=_+(j^I&(P^j))+N[8]+1770035416&4294967295,_=I+(C<<7&4294967295|C>>>25),C=j+(P^_&(I^P))+N[9]+2336552879&4294967295,j=_+(C<<12&4294967295|C>>>20),C=P+(I^j&(_^I))+N[10]+4294925233&4294967295,P=j+(C<<17&4294967295|C>>>15),C=I+(_^P&(j^_))+N[11]+2304563134&4294967295,I=P+(C<<22&4294967295|C>>>10),C=_+(j^I&(P^j))+N[12]+1804603682&4294967295,_=I+(C<<7&4294967295|C>>>25),C=j+(P^_&(I^P))+N[13]+4254626195&4294967295,j=_+(C<<12&4294967295|C>>>20),C=P+(I^j&(_^I))+N[14]+2792965006&4294967295,P=j+(C<<17&4294967295|C>>>15),C=I+(_^P&(j^_))+N[15]+1236535329&4294967295,I=P+(C<<22&4294967295|C>>>10),C=_+(P^j&(I^P))+N[1]+4129170786&4294967295,_=I+(C<<5&4294967295|C>>>27),C=j+(I^P&(_^I))+N[6]+3225465664&4294967295,j=_+(C<<9&4294967295|C>>>23),C=P+(_^I&(j^_))+N[11]+643717713&4294967295,P=j+(C<<14&4294967295|C>>>18),C=I+(j^_&(P^j))+N[0]+3921069994&4294967295,I=P+(C<<20&4294967295|C>>>12),C=_+(P^j&(I^P))+N[5]+3593408605&4294967295,_=I+(C<<5&4294967295|C>>>27),C=j+(I^P&(_^I))+N[10]+38016083&4294967295,j=_+(C<<9&4294967295|C>>>23),C=P+(_^I&(j^_))+N[15]+3634488961&4294967295,P=j+(C<<14&4294967295|C>>>18),C=I+(j^_&(P^j))+N[4]+3889429448&4294967295,I=P+(C<<20&4294967295|C>>>12),C=_+(P^j&(I^P))+N[9]+568446438&4294967295,_=I+(C<<5&4294967295|C>>>27),C=j+(I^P&(_^I))+N[14]+3275163606&4294967295,j=_+(C<<9&4294967295|C>>>23),C=P+(_^I&(j^_))+N[3]+4107603335&4294967295,P=j+(C<<14&4294967295|C>>>18),C=I+(j^_&(P^j))+N[8]+1163531501&4294967295,I=P+(C<<20&4294967295|C>>>12),C=_+(P^j&(I^P))+N[13]+2850285829&4294967295,_=I+(C<<5&4294967295|C>>>27),C=j+(I^P&(_^I))+N[2]+4243563512&4294967295,j=_+(C<<9&4294967295|C>>>23),C=P+(_^I&(j^_))+N[7]+1735328473&4294967295,P=j+(C<<14&4294967295|C>>>18),C=I+(j^_&(P^j))+N[12]+2368359562&4294967295,I=P+(C<<20&4294967295|C>>>12),C=_+(I^P^j)+N[5]+4294588738&4294967295,_=I+(C<<4&4294967295|C>>>28),C=j+(_^I^P)+N[8]+2272392833&4294967295,j=_+(C<<11&4294967295|C>>>21),C=P+(j^_^I)+N[11]+1839030562&4294967295,P=j+(C<<16&4294967295|C>>>16),C=I+(P^j^_)+N[14]+4259657740&4294967295,I=P+(C<<23&4294967295|C>>>9),C=_+(I^P^j)+N[1]+2763975236&4294967295,_=I+(C<<4&4294967295|C>>>28),C=j+(_^I^P)+N[4]+1272893353&4294967295,j=_+(C<<11&4294967295|C>>>21),C=P+(j^_^I)+N[7]+4139469664&4294967295,P=j+(C<<16&4294967295|C>>>16),C=I+(P^j^_)+N[10]+3200236656&4294967295,I=P+(C<<23&4294967295|C>>>9),C=_+(I^P^j)+N[13]+681279174&4294967295,_=I+(C<<4&4294967295|C>>>28),C=j+(_^I^P)+N[0]+3936430074&4294967295,j=_+(C<<11&4294967295|C>>>21),C=P+(j^_^I)+N[3]+3572445317&4294967295,P=j+(C<<16&4294967295|C>>>16),C=I+(P^j^_)+N[6]+76029189&4294967295,I=P+(C<<23&4294967295|C>>>9),C=_+(I^P^j)+N[9]+3654602809&4294967295,_=I+(C<<4&4294967295|C>>>28),C=j+(_^I^P)+N[12]+3873151461&4294967295,j=_+(C<<11&4294967295|C>>>21),C=P+(j^_^I)+N[15]+530742520&4294967295,P=j+(C<<16&4294967295|C>>>16),C=I+(P^j^_)+N[2]+3299628645&4294967295,I=P+(C<<23&4294967295|C>>>9),C=_+(P^(I|~j))+N[0]+4096336452&4294967295,_=I+(C<<6&4294967295|C>>>26),C=j+(I^(_|~P))+N[7]+1126891415&4294967295,j=_+(C<<10&4294967295|C>>>22),C=P+(_^(j|~I))+N[14]+2878612391&4294967295,P=j+(C<<15&4294967295|C>>>17),C=I+(j^(P|~_))+N[5]+4237533241&4294967295,I=P+(C<<21&4294967295|C>>>11),C=_+(P^(I|~j))+N[12]+1700485571&4294967295,_=I+(C<<6&4294967295|C>>>26),C=j+(I^(_|~P))+N[3]+2399980690&4294967295,j=_+(C<<10&4294967295|C>>>22),C=P+(_^(j|~I))+N[10]+4293915773&4294967295,P=j+(C<<15&4294967295|C>>>17),C=I+(j^(P|~_))+N[1]+2240044497&4294967295,I=P+(C<<21&4294967295|C>>>11),C=_+(P^(I|~j))+N[8]+1873313359&4294967295,_=I+(C<<6&4294967295|C>>>26),C=j+(I^(_|~P))+N[15]+4264355552&4294967295,j=_+(C<<10&4294967295|C>>>22),C=P+(_^(j|~I))+N[6]+2734768916&4294967295,P=j+(C<<15&4294967295|C>>>17),C=I+(j^(P|~_))+N[13]+1309151649&4294967295,I=P+(C<<21&4294967295|C>>>11),C=_+(P^(I|~j))+N[4]+4149444226&4294967295,_=I+(C<<6&4294967295|C>>>26),C=j+(I^(_|~P))+N[11]+3174756917&4294967295,j=_+(C<<10&4294967295|C>>>22),C=P+(_^(j|~I))+N[2]+718787259&4294967295,P=j+(C<<15&4294967295|C>>>17),C=I+(j^(P|~_))+N[9]+3951481745&4294967295,S.g[0]=S.g[0]+_&4294967295,S.g[1]=S.g[1]+(P+(C<<21&4294967295|C>>>11))&4294967295,S.g[2]=S.g[2]+P&4294967295,S.g[3]=S.g[3]+j&4294967295}r.prototype.u=function(S,_){_===void 0&&(_=S.length);for(var I=_-this.blockSize,N=this.B,P=this.h,j=0;j<_;){if(P==0)for(;j<=I;)s(this,S,j),j+=this.blockSize;if(typeof S=="string"){for(;j<_;)if(N[P++]=S.charCodeAt(j++),P==this.blockSize){s(this,N),P=0;break}}else for(;j<_;)if(N[P++]=S[j++],P==this.blockSize){s(this,N),P=0;break}}this.h=P,this.o+=_},r.prototype.v=function(){var S=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);S[0]=128;for(var _=1;_<S.length-8;++_)S[_]=0;var I=8*this.o;for(_=S.length-8;_<S.length;++_)S[_]=I&255,I/=256;for(this.u(S),S=Array(16),_=I=0;4>_;++_)for(var N=0;32>N;N+=8)S[I++]=this.g[_]>>>N&255;return S};function i(S,_){var I=l;return Object.prototype.hasOwnProperty.call(I,S)?I[S]:I[S]=_(S)}function o(S,_){this.h=_;for(var I=[],N=!0,P=S.length-1;0<=P;P--){var j=S[P]|0;N&&j==_||(I[P]=j,N=!1)}this.g=I}var l={};function c(S){return-128<=S&&128>S?i(S,function(_){return new o([_|0],0>_?-1:0)}):new o([S|0],0>S?-1:0)}function d(S){if(isNaN(S)||!isFinite(S))return p;if(0>S)return b(d(-S));for(var _=[],I=1,N=0;S>=I;N++)_[N]=S/I|0,I*=4294967296;return new o(_,0)}function f(S,_){if(S.length==0)throw Error("number format error: empty string");if(_=_||10,2>_||36<_)throw Error("radix out of range: "+_);if(S.charAt(0)=="-")return b(f(S.substring(1),_));if(0<=S.indexOf("-"))throw Error('number format error: interior "-" character');for(var I=d(Math.pow(_,8)),N=p,P=0;P<S.length;P+=8){var j=Math.min(8,S.length-P),C=parseInt(S.substring(P,P+j),_);8>j?(j=d(Math.pow(_,j)),N=N.j(j).add(d(C))):(N=N.j(I),N=N.add(d(C)))}return N}var p=c(0),m=c(1),y=c(16777216);t=o.prototype,t.m=function(){if(A(this))return-b(this).m();for(var S=0,_=1,I=0;I<this.g.length;I++){var N=this.i(I);S+=(0<=N?N:4294967296+N)*_,_*=4294967296}return S},t.toString=function(S){if(S=S||10,2>S||36<S)throw Error("radix out of range: "+S);if(w(this))return"0";if(A(this))return"-"+b(this).toString(S);for(var _=d(Math.pow(S,6)),I=this,N="";;){var P=R(I,_).g;I=E(I,P.j(_));var j=((0<I.g.length?I.g[0]:I.h)>>>0).toString(S);if(I=P,w(I))return j+N;for(;6>j.length;)j="0"+j;N=j+N}},t.i=function(S){return 0>S?0:S<this.g.length?this.g[S]:this.h};function w(S){if(S.h!=0)return!1;for(var _=0;_<S.g.length;_++)if(S.g[_]!=0)return!1;return!0}function A(S){return S.h==-1}t.l=function(S){return S=E(this,S),A(S)?-1:w(S)?0:1};function b(S){for(var _=S.g.length,I=[],N=0;N<_;N++)I[N]=~S.g[N];return new o(I,~S.h).add(m)}t.abs=function(){return A(this)?b(this):this},t.add=function(S){for(var _=Math.max(this.g.length,S.g.length),I=[],N=0,P=0;P<=_;P++){var j=N+(this.i(P)&65535)+(S.i(P)&65535),C=(j>>>16)+(this.i(P)>>>16)+(S.i(P)>>>16);N=C>>>16,j&=65535,C&=65535,I[P]=C<<16|j}return new o(I,I[I.length-1]&-2147483648?-1:0)};function E(S,_){return S.add(b(_))}t.j=function(S){if(w(this)||w(S))return p;if(A(this))return A(S)?b(this).j(b(S)):b(b(this).j(S));if(A(S))return b(this.j(b(S)));if(0>this.l(y)&&0>S.l(y))return d(this.m()*S.m());for(var _=this.g.length+S.g.length,I=[],N=0;N<2*_;N++)I[N]=0;for(N=0;N<this.g.length;N++)for(var P=0;P<S.g.length;P++){var j=this.i(N)>>>16,C=this.i(N)&65535,at=S.i(P)>>>16,xt=S.i(P)&65535;I[2*N+2*P]+=C*xt,v(I,2*N+2*P),I[2*N+2*P+1]+=j*xt,v(I,2*N+2*P+1),I[2*N+2*P+1]+=C*at,v(I,2*N+2*P+1),I[2*N+2*P+2]+=j*at,v(I,2*N+2*P+2)}for(N=0;N<_;N++)I[N]=I[2*N+1]<<16|I[2*N];for(N=_;N<2*_;N++)I[N]=0;return new o(I,0)};function v(S,_){for(;(S[_]&65535)!=S[_];)S[_+1]+=S[_]>>>16,S[_]&=65535,_++}function x(S,_){this.g=S,this.h=_}function R(S,_){if(w(_))throw Error("division by zero");if(w(S))return new x(p,p);if(A(S))return _=R(b(S),_),new x(b(_.g),b(_.h));if(A(_))return _=R(S,b(_)),new x(b(_.g),_.h);if(30<S.g.length){if(A(S)||A(_))throw Error("slowDivide_ only works with positive integers.");for(var I=m,N=_;0>=N.l(S);)I=O(I),N=O(N);var P=L(I,1),j=L(N,1);for(N=L(N,2),I=L(I,2);!w(N);){var C=j.add(N);0>=C.l(S)&&(P=P.add(I),j=C),N=L(N,1),I=L(I,1)}return _=E(S,P.j(_)),new x(P,_)}for(P=p;0<=S.l(_);){for(I=Math.max(1,Math.floor(S.m()/_.m())),N=Math.ceil(Math.log(I)/Math.LN2),N=48>=N?1:Math.pow(2,N-48),j=d(I),C=j.j(_);A(C)||0<C.l(S);)I-=N,j=d(I),C=j.j(_);w(j)&&(j=m),P=P.add(j),S=E(S,C)}return new x(P,S)}t.A=function(S){return R(this,S).h},t.and=function(S){for(var _=Math.max(this.g.length,S.g.length),I=[],N=0;N<_;N++)I[N]=this.i(N)&S.i(N);return new o(I,this.h&S.h)},t.or=function(S){for(var _=Math.max(this.g.length,S.g.length),I=[],N=0;N<_;N++)I[N]=this.i(N)|S.i(N);return new o(I,this.h|S.h)},t.xor=function(S){for(var _=Math.max(this.g.length,S.g.length),I=[],N=0;N<_;N++)I[N]=this.i(N)^S.i(N);return new o(I,this.h^S.h)};function O(S){for(var _=S.g.length+1,I=[],N=0;N<_;N++)I[N]=S.i(N)<<1|S.i(N-1)>>>31;return new o(I,S.h)}function L(S,_){var I=_>>5;_%=32;for(var N=S.g.length-I,P=[],j=0;j<N;j++)P[j]=0<_?S.i(j+I)>>>_|S.i(j+I+1)<<32-_:S.i(j+I);return new o(P,S.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,qE=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=d,o.fromString=f,As=o}).apply(typeof o_<"u"?o_:typeof self<"u"?self:typeof window<"u"?window:{});var yu=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var WE,fa,HE,Uu,Xf,GE,KE,QE;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(a,h,g){return a==Array.prototype||a==Object.prototype||(a[h]=g.value),a};function n(a){a=[typeof globalThis=="object"&&globalThis,a,typeof window=="object"&&window,typeof self=="object"&&self,typeof yu=="object"&&yu];for(var h=0;h<a.length;++h){var g=a[h];if(g&&g.Math==Math)return g}throw Error("Cannot find global object")}var r=n(this);function s(a,h){if(h)e:{var g=r;a=a.split(".");for(var T=0;T<a.length-1;T++){var D=a[T];if(!(D in g))break e;g=g[D]}a=a[a.length-1],T=g[a],h=h(T),h!=T&&h!=null&&e(g,a,{configurable:!0,writable:!0,value:h})}}function i(a,h){a instanceof String&&(a+="");var g=0,T=!1,D={next:function(){if(!T&&g<a.length){var V=g++;return{value:h(V,a[V]),done:!1}}return T=!0,{done:!0,value:void 0}}};return D[Symbol.iterator]=function(){return D},D}s("Array.prototype.values",function(a){return a||function(){return i(this,function(h,g){return g})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},l=this||self;function c(a){var h=typeof a;return h=h!="object"?h:a?Array.isArray(a)?"array":h:"null",h=="array"||h=="object"&&typeof a.length=="number"}function d(a){var h=typeof a;return h=="object"&&a!=null||h=="function"}function f(a,h,g){return a.call.apply(a.bind,arguments)}function p(a,h,g){if(!a)throw Error();if(2<arguments.length){var T=Array.prototype.slice.call(arguments,2);return function(){var D=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(D,T),a.apply(h,D)}}return function(){return a.apply(h,arguments)}}function m(a,h,g){return m=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?f:p,m.apply(null,arguments)}function y(a,h){var g=Array.prototype.slice.call(arguments,1);return function(){var T=g.slice();return T.push.apply(T,arguments),a.apply(this,T)}}function w(a,h){function g(){}g.prototype=h.prototype,a.aa=h.prototype,a.prototype=new g,a.prototype.constructor=a,a.Qb=function(T,D,V){for(var W=Array(arguments.length-2),Me=2;Me<arguments.length;Me++)W[Me-2]=arguments[Me];return h.prototype[D].apply(T,W)}}function A(a){const h=a.length;if(0<h){const g=Array(h);for(let T=0;T<h;T++)g[T]=a[T];return g}return[]}function b(a,h){for(let g=1;g<arguments.length;g++){const T=arguments[g];if(c(T)){const D=a.length||0,V=T.length||0;a.length=D+V;for(let W=0;W<V;W++)a[D+W]=T[W]}else a.push(T)}}class E{constructor(h,g){this.i=h,this.j=g,this.h=0,this.g=null}get(){let h;return 0<this.h?(this.h--,h=this.g,this.g=h.next,h.next=null):h=this.i(),h}}function v(a){return/^[\s\xa0]*$/.test(a)}function x(){var a=l.navigator;return a&&(a=a.userAgent)?a:""}function R(a){return R[" "](a),a}R[" "]=function(){};var O=x().indexOf("Gecko")!=-1&&!(x().toLowerCase().indexOf("webkit")!=-1&&x().indexOf("Edge")==-1)&&!(x().indexOf("Trident")!=-1||x().indexOf("MSIE")!=-1)&&x().indexOf("Edge")==-1;function L(a,h,g){for(const T in a)h.call(g,a[T],T,a)}function S(a,h){for(const g in a)h.call(void 0,a[g],g,a)}function _(a){const h={};for(const g in a)h[g]=a[g];return h}const I="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function N(a,h){let g,T;for(let D=1;D<arguments.length;D++){T=arguments[D];for(g in T)a[g]=T[g];for(let V=0;V<I.length;V++)g=I[V],Object.prototype.hasOwnProperty.call(T,g)&&(a[g]=T[g])}}function P(a){var h=1;a=a.split(":");const g=[];for(;0<h&&a.length;)g.push(a.shift()),h--;return a.length&&g.push(a.join(":")),g}function j(a){l.setTimeout(()=>{throw a},0)}function C(){var a=K;let h=null;return a.g&&(h=a.g,a.g=a.g.next,a.g||(a.h=null),h.next=null),h}class at{constructor(){this.h=this.g=null}add(h,g){const T=xt.get();T.set(h,g),this.h?this.h.next=T:this.g=T,this.h=T}}var xt=new E(()=>new Un,a=>a.reset());class Un{constructor(){this.next=this.g=this.h=null}set(h,g){this.h=h,this.g=g,this.next=null}reset(){this.next=this.g=this.h=null}}let Q,B=!1,K=new at,J=()=>{const a=l.Promise.resolve(void 0);Q=()=>{a.then(ye)}};var ye=()=>{for(var a;a=C();){try{a.h.call(a.g)}catch(g){j(g)}var h=xt;h.j(a),100>h.h&&(h.h++,a.next=h.g,h.g=a)}B=!1};function de(){this.s=this.s,this.C=this.C}de.prototype.s=!1,de.prototype.ma=function(){this.s||(this.s=!0,this.N())},de.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function re(a,h){this.type=a,this.g=this.target=h,this.defaultPrevented=!1}re.prototype.h=function(){this.defaultPrevented=!0};var st=function(){if(!l.addEventListener||!Object.defineProperty)return!1;var a=!1,h=Object.defineProperty({},"passive",{get:function(){a=!0}});try{const g=()=>{};l.addEventListener("test",g,h),l.removeEventListener("test",g,h)}catch{}return a}();function Et(a,h){if(re.call(this,a?a.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,a){var g=this.type=a.type,T=a.changedTouches&&a.changedTouches.length?a.changedTouches[0]:null;if(this.target=a.target||a.srcElement,this.g=h,h=a.relatedTarget){if(O){e:{try{R(h.nodeName);var D=!0;break e}catch{}D=!1}D||(h=null)}}else g=="mouseover"?h=a.fromElement:g=="mouseout"&&(h=a.toElement);this.relatedTarget=h,T?(this.clientX=T.clientX!==void 0?T.clientX:T.pageX,this.clientY=T.clientY!==void 0?T.clientY:T.pageY,this.screenX=T.screenX||0,this.screenY=T.screenY||0):(this.clientX=a.clientX!==void 0?a.clientX:a.pageX,this.clientY=a.clientY!==void 0?a.clientY:a.pageY,this.screenX=a.screenX||0,this.screenY=a.screenY||0),this.button=a.button,this.key=a.key||"",this.ctrlKey=a.ctrlKey,this.altKey=a.altKey,this.shiftKey=a.shiftKey,this.metaKey=a.metaKey,this.pointerId=a.pointerId||0,this.pointerType=typeof a.pointerType=="string"?a.pointerType:Qe[a.pointerType]||"",this.state=a.state,this.i=a,a.defaultPrevented&&Et.aa.h.call(this)}}w(Et,re);var Qe={2:"touch",3:"pen",4:"mouse"};Et.prototype.h=function(){Et.aa.h.call(this);var a=this.i;a.preventDefault?a.preventDefault():a.returnValue=!1};var Oe="closure_listenable_"+(1e6*Math.random()|0),Tt=0;function z(a,h,g,T,D){this.listener=a,this.proxy=null,this.src=h,this.type=g,this.capture=!!T,this.ha=D,this.key=++Tt,this.da=this.fa=!1}function Z(a){a.da=!0,a.listener=null,a.proxy=null,a.src=null,a.ha=null}function me(a){this.src=a,this.g={},this.h=0}me.prototype.add=function(a,h,g,T,D){var V=a.toString();a=this.g[V],a||(a=this.g[V]=[],this.h++);var W=Se(a,h,T,D);return-1<W?(h=a[W],g||(h.fa=!1)):(h=new z(h,this.src,V,!!T,D),h.fa=g,a.push(h)),h};function le(a,h){var g=h.type;if(g in a.g){var T=a.g[g],D=Array.prototype.indexOf.call(T,h,void 0),V;(V=0<=D)&&Array.prototype.splice.call(T,D,1),V&&(Z(h),a.g[g].length==0&&(delete a.g[g],a.h--))}}function Se(a,h,g,T){for(var D=0;D<a.length;++D){var V=a[D];if(!V.da&&V.listener==h&&V.capture==!!g&&V.ha==T)return D}return-1}var ve="closure_lm_"+(1e6*Math.random()|0),oe={};function It(a,h,g,T,D){if(Array.isArray(h)){for(var V=0;V<h.length;V++)It(a,h[V],g,T,D);return null}return g=Pl(g),a&&a[Oe]?a.K(h,g,d(T)?!!T.capture:!1,D):Ie(a,h,g,!1,T,D)}function Ie(a,h,g,T,D,V){if(!h)throw Error("Invalid event type");var W=d(D)?!!D.capture:!!D,Me=Jr(a);if(Me||(a[ve]=Me=new me(a)),g=Me.add(h,g,T,W,V),g.proxy)return g;if(T=Le(),g.proxy=T,T.src=a,T.listener=g,a.addEventListener)st||(D=W),D===void 0&&(D=!1),a.addEventListener(h.toString(),T,D);else if(a.attachEvent)a.attachEvent(Qt(h.toString()),T);else if(a.addListener&&a.removeListener)a.addListener(T);else throw Error("addEventListener and attachEvent are unavailable.");return g}function Le(){function a(g){return h.call(a.src,a.listener,g)}const h=Fn;return a}function qe(a,h,g,T,D){if(Array.isArray(h))for(var V=0;V<h.length;V++)qe(a,h[V],g,T,D);else T=d(T)?!!T.capture:!!T,g=Pl(g),a&&a[Oe]?(a=a.i,h=String(h).toString(),h in a.g&&(V=a.g[h],g=Se(V,g,T,D),-1<g&&(Z(V[g]),Array.prototype.splice.call(V,g,1),V.length==0&&(delete a.g[h],a.h--)))):a&&(a=Jr(a))&&(h=a.g[h.toString()],a=-1,h&&(a=Se(h,g,T,D)),(g=-1<a?h[a]:null)&&gt(g))}function gt(a){if(typeof a!="number"&&a&&!a.da){var h=a.src;if(h&&h[Oe])le(h.i,a);else{var g=a.type,T=a.proxy;h.removeEventListener?h.removeEventListener(g,T,a.capture):h.detachEvent?h.detachEvent(Qt(g),T):h.addListener&&h.removeListener&&h.removeListener(T),(g=Jr(h))?(le(g,a),g.h==0&&(g.src=null,h[ve]=null)):Z(a)}}}function Qt(a){return a in oe?oe[a]:oe[a]="on"+a}function Fn(a,h){if(a.da)a=!0;else{h=new Et(h,this);var g=a.listener,T=a.ha||a.src;a.fa&&gt(a),a=g.call(T,h)}return a}function Jr(a){return a=a[ve],a instanceof me?a:null}var Tr="__closure_events_fn_"+(1e9*Math.random()>>>0);function Pl(a){return typeof a=="function"?a:(a[Tr]||(a[Tr]=function(h){return a.handleEvent(h)}),a[Tr])}function ct(){de.call(this),this.i=new me(this),this.M=this,this.F=null}w(ct,de),ct.prototype[Oe]=!0,ct.prototype.removeEventListener=function(a,h,g,T){qe(this,a,h,g,T)};function dt(a,h){var g,T=a.F;if(T)for(g=[];T;T=T.F)g.push(T);if(a=a.M,T=h.type||h,typeof h=="string")h=new re(h,a);else if(h instanceof re)h.target=h.target||a;else{var D=h;h=new re(T,a),N(h,D)}if(D=!0,g)for(var V=g.length-1;0<=V;V--){var W=h.g=g[V];D=$n(W,T,!0,h)&&D}if(W=h.g=a,D=$n(W,T,!0,h)&&D,D=$n(W,T,!1,h)&&D,g)for(V=0;V<g.length;V++)W=h.g=g[V],D=$n(W,T,!1,h)&&D}ct.prototype.N=function(){if(ct.aa.N.call(this),this.i){var a=this.i,h;for(h in a.g){for(var g=a.g[h],T=0;T<g.length;T++)Z(g[T]);delete a.g[h],a.h--}}this.F=null},ct.prototype.K=function(a,h,g,T){return this.i.add(String(a),h,!1,g,T)},ct.prototype.L=function(a,h,g,T){return this.i.add(String(a),h,!0,g,T)};function $n(a,h,g,T){if(h=a.i.g[String(h)],!h)return!0;h=h.concat();for(var D=!0,V=0;V<h.length;++V){var W=h[V];if(W&&!W.da&&W.capture==g){var Me=W.listener,Rt=W.ha||W.src;W.fa&&le(a.i,W),D=Me.call(Rt,T)!==!1&&D}}return D&&!T.defaultPrevented}function jl(a,h,g){if(typeof a=="function")g&&(a=m(a,g));else if(a&&typeof a.handleEvent=="function")a=m(a.handleEvent,a);else throw Error("Invalid listener argument");return 2147483647<Number(h)?-1:l.setTimeout(a,h||0)}function Pi(a){a.g=jl(()=>{a.g=null,a.i&&(a.i=!1,Pi(a))},a.l);const h=a.h;a.h=null,a.m.apply(null,h)}class Dl extends de{constructor(h,g){super(),this.m=h,this.l=g,this.h=null,this.i=!1,this.g=null}j(h){this.h=arguments,this.g?this.i=!0:Pi(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function qs(a){de.call(this),this.h=a,this.g={}}w(qs,de);var ji=[];function Ol(a){L(a.g,function(h,g){this.g.hasOwnProperty(g)&&gt(h)},a),a.g={}}qs.prototype.N=function(){qs.aa.N.call(this),Ol(this)},qs.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Bo=l.JSON.stringify,Ld=l.JSON.parse,Md=class{stringify(a){return l.JSON.stringify(a,void 0)}parse(a){return l.JSON.parse(a,void 0)}};function zo(){}zo.prototype.h=null;function Vl(a){return a.h||(a.h=a.i())}function or(){}var Ws={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Di(){re.call(this,"d")}w(Di,re);function qo(){re.call(this,"c")}w(qo,re);var ar={},Ll=null;function Hs(){return Ll=Ll||new ct}ar.La="serverreachability";function F(a){re.call(this,ar.La,a)}w(F,re);function se(a){const h=Hs();dt(h,new F(h))}ar.STAT_EVENT="statevent";function ge(a,h){re.call(this,ar.STAT_EVENT,a),this.stat=h}w(ge,re);function ie(a){const h=Hs();dt(h,new ge(h,a))}ar.Ma="timingevent";function Re(a,h){re.call(this,ar.Ma,a),this.size=h}w(Re,re);function ue(a,h){if(typeof a!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){a()},h)}function ce(){this.g=!0}ce.prototype.xa=function(){this.g=!1};function Lt(a,h,g,T,D,V){a.info(function(){if(a.g)if(V)for(var W="",Me=V.split("&"),Rt=0;Rt<Me.length;Rt++){var Ce=Me[Rt].split("=");if(1<Ce.length){var Mt=Ce[0];Ce=Ce[1];var Ut=Mt.split("_");W=2<=Ut.length&&Ut[1]=="type"?W+(Mt+"="+Ce+"&"):W+(Mt+"=redacted&")}}else W=null;else W=V;return"XMLHTTP REQ ("+T+") [attempt "+D+"]: "+h+`
`+g+`
`+W})}function Ir(a,h,g,T,D,V,W){a.info(function(){return"XMLHTTP RESP ("+T+") [ attempt "+D+"]: "+h+`
`+g+`
`+V+" "+W})}function rn(a,h,g,T){a.info(function(){return"XMLHTTP TEXT ("+h+"): "+Xr(a,g)+(T?" "+T:"")})}function Oi(a,h){a.info(function(){return"TIMEOUT: "+h})}ce.prototype.info=function(){};function Xr(a,h){if(!a.g)return h;if(!h)return null;try{var g=JSON.parse(h);if(g){for(a=0;a<g.length;a++)if(Array.isArray(g[a])){var T=g[a];if(!(2>T.length)){var D=T[1];if(Array.isArray(D)&&!(1>D.length)){var V=D[0];if(V!="noop"&&V!="stop"&&V!="close")for(var W=1;W<D.length;W++)D[W]=""}}}}return Bo(g)}catch{return h}}var Ml={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Cg={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Ud;function Ul(){}w(Ul,zo),Ul.prototype.g=function(){return new XMLHttpRequest},Ul.prototype.i=function(){return{}},Ud=new Ul;function Zr(a,h,g,T){this.j=a,this.i=h,this.l=g,this.R=T||1,this.U=new qs(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new kg}function kg(){this.i=null,this.g="",this.h=!1}var Rg={},Fd={};function $d(a,h,g){a.L=1,a.v=zl(Sr(h)),a.m=g,a.P=!0,Pg(a,null)}function Pg(a,h){a.F=Date.now(),Fl(a),a.A=Sr(a.v);var g=a.A,T=a.R;Array.isArray(T)||(T=[String(T)]),Hg(g.i,"t",T),a.C=0,g=a.j.J,a.h=new kg,a.g=cy(a.j,g?h:null,!a.m),0<a.O&&(a.M=new Dl(m(a.Y,a,a.g),a.O)),h=a.U,g=a.g,T=a.ca;var D="readystatechange";Array.isArray(D)||(D&&(ji[0]=D.toString()),D=ji);for(var V=0;V<D.length;V++){var W=It(g,D[V],T||h.handleEvent,!1,h.h||h);if(!W)break;h.g[W.key]=W}h=a.H?_(a.H):{},a.m?(a.u||(a.u="POST"),h["Content-Type"]="application/x-www-form-urlencoded",a.g.ea(a.A,a.u,a.m,h)):(a.u="GET",a.g.ea(a.A,a.u,null,h)),se(),Lt(a.i,a.u,a.A,a.l,a.R,a.m)}Zr.prototype.ca=function(a){a=a.target;const h=this.M;h&&Nr(a)==3?h.j():this.Y(a)},Zr.prototype.Y=function(a){try{if(a==this.g)e:{const Ut=Nr(this.g);var h=this.g.Ba();const Mi=this.g.Z();if(!(3>Ut)&&(Ut!=3||this.g&&(this.h.h||this.g.oa()||Zg(this.g)))){this.J||Ut!=4||h==7||(h==8||0>=Mi?se(3):se(2)),Bd(this);var g=this.g.Z();this.X=g;t:if(jg(this)){var T=Zg(this.g);a="";var D=T.length,V=Nr(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Gs(this),Wo(this);var W="";break t}this.h.i=new l.TextDecoder}for(h=0;h<D;h++)this.h.h=!0,a+=this.h.i.decode(T[h],{stream:!(V&&h==D-1)});T.length=0,this.h.g+=a,this.C=0,W=this.h.g}else W=this.g.oa();if(this.o=g==200,Ir(this.i,this.u,this.A,this.l,this.R,Ut,g),this.o){if(this.T&&!this.K){t:{if(this.g){var Me,Rt=this.g;if((Me=Rt.g?Rt.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!v(Me)){var Ce=Me;break t}}Ce=null}if(g=Ce)rn(this.i,this.l,g,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,zd(this,g);else{this.o=!1,this.s=3,ie(12),Gs(this),Wo(this);break e}}if(this.P){g=!0;let Bn;for(;!this.J&&this.C<W.length;)if(Bn=aS(this,W),Bn==Fd){Ut==4&&(this.s=4,ie(14),g=!1),rn(this.i,this.l,null,"[Incomplete Response]");break}else if(Bn==Rg){this.s=4,ie(15),rn(this.i,this.l,W,"[Invalid Chunk]"),g=!1;break}else rn(this.i,this.l,Bn,null),zd(this,Bn);if(jg(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Ut!=4||W.length!=0||this.h.h||(this.s=1,ie(16),g=!1),this.o=this.o&&g,!g)rn(this.i,this.l,W,"[Invalid Chunked Response]"),Gs(this),Wo(this);else if(0<W.length&&!this.W){this.W=!0;var Mt=this.j;Mt.g==this&&Mt.ba&&!Mt.M&&(Mt.j.info("Great, no buffering proxy detected. Bytes received: "+W.length),Qd(Mt),Mt.M=!0,ie(11))}}else rn(this.i,this.l,W,null),zd(this,W);Ut==4&&Gs(this),this.o&&!this.J&&(Ut==4?oy(this.j,this):(this.o=!1,Fl(this)))}else IS(this.g),g==400&&0<W.indexOf("Unknown SID")?(this.s=3,ie(12)):(this.s=0,ie(13)),Gs(this),Wo(this)}}}catch{}finally{}};function jg(a){return a.g?a.u=="GET"&&a.L!=2&&a.j.Ca:!1}function aS(a,h){var g=a.C,T=h.indexOf(`
`,g);return T==-1?Fd:(g=Number(h.substring(g,T)),isNaN(g)?Rg:(T+=1,T+g>h.length?Fd:(h=h.slice(T,T+g),a.C=T+g,h)))}Zr.prototype.cancel=function(){this.J=!0,Gs(this)};function Fl(a){a.S=Date.now()+a.I,Dg(a,a.I)}function Dg(a,h){if(a.B!=null)throw Error("WatchDog timer not null");a.B=ue(m(a.ba,a),h)}function Bd(a){a.B&&(l.clearTimeout(a.B),a.B=null)}Zr.prototype.ba=function(){this.B=null;const a=Date.now();0<=a-this.S?(Oi(this.i,this.A),this.L!=2&&(se(),ie(17)),Gs(this),this.s=2,Wo(this)):Dg(this,this.S-a)};function Wo(a){a.j.G==0||a.J||oy(a.j,a)}function Gs(a){Bd(a);var h=a.M;h&&typeof h.ma=="function"&&h.ma(),a.M=null,Ol(a.U),a.g&&(h=a.g,a.g=null,h.abort(),h.ma())}function zd(a,h){try{var g=a.j;if(g.G!=0&&(g.g==a||qd(g.h,a))){if(!a.K&&qd(g.h,a)&&g.G==3){try{var T=g.Da.g.parse(h)}catch{T=null}if(Array.isArray(T)&&T.length==3){var D=T;if(D[0]==0){e:if(!g.u){if(g.g)if(g.g.F+3e3<a.F)Ql(g),Gl(g);else break e;Kd(g),ie(18)}}else g.za=D[1],0<g.za-g.T&&37500>D[2]&&g.F&&g.v==0&&!g.C&&(g.C=ue(m(g.Za,g),6e3));if(1>=Lg(g.h)&&g.ca){try{g.ca()}catch{}g.ca=void 0}}else Qs(g,11)}else if((a.K||g.g==a)&&Ql(g),!v(h))for(D=g.Da.g.parse(h),h=0;h<D.length;h++){let Ce=D[h];if(g.T=Ce[0],Ce=Ce[1],g.G==2)if(Ce[0]=="c"){g.K=Ce[1],g.ia=Ce[2];const Mt=Ce[3];Mt!=null&&(g.la=Mt,g.j.info("VER="+g.la));const Ut=Ce[4];Ut!=null&&(g.Aa=Ut,g.j.info("SVER="+g.Aa));const Mi=Ce[5];Mi!=null&&typeof Mi=="number"&&0<Mi&&(T=1.5*Mi,g.L=T,g.j.info("backChannelRequestTimeoutMs_="+T)),T=g;const Bn=a.g;if(Bn){const Jl=Bn.g?Bn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Jl){var V=T.h;V.g||Jl.indexOf("spdy")==-1&&Jl.indexOf("quic")==-1&&Jl.indexOf("h2")==-1||(V.j=V.l,V.g=new Set,V.h&&(Wd(V,V.h),V.h=null))}if(T.D){const Yd=Bn.g?Bn.g.getResponseHeader("X-HTTP-Session-Id"):null;Yd&&(T.ya=Yd,We(T.I,T.D,Yd))}}g.G=3,g.l&&g.l.ua(),g.ba&&(g.R=Date.now()-a.F,g.j.info("Handshake RTT: "+g.R+"ms")),T=g;var W=a;if(T.qa=uy(T,T.J?T.ia:null,T.W),W.K){Mg(T.h,W);var Me=W,Rt=T.L;Rt&&(Me.I=Rt),Me.B&&(Bd(Me),Fl(Me)),T.g=W}else sy(T);0<g.i.length&&Kl(g)}else Ce[0]!="stop"&&Ce[0]!="close"||Qs(g,7);else g.G==3&&(Ce[0]=="stop"||Ce[0]=="close"?Ce[0]=="stop"?Qs(g,7):Gd(g):Ce[0]!="noop"&&g.l&&g.l.ta(Ce),g.v=0)}}se(4)}catch{}}var lS=class{constructor(a,h){this.g=a,this.map=h}};function Og(a){this.l=a||10,l.PerformanceNavigationTiming?(a=l.performance.getEntriesByType("navigation"),a=0<a.length&&(a[0].nextHopProtocol=="hq"||a[0].nextHopProtocol=="h2")):a=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=a?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Vg(a){return a.h?!0:a.g?a.g.size>=a.j:!1}function Lg(a){return a.h?1:a.g?a.g.size:0}function qd(a,h){return a.h?a.h==h:a.g?a.g.has(h):!1}function Wd(a,h){a.g?a.g.add(h):a.h=h}function Mg(a,h){a.h&&a.h==h?a.h=null:a.g&&a.g.has(h)&&a.g.delete(h)}Og.prototype.cancel=function(){if(this.i=Ug(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const a of this.g.values())a.cancel();this.g.clear()}};function Ug(a){if(a.h!=null)return a.i.concat(a.h.D);if(a.g!=null&&a.g.size!==0){let h=a.i;for(const g of a.g.values())h=h.concat(g.D);return h}return A(a.i)}function uS(a){if(a.V&&typeof a.V=="function")return a.V();if(typeof Map<"u"&&a instanceof Map||typeof Set<"u"&&a instanceof Set)return Array.from(a.values());if(typeof a=="string")return a.split("");if(c(a)){for(var h=[],g=a.length,T=0;T<g;T++)h.push(a[T]);return h}h=[],g=0;for(T in a)h[g++]=a[T];return h}function cS(a){if(a.na&&typeof a.na=="function")return a.na();if(!a.V||typeof a.V!="function"){if(typeof Map<"u"&&a instanceof Map)return Array.from(a.keys());if(!(typeof Set<"u"&&a instanceof Set)){if(c(a)||typeof a=="string"){var h=[];a=a.length;for(var g=0;g<a;g++)h.push(g);return h}h=[],g=0;for(const T in a)h[g++]=T;return h}}}function Fg(a,h){if(a.forEach&&typeof a.forEach=="function")a.forEach(h,void 0);else if(c(a)||typeof a=="string")Array.prototype.forEach.call(a,h,void 0);else for(var g=cS(a),T=uS(a),D=T.length,V=0;V<D;V++)h.call(void 0,T[V],g&&g[V],a)}var $g=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function dS(a,h){if(a){a=a.split("&");for(var g=0;g<a.length;g++){var T=a[g].indexOf("="),D=null;if(0<=T){var V=a[g].substring(0,T);D=a[g].substring(T+1)}else V=a[g];h(V,D?decodeURIComponent(D.replace(/\+/g," ")):"")}}}function Ks(a){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,a instanceof Ks){this.h=a.h,$l(this,a.j),this.o=a.o,this.g=a.g,Bl(this,a.s),this.l=a.l;var h=a.i,g=new Ko;g.i=h.i,h.g&&(g.g=new Map(h.g),g.h=h.h),Bg(this,g),this.m=a.m}else a&&(h=String(a).match($g))?(this.h=!1,$l(this,h[1]||"",!0),this.o=Ho(h[2]||""),this.g=Ho(h[3]||"",!0),Bl(this,h[4]),this.l=Ho(h[5]||"",!0),Bg(this,h[6]||"",!0),this.m=Ho(h[7]||"")):(this.h=!1,this.i=new Ko(null,this.h))}Ks.prototype.toString=function(){var a=[],h=this.j;h&&a.push(Go(h,zg,!0),":");var g=this.g;return(g||h=="file")&&(a.push("//"),(h=this.o)&&a.push(Go(h,zg,!0),"@"),a.push(encodeURIComponent(String(g)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),g=this.s,g!=null&&a.push(":",String(g))),(g=this.l)&&(this.g&&g.charAt(0)!="/"&&a.push("/"),a.push(Go(g,g.charAt(0)=="/"?pS:fS,!0))),(g=this.i.toString())&&a.push("?",g),(g=this.m)&&a.push("#",Go(g,gS)),a.join("")};function Sr(a){return new Ks(a)}function $l(a,h,g){a.j=g?Ho(h,!0):h,a.j&&(a.j=a.j.replace(/:$/,""))}function Bl(a,h){if(h){if(h=Number(h),isNaN(h)||0>h)throw Error("Bad port number "+h);a.s=h}else a.s=null}function Bg(a,h,g){h instanceof Ko?(a.i=h,yS(a.i,a.h)):(g||(h=Go(h,mS)),a.i=new Ko(h,a.h))}function We(a,h,g){a.i.set(h,g)}function zl(a){return We(a,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),a}function Ho(a,h){return a?h?decodeURI(a.replace(/%25/g,"%2525")):decodeURIComponent(a):""}function Go(a,h,g){return typeof a=="string"?(a=encodeURI(a).replace(h,hS),g&&(a=a.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),a):null}function hS(a){return a=a.charCodeAt(0),"%"+(a>>4&15).toString(16)+(a&15).toString(16)}var zg=/[#\/\?@]/g,fS=/[#\?:]/g,pS=/[#\?]/g,mS=/[#\?@]/g,gS=/#/g;function Ko(a,h){this.h=this.g=null,this.i=a||null,this.j=!!h}function es(a){a.g||(a.g=new Map,a.h=0,a.i&&dS(a.i,function(h,g){a.add(decodeURIComponent(h.replace(/\+/g," ")),g)}))}t=Ko.prototype,t.add=function(a,h){es(this),this.i=null,a=Vi(this,a);var g=this.g.get(a);return g||this.g.set(a,g=[]),g.push(h),this.h+=1,this};function qg(a,h){es(a),h=Vi(a,h),a.g.has(h)&&(a.i=null,a.h-=a.g.get(h).length,a.g.delete(h))}function Wg(a,h){return es(a),h=Vi(a,h),a.g.has(h)}t.forEach=function(a,h){es(this),this.g.forEach(function(g,T){g.forEach(function(D){a.call(h,D,T,this)},this)},this)},t.na=function(){es(this);const a=Array.from(this.g.values()),h=Array.from(this.g.keys()),g=[];for(let T=0;T<h.length;T++){const D=a[T];for(let V=0;V<D.length;V++)g.push(h[T])}return g},t.V=function(a){es(this);let h=[];if(typeof a=="string")Wg(this,a)&&(h=h.concat(this.g.get(Vi(this,a))));else{a=Array.from(this.g.values());for(let g=0;g<a.length;g++)h=h.concat(a[g])}return h},t.set=function(a,h){return es(this),this.i=null,a=Vi(this,a),Wg(this,a)&&(this.h-=this.g.get(a).length),this.g.set(a,[h]),this.h+=1,this},t.get=function(a,h){return a?(a=this.V(a),0<a.length?String(a[0]):h):h};function Hg(a,h,g){qg(a,h),0<g.length&&(a.i=null,a.g.set(Vi(a,h),A(g)),a.h+=g.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const a=[],h=Array.from(this.g.keys());for(var g=0;g<h.length;g++){var T=h[g];const V=encodeURIComponent(String(T)),W=this.V(T);for(T=0;T<W.length;T++){var D=V;W[T]!==""&&(D+="="+encodeURIComponent(String(W[T]))),a.push(D)}}return this.i=a.join("&")};function Vi(a,h){return h=String(h),a.j&&(h=h.toLowerCase()),h}function yS(a,h){h&&!a.j&&(es(a),a.i=null,a.g.forEach(function(g,T){var D=T.toLowerCase();T!=D&&(qg(this,T),Hg(this,D,g))},a)),a.j=h}function vS(a,h){const g=new ce;if(l.Image){const T=new Image;T.onload=y(ts,g,"TestLoadImage: loaded",!0,h,T),T.onerror=y(ts,g,"TestLoadImage: error",!1,h,T),T.onabort=y(ts,g,"TestLoadImage: abort",!1,h,T),T.ontimeout=y(ts,g,"TestLoadImage: timeout",!1,h,T),l.setTimeout(function(){T.ontimeout&&T.ontimeout()},1e4),T.src=a}else h(!1)}function _S(a,h){const g=new ce,T=new AbortController,D=setTimeout(()=>{T.abort(),ts(g,"TestPingServer: timeout",!1,h)},1e4);fetch(a,{signal:T.signal}).then(V=>{clearTimeout(D),V.ok?ts(g,"TestPingServer: ok",!0,h):ts(g,"TestPingServer: server error",!1,h)}).catch(()=>{clearTimeout(D),ts(g,"TestPingServer: error",!1,h)})}function ts(a,h,g,T,D){try{D&&(D.onload=null,D.onerror=null,D.onabort=null,D.ontimeout=null),T(g)}catch{}}function wS(){this.g=new Md}function xS(a,h,g){const T=g||"";try{Fg(a,function(D,V){let W=D;d(D)&&(W=Bo(D)),h.push(T+V+"="+encodeURIComponent(W))})}catch(D){throw h.push(T+"type="+encodeURIComponent("_badmap")),D}}function ql(a){this.l=a.Ub||null,this.j=a.eb||!1}w(ql,zo),ql.prototype.g=function(){return new Wl(this.l,this.j)},ql.prototype.i=function(a){return function(){return a}}({});function Wl(a,h){ct.call(this),this.D=a,this.o=h,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}w(Wl,ct),t=Wl.prototype,t.open=function(a,h){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=a,this.A=h,this.readyState=1,Yo(this)},t.send=function(a){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const h={headers:this.u,method:this.B,credentials:this.m,cache:void 0};a&&(h.body=a),(this.D||l).fetch(new Request(this.A,h)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Qo(this)),this.readyState=0},t.Sa=function(a){if(this.g&&(this.l=a,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=a.headers,this.readyState=2,Yo(this)),this.g&&(this.readyState=3,Yo(this),this.g)))if(this.responseType==="arraybuffer")a.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in a){if(this.j=a.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Gg(this)}else a.text().then(this.Ra.bind(this),this.ga.bind(this))};function Gg(a){a.j.read().then(a.Pa.bind(a)).catch(a.ga.bind(a))}t.Pa=function(a){if(this.g){if(this.o&&a.value)this.response.push(a.value);else if(!this.o){var h=a.value?a.value:new Uint8Array(0);(h=this.v.decode(h,{stream:!a.done}))&&(this.response=this.responseText+=h)}a.done?Qo(this):Yo(this),this.readyState==3&&Gg(this)}},t.Ra=function(a){this.g&&(this.response=this.responseText=a,Qo(this))},t.Qa=function(a){this.g&&(this.response=a,Qo(this))},t.ga=function(){this.g&&Qo(this)};function Qo(a){a.readyState=4,a.l=null,a.j=null,a.v=null,Yo(a)}t.setRequestHeader=function(a,h){this.u.append(a,h)},t.getResponseHeader=function(a){return this.h&&this.h.get(a.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const a=[],h=this.h.entries();for(var g=h.next();!g.done;)g=g.value,a.push(g[0]+": "+g[1]),g=h.next();return a.join(`\r
`)};function Yo(a){a.onreadystatechange&&a.onreadystatechange.call(a)}Object.defineProperty(Wl.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(a){this.m=a?"include":"same-origin"}});function Kg(a){let h="";return L(a,function(g,T){h+=T,h+=":",h+=g,h+=`\r
`}),h}function Hd(a,h,g){e:{for(T in g){var T=!1;break e}T=!0}T||(g=Kg(g),typeof a=="string"?g!=null&&encodeURIComponent(String(g)):We(a,h,g))}function it(a){ct.call(this),this.headers=new Map,this.o=a||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}w(it,ct);var ES=/^https?$/i,TS=["POST","PUT"];t=it.prototype,t.Ha=function(a){this.J=a},t.ea=function(a,h,g,T){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+a);h=h?h.toUpperCase():"GET",this.D=a,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Ud.g(),this.v=this.o?Vl(this.o):Vl(Ud),this.g.onreadystatechange=m(this.Ea,this);try{this.B=!0,this.g.open(h,String(a),!0),this.B=!1}catch(V){Qg(this,V);return}if(a=g||"",g=new Map(this.headers),T)if(Object.getPrototypeOf(T)===Object.prototype)for(var D in T)g.set(D,T[D]);else if(typeof T.keys=="function"&&typeof T.get=="function")for(const V of T.keys())g.set(V,T.get(V));else throw Error("Unknown input type for opt_headers: "+String(T));T=Array.from(g.keys()).find(V=>V.toLowerCase()=="content-type"),D=l.FormData&&a instanceof l.FormData,!(0<=Array.prototype.indexOf.call(TS,h,void 0))||T||D||g.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[V,W]of g)this.g.setRequestHeader(V,W);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Xg(this),this.u=!0,this.g.send(a),this.u=!1}catch(V){Qg(this,V)}};function Qg(a,h){a.h=!1,a.g&&(a.j=!0,a.g.abort(),a.j=!1),a.l=h,a.m=5,Yg(a),Hl(a)}function Yg(a){a.A||(a.A=!0,dt(a,"complete"),dt(a,"error"))}t.abort=function(a){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=a||7,dt(this,"complete"),dt(this,"abort"),Hl(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Hl(this,!0)),it.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?Jg(this):this.bb())},t.bb=function(){Jg(this)};function Jg(a){if(a.h&&typeof o<"u"&&(!a.v[1]||Nr(a)!=4||a.Z()!=2)){if(a.u&&Nr(a)==4)jl(a.Ea,0,a);else if(dt(a,"readystatechange"),Nr(a)==4){a.h=!1;try{const W=a.Z();e:switch(W){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var h=!0;break e;default:h=!1}var g;if(!(g=h)){var T;if(T=W===0){var D=String(a.D).match($g)[1]||null;!D&&l.self&&l.self.location&&(D=l.self.location.protocol.slice(0,-1)),T=!ES.test(D?D.toLowerCase():"")}g=T}if(g)dt(a,"complete"),dt(a,"success");else{a.m=6;try{var V=2<Nr(a)?a.g.statusText:""}catch{V=""}a.l=V+" ["+a.Z()+"]",Yg(a)}}finally{Hl(a)}}}}function Hl(a,h){if(a.g){Xg(a);const g=a.g,T=a.v[0]?()=>{}:null;a.g=null,a.v=null,h||dt(a,"ready");try{g.onreadystatechange=T}catch{}}}function Xg(a){a.I&&(l.clearTimeout(a.I),a.I=null)}t.isActive=function(){return!!this.g};function Nr(a){return a.g?a.g.readyState:0}t.Z=function(){try{return 2<Nr(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(a){if(this.g){var h=this.g.responseText;return a&&h.indexOf(a)==0&&(h=h.substring(a.length)),Ld(h)}};function Zg(a){try{if(!a.g)return null;if("response"in a.g)return a.g.response;switch(a.H){case"":case"text":return a.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in a.g)return a.g.mozResponseArrayBuffer}return null}catch{return null}}function IS(a){const h={};a=(a.g&&2<=Nr(a)&&a.g.getAllResponseHeaders()||"").split(`\r
`);for(let T=0;T<a.length;T++){if(v(a[T]))continue;var g=P(a[T]);const D=g[0];if(g=g[1],typeof g!="string")continue;g=g.trim();const V=h[D]||[];h[D]=V,V.push(g)}S(h,function(T){return T.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Jo(a,h,g){return g&&g.internalChannelParams&&g.internalChannelParams[a]||h}function ey(a){this.Aa=0,this.i=[],this.j=new ce,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Jo("failFast",!1,a),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Jo("baseRetryDelayMs",5e3,a),this.cb=Jo("retryDelaySeedMs",1e4,a),this.Wa=Jo("forwardChannelMaxRetries",2,a),this.wa=Jo("forwardChannelRequestTimeoutMs",2e4,a),this.pa=a&&a.xmlHttpFactory||void 0,this.Xa=a&&a.Tb||void 0,this.Ca=a&&a.useFetchStreams||!1,this.L=void 0,this.J=a&&a.supportsCrossDomainXhr||!1,this.K="",this.h=new Og(a&&a.concurrentRequestLimit),this.Da=new wS,this.P=a&&a.fastHandshake||!1,this.O=a&&a.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=a&&a.Rb||!1,a&&a.xa&&this.j.xa(),a&&a.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&a&&a.detectBufferingProxy||!1,this.ja=void 0,a&&a.longPollingTimeout&&0<a.longPollingTimeout&&(this.ja=a.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=ey.prototype,t.la=8,t.G=1,t.connect=function(a,h,g,T){ie(0),this.W=a,this.H=h||{},g&&T!==void 0&&(this.H.OSID=g,this.H.OAID=T),this.F=this.X,this.I=uy(this,null,this.W),Kl(this)};function Gd(a){if(ty(a),a.G==3){var h=a.U++,g=Sr(a.I);if(We(g,"SID",a.K),We(g,"RID",h),We(g,"TYPE","terminate"),Xo(a,g),h=new Zr(a,a.j,h),h.L=2,h.v=zl(Sr(g)),g=!1,l.navigator&&l.navigator.sendBeacon)try{g=l.navigator.sendBeacon(h.v.toString(),"")}catch{}!g&&l.Image&&(new Image().src=h.v,g=!0),g||(h.g=cy(h.j,null),h.g.ea(h.v)),h.F=Date.now(),Fl(h)}ly(a)}function Gl(a){a.g&&(Qd(a),a.g.cancel(),a.g=null)}function ty(a){Gl(a),a.u&&(l.clearTimeout(a.u),a.u=null),Ql(a),a.h.cancel(),a.s&&(typeof a.s=="number"&&l.clearTimeout(a.s),a.s=null)}function Kl(a){if(!Vg(a.h)&&!a.s){a.s=!0;var h=a.Ga;Q||J(),B||(Q(),B=!0),K.add(h,a),a.B=0}}function SS(a,h){return Lg(a.h)>=a.h.j-(a.s?1:0)?!1:a.s?(a.i=h.D.concat(a.i),!0):a.G==1||a.G==2||a.B>=(a.Va?0:a.Wa)?!1:(a.s=ue(m(a.Ga,a,h),ay(a,a.B)),a.B++,!0)}t.Ga=function(a){if(this.s)if(this.s=null,this.G==1){if(!a){this.U=Math.floor(1e5*Math.random()),a=this.U++;const D=new Zr(this,this.j,a);let V=this.o;if(this.S&&(V?(V=_(V),N(V,this.S)):V=this.S),this.m!==null||this.O||(D.H=V,V=null),this.P)e:{for(var h=0,g=0;g<this.i.length;g++){t:{var T=this.i[g];if("__data__"in T.map&&(T=T.map.__data__,typeof T=="string")){T=T.length;break t}T=void 0}if(T===void 0)break;if(h+=T,4096<h){h=g;break e}if(h===4096||g===this.i.length-1){h=g+1;break e}}h=1e3}else h=1e3;h=ry(this,D,h),g=Sr(this.I),We(g,"RID",a),We(g,"CVER",22),this.D&&We(g,"X-HTTP-Session-Id",this.D),Xo(this,g),V&&(this.O?h="headers="+encodeURIComponent(String(Kg(V)))+"&"+h:this.m&&Hd(g,this.m,V)),Wd(this.h,D),this.Ua&&We(g,"TYPE","init"),this.P?(We(g,"$req",h),We(g,"SID","null"),D.T=!0,$d(D,g,null)):$d(D,g,h),this.G=2}}else this.G==3&&(a?ny(this,a):this.i.length==0||Vg(this.h)||ny(this))};function ny(a,h){var g;h?g=h.l:g=a.U++;const T=Sr(a.I);We(T,"SID",a.K),We(T,"RID",g),We(T,"AID",a.T),Xo(a,T),a.m&&a.o&&Hd(T,a.m,a.o),g=new Zr(a,a.j,g,a.B+1),a.m===null&&(g.H=a.o),h&&(a.i=h.D.concat(a.i)),h=ry(a,g,1e3),g.I=Math.round(.5*a.wa)+Math.round(.5*a.wa*Math.random()),Wd(a.h,g),$d(g,T,h)}function Xo(a,h){a.H&&L(a.H,function(g,T){We(h,T,g)}),a.l&&Fg({},function(g,T){We(h,T,g)})}function ry(a,h,g){g=Math.min(a.i.length,g);var T=a.l?m(a.l.Na,a.l,a):null;e:{var D=a.i;let V=-1;for(;;){const W=["count="+g];V==-1?0<g?(V=D[0].g,W.push("ofs="+V)):V=0:W.push("ofs="+V);let Me=!0;for(let Rt=0;Rt<g;Rt++){let Ce=D[Rt].g;const Mt=D[Rt].map;if(Ce-=V,0>Ce)V=Math.max(0,D[Rt].g-100),Me=!1;else try{xS(Mt,W,"req"+Ce+"_")}catch{T&&T(Mt)}}if(Me){T=W.join("&");break e}}}return a=a.i.splice(0,g),h.D=a,T}function sy(a){if(!a.g&&!a.u){a.Y=1;var h=a.Fa;Q||J(),B||(Q(),B=!0),K.add(h,a),a.v=0}}function Kd(a){return a.g||a.u||3<=a.v?!1:(a.Y++,a.u=ue(m(a.Fa,a),ay(a,a.v)),a.v++,!0)}t.Fa=function(){if(this.u=null,iy(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var a=2*this.R;this.j.info("BP detection timer enabled: "+a),this.A=ue(m(this.ab,this),a)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,ie(10),Gl(this),iy(this))};function Qd(a){a.A!=null&&(l.clearTimeout(a.A),a.A=null)}function iy(a){a.g=new Zr(a,a.j,"rpc",a.Y),a.m===null&&(a.g.H=a.o),a.g.O=0;var h=Sr(a.qa);We(h,"RID","rpc"),We(h,"SID",a.K),We(h,"AID",a.T),We(h,"CI",a.F?"0":"1"),!a.F&&a.ja&&We(h,"TO",a.ja),We(h,"TYPE","xmlhttp"),Xo(a,h),a.m&&a.o&&Hd(h,a.m,a.o),a.L&&(a.g.I=a.L);var g=a.g;a=a.ia,g.L=1,g.v=zl(Sr(h)),g.m=null,g.P=!0,Pg(g,a)}t.Za=function(){this.C!=null&&(this.C=null,Gl(this),Kd(this),ie(19))};function Ql(a){a.C!=null&&(l.clearTimeout(a.C),a.C=null)}function oy(a,h){var g=null;if(a.g==h){Ql(a),Qd(a),a.g=null;var T=2}else if(qd(a.h,h))g=h.D,Mg(a.h,h),T=1;else return;if(a.G!=0){if(h.o)if(T==1){g=h.m?h.m.length:0,h=Date.now()-h.F;var D=a.B;T=Hs(),dt(T,new Re(T,g)),Kl(a)}else sy(a);else if(D=h.s,D==3||D==0&&0<h.X||!(T==1&&SS(a,h)||T==2&&Kd(a)))switch(g&&0<g.length&&(h=a.h,h.i=h.i.concat(g)),D){case 1:Qs(a,5);break;case 4:Qs(a,10);break;case 3:Qs(a,6);break;default:Qs(a,2)}}}function ay(a,h){let g=a.Ta+Math.floor(Math.random()*a.cb);return a.isActive()||(g*=2),g*h}function Qs(a,h){if(a.j.info("Error code "+h),h==2){var g=m(a.fb,a),T=a.Xa;const D=!T;T=new Ks(T||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||$l(T,"https"),zl(T),D?vS(T.toString(),g):_S(T.toString(),g)}else ie(2);a.G=0,a.l&&a.l.sa(h),ly(a),ty(a)}t.fb=function(a){a?(this.j.info("Successfully pinged google.com"),ie(2)):(this.j.info("Failed to ping google.com"),ie(1))};function ly(a){if(a.G=0,a.ka=[],a.l){const h=Ug(a.h);(h.length!=0||a.i.length!=0)&&(b(a.ka,h),b(a.ka,a.i),a.h.i.length=0,A(a.i),a.i.length=0),a.l.ra()}}function uy(a,h,g){var T=g instanceof Ks?Sr(g):new Ks(g);if(T.g!="")h&&(T.g=h+"."+T.g),Bl(T,T.s);else{var D=l.location;T=D.protocol,h=h?h+"."+D.hostname:D.hostname,D=+D.port;var V=new Ks(null);T&&$l(V,T),h&&(V.g=h),D&&Bl(V,D),g&&(V.l=g),T=V}return g=a.D,h=a.ya,g&&h&&We(T,g,h),We(T,"VER",a.la),Xo(a,T),T}function cy(a,h,g){if(h&&!a.J)throw Error("Can't create secondary domain capable XhrIo object.");return h=a.Ca&&!a.pa?new it(new ql({eb:g})):new it(a.pa),h.Ha(a.J),h}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function dy(){}t=dy.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function Yl(){}Yl.prototype.g=function(a,h){return new mn(a,h)};function mn(a,h){ct.call(this),this.g=new ey(h),this.l=a,this.h=h&&h.messageUrlParams||null,a=h&&h.messageHeaders||null,h&&h.clientProtocolHeaderRequired&&(a?a["X-Client-Protocol"]="webchannel":a={"X-Client-Protocol":"webchannel"}),this.g.o=a,a=h&&h.initMessageHeaders||null,h&&h.messageContentType&&(a?a["X-WebChannel-Content-Type"]=h.messageContentType:a={"X-WebChannel-Content-Type":h.messageContentType}),h&&h.va&&(a?a["X-WebChannel-Client-Profile"]=h.va:a={"X-WebChannel-Client-Profile":h.va}),this.g.S=a,(a=h&&h.Sb)&&!v(a)&&(this.g.m=a),this.v=h&&h.supportsCrossDomainXhr||!1,this.u=h&&h.sendRawJson||!1,(h=h&&h.httpSessionIdParam)&&!v(h)&&(this.g.D=h,a=this.h,a!==null&&h in a&&(a=this.h,h in a&&delete a[h])),this.j=new Li(this)}w(mn,ct),mn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},mn.prototype.close=function(){Gd(this.g)},mn.prototype.o=function(a){var h=this.g;if(typeof a=="string"){var g={};g.__data__=a,a=g}else this.u&&(g={},g.__data__=Bo(a),a=g);h.i.push(new lS(h.Ya++,a)),h.G==3&&Kl(h)},mn.prototype.N=function(){this.g.l=null,delete this.j,Gd(this.g),delete this.g,mn.aa.N.call(this)};function hy(a){Di.call(this),a.__headers__&&(this.headers=a.__headers__,this.statusCode=a.__status__,delete a.__headers__,delete a.__status__);var h=a.__sm__;if(h){e:{for(const g in h){a=g;break e}a=void 0}(this.i=a)&&(a=this.i,h=h!==null&&a in h?h[a]:void 0),this.data=h}else this.data=a}w(hy,Di);function fy(){qo.call(this),this.status=1}w(fy,qo);function Li(a){this.g=a}w(Li,dy),Li.prototype.ua=function(){dt(this.g,"a")},Li.prototype.ta=function(a){dt(this.g,new hy(a))},Li.prototype.sa=function(a){dt(this.g,new fy)},Li.prototype.ra=function(){dt(this.g,"b")},Yl.prototype.createWebChannel=Yl.prototype.g,mn.prototype.send=mn.prototype.o,mn.prototype.open=mn.prototype.m,mn.prototype.close=mn.prototype.close,QE=function(){return new Yl},KE=function(){return Hs()},GE=ar,Xf={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Ml.NO_ERROR=0,Ml.TIMEOUT=8,Ml.HTTP_ERROR=6,Uu=Ml,Cg.COMPLETE="complete",HE=Cg,or.EventType=Ws,Ws.OPEN="a",Ws.CLOSE="b",Ws.ERROR="c",Ws.MESSAGE="d",ct.prototype.listen=ct.prototype.K,fa=or,it.prototype.listenOnce=it.prototype.L,it.prototype.getLastError=it.prototype.Ka,it.prototype.getLastErrorCode=it.prototype.Ba,it.prototype.getStatus=it.prototype.Z,it.prototype.getResponseJson=it.prototype.Oa,it.prototype.getResponseText=it.prototype.oa,it.prototype.send=it.prototype.ea,it.prototype.setWithCredentials=it.prototype.Ha,WE=it}).apply(typeof yu<"u"?yu:typeof self<"u"?self:typeof window<"u"?window:{});const a_="@firebase/firestore",l_="4.9.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zt{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}zt.UNAUTHENTICATED=new zt(null),zt.GOOGLE_CREDENTIALS=new zt("google-credentials-uid"),zt.FIRST_PARTY=new zt("first-party-uid"),zt.MOCK_USER=new zt("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Lo="12.0.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gi=new ym("@firebase/firestore");function Fi(){return gi.logLevel}function Y(t,...e){if(gi.logLevel<=xe.DEBUG){const n=e.map(Dm);gi.debug(`Firestore (${Lo}): ${t}`,...n)}}function Wr(t,...e){if(gi.logLevel<=xe.ERROR){const n=e.map(Dm);gi.error(`Firestore (${Lo}): ${t}`,...n)}}function yi(t,...e){if(gi.logLevel<=xe.WARN){const n=e.map(Dm);gi.warn(`Firestore (${Lo}): ${t}`,...n)}}function Dm(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ae(t,e,n){let r="Unexpected state";typeof e=="string"?r=e:n=e,YE(t,r,n)}function YE(t,e,n){let r=`FIRESTORE (${Lo}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(n!==void 0)try{r+=" CONTEXT: "+JSON.stringify(n)}catch{r+=" CONTEXT: "+n}throw Wr(r),new Error(r)}function je(t,e,n,r){let s="Unexpected state";typeof n=="string"?s=n:r=n,t||YE(e,s,r)}function he(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const M={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class H extends nr{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gr{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JE{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class XE{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(zt.UNAUTHENTICATED))}shutdown(){}}class sP{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class iP{constructor(e){this.t=e,this.currentUser=zt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){je(this.o===void 0,42304);let r=this.i;const s=c=>this.i!==r?(r=this.i,n(c)):Promise.resolve();let i=new gr;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new gr,e.enqueueRetryable(()=>s(this.currentUser))};const o=()=>{const c=i;e.enqueueRetryable(async()=>{await c.promise,await s(this.currentUser)})},l=c=>{Y("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(c=>l(c)),setTimeout(()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?l(c):(Y("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new gr)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(Y("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(je(typeof r.accessToken=="string",31837,{l:r}),new JE(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return je(e===null||typeof e=="string",2055,{h:e}),new zt(e)}}class oP{constructor(e,n,r){this.P=e,this.T=n,this.I=r,this.type="FirstParty",this.user=zt.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class aP{constructor(e,n,r){this.P=e,this.T=n,this.I=r}getToken(){return Promise.resolve(new oP(this.P,this.T,this.I))}start(e,n){e.enqueueRetryable(()=>n(zt.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class u_{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class lP{constructor(e,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,an(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,n){je(this.o===void 0,3512);const r=i=>{i.error!=null&&Y("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.m;return this.m=i.token,Y("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>r(i))};const s=i=>{Y("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.V.getImmediate({optional:!0});i?s(i):Y("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new u_(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(je(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new u_(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uP(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dd{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const s=uP(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<n&&(r+=e.charAt(s[i]%62))}return r}}function Ee(t,e){return t<e?-1:t>e?1:0}function Zf(t,e){const n=Math.min(t.length,e.length);for(let r=0;r<n;r++){const s=t.charAt(r),i=e.charAt(r);if(s!==i)return Ph(s)===Ph(i)?Ee(s,i):Ph(s)?1:-1}return Ee(t.length,e.length)}const cP=55296,dP=57343;function Ph(t){const e=t.charCodeAt(0);return e>=cP&&e<=dP}function To(t,e,n){return t.length===e.length&&t.every((r,s)=>n(r,e[s]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ep="__name__";class cr{constructor(e,n,r){n===void 0?n=0:n>e.length&&ae(637,{offset:n,range:e.length}),r===void 0?r=e.length-n:r>e.length-n&&ae(1746,{length:r,range:e.length-n}),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return cr.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof cr?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let s=0;s<r;s++){const i=cr.compareSegments(e.get(s),n.get(s));if(i!==0)return i}return Ee(e.length,n.length)}static compareSegments(e,n){const r=cr.isNumericId(e),s=cr.isNumericId(n);return r&&!s?-1:!r&&s?1:r&&s?cr.extractNumericId(e).compare(cr.extractNumericId(n)):Zf(e,n)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return As.fromString(e.substring(4,e.length-2))}}class Ue extends cr{construct(e,n,r){return new Ue(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new H(M.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(s=>s.length>0))}return new Ue(n)}static emptyPath(){return new Ue([])}}const hP=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class bt extends cr{construct(e,n,r){return new bt(e,n,r)}static isValidIdentifier(e){return hP.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),bt.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===ep}static keyField(){return new bt([ep])}static fromServerFormat(e){const n=[];let r="",s=0;const i=()=>{if(r.length===0)throw new H(M.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;s<e.length;){const l=e[s];if(l==="\\"){if(s+1===e.length)throw new H(M.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[s+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new H(M.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=c,s+=2}else l==="`"?(o=!o,s++):l!=="."||o?(r+=l,s++):(i(),s++)}if(i(),o)throw new H(M.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new bt(n)}static emptyPath(){return new bt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ee{constructor(e){this.path=e}static fromPath(e){return new ee(Ue.fromString(e))}static fromName(e){return new ee(Ue.fromString(e).popFirst(5))}static empty(){return new ee(Ue.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Ue.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return Ue.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ee(new Ue(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Om(t,e,n){if(!n)throw new H(M.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function ZE(t,e,n,r){if(e===!0&&r===!0)throw new H(M.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function c_(t){if(!ee.isDocumentKey(t))throw new H(M.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function d_(t){if(ee.isDocumentKey(t))throw new H(M.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function eT(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function hd(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":ae(12329,{type:typeof t})}function Ct(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new H(M.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=hd(t);throw new H(M.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mt(t,e){const n={typeString:t};return e&&(n.value=e),n}function xl(t,e){if(!eT(t))throw new H(M.INVALID_ARGUMENT,"JSON must be an object");let n;for(const r in e)if(e[r]){const s=e[r].typeString,i="value"in e[r]?{value:e[r].value}:void 0;if(!(r in t)){n=`JSON missing required field: '${r}'`;break}const o=t[r];if(s&&typeof o!==s){n=`JSON field '${r}' must be a ${s}.`;break}if(i!==void 0&&o!==i.value){n=`Expected '${r}' field to equal '${i.value}'`;break}}if(n)throw new H(M.INVALID_ARGUMENT,n);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const h_=-62135596800,f_=1e6;class Be{static now(){return Be.fromMillis(Date.now())}static fromDate(e){return Be.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor((e-1e3*n)*f_);return new Be(n,r)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new H(M.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new H(M.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<h_)throw new H(M.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new H(M.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/f_}_compareTo(e){return this.seconds===e.seconds?Ee(this.nanoseconds,e.nanoseconds):Ee(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Be._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(xl(e,Be._jsonSchema))return new Be(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-h_;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Be._jsonSchemaVersion="firestore/timestamp/1.0",Be._jsonSchema={type:mt("string",Be._jsonSchemaVersion),seconds:mt("number"),nanoseconds:mt("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fe{static fromTimestamp(e){return new fe(e)}static min(){return new fe(new Be(0,0))}static max(){return new fe(new Be(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const el=-1;function fP(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,s=fe.fromTimestamp(r===1e9?new Be(n+1,0):new Be(n,r));return new js(s,ee.empty(),e)}function pP(t){return new js(t.readTime,t.key,el)}class js{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new js(fe.min(),ee.empty(),el)}static max(){return new js(fe.max(),ee.empty(),el)}}function mP(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=ee.comparator(t.documentKey,e.documentKey),n!==0?n:Ee(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gP="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class yP{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Mo(t){if(t.code!==M.FAILED_PRECONDITION||t.message!==gP)throw t;Y("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&ae(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new U((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(n,i).next(r,s)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof U?n:U.resolve(n)}catch(n){return U.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):U.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):U.reject(n)}static resolve(e){return new U((n,r)=>{n(e)})}static reject(e){return new U((n,r)=>{r(e)})}static waitFor(e){return new U((n,r)=>{let s=0,i=0,o=!1;e.forEach(l=>{++s,l.next(()=>{++i,o&&i===s&&n()},c=>r(c))}),o=!0,i===s&&n()})}static or(e){let n=U.resolve(!1);for(const r of e)n=n.next(s=>s?U.resolve(s):r());return n}static forEach(e,n){const r=[];return e.forEach((s,i)=>{r.push(n.call(this,s,i))}),this.waitFor(r)}static mapArray(e,n){return new U((r,s)=>{const i=e.length,o=new Array(i);let l=0;for(let c=0;c<i;c++){const d=c;n(e[d]).next(f=>{o[d]=f,++l,l===i&&r(o)},f=>s(f))}})}static doWhile(e,n){return new U((r,s)=>{const i=()=>{e()===!0?n().next(()=>{i()},s):r()};i()})}}function vP(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function Uo(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fd{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>n.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}fd.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vm=-1;function pd(t){return t==null}function Sc(t){return t===0&&1/t==-1/0}function _P(t){return typeof t=="number"&&Number.isInteger(t)&&!Sc(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tT="";function wP(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=p_(e)),e=xP(t.get(n),e);return p_(e)}function xP(t,e){let n=e;const r=t.length;for(let s=0;s<r;s++){const i=t.charAt(s);switch(i){case"\0":n+="";break;case tT:n+="";break;default:n+=i}}return n}function p_(t){return t+tT+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function m_(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Bs(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function EP(t,e){const n=[];for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&n.push(e(t[r],r,t));return n}function nT(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rt{constructor(e,n){this.comparator=e,this.root=n||jt.EMPTY}insert(e,n){return new rt(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,jt.BLACK,null,null))}remove(e){return new rt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,jt.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return n+r.left.size;s<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new vu(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new vu(this.root,e,this.comparator,!1)}getReverseIterator(){return new vu(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new vu(this.root,e,this.comparator,!0)}}class vu{constructor(e,n,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=n?r(e.key,n):1,n&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class jt{constructor(e,n,r,s,i){this.key=e,this.value=n,this.color=r??jt.RED,this.left=s??jt.EMPTY,this.right=i??jt.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,s,i){return new jt(e??this.key,n??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,n,r),null):i===0?s.copy(null,n,null,null,null):s.copy(null,null,null,null,s.right.insert(e,n,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return jt.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,s=this;if(n(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),n(e,s.key)===0){if(s.right.isEmpty())return jt.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,jt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,jt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw ae(43730,{key:this.key,value:this.value});if(this.right.isRed())throw ae(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw ae(27949);return e+(this.isRed()?0:1)}}jt.EMPTY=null,jt.RED=!0,jt.BLACK=!1;jt.EMPTY=new class{constructor(){this.size=0}get key(){throw ae(57766)}get value(){throw ae(16141)}get color(){throw ae(16727)}get left(){throw ae(29726)}get right(){throw ae(36894)}copy(e,n,r,s,i){return this}insert(e,n,r){return new jt(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _t{constructor(e){this.comparator=e,this.data=new rt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;n(s.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new g_(this.data.getIterator())}getIteratorFrom(e){return new g_(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof _t)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new _t(this.comparator);return n.data=e,n}}class g_{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _n{constructor(e){this.fields=e,e.sort(bt.comparator)}static empty(){return new _n([])}unionWith(e){let n=new _t(bt.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new _n(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return To(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rT extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kt{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new rT("Invalid base64 string: "+i):i}}(e);return new kt(n)}static fromUint8Array(e){const n=function(s){let i="";for(let o=0;o<s.length;++o)i+=String.fromCharCode(s[o]);return i}(e);return new kt(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Ee(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}kt.EMPTY_BYTE_STRING=new kt("");const TP=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ds(t){if(je(!!t,39018),typeof t=="string"){let e=0;const n=TP.exec(t);if(je(!!n,46558,{timestamp:t}),n[1]){let s=n[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:lt(t.seconds),nanos:lt(t.nanos)}}function lt(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Os(t){return typeof t=="string"?kt.fromBase64String(t):kt.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sT="server_timestamp",iT="__type__",oT="__previous_value__",aT="__local_write_time__";function Lm(t){var n,r;return((r=(((n=t==null?void 0:t.mapValue)==null?void 0:n.fields)||{})[iT])==null?void 0:r.stringValue)===sT}function md(t){const e=t.mapValue.fields[oT];return Lm(e)?md(e):e}function tl(t){const e=Ds(t.mapValue.fields[aT].timestampValue);return new Be(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IP{constructor(e,n,r,s,i,o,l,c,d,f){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=l,this.longPollingOptions=c,this.useFetchStreams=d,this.isUsingEmulator=f}}const Nc="(default)";class Io{constructor(e,n){this.projectId=e,this.database=n||Nc}static empty(){return new Io("","")}get isDefaultDatabase(){return this.database===Nc}isEqual(e){return e instanceof Io&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lT="__type__",SP="__max__",_u={mapValue:{}},uT="__vector__",bc="value";function Vs(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Lm(t)?4:bP(t)?9007199254740991:NP(t)?10:11:ae(28295,{value:t})}function wr(t,e){if(t===e)return!0;const n=Vs(t);if(n!==Vs(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return tl(t).isEqual(tl(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const o=Ds(s.timestampValue),l=Ds(i.timestampValue);return o.seconds===l.seconds&&o.nanos===l.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,i){return Os(s.bytesValue).isEqual(Os(i.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,i){return lt(s.geoPointValue.latitude)===lt(i.geoPointValue.latitude)&&lt(s.geoPointValue.longitude)===lt(i.geoPointValue.longitude)}(t,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return lt(s.integerValue)===lt(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const o=lt(s.doubleValue),l=lt(i.doubleValue);return o===l?Sc(o)===Sc(l):isNaN(o)&&isNaN(l)}return!1}(t,e);case 9:return To(t.arrayValue.values||[],e.arrayValue.values||[],wr);case 10:case 11:return function(s,i){const o=s.mapValue.fields||{},l=i.mapValue.fields||{};if(m_(o)!==m_(l))return!1;for(const c in o)if(o.hasOwnProperty(c)&&(l[c]===void 0||!wr(o[c],l[c])))return!1;return!0}(t,e);default:return ae(52216,{left:t})}}function nl(t,e){return(t.values||[]).find(n=>wr(n,e))!==void 0}function So(t,e){if(t===e)return 0;const n=Vs(t),r=Vs(e);if(n!==r)return Ee(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return Ee(t.booleanValue,e.booleanValue);case 2:return function(i,o){const l=lt(i.integerValue||i.doubleValue),c=lt(o.integerValue||o.doubleValue);return l<c?-1:l>c?1:l===c?0:isNaN(l)?isNaN(c)?0:-1:1}(t,e);case 3:return y_(t.timestampValue,e.timestampValue);case 4:return y_(tl(t),tl(e));case 5:return Zf(t.stringValue,e.stringValue);case 6:return function(i,o){const l=Os(i),c=Os(o);return l.compareTo(c)}(t.bytesValue,e.bytesValue);case 7:return function(i,o){const l=i.split("/"),c=o.split("/");for(let d=0;d<l.length&&d<c.length;d++){const f=Ee(l[d],c[d]);if(f!==0)return f}return Ee(l.length,c.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,o){const l=Ee(lt(i.latitude),lt(o.latitude));return l!==0?l:Ee(lt(i.longitude),lt(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return v_(t.arrayValue,e.arrayValue);case 10:return function(i,o){var m,y,w,A;const l=i.fields||{},c=o.fields||{},d=(m=l[bc])==null?void 0:m.arrayValue,f=(y=c[bc])==null?void 0:y.arrayValue,p=Ee(((w=d==null?void 0:d.values)==null?void 0:w.length)||0,((A=f==null?void 0:f.values)==null?void 0:A.length)||0);return p!==0?p:v_(d,f)}(t.mapValue,e.mapValue);case 11:return function(i,o){if(i===_u.mapValue&&o===_u.mapValue)return 0;if(i===_u.mapValue)return 1;if(o===_u.mapValue)return-1;const l=i.fields||{},c=Object.keys(l),d=o.fields||{},f=Object.keys(d);c.sort(),f.sort();for(let p=0;p<c.length&&p<f.length;++p){const m=Zf(c[p],f[p]);if(m!==0)return m;const y=So(l[c[p]],d[f[p]]);if(y!==0)return y}return Ee(c.length,f.length)}(t.mapValue,e.mapValue);default:throw ae(23264,{he:n})}}function y_(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Ee(t,e);const n=Ds(t),r=Ds(e),s=Ee(n.seconds,r.seconds);return s!==0?s:Ee(n.nanos,r.nanos)}function v_(t,e){const n=t.values||[],r=e.values||[];for(let s=0;s<n.length&&s<r.length;++s){const i=So(n[s],r[s]);if(i)return i}return Ee(n.length,r.length)}function No(t){return tp(t)}function tp(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=Ds(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return Os(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return ee.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",s=!0;for(const i of n.values||[])s?s=!1:r+=",",r+=tp(i);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let s="{",i=!0;for(const o of r)i?i=!1:s+=",",s+=`${o}:${tp(n.fields[o])}`;return s+"}"}(t.mapValue):ae(61005,{value:t})}function Fu(t){switch(Vs(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=md(t);return e?16+Fu(e):16;case 5:return 2*t.stringValue.length;case 6:return Os(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((s,i)=>s+Fu(i),0)}(t.arrayValue);case 10:case 11:return function(r){let s=0;return Bs(r.fields,(i,o)=>{s+=i.length+Fu(o)}),s}(t.mapValue);default:throw ae(13486,{value:t})}}function __(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function np(t){return!!t&&"integerValue"in t}function Mm(t){return!!t&&"arrayValue"in t}function w_(t){return!!t&&"nullValue"in t}function x_(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function $u(t){return!!t&&"mapValue"in t}function NP(t){var n,r;return((r=(((n=t==null?void 0:t.mapValue)==null?void 0:n.fields)||{})[lT])==null?void 0:r.stringValue)===uT}function ba(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return Bs(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=ba(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=ba(t.arrayValue.values[n]);return e}return{...t}}function bP(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===SP}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ln{constructor(e){this.value=e}static empty(){return new ln({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!$u(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=ba(n)}setAll(e){let n=bt.emptyPath(),r={},s=[];e.forEach((o,l)=>{if(!n.isImmediateParentOf(l)){const c=this.getFieldsMap(n);this.applyChanges(c,r,s),r={},s=[],n=l.popLast()}o?r[l.lastSegment()]=ba(o):s.push(l.lastSegment())});const i=this.getFieldsMap(n);this.applyChanges(i,r,s)}delete(e){const n=this.field(e.popLast());$u(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return wr(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=n.mapValue.fields[e.get(r)];$u(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=s),n=s}return n.mapValue.fields}applyChanges(e,n,r){Bs(n,(s,i)=>e[s]=i);for(const s of r)delete e[s]}clone(){return new ln(ba(this.value))}}function cT(t){const e=[];return Bs(t.fields,(n,r)=>{const s=new bt([n]);if($u(r)){const i=cT(r.mapValue).fields;if(i.length===0)e.push(s);else for(const o of i)e.push(s.child(o))}else e.push(s)}),new _n(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wt{constructor(e,n,r,s,i,o,l){this.key=e,this.documentType=n,this.version=r,this.readTime=s,this.createTime=i,this.data=o,this.documentState=l}static newInvalidDocument(e){return new Wt(e,0,fe.min(),fe.min(),fe.min(),ln.empty(),0)}static newFoundDocument(e,n,r,s){return new Wt(e,1,n,fe.min(),r,s,0)}static newNoDocument(e,n){return new Wt(e,2,n,fe.min(),fe.min(),ln.empty(),0)}static newUnknownDocument(e,n){return new Wt(e,3,n,fe.min(),fe.min(),ln.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(fe.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=ln.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=ln.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=fe.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Wt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Wt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ac{constructor(e,n){this.position=e,this.inclusive=n}}function E_(t,e,n){let r=0;for(let s=0;s<t.position.length;s++){const i=e[s],o=t.position[s];if(i.field.isKeyField()?r=ee.comparator(ee.fromName(o.referenceValue),n.key):r=So(o,n.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function T_(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!wr(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rl{constructor(e,n="asc"){this.field=e,this.dir=n}}function AP(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dT{}class pt extends dT{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new kP(e,n,r):n==="array-contains"?new jP(e,r):n==="in"?new DP(e,r):n==="not-in"?new OP(e,r):n==="array-contains-any"?new VP(e,r):new pt(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new RP(e,r):new PP(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(So(n,this.value)):n!==null&&Vs(this.value)===Vs(n)&&this.matchesComparison(So(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return ae(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class tr extends dT{constructor(e,n){super(),this.filters=e,this.op=n,this.Pe=null}static create(e,n){return new tr(e,n)}matches(e){return hT(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function hT(t){return t.op==="and"}function fT(t){return CP(t)&&hT(t)}function CP(t){for(const e of t.filters)if(e instanceof tr)return!1;return!0}function rp(t){if(t instanceof pt)return t.field.canonicalString()+t.op.toString()+No(t.value);if(fT(t))return t.filters.map(e=>rp(e)).join(",");{const e=t.filters.map(n=>rp(n)).join(",");return`${t.op}(${e})`}}function pT(t,e){return t instanceof pt?function(r,s){return s instanceof pt&&r.op===s.op&&r.field.isEqual(s.field)&&wr(r.value,s.value)}(t,e):t instanceof tr?function(r,s){return s instanceof tr&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce((i,o,l)=>i&&pT(o,s.filters[l]),!0):!1}(t,e):void ae(19439)}function mT(t){return t instanceof pt?function(n){return`${n.field.canonicalString()} ${n.op} ${No(n.value)}`}(t):t instanceof tr?function(n){return n.op.toString()+" {"+n.getFilters().map(mT).join(" ,")+"}"}(t):"Filter"}class kP extends pt{constructor(e,n,r){super(e,n,r),this.key=ee.fromName(r.referenceValue)}matches(e){const n=ee.comparator(e.key,this.key);return this.matchesComparison(n)}}class RP extends pt{constructor(e,n){super(e,"in",n),this.keys=gT("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class PP extends pt{constructor(e,n){super(e,"not-in",n),this.keys=gT("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function gT(t,e){var n;return(((n=e.arrayValue)==null?void 0:n.values)||[]).map(r=>ee.fromName(r.referenceValue))}class jP extends pt{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return Mm(n)&&nl(n.arrayValue,this.value)}}class DP extends pt{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&nl(this.value.arrayValue,n)}}class OP extends pt{constructor(e,n){super(e,"not-in",n)}matches(e){if(nl(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&n.nullValue===void 0&&!nl(this.value.arrayValue,n)}}class VP extends pt{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!Mm(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>nl(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LP{constructor(e,n=null,r=[],s=[],i=null,o=null,l=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=o,this.endAt=l,this.Te=null}}function I_(t,e=null,n=[],r=[],s=null,i=null,o=null){return new LP(t,e,n,r,s,i,o)}function Um(t){const e=he(t);if(e.Te===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>rp(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(i){return i.field.canonicalString()+i.dir}(r)).join(","),pd(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>No(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>No(r)).join(",")),e.Te=n}return e.Te}function Fm(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!AP(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!pT(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!T_(t.startAt,e.startAt)&&T_(t.endAt,e.endAt)}function sp(t){return ee.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bi{constructor(e,n=null,r=[],s=[],i=null,o="F",l=null,c=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=o,this.startAt=l,this.endAt=c,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function MP(t,e,n,r,s,i,o,l){return new bi(t,e,n,r,s,i,o,l)}function gd(t){return new bi(t)}function S_(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function yT(t){return t.collectionGroup!==null}function Aa(t){const e=he(t);if(e.Ie===null){e.Ie=[];const n=new Set;for(const i of e.explicitOrderBy)e.Ie.push(i),n.add(i.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let l=new _t(bt.comparator);return o.filters.forEach(c=>{c.getFlattenedFilters().forEach(d=>{d.isInequality()&&(l=l.add(d.field))})}),l})(e).forEach(i=>{n.has(i.canonicalString())||i.isKeyField()||e.Ie.push(new rl(i,r))}),n.has(bt.keyField().canonicalString())||e.Ie.push(new rl(bt.keyField(),r))}return e.Ie}function yr(t){const e=he(t);return e.Ee||(e.Ee=vT(e,Aa(t))),e.Ee}function UP(t){const e=he(t);return e.de||(e.de=vT(e,t.explicitOrderBy)),e.de}function vT(t,e){if(t.limitType==="F")return I_(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new rl(s.field,i)});const n=t.endAt?new Ac(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new Ac(t.startAt.position,t.startAt.inclusive):null;return I_(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function ip(t,e){const n=t.filters.concat([e]);return new bi(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function Cc(t,e,n){return new bi(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function yd(t,e){return Fm(yr(t),yr(e))&&t.limitType===e.limitType}function _T(t){return`${Um(yr(t))}|lt:${t.limitType}`}function $i(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(s=>mT(s)).join(", ")}]`),pd(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(s=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(s)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(s=>No(s)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(s=>No(s)).join(",")),`Target(${r})`}(yr(t))}; limitType=${t.limitType})`}function vd(t,e){return e.isFoundDocument()&&function(r,s){const i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):ee.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)}(t,e)&&function(r,s){for(const i of Aa(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(t,e)&&function(r,s){for(const i of r.filters)if(!i.matches(s))return!1;return!0}(t,e)&&function(r,s){return!(r.startAt&&!function(o,l,c){const d=E_(o,l,c);return o.inclusive?d<=0:d<0}(r.startAt,Aa(r),s)||r.endAt&&!function(o,l,c){const d=E_(o,l,c);return o.inclusive?d>=0:d>0}(r.endAt,Aa(r),s))}(t,e)}function FP(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function wT(t){return(e,n)=>{let r=!1;for(const s of Aa(t)){const i=$P(s,e,n);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function $P(t,e,n){const r=t.field.isKeyField()?ee.comparator(e.key,n.key):function(i,o,l){const c=o.data.field(i),d=l.data.field(i);return c!==null&&d!==null?So(c,d):ae(42886)}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return ae(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ai{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,n]);s.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[n]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){Bs(this.inner,(n,r)=>{for(const[s,i]of r)e(s,i)})}isEmpty(){return nT(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BP=new rt(ee.comparator);function Hr(){return BP}const xT=new rt(ee.comparator);function pa(...t){let e=xT;for(const n of t)e=e.insert(n.key,n);return e}function ET(t){let e=xT;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function si(){return Ca()}function TT(){return Ca()}function Ca(){return new Ai(t=>t.toString(),(t,e)=>t.isEqual(e))}const zP=new rt(ee.comparator),qP=new _t(ee.comparator);function Te(...t){let e=qP;for(const n of t)e=e.add(n);return e}const WP=new _t(Ee);function HP(){return WP}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $m(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Sc(e)?"-0":e}}function IT(t){return{integerValue:""+t}}function GP(t,e){return _P(e)?IT(e):$m(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _d{constructor(){this._=void 0}}function KP(t,e,n){return t instanceof sl?function(s,i){const o={fields:{[iT]:{stringValue:sT},[aT]:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&Lm(i)&&(i=md(i)),i&&(o.fields[oT]=i),{mapValue:o}}(n,e):t instanceof il?NT(t,e):t instanceof ol?bT(t,e):function(s,i){const o=ST(s,i),l=N_(o)+N_(s.Ae);return np(o)&&np(s.Ae)?IT(l):$m(s.serializer,l)}(t,e)}function QP(t,e,n){return t instanceof il?NT(t,e):t instanceof ol?bT(t,e):n}function ST(t,e){return t instanceof kc?function(r){return np(r)||function(i){return!!i&&"doubleValue"in i}(r)}(e)?e:{integerValue:0}:null}class sl extends _d{}class il extends _d{constructor(e){super(),this.elements=e}}function NT(t,e){const n=AT(e);for(const r of t.elements)n.some(s=>wr(s,r))||n.push(r);return{arrayValue:{values:n}}}class ol extends _d{constructor(e){super(),this.elements=e}}function bT(t,e){let n=AT(e);for(const r of t.elements)n=n.filter(s=>!wr(s,r));return{arrayValue:{values:n}}}class kc extends _d{constructor(e,n){super(),this.serializer=e,this.Ae=n}}function N_(t){return lt(t.integerValue||t.doubleValue)}function AT(t){return Mm(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YP{constructor(e,n){this.field=e,this.transform=n}}function JP(t,e){return t.field.isEqual(e.field)&&function(r,s){return r instanceof il&&s instanceof il||r instanceof ol&&s instanceof ol?To(r.elements,s.elements,wr):r instanceof kc&&s instanceof kc?wr(r.Ae,s.Ae):r instanceof sl&&s instanceof sl}(t.transform,e.transform)}class XP{constructor(e,n){this.version=e,this.transformResults=n}}class en{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new en}static exists(e){return new en(void 0,e)}static updateTime(e){return new en(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Bu(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class wd{}function CT(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new xd(t.key,en.none()):new El(t.key,t.data,en.none());{const n=t.data,r=ln.empty();let s=new _t(bt.comparator);for(let i of e.fields)if(!s.has(i)){let o=n.field(i);o===null&&i.length>1&&(i=i.popLast(),o=n.field(i)),o===null?r.delete(i):r.set(i,o),s=s.add(i)}return new zs(t.key,r,new _n(s.toArray()),en.none())}}function ZP(t,e,n){t instanceof El?function(s,i,o){const l=s.value.clone(),c=A_(s.fieldTransforms,i,o.transformResults);l.setAll(c),i.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(t,e,n):t instanceof zs?function(s,i,o){if(!Bu(s.precondition,i))return void i.convertToUnknownDocument(o.version);const l=A_(s.fieldTransforms,i,o.transformResults),c=i.data;c.setAll(kT(s)),c.setAll(l),i.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(t,e,n):function(s,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function ka(t,e,n,r){return t instanceof El?function(i,o,l,c){if(!Bu(i.precondition,o))return l;const d=i.value.clone(),f=C_(i.fieldTransforms,c,o);return d.setAll(f),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),null}(t,e,n,r):t instanceof zs?function(i,o,l,c){if(!Bu(i.precondition,o))return l;const d=C_(i.fieldTransforms,c,o),f=o.data;return f.setAll(kT(i)),f.setAll(d),o.convertToFoundDocument(o.version,f).setHasLocalMutations(),l===null?null:l.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(p=>p.field))}(t,e,n,r):function(i,o,l){return Bu(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):l}(t,e,n)}function e2(t,e){let n=null;for(const r of t.fieldTransforms){const s=e.data.field(r.field),i=ST(r.transform,s||null);i!=null&&(n===null&&(n=ln.empty()),n.set(r.field,i))}return n||null}function b_(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&To(r,s,(i,o)=>JP(i,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class El extends wd{constructor(e,n,r,s=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class zs extends wd{constructor(e,n,r,s,i=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function kT(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function A_(t,e,n){const r=new Map;je(t.length===n.length,32656,{Re:n.length,Ve:t.length});for(let s=0;s<n.length;s++){const i=t[s],o=i.transform,l=e.data.field(i.field);r.set(i.field,QP(o,l,n[s]))}return r}function C_(t,e,n){const r=new Map;for(const s of t){const i=s.transform,o=n.data.field(s.field);r.set(s.field,KP(i,o,e))}return r}class xd extends wd{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class t2 extends wd{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n2{constructor(e,n,r,s){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&ZP(i,e,r[s])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=ka(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=ka(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=TT();return this.mutations.forEach(s=>{const i=e.get(s.key),o=i.overlayedDocument;let l=this.applyToLocalView(o,i.mutatedFields);l=n.has(s.key)?null:l;const c=CT(o,l);c!==null&&r.set(s.key,c),o.isValidDocument()||o.convertToNoDocument(fe.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),Te())}isEqual(e){return this.batchId===e.batchId&&To(this.mutations,e.mutations,(n,r)=>b_(n,r))&&To(this.baseMutations,e.baseMutations,(n,r)=>b_(n,r))}}class Bm{constructor(e,n,r,s){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=s}static from(e,n,r){je(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let s=function(){return zP}();const i=e.mutations;for(let o=0;o<i.length;o++)s=s.insert(i[o].key,r[o].version);return new Bm(e,n,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r2{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s2{constructor(e,n,r){this.alias=e,this.aggregateType=n,this.fieldPath=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i2{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ht,Ne;function o2(t){switch(t){case M.OK:return ae(64938);case M.CANCELLED:case M.UNKNOWN:case M.DEADLINE_EXCEEDED:case M.RESOURCE_EXHAUSTED:case M.INTERNAL:case M.UNAVAILABLE:case M.UNAUTHENTICATED:return!1;case M.INVALID_ARGUMENT:case M.NOT_FOUND:case M.ALREADY_EXISTS:case M.PERMISSION_DENIED:case M.FAILED_PRECONDITION:case M.ABORTED:case M.OUT_OF_RANGE:case M.UNIMPLEMENTED:case M.DATA_LOSS:return!0;default:return ae(15467,{code:t})}}function RT(t){if(t===void 0)return Wr("GRPC error has no .code"),M.UNKNOWN;switch(t){case ht.OK:return M.OK;case ht.CANCELLED:return M.CANCELLED;case ht.UNKNOWN:return M.UNKNOWN;case ht.DEADLINE_EXCEEDED:return M.DEADLINE_EXCEEDED;case ht.RESOURCE_EXHAUSTED:return M.RESOURCE_EXHAUSTED;case ht.INTERNAL:return M.INTERNAL;case ht.UNAVAILABLE:return M.UNAVAILABLE;case ht.UNAUTHENTICATED:return M.UNAUTHENTICATED;case ht.INVALID_ARGUMENT:return M.INVALID_ARGUMENT;case ht.NOT_FOUND:return M.NOT_FOUND;case ht.ALREADY_EXISTS:return M.ALREADY_EXISTS;case ht.PERMISSION_DENIED:return M.PERMISSION_DENIED;case ht.FAILED_PRECONDITION:return M.FAILED_PRECONDITION;case ht.ABORTED:return M.ABORTED;case ht.OUT_OF_RANGE:return M.OUT_OF_RANGE;case ht.UNIMPLEMENTED:return M.UNIMPLEMENTED;case ht.DATA_LOSS:return M.DATA_LOSS;default:return ae(39323,{code:t})}}(Ne=ht||(ht={}))[Ne.OK=0]="OK",Ne[Ne.CANCELLED=1]="CANCELLED",Ne[Ne.UNKNOWN=2]="UNKNOWN",Ne[Ne.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ne[Ne.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ne[Ne.NOT_FOUND=5]="NOT_FOUND",Ne[Ne.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ne[Ne.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ne[Ne.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ne[Ne.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ne[Ne.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ne[Ne.ABORTED=10]="ABORTED",Ne[Ne.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ne[Ne.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ne[Ne.INTERNAL=13]="INTERNAL",Ne[Ne.UNAVAILABLE=14]="UNAVAILABLE",Ne[Ne.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function a2(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const l2=new As([4294967295,4294967295],0);function k_(t){const e=a2().encode(t),n=new qE;return n.update(e),new Uint8Array(n.digest())}function R_(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new As([n,r],0),new As([s,i],0)]}class zm{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new ma(`Invalid padding: ${n}`);if(r<0)throw new ma(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new ma(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new ma(`Invalid padding when bitmap length is 0: ${n}`);this.ge=8*e.length-n,this.pe=As.fromNumber(this.ge)}ye(e,n,r){let s=e.add(n.multiply(As.fromNumber(r)));return s.compare(l2)===1&&(s=new As([s.getBits(0),s.getBits(1)],0)),s.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const n=k_(e),[r,s]=R_(n);for(let i=0;i<this.hashCount;i++){const o=this.ye(r,s,i);if(!this.we(o))return!1}return!0}static create(e,n,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new zm(i,s,n);return r.forEach(l=>o.insert(l)),o}insert(e){if(this.ge===0)return;const n=k_(e),[r,s]=R_(n);for(let i=0;i<this.hashCount;i++){const o=this.ye(r,s,i);this.Se(o)}}Se(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class ma extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ed{constructor(e,n,r,s,i){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const s=new Map;return s.set(e,Tl.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new Ed(fe.min(),s,new rt(Ee),Hr(),Te())}}class Tl{constructor(e,n,r,s,i){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new Tl(r,n,Te(),Te(),Te())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zu{constructor(e,n,r,s){this.be=e,this.removedTargetIds=n,this.key=r,this.De=s}}class PT{constructor(e,n){this.targetId=e,this.Ce=n}}class jT{constructor(e,n,r=kt.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=s}}class P_{constructor(){this.ve=0,this.Fe=j_(),this.Me=kt.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Te(),n=Te(),r=Te();return this.Fe.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:n=n.add(s);break;case 1:r=r.add(s);break;default:ae(38017,{changeType:i})}}),new Tl(this.Me,this.xe,e,n,r)}qe(){this.Oe=!1,this.Fe=j_()}Qe(e,n){this.Oe=!0,this.Fe=this.Fe.insert(e,n)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,je(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class u2{constructor(e){this.Ge=e,this.ze=new Map,this.je=Hr(),this.Je=wu(),this.He=wu(),this.Ye=new rt(Ee)}Ze(e){for(const n of e.be)e.De&&e.De.isFoundDocument()?this.Xe(n,e.De):this.et(n,e.key,e.De);for(const n of e.removedTargetIds)this.et(n,e.key,e.De)}tt(e){this.forEachTarget(e,n=>{const r=this.nt(n);switch(e.state){case 0:this.rt(n)&&r.Le(e.resumeToken);break;case 1:r.Ke(),r.Ne||r.qe(),r.Le(e.resumeToken);break;case 2:r.Ke(),r.Ne||this.removeTarget(n);break;case 3:this.rt(n)&&(r.We(),r.Le(e.resumeToken));break;case 4:this.rt(n)&&(this.it(n),r.Le(e.resumeToken));break;default:ae(56790,{state:e.state})}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.ze.forEach((r,s)=>{this.rt(s)&&n(s)})}st(e){const n=e.targetId,r=e.Ce.count,s=this.ot(n);if(s){const i=s.target;if(sp(i))if(r===0){const o=new ee(i.path);this.et(n,o,Wt.newNoDocument(o,fe.min()))}else je(r===1,20013,{expectedCount:r});else{const o=this._t(n);if(o!==r){const l=this.ut(e),c=l?this.ct(l,e,o):1;if(c!==0){this.it(n);const d=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(n,d)}}}}}ut(e){const n=e.Ce.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:i=0}=n;let o,l;try{o=Os(r).toUint8Array()}catch(c){if(c instanceof rT)return yi("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{l=new zm(o,s,i)}catch(c){return yi(c instanceof ma?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return l.ge===0?null:l}ct(e,n,r){return n.Ce.count===r-this.Pt(e,n.targetId)?0:2}Pt(e,n){const r=this.Ge.getRemoteKeysForTarget(n);let s=0;return r.forEach(i=>{const o=this.Ge.ht(),l=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;e.mightContain(l)||(this.et(n,i,null),s++)}),s}Tt(e){const n=new Map;this.ze.forEach((i,o)=>{const l=this.ot(o);if(l){if(i.current&&sp(l.target)){const c=new ee(l.target.path);this.It(c).has(o)||this.Et(o,c)||this.et(o,c,Wt.newNoDocument(c,e))}i.Be&&(n.set(o,i.ke()),i.qe())}});let r=Te();this.He.forEach((i,o)=>{let l=!0;o.forEachWhile(c=>{const d=this.ot(c);return!d||d.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)}),l&&(r=r.add(i))}),this.je.forEach((i,o)=>o.setReadTime(e));const s=new Ed(e,n,this.Ye,this.je,r);return this.je=Hr(),this.Je=wu(),this.He=wu(),this.Ye=new rt(Ee),s}Xe(e,n){if(!this.rt(e))return;const r=this.Et(e,n.key)?2:0;this.nt(e).Qe(n.key,r),this.je=this.je.insert(n.key,n),this.Je=this.Je.insert(n.key,this.It(n.key).add(e)),this.He=this.He.insert(n.key,this.dt(n.key).add(e))}et(e,n,r){if(!this.rt(e))return;const s=this.nt(e);this.Et(e,n)?s.Qe(n,1):s.$e(n),this.He=this.He.insert(n,this.dt(n).delete(e)),this.He=this.He.insert(n,this.dt(n).add(e)),r&&(this.je=this.je.insert(n,r))}removeTarget(e){this.ze.delete(e)}_t(e){const n=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let n=this.ze.get(e);return n||(n=new P_,this.ze.set(e,n)),n}dt(e){let n=this.He.get(e);return n||(n=new _t(Ee),this.He=this.He.insert(e,n)),n}It(e){let n=this.Je.get(e);return n||(n=new _t(Ee),this.Je=this.Je.insert(e,n)),n}rt(e){const n=this.ot(e)!==null;return n||Y("WatchChangeAggregator","Detected inactive target",e),n}ot(e){const n=this.ze.get(e);return n&&n.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new P_),this.Ge.getRemoteKeysForTarget(e).forEach(n=>{this.et(e,n,null)})}Et(e,n){return this.Ge.getRemoteKeysForTarget(e).has(n)}}function wu(){return new rt(ee.comparator)}function j_(){return new rt(ee.comparator)}const c2={asc:"ASCENDING",desc:"DESCENDING"},d2={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},h2={and:"AND",or:"OR"};class f2{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function op(t,e){return t.useProto3Json||pd(e)?e:{value:e}}function Rc(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function DT(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function p2(t,e){return Rc(t,e.toTimestamp())}function vr(t){return je(!!t,49232),fe.fromTimestamp(function(n){const r=Ds(n);return new Be(r.seconds,r.nanos)}(t))}function qm(t,e){return ap(t,e).canonicalString()}function ap(t,e){const n=function(s){return new Ue(["projects",s.projectId,"databases",s.database])}(t).child("documents");return e===void 0?n:n.child(e)}function OT(t){const e=Ue.fromString(t);return je($T(e),10190,{key:e.toString()}),e}function lp(t,e){return qm(t.databaseId,e.path)}function jh(t,e){const n=OT(e);if(n.get(1)!==t.databaseId.projectId)throw new H(M.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new H(M.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new ee(LT(n))}function VT(t,e){return qm(t.databaseId,e)}function m2(t){const e=OT(t);return e.length===4?Ue.emptyPath():LT(e)}function up(t){return new Ue(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function LT(t){return je(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function D_(t,e,n){return{name:lp(t,e),fields:n.value.mapValue.fields}}function g2(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:ae(39313,{state:d})}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(d,f){return d.useProto3Json?(je(f===void 0||typeof f=="string",58123),kt.fromBase64String(f||"")):(je(f===void 0||f instanceof Buffer||f instanceof Uint8Array,16193),kt.fromUint8Array(f||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,l=o&&function(d){const f=d.code===void 0?M.UNKNOWN:RT(d.code);return new H(f,d.message||"")}(o);n=new jT(r,s,i,l||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=jh(t,r.document.name),i=vr(r.document.updateTime),o=r.document.createTime?vr(r.document.createTime):fe.min(),l=new ln({mapValue:{fields:r.document.fields}}),c=Wt.newFoundDocument(s,i,o,l),d=r.targetIds||[],f=r.removedTargetIds||[];n=new zu(d,f,c.key,c)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=jh(t,r.document),i=r.readTime?vr(r.readTime):fe.min(),o=Wt.newNoDocument(s,i),l=r.removedTargetIds||[];n=new zu([],l,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=jh(t,r.document),i=r.removedTargetIds||[];n=new zu([],i,s,null)}else{if(!("filter"in e))return ae(11601,{Rt:e});{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,o=new i2(s,i),l=r.targetId;n=new PT(l,o)}}return n}function y2(t,e){let n;if(e instanceof El)n={update:D_(t,e.key,e.value)};else if(e instanceof xd)n={delete:lp(t,e.key)};else if(e instanceof zs)n={update:D_(t,e.key,e.data),updateMask:N2(e.fieldMask)};else{if(!(e instanceof t2))return ae(16599,{Vt:e.type});n={verify:lp(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(i,o){const l=o.transform;if(l instanceof sl)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof il)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof ol)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof kc)return{fieldPath:o.field.canonicalString(),increment:l.Ae};throw ae(20930,{transform:o.transform})}(0,r))),e.precondition.isNone||(n.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:p2(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:ae(27497)}(t,e.precondition)),n}function v2(t,e){return t&&t.length>0?(je(e!==void 0,14353),t.map(n=>function(s,i){let o=s.updateTime?vr(s.updateTime):vr(i);return o.isEqual(fe.min())&&(o=vr(i)),new XP(o,s.transformResults||[])}(n,e))):[]}function _2(t,e){return{documents:[VT(t,e.path)]}}function MT(t,e){const n={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=VT(t,s);const i=function(d){if(d.length!==0)return FT(tr.create(d,"and"))}(e.filters);i&&(n.structuredQuery.where=i);const o=function(d){if(d.length!==0)return d.map(f=>function(m){return{field:fs(m.field),direction:T2(m.dir)}}(f))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const l=op(t,e.limit);return l!==null&&(n.structuredQuery.limit=l),e.startAt&&(n.structuredQuery.startAt=function(d){return{before:d.inclusive,values:d.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(d){return{before:!d.inclusive,values:d.position}}(e.endAt)),{ft:n,parent:s}}function w2(t,e,n,r){const{ft:s,parent:i}=MT(t,e),o={},l=[];let c=0;return n.forEach(d=>{const f="aggregate_"+c++;o[f]=d.alias,d.aggregateType==="count"?l.push({alias:f,count:{}}):d.aggregateType==="avg"?l.push({alias:f,avg:{field:fs(d.fieldPath)}}):d.aggregateType==="sum"&&l.push({alias:f,sum:{field:fs(d.fieldPath)}})}),{request:{structuredAggregationQuery:{aggregations:l,structuredQuery:s.structuredQuery},parent:s.parent},gt:o,parent:i}}function x2(t){let e=m2(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let s=null;if(r>0){je(r===1,65062);const f=n.from[0];f.allDescendants?s=f.collectionId:e=e.child(f.collectionId)}let i=[];n.where&&(i=function(p){const m=UT(p);return m instanceof tr&&fT(m)?m.getFilters():[m]}(n.where));let o=[];n.orderBy&&(o=function(p){return p.map(m=>function(w){return new rl(Bi(w.field),function(b){switch(b){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(w.direction))}(m))}(n.orderBy));let l=null;n.limit&&(l=function(p){let m;return m=typeof p=="object"?p.value:p,pd(m)?null:m}(n.limit));let c=null;n.startAt&&(c=function(p){const m=!!p.before,y=p.values||[];return new Ac(y,m)}(n.startAt));let d=null;return n.endAt&&(d=function(p){const m=!p.before,y=p.values||[];return new Ac(y,m)}(n.endAt)),MP(e,s,o,i,l,"F",c,d)}function E2(t,e){const n=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ae(28987,{purpose:s})}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function UT(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=Bi(n.unaryFilter.field);return pt.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=Bi(n.unaryFilter.field);return pt.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=Bi(n.unaryFilter.field);return pt.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Bi(n.unaryFilter.field);return pt.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return ae(61313);default:return ae(60726)}}(t):t.fieldFilter!==void 0?function(n){return pt.create(Bi(n.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return ae(58110);default:return ae(50506)}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return tr.create(n.compositeFilter.filters.map(r=>UT(r)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return ae(1026)}}(n.compositeFilter.op))}(t):ae(30097,{filter:t})}function T2(t){return c2[t]}function I2(t){return d2[t]}function S2(t){return h2[t]}function fs(t){return{fieldPath:t.canonicalString()}}function Bi(t){return bt.fromServerFormat(t.fieldPath)}function FT(t){return t instanceof pt?function(n){if(n.op==="=="){if(x_(n.value))return{unaryFilter:{field:fs(n.field),op:"IS_NAN"}};if(w_(n.value))return{unaryFilter:{field:fs(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(x_(n.value))return{unaryFilter:{field:fs(n.field),op:"IS_NOT_NAN"}};if(w_(n.value))return{unaryFilter:{field:fs(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:fs(n.field),op:I2(n.op),value:n.value}}}(t):t instanceof tr?function(n){const r=n.getFilters().map(s=>FT(s));return r.length===1?r[0]:{compositeFilter:{op:S2(n.op),filters:r}}}(t):ae(54877,{filter:t})}function N2(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function $T(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ys{constructor(e,n,r,s,i=fe.min(),o=fe.min(),l=kt.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=l,this.expectedCount=c}withSequenceNumber(e){return new ys(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new ys(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new ys(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new ys(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b2{constructor(e){this.yt=e}}function A2(t){const e=x2({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Cc(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C2{constructor(){this.Cn=new k2}addToCollectionParentIndex(e,n){return this.Cn.add(n),U.resolve()}getCollectionParents(e,n){return U.resolve(this.Cn.getEntries(n))}addFieldIndex(e,n){return U.resolve()}deleteFieldIndex(e,n){return U.resolve()}deleteAllFieldIndexes(e){return U.resolve()}createTargetIndexes(e,n){return U.resolve()}getDocumentsMatchingTarget(e,n){return U.resolve(null)}getIndexType(e,n){return U.resolve(0)}getFieldIndexes(e,n){return U.resolve([])}getNextCollectionGroupToUpdate(e){return U.resolve(null)}getMinOffset(e,n){return U.resolve(js.min())}getMinOffsetFromCollectionGroup(e,n){return U.resolve(js.min())}updateCollectionGroup(e,n,r){return U.resolve()}updateIndexEntries(e,n){return U.resolve()}}class k2{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n]||new _t(Ue.comparator),i=!s.has(r);return this.index[n]=s.add(r),i}has(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n];return s&&s.has(r)}getEntries(e){return(this.index[e]||new _t(Ue.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const O_={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},BT=41943040;class sn{static withCacheSize(e){return new sn(e,sn.DEFAULT_COLLECTION_PERCENTILE,sn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */sn.DEFAULT_COLLECTION_PERCENTILE=10,sn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,sn.DEFAULT=new sn(BT,sn.DEFAULT_COLLECTION_PERCENTILE,sn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),sn.DISABLED=new sn(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bo{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new bo(0)}static cr(){return new bo(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const V_="LruGarbageCollector",R2=1048576;function L_([t,e],[n,r]){const s=Ee(t,n);return s===0?Ee(e,r):s}class P2{constructor(e){this.Ir=e,this.buffer=new _t(L_),this.Er=0}dr(){return++this.Er}Ar(e){const n=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();L_(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class j2{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){Y(V_,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){Uo(n)?Y(V_,"Ignoring IndexedDB error during garbage collection: ",n):await Mo(n)}await this.Vr(3e5)})}}class D2{constructor(e,n){this.mr=e,this.params=n}calculateTargetCount(e,n){return this.mr.gr(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return U.resolve(fd.ce);const r=new P2(n);return this.mr.forEachTarget(e,s=>r.Ar(s.sequenceNumber)).next(()=>this.mr.pr(e,s=>r.Ar(s))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.mr.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.mr.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(Y("LruGarbageCollector","Garbage collection skipped; disabled"),U.resolve(O_)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(Y("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),O_):this.yr(e,n))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,n){let r,s,i,o,l,c,d;const f=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(p=>(p>this.params.maximumSequenceNumbersToCollect?(Y("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${p}`),s=this.params.maximumSequenceNumbersToCollect):s=p,o=Date.now(),this.nthSequenceNumber(e,s))).next(p=>(r=p,l=Date.now(),this.removeTargets(e,r,n))).next(p=>(i=p,c=Date.now(),this.removeOrphanedDocuments(e,r))).next(p=>(d=Date.now(),Fi()<=xe.DEBUG&&Y("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-f}ms
	Determined least recently used ${s} in `+(l-o)+`ms
	Removed ${i} targets in `+(c-l)+`ms
	Removed ${p} documents in `+(d-c)+`ms
Total Duration: ${d-f}ms`),U.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:i,documentsRemoved:p})))}}function O2(t,e){return new D2(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V2{constructor(){this.changes=new Ai(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,Wt.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?U.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L2{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M2{constructor(e,n,r,s){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,n))).next(s=>(r!==null&&ka(r.mutation,s,_n.empty(),Be.now()),s))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,Te()).next(()=>r))}getLocalViewOfDocuments(e,n,r=Te()){const s=si();return this.populateOverlays(e,s,n).next(()=>this.computeViews(e,n,s,r).next(i=>{let o=pa();return i.forEach((l,c)=>{o=o.insert(l,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=si();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,Te()))}populateOverlays(e,n,r){const s=[];return r.forEach(i=>{n.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((o,l)=>{n.set(o,l)})})}computeViews(e,n,r,s){let i=Hr();const o=Ca(),l=function(){return Ca()}();return n.forEach((c,d)=>{const f=r.get(d.key);s.has(d.key)&&(f===void 0||f.mutation instanceof zs)?i=i.insert(d.key,d):f!==void 0?(o.set(d.key,f.mutation.getFieldMask()),ka(f.mutation,d,f.mutation.getFieldMask(),Be.now())):o.set(d.key,_n.empty())}),this.recalculateAndSaveOverlays(e,i).next(c=>(c.forEach((d,f)=>o.set(d,f)),n.forEach((d,f)=>l.set(d,new L2(f,o.get(d)??null))),l))}recalculateAndSaveOverlays(e,n){const r=Ca();let s=new rt((o,l)=>o-l),i=Te();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const l of o)l.keys().forEach(c=>{const d=n.get(c);if(d===null)return;let f=r.get(c)||_n.empty();f=l.applyToLocalView(d,f),r.set(c,f);const p=(s.get(l.batchId)||Te()).add(c);s=s.insert(l.batchId,p)})}).next(()=>{const o=[],l=s.getReverseIterator();for(;l.hasNext();){const c=l.getNext(),d=c.key,f=c.value,p=TT();f.forEach(m=>{if(!i.has(m)){const y=CT(n.get(m),r.get(m));y!==null&&p.set(m,y),i=i.add(m)}}),o.push(this.documentOverlayCache.saveOverlays(e,d,p))}return U.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,s){return function(o){return ee.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):yT(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,s):this.getDocumentsMatchingCollectionQuery(e,n,r,s)}getNextDocuments(e,n,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,s).next(i=>{const o=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,s-i.size):U.resolve(si());let l=el,c=i;return o.next(d=>U.forEach(d,(f,p)=>(l<p.largestBatchId&&(l=p.largestBatchId),i.get(f)?U.resolve():this.remoteDocumentCache.getEntry(e,f).next(m=>{c=c.insert(f,m)}))).next(()=>this.populateOverlays(e,d,i)).next(()=>this.computeViews(e,c,d,Te())).next(f=>({batchId:l,changes:ET(f)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new ee(n)).next(r=>{let s=pa();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,n,r,s){const i=n.collectionGroup;let o=pa();return this.indexManager.getCollectionParents(e,i).next(l=>U.forEach(l,c=>{const d=function(p,m){return new bi(m,null,p.explicitOrderBy.slice(),p.filters.slice(),p.limit,p.limitType,p.startAt,p.endAt)}(n,c.child(i));return this.getDocumentsMatchingCollectionQuery(e,d,r,s).next(f=>{f.forEach((p,m)=>{o=o.insert(p,m)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,i,s))).next(o=>{i.forEach((c,d)=>{const f=d.getKey();o.get(f)===null&&(o=o.insert(f,Wt.newInvalidDocument(f)))});let l=pa();return o.forEach((c,d)=>{const f=i.get(c);f!==void 0&&ka(f.mutation,d,_n.empty(),Be.now()),vd(n,d)&&(l=l.insert(c,d))}),l})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U2{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,n){return U.resolve(this.Lr.get(n))}saveBundleMetadata(e,n){return this.Lr.set(n.id,function(s){return{id:s.id,version:s.version,createTime:vr(s.createTime)}}(n)),U.resolve()}getNamedQuery(e,n){return U.resolve(this.kr.get(n))}saveNamedQuery(e,n){return this.kr.set(n.name,function(s){return{name:s.name,query:A2(s.bundledQuery),readTime:vr(s.readTime)}}(n)),U.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F2{constructor(){this.overlays=new rt(ee.comparator),this.qr=new Map}getOverlay(e,n){return U.resolve(this.overlays.get(n))}getOverlays(e,n){const r=si();return U.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((s,i)=>{this.St(e,n,i)}),U.resolve()}removeOverlaysForBatchId(e,n,r){const s=this.qr.get(r);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.qr.delete(r)),U.resolve()}getOverlaysForCollection(e,n,r){const s=si(),i=n.length+1,o=new ee(n.child("")),l=this.overlays.getIteratorFrom(o);for(;l.hasNext();){const c=l.getNext().value,d=c.getKey();if(!n.isPrefixOf(d.path))break;d.path.length===i&&c.largestBatchId>r&&s.set(c.getKey(),c)}return U.resolve(s)}getOverlaysForCollectionGroup(e,n,r,s){let i=new rt((d,f)=>d-f);const o=this.overlays.getIterator();for(;o.hasNext();){const d=o.getNext().value;if(d.getKey().getCollectionGroup()===n&&d.largestBatchId>r){let f=i.get(d.largestBatchId);f===null&&(f=si(),i=i.insert(d.largestBatchId,f)),f.set(d.getKey(),d)}}const l=si(),c=i.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((d,f)=>l.set(d,f)),!(l.size()>=s)););return U.resolve(l)}St(e,n,r){const s=this.overlays.get(r.key);if(s!==null){const o=this.qr.get(s.largestBatchId).delete(r.key);this.qr.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new r2(n,r));let i=this.qr.get(n);i===void 0&&(i=Te(),this.qr.set(n,i)),this.qr.set(n,i.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $2{constructor(){this.sessionToken=kt.EMPTY_BYTE_STRING}getSessionToken(e){return U.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,U.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wm{constructor(){this.Qr=new _t(St.$r),this.Ur=new _t(St.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,n){const r=new St(e,n);this.Qr=this.Qr.add(r),this.Ur=this.Ur.add(r)}Wr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Gr(new St(e,n))}zr(e,n){e.forEach(r=>this.removeReference(r,n))}jr(e){const n=new ee(new Ue([])),r=new St(n,e),s=new St(n,e+1),i=[];return this.Ur.forEachInRange([r,s],o=>{this.Gr(o),i.push(o.key)}),i}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const n=new ee(new Ue([])),r=new St(n,e),s=new St(n,e+1);let i=Te();return this.Ur.forEachInRange([r,s],o=>{i=i.add(o.key)}),i}containsKey(e){const n=new St(e,0),r=this.Qr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class St{constructor(e,n){this.key=e,this.Yr=n}static $r(e,n){return ee.comparator(e.key,n.key)||Ee(e.Yr,n.Yr)}static Kr(e,n){return Ee(e.Yr,n.Yr)||ee.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B2{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.tr=1,this.Zr=new _t(St.$r)}checkEmpty(e){return U.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,s){const i=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new n2(i,n,r,s);this.mutationQueue.push(o);for(const l of s)this.Zr=this.Zr.add(new St(l.key,i)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return U.resolve(o)}lookupMutationBatch(e,n){return U.resolve(this.Xr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=this.ei(r),i=s<0?0:s;return U.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return U.resolve(this.mutationQueue.length===0?Vm:this.tr-1)}getAllMutationBatches(e){return U.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new St(n,0),s=new St(n,Number.POSITIVE_INFINITY),i=[];return this.Zr.forEachInRange([r,s],o=>{const l=this.Xr(o.Yr);i.push(l)}),U.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new _t(Ee);return n.forEach(s=>{const i=new St(s,0),o=new St(s,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([i,o],l=>{r=r.add(l.Yr)})}),U.resolve(this.ti(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1;let i=r;ee.isDocumentKey(i)||(i=i.child(""));const o=new St(new ee(i),0);let l=new _t(Ee);return this.Zr.forEachWhile(c=>{const d=c.key.path;return!!r.isPrefixOf(d)&&(d.length===s&&(l=l.add(c.Yr)),!0)},o),U.resolve(this.ti(l))}ti(e){const n=[];return e.forEach(r=>{const s=this.Xr(r);s!==null&&n.push(s)}),n}removeMutationBatch(e,n){je(this.ni(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Zr;return U.forEach(n.mutations,s=>{const i=new St(s.key,n.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.Zr=r})}ir(e){}containsKey(e,n){const r=new St(n,0),s=this.Zr.firstAfterOrEqual(r);return U.resolve(n.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,U.resolve()}ni(e,n){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const n=this.ei(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z2{constructor(e){this.ri=e,this.docs=function(){return new rt(ee.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,s=this.docs.get(r),i=s?s.size:0,o=this.ri(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return U.resolve(r?r.document.mutableCopy():Wt.newInvalidDocument(n))}getEntries(e,n){let r=Hr();return n.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():Wt.newInvalidDocument(s))}),U.resolve(r)}getDocumentsMatchingQuery(e,n,r,s){let i=Hr();const o=n.path,l=new ee(o.child("__id-9223372036854775808__")),c=this.docs.getIteratorFrom(l);for(;c.hasNext();){const{key:d,value:{document:f}}=c.getNext();if(!o.isPrefixOf(d.path))break;d.path.length>o.length+1||mP(pP(f),r)<=0||(s.has(f.key)||vd(n,f))&&(i=i.insert(f.key,f.mutableCopy()))}return U.resolve(i)}getAllFromCollectionGroup(e,n,r,s){ae(9500)}ii(e,n){return U.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new q2(this)}getSize(e){return U.resolve(this.size)}}class q2 extends V2{constructor(e){super(),this.Nr=e}applyChanges(e){const n=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?n.push(this.Nr.addEntry(e,s)):this.Nr.removeEntry(r)}),U.waitFor(n)}getFromCache(e,n){return this.Nr.getEntry(e,n)}getAllFromCache(e,n){return this.Nr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W2{constructor(e){this.persistence=e,this.si=new Ai(n=>Um(n),Fm),this.lastRemoteSnapshotVersion=fe.min(),this.highestTargetId=0,this.oi=0,this._i=new Wm,this.targetCount=0,this.ai=bo.ur()}forEachTarget(e,n){return this.si.forEach((r,s)=>n(s)),U.resolve()}getLastRemoteSnapshotVersion(e){return U.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return U.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),U.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.oi&&(this.oi=n),U.resolve()}Pr(e){this.si.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.ai=new bo(n),this.highestTargetId=n),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,n){return this.Pr(n),this.targetCount+=1,U.resolve()}updateTargetData(e,n){return this.Pr(n),U.resolve()}removeTargetData(e,n){return this.si.delete(n.target),this._i.jr(n.targetId),this.targetCount-=1,U.resolve()}removeTargets(e,n,r){let s=0;const i=[];return this.si.forEach((o,l)=>{l.sequenceNumber<=n&&r.get(l.targetId)===null&&(this.si.delete(o),i.push(this.removeMatchingKeysForTargetId(e,l.targetId)),s++)}),U.waitFor(i).next(()=>s)}getTargetCount(e){return U.resolve(this.targetCount)}getTargetData(e,n){const r=this.si.get(n)||null;return U.resolve(r)}addMatchingKeys(e,n,r){return this._i.Wr(n,r),U.resolve()}removeMatchingKeys(e,n,r){this._i.zr(n,r);const s=this.persistence.referenceDelegate,i=[];return s&&n.forEach(o=>{i.push(s.markPotentiallyOrphaned(e,o))}),U.waitFor(i)}removeMatchingKeysForTargetId(e,n){return this._i.jr(n),U.resolve()}getMatchingKeysForTargetId(e,n){const r=this._i.Hr(n);return U.resolve(r)}containsKey(e,n){return U.resolve(this._i.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zT{constructor(e,n){this.ui={},this.overlays={},this.ci=new fd(0),this.li=!1,this.li=!0,this.hi=new $2,this.referenceDelegate=e(this),this.Pi=new W2(this),this.indexManager=new C2,this.remoteDocumentCache=function(s){return new z2(s)}(r=>this.referenceDelegate.Ti(r)),this.serializer=new b2(n),this.Ii=new U2(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new F2,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.ui[e.toKey()];return r||(r=new B2(n,this.referenceDelegate),this.ui[e.toKey()]=r),r}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,n,r){Y("MemoryPersistence","Starting transaction:",e);const s=new H2(this.ci.next());return this.referenceDelegate.Ei(),r(s).next(i=>this.referenceDelegate.di(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Ai(e,n){return U.or(Object.values(this.ui).map(r=>()=>r.containsKey(e,n)))}}class H2 extends yP{constructor(e){super(),this.currentSequenceNumber=e}}class Hm{constructor(e){this.persistence=e,this.Ri=new Wm,this.Vi=null}static mi(e){return new Hm(e)}get fi(){if(this.Vi)return this.Vi;throw ae(60996)}addReference(e,n,r){return this.Ri.addReference(r,n),this.fi.delete(r.toString()),U.resolve()}removeReference(e,n,r){return this.Ri.removeReference(r,n),this.fi.add(r.toString()),U.resolve()}markPotentiallyOrphaned(e,n){return this.fi.add(n.toString()),U.resolve()}removeTarget(e,n){this.Ri.jr(n.targetId).forEach(s=>this.fi.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(s=>{s.forEach(i=>this.fi.add(i.toString()))}).next(()=>r.removeTargetData(e,n))}Ei(){this.Vi=new Set}di(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return U.forEach(this.fi,r=>{const s=ee.fromPath(r);return this.gi(e,s).next(i=>{i||n.removeEntry(s,fe.min())})}).next(()=>(this.Vi=null,n.apply(e)))}updateLimboDocument(e,n){return this.gi(e,n).next(r=>{r?this.fi.delete(n.toString()):this.fi.add(n.toString())})}Ti(e){return 0}gi(e,n){return U.or([()=>U.resolve(this.Ri.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ai(e,n)])}}class Pc{constructor(e,n){this.persistence=e,this.pi=new Ai(r=>wP(r.path),(r,s)=>r.isEqual(s)),this.garbageCollector=O2(this,n)}static mi(e,n){return new Pc(e,n)}Ei(){}di(e){return U.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}gr(e){const n=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>n.next(s=>r+s))}wr(e){let n=0;return this.pr(e,r=>{n++}).next(()=>n)}pr(e,n){return U.forEach(this.pi,(r,s)=>this.br(e,r,s).next(i=>i?U.resolve():n(s)))}removeTargets(e,n,r){return this.persistence.getTargetCache().removeTargets(e,n,r)}removeOrphanedDocuments(e,n){let r=0;const s=this.persistence.getRemoteDocumentCache(),i=s.newChangeBuffer();return s.ii(e,o=>this.br(e,o,n).next(l=>{l||(r++,i.removeEntry(o,fe.min()))})).next(()=>i.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,n){return this.pi.set(n,e.currentSequenceNumber),U.resolve()}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,n,r){return this.pi.set(r,e.currentSequenceNumber),U.resolve()}removeReference(e,n,r){return this.pi.set(r,e.currentSequenceNumber),U.resolve()}updateLimboDocument(e,n){return this.pi.set(n,e.currentSequenceNumber),U.resolve()}Ti(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=Fu(e.data.value)),n}br(e,n,r){return U.or([()=>this.persistence.Ai(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const s=this.pi.get(n);return U.resolve(s!==void 0&&s>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gm{constructor(e,n,r,s){this.targetId=e,this.fromCache=n,this.Es=r,this.ds=s}static As(e,n){let r=Te(),s=Te();for(const i of n.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new Gm(e,n.fromCache,r,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G2{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K2{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=function(){return T1()?8:vP(Kt())>0?6:4}()}initialize(e,n){this.ps=e,this.indexManager=n,this.Rs=!0}getDocumentsMatchingQuery(e,n,r,s){const i={result:null};return this.ys(e,n).next(o=>{i.result=o}).next(()=>{if(!i.result)return this.ws(e,n,s,r).next(o=>{i.result=o})}).next(()=>{if(i.result)return;const o=new G2;return this.Ss(e,n,o).next(l=>{if(i.result=l,this.Vs)return this.bs(e,n,o,l.size)})}).next(()=>i.result)}bs(e,n,r,s){return r.documentReadCount<this.fs?(Fi()<=xe.DEBUG&&Y("QueryEngine","SDK will not create cache indexes for query:",$i(n),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),U.resolve()):(Fi()<=xe.DEBUG&&Y("QueryEngine","Query:",$i(n),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.gs*s?(Fi()<=xe.DEBUG&&Y("QueryEngine","The SDK decides to create cache indexes for query:",$i(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,yr(n))):U.resolve())}ys(e,n){if(S_(n))return U.resolve(null);let r=yr(n);return this.indexManager.getIndexType(e,r).next(s=>s===0?null:(n.limit!==null&&s===1&&(n=Cc(n,null,"F"),r=yr(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(i=>{const o=Te(...i);return this.ps.getDocuments(e,o).next(l=>this.indexManager.getMinOffset(e,r).next(c=>{const d=this.Ds(n,l);return this.Cs(n,d,o,c.readTime)?this.ys(e,Cc(n,null,"F")):this.vs(e,d,n,c)}))})))}ws(e,n,r,s){return S_(n)||s.isEqual(fe.min())?U.resolve(null):this.ps.getDocuments(e,r).next(i=>{const o=this.Ds(n,i);return this.Cs(n,o,r,s)?U.resolve(null):(Fi()<=xe.DEBUG&&Y("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),$i(n)),this.vs(e,o,n,fP(s,el)).next(l=>l))})}Ds(e,n){let r=new _t(wT(e));return n.forEach((s,i)=>{vd(e,i)&&(r=r.add(i))}),r}Cs(e,n,r,s){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const i=e.limitType==="F"?n.last():n.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Ss(e,n,r){return Fi()<=xe.DEBUG&&Y("QueryEngine","Using full collection scan to execute query:",$i(n)),this.ps.getDocumentsMatchingQuery(e,n,js.min(),r)}vs(e,n,r,s){return this.ps.getDocumentsMatchingQuery(e,r,s).next(i=>(n.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Km="LocalStore",Q2=3e8;class Y2{constructor(e,n,r,s){this.persistence=e,this.Fs=n,this.serializer=s,this.Ms=new rt(Ee),this.xs=new Ai(i=>Um(i),Fm),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(r)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new M2(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.Ms))}}function J2(t,e,n,r){return new Y2(t,e,n,r)}async function qT(t,e){const n=he(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let s;return n.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,n.Bs(e),n.mutationQueue.getAllMutationBatches(r))).next(i=>{const o=[],l=[];let c=Te();for(const d of s){o.push(d.batchId);for(const f of d.mutations)c=c.add(f.key)}for(const d of i){l.push(d.batchId);for(const f of d.mutations)c=c.add(f.key)}return n.localDocuments.getDocuments(r,c).next(d=>({Ls:d,removedBatchIds:o,addedBatchIds:l}))})})}function X2(t,e){const n=he(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),i=n.Ns.newChangeBuffer({trackRemovals:!0});return function(l,c,d,f){const p=d.batch,m=p.keys();let y=U.resolve();return m.forEach(w=>{y=y.next(()=>f.getEntry(c,w)).next(A=>{const b=d.docVersions.get(w);je(b!==null,48541),A.version.compareTo(b)<0&&(p.applyToRemoteDocument(A,d),A.isValidDocument()&&(A.setReadTime(d.commitVersion),f.addEntry(A)))})}),y.next(()=>l.mutationQueue.removeMutationBatch(c,p))}(n,r,e,i).next(()=>i.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(l){let c=Te();for(let d=0;d<l.mutationResults.length;++d)l.mutationResults[d].transformResults.length>0&&(c=c.add(l.batch.mutations[d].key));return c}(e))).next(()=>n.localDocuments.getDocuments(r,s))})}function WT(t){const e=he(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Pi.getLastRemoteSnapshotVersion(n))}function Z2(t,e){const n=he(t),r=e.snapshotVersion;let s=n.Ms;return n.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=n.Ns.newChangeBuffer({trackRemovals:!0});s=n.Ms;const l=[];e.targetChanges.forEach((f,p)=>{const m=s.get(p);if(!m)return;l.push(n.Pi.removeMatchingKeys(i,f.removedDocuments,p).next(()=>n.Pi.addMatchingKeys(i,f.addedDocuments,p)));let y=m.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(p)!==null?y=y.withResumeToken(kt.EMPTY_BYTE_STRING,fe.min()).withLastLimboFreeSnapshotVersion(fe.min()):f.resumeToken.approximateByteSize()>0&&(y=y.withResumeToken(f.resumeToken,r)),s=s.insert(p,y),function(A,b,E){return A.resumeToken.approximateByteSize()===0||b.snapshotVersion.toMicroseconds()-A.snapshotVersion.toMicroseconds()>=Q2?!0:E.addedDocuments.size+E.modifiedDocuments.size+E.removedDocuments.size>0}(m,y,f)&&l.push(n.Pi.updateTargetData(i,y))});let c=Hr(),d=Te();if(e.documentUpdates.forEach(f=>{e.resolvedLimboDocuments.has(f)&&l.push(n.persistence.referenceDelegate.updateLimboDocument(i,f))}),l.push(ej(i,o,e.documentUpdates).next(f=>{c=f.ks,d=f.qs})),!r.isEqual(fe.min())){const f=n.Pi.getLastRemoteSnapshotVersion(i).next(p=>n.Pi.setTargetsMetadata(i,i.currentSequenceNumber,r));l.push(f)}return U.waitFor(l).next(()=>o.apply(i)).next(()=>n.localDocuments.getLocalViewOfDocuments(i,c,d)).next(()=>c)}).then(i=>(n.Ms=s,i))}function ej(t,e,n){let r=Te(),s=Te();return n.forEach(i=>r=r.add(i)),e.getEntries(t,r).next(i=>{let o=Hr();return n.forEach((l,c)=>{const d=i.get(l);c.isFoundDocument()!==d.isFoundDocument()&&(s=s.add(l)),c.isNoDocument()&&c.version.isEqual(fe.min())?(e.removeEntry(l,c.readTime),o=o.insert(l,c)):!d.isValidDocument()||c.version.compareTo(d.version)>0||c.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(c),o=o.insert(l,c)):Y(Km,"Ignoring outdated watch update for ",l,". Current version:",d.version," Watch version:",c.version)}),{ks:o,qs:s}})}function tj(t,e){const n=he(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=Vm),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function nj(t,e){const n=he(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return n.Pi.getTargetData(r,e).next(i=>i?(s=i,U.resolve(s)):n.Pi.allocateTargetId(r).next(o=>(s=new ys(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.Pi.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=n.Ms.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(n.Ms=n.Ms.insert(r.targetId,r),n.xs.set(e,r.targetId)),r})}async function cp(t,e,n){const r=he(t),s=r.Ms.get(e),i=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",i,o=>r.persistence.referenceDelegate.removeTarget(o,s))}catch(o){if(!Uo(o))throw o;Y(Km,`Failed to update sequence numbers for target ${e}: ${o}`)}r.Ms=r.Ms.remove(e),r.xs.delete(s.target)}function M_(t,e,n){const r=he(t);let s=fe.min(),i=Te();return r.persistence.runTransaction("Execute query","readwrite",o=>function(c,d,f){const p=he(c),m=p.xs.get(f);return m!==void 0?U.resolve(p.Ms.get(m)):p.Pi.getTargetData(d,f)}(r,o,yr(e)).next(l=>{if(l)return s=l.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(o,l.targetId).next(c=>{i=c})}).next(()=>r.Fs.getDocumentsMatchingQuery(o,e,n?s:fe.min(),n?i:Te())).next(l=>(rj(r,FP(e),l),{documents:l,Qs:i})))}function rj(t,e,n){let r=t.Os.get(e)||fe.min();n.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),t.Os.set(e,r)}class U_{constructor(){this.activeTargetIds=HP()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class sj{constructor(){this.Mo=new U_,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,n,r){this.xo[e]=n}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new U_,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ij{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F_="ConnectivityMonitor";class $_{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){Y(F_,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){Y(F_,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let xu=null;function dp(){return xu===null?xu=function(){return 268435456+Math.round(2147483648*Math.random())}():xu++,"0x"+xu.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dh="RestConnection",oj={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class aj{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Uo=n+"://"+e.host,this.Ko=`projects/${r}/databases/${s}`,this.Wo=this.databaseId.database===Nc?`project_id=${r}`:`project_id=${r}&database_id=${s}`}Go(e,n,r,s,i){const o=dp(),l=this.zo(e,n.toUriEncodedString());Y(Dh,`Sending RPC '${e}' ${o}:`,l,r);const c={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(c,s,i);const{host:d}=new URL(l),f=Ii(d);return this.Jo(e,l,c,r,f).then(p=>(Y(Dh,`Received RPC '${e}' ${o}: `,p),p),p=>{throw yi(Dh,`RPC '${e}' ${o} failed with error: `,p,"url: ",l,"request:",r),p})}Ho(e,n,r,s,i,o){return this.Go(e,n,r,s,i)}jo(e,n,r){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Lo}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((s,i)=>e[i]=s),r&&r.headers.forEach((s,i)=>e[i]=s)}zo(e,n){const r=oj[e];return`${this.Uo}/v1/${n}:${r}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lj{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bt="WebChannelConnection";class uj extends aj{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,n,r,s,i){const o=dp();return new Promise((l,c)=>{const d=new WE;d.setWithCredentials(!0),d.listenOnce(HE.COMPLETE,()=>{try{switch(d.getLastErrorCode()){case Uu.NO_ERROR:const p=d.getResponseJson();Y(Bt,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(p)),l(p);break;case Uu.TIMEOUT:Y(Bt,`RPC '${e}' ${o} timed out`),c(new H(M.DEADLINE_EXCEEDED,"Request time out"));break;case Uu.HTTP_ERROR:const m=d.getStatus();if(Y(Bt,`RPC '${e}' ${o} failed with status:`,m,"response text:",d.getResponseText()),m>0){let y=d.getResponseJson();Array.isArray(y)&&(y=y[0]);const w=y==null?void 0:y.error;if(w&&w.status&&w.message){const A=function(E){const v=E.toLowerCase().replace(/_/g,"-");return Object.values(M).indexOf(v)>=0?v:M.UNKNOWN}(w.status);c(new H(A,w.message))}else c(new H(M.UNKNOWN,"Server responded with status "+d.getStatus()))}else c(new H(M.UNAVAILABLE,"Connection failed."));break;default:ae(9055,{l_:e,streamId:o,h_:d.getLastErrorCode(),P_:d.getLastError()})}}finally{Y(Bt,`RPC '${e}' ${o} completed.`)}});const f=JSON.stringify(s);Y(Bt,`RPC '${e}' ${o} sending request:`,s),d.send(n,"POST",f,r,15)})}T_(e,n,r){const s=dp(),i=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=QE(),l=KE(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(c.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(c.useFetchStreams=!0),this.jo(c.initMessageHeaders,n,r),c.encodeInitMessageHeaders=!0;const f=i.join("");Y(Bt,`Creating RPC '${e}' stream ${s}: ${f}`,c);const p=o.createWebChannel(f,c);this.I_(p);let m=!1,y=!1;const w=new lj({Yo:b=>{y?Y(Bt,`Not sending because RPC '${e}' stream ${s} is closed:`,b):(m||(Y(Bt,`Opening RPC '${e}' stream ${s} transport.`),p.open(),m=!0),Y(Bt,`RPC '${e}' stream ${s} sending:`,b),p.send(b))},Zo:()=>p.close()}),A=(b,E,v)=>{b.listen(E,x=>{try{v(x)}catch(R){setTimeout(()=>{throw R},0)}})};return A(p,fa.EventType.OPEN,()=>{y||(Y(Bt,`RPC '${e}' stream ${s} transport opened.`),w.o_())}),A(p,fa.EventType.CLOSE,()=>{y||(y=!0,Y(Bt,`RPC '${e}' stream ${s} transport closed`),w.a_(),this.E_(p))}),A(p,fa.EventType.ERROR,b=>{y||(y=!0,yi(Bt,`RPC '${e}' stream ${s} transport errored. Name:`,b.name,"Message:",b.message),w.a_(new H(M.UNAVAILABLE,"The operation could not be completed")))}),A(p,fa.EventType.MESSAGE,b=>{var E;if(!y){const v=b.data[0];je(!!v,16349);const x=v,R=(x==null?void 0:x.error)||((E=x[0])==null?void 0:E.error);if(R){Y(Bt,`RPC '${e}' stream ${s} received error:`,R);const O=R.status;let L=function(I){const N=ht[I];if(N!==void 0)return RT(N)}(O),S=R.message;L===void 0&&(L=M.INTERNAL,S="Unknown error status: "+O+" with message "+R.message),y=!0,w.a_(new H(L,S)),p.close()}else Y(Bt,`RPC '${e}' stream ${s} received:`,v),w.u_(v)}}),A(l,GE.STAT_EVENT,b=>{b.stat===Xf.PROXY?Y(Bt,`RPC '${e}' stream ${s} detected buffering proxy`):b.stat===Xf.NOPROXY&&Y(Bt,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{w.__()},0),w}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(n=>n===e)}}function Oh(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Td(t){return new f2(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HT{constructor(e,n,r=1e3,s=1.5,i=6e4){this.Mi=e,this.timerId=n,this.d_=r,this.A_=s,this.R_=i,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const n=Math.floor(this.V_+this.y_()),r=Math.max(0,Date.now()-this.f_),s=Math.max(0,n-r);s>0&&Y("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.V_} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,s,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B_="PersistentStream";class GT{constructor(e,n,r,s,i,o,l,c){this.Mi=e,this.S_=r,this.b_=s,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=l,this.listener=c,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new HT(e,n)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,n){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():n&&n.code===M.RESOURCE_EXHAUSTED?(Wr(n.toString()),Wr("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):n&&n.code===M.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(n)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),n=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.D_===n&&this.G_(r,s)},r=>{e(()=>{const s=new H(M.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(s)})})}G_(e,n){const r=this.W_(this.D_);this.stream=this.j_(e,n),this.stream.Xo(()=>{r(()=>this.listener.Xo())}),this.stream.t_(()=>{r(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(s=>{r(()=>this.z_(s))}),this.stream.onMessage(s=>{r(()=>++this.F_==1?this.J_(s):this.onNext(s))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return Y(B_,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return n=>{this.Mi.enqueueAndForget(()=>this.D_===e?n():(Y(B_,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class cj extends GT{constructor(e,n,r,s,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}j_(e,n){return this.connection.T_("Listen",e,n)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const n=g2(this.serializer,e),r=function(i){if(!("targetChange"in i))return fe.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?fe.min():o.readTime?vr(o.readTime):fe.min()}(e);return this.listener.H_(n,r)}Y_(e){const n={};n.database=up(this.serializer),n.addTarget=function(i,o){let l;const c=o.target;if(l=sp(c)?{documents:_2(i,c)}:{query:MT(i,c).ft},l.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){l.resumeToken=DT(i,o.resumeToken);const d=op(i,o.expectedCount);d!==null&&(l.expectedCount=d)}else if(o.snapshotVersion.compareTo(fe.min())>0){l.readTime=Rc(i,o.snapshotVersion.toTimestamp());const d=op(i,o.expectedCount);d!==null&&(l.expectedCount=d)}return l}(this.serializer,e);const r=E2(this.serializer,e);r&&(n.labels=r),this.q_(n)}Z_(e){const n={};n.database=up(this.serializer),n.removeTarget=e,this.q_(n)}}class dj extends GT{constructor(e,n,r,s,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,n){return this.connection.T_("Write",e,n)}J_(e){return je(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,je(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){je(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const n=v2(e.writeResults,e.commitTime),r=vr(e.commitTime);return this.listener.na(r,n)}ra(){const e={};e.database=up(this.serializer),this.q_(e)}ea(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>y2(this.serializer,r))};this.q_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hj{}class fj extends hj{constructor(e,n,r,s){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=s,this.ia=!1}sa(){if(this.ia)throw new H(M.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,n,r,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.Go(e,ap(n,r),s,i,o)).catch(i=>{throw i.name==="FirebaseError"?(i.code===M.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new H(M.UNKNOWN,i.toString())})}Ho(e,n,r,s,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,l])=>this.connection.Ho(e,ap(n,r),s,o,l,i)).catch(o=>{throw o.name==="FirebaseError"?(o.code===M.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new H(M.UNKNOWN,o.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class pj{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Wr(n),this.aa=!1):Y("OnlineStateTracker",n)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vi="RemoteStore";class mj{constructor(e,n,r,s,i){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=i,this.Aa.Oo(o=>{r.enqueueAndForget(async()=>{Ci(this)&&(Y(vi,"Restarting streams for network reachability change."),await async function(c){const d=he(c);d.Ea.add(4),await Il(d),d.Ra.set("Unknown"),d.Ea.delete(4),await Id(d)}(this))})}),this.Ra=new pj(r,s)}}async function Id(t){if(Ci(t))for(const e of t.da)await e(!0)}async function Il(t){for(const e of t.da)await e(!1)}function KT(t,e){const n=he(t);n.Ia.has(e.targetId)||(n.Ia.set(e.targetId,e),Xm(n)?Jm(n):Fo(n).O_()&&Ym(n,e))}function Qm(t,e){const n=he(t),r=Fo(n);n.Ia.delete(e),r.O_()&&QT(n,e),n.Ia.size===0&&(r.O_()?r.L_():Ci(n)&&n.Ra.set("Unknown"))}function Ym(t,e){if(t.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(fe.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}Fo(t).Y_(e)}function QT(t,e){t.Va.Ue(e),Fo(t).Z_(e)}function Jm(t){t.Va=new u2({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),Fo(t).start(),t.Ra.ua()}function Xm(t){return Ci(t)&&!Fo(t).x_()&&t.Ia.size>0}function Ci(t){return he(t).Ea.size===0}function YT(t){t.Va=void 0}async function gj(t){t.Ra.set("Online")}async function yj(t){t.Ia.forEach((e,n)=>{Ym(t,e)})}async function vj(t,e){YT(t),Xm(t)?(t.Ra.ha(e),Jm(t)):t.Ra.set("Unknown")}async function _j(t,e,n){if(t.Ra.set("Online"),e instanceof jT&&e.state===2&&e.cause)try{await async function(s,i){const o=i.cause;for(const l of i.targetIds)s.Ia.has(l)&&(await s.remoteSyncer.rejectListen(l,o),s.Ia.delete(l),s.Va.removeTarget(l))}(t,e)}catch(r){Y(vi,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await jc(t,r)}else if(e instanceof zu?t.Va.Ze(e):e instanceof PT?t.Va.st(e):t.Va.tt(e),!n.isEqual(fe.min()))try{const r=await WT(t.localStore);n.compareTo(r)>=0&&await function(i,o){const l=i.Va.Tt(o);return l.targetChanges.forEach((c,d)=>{if(c.resumeToken.approximateByteSize()>0){const f=i.Ia.get(d);f&&i.Ia.set(d,f.withResumeToken(c.resumeToken,o))}}),l.targetMismatches.forEach((c,d)=>{const f=i.Ia.get(c);if(!f)return;i.Ia.set(c,f.withResumeToken(kt.EMPTY_BYTE_STRING,f.snapshotVersion)),QT(i,c);const p=new ys(f.target,c,d,f.sequenceNumber);Ym(i,p)}),i.remoteSyncer.applyRemoteEvent(l)}(t,n)}catch(r){Y(vi,"Failed to raise snapshot:",r),await jc(t,r)}}async function jc(t,e,n){if(!Uo(e))throw e;t.Ea.add(1),await Il(t),t.Ra.set("Offline"),n||(n=()=>WT(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{Y(vi,"Retrying IndexedDB access"),await n(),t.Ea.delete(1),await Id(t)})}function JT(t,e){return e().catch(n=>jc(t,n,e))}async function Sd(t){const e=he(t),n=Ls(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Vm;for(;wj(e);)try{const s=await tj(e.localStore,r);if(s===null){e.Ta.length===0&&n.L_();break}r=s.batchId,xj(e,s)}catch(s){await jc(e,s)}XT(e)&&ZT(e)}function wj(t){return Ci(t)&&t.Ta.length<10}function xj(t,e){t.Ta.push(e);const n=Ls(t);n.O_()&&n.X_&&n.ea(e.mutations)}function XT(t){return Ci(t)&&!Ls(t).x_()&&t.Ta.length>0}function ZT(t){Ls(t).start()}async function Ej(t){Ls(t).ra()}async function Tj(t){const e=Ls(t);for(const n of t.Ta)e.ea(n.mutations)}async function Ij(t,e,n){const r=t.Ta.shift(),s=Bm.from(r,e,n);await JT(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await Sd(t)}async function Sj(t,e){e&&Ls(t).X_&&await async function(r,s){if(function(o){return o2(o)&&o!==M.ABORTED}(s.code)){const i=r.Ta.shift();Ls(r).B_(),await JT(r,()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s)),await Sd(r)}}(t,e),XT(t)&&ZT(t)}async function z_(t,e){const n=he(t);n.asyncQueue.verifyOperationInProgress(),Y(vi,"RemoteStore received new credentials");const r=Ci(n);n.Ea.add(3),await Il(n),r&&n.Ra.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.Ea.delete(3),await Id(n)}async function Nj(t,e){const n=he(t);e?(n.Ea.delete(2),await Id(n)):e||(n.Ea.add(2),await Il(n),n.Ra.set("Unknown"))}function Fo(t){return t.ma||(t.ma=function(n,r,s){const i=he(n);return i.sa(),new cj(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Xo:gj.bind(null,t),t_:yj.bind(null,t),r_:vj.bind(null,t),H_:_j.bind(null,t)}),t.da.push(async e=>{e?(t.ma.B_(),Xm(t)?Jm(t):t.Ra.set("Unknown")):(await t.ma.stop(),YT(t))})),t.ma}function Ls(t){return t.fa||(t.fa=function(n,r,s){const i=he(n);return i.sa(),new dj(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Xo:()=>Promise.resolve(),t_:Ej.bind(null,t),r_:Sj.bind(null,t),ta:Tj.bind(null,t),na:Ij.bind(null,t)}),t.da.push(async e=>{e?(t.fa.B_(),await Sd(t)):(await t.fa.stop(),t.Ta.length>0&&(Y(vi,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))})),t.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zm{constructor(e,n,r,s,i){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new gr,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,s,i){const o=Date.now()+r,l=new Zm(e,n,o,s,i);return l.start(r),l}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new H(M.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function eg(t,e){if(Wr("AsyncQueue",`${e}: ${t}`),Uo(t))return new H(M.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fo{static emptySet(e){return new fo(e.comparator)}constructor(e){this.comparator=e?(n,r)=>e(n,r)||ee.comparator(n.key,r.key):(n,r)=>ee.comparator(n.key,r.key),this.keyedMap=pa(),this.sortedSet=new rt(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof fo)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new fo;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q_{constructor(){this.ga=new rt(ee.comparator)}track(e){const n=e.doc.key,r=this.ga.get(n);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(n,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(n):e.type===1&&r.type===2?this.ga=this.ga.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):ae(63341,{Rt:e,pa:r}):this.ga=this.ga.insert(n,e)}ya(){const e=[];return this.ga.inorderTraversal((n,r)=>{e.push(r)}),e}}class Ao{constructor(e,n,r,s,i,o,l,c,d){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=l,this.excludesMetadataChanges=c,this.hasCachedResults=d}static fromInitialDocuments(e,n,r,s,i){const o=[];return n.forEach(l=>{o.push({type:0,doc:l})}),new Ao(e,n,fo.emptySet(n),o,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&yd(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let s=0;s<n.length;s++)if(n[s].type!==r[s].type||!n[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bj{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class Aj{constructor(){this.queries=W_(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(n,r){const s=he(n),i=s.queries;s.queries=W_(),i.forEach((o,l)=>{for(const c of l.Sa)c.onError(r)})})(this,new H(M.ABORTED,"Firestore shutting down"))}}function W_(){return new Ai(t=>_T(t),yd)}async function tg(t,e){const n=he(t);let r=3;const s=e.query;let i=n.queries.get(s);i?!i.ba()&&e.Da()&&(r=2):(i=new bj,r=e.Da()?0:1);try{switch(r){case 0:i.wa=await n.onListen(s,!0);break;case 1:i.wa=await n.onListen(s,!1);break;case 2:await n.onFirstRemoteStoreListen(s)}}catch(o){const l=eg(o,`Initialization of query '${$i(e.query)}' failed`);return void e.onError(l)}n.queries.set(s,i),i.Sa.push(e),e.va(n.onlineState),i.wa&&e.Fa(i.wa)&&rg(n)}async function ng(t,e){const n=he(t),r=e.query;let s=3;const i=n.queries.get(r);if(i){const o=i.Sa.indexOf(e);o>=0&&(i.Sa.splice(o,1),i.Sa.length===0?s=e.Da()?0:1:!i.ba()&&e.Da()&&(s=2))}switch(s){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function Cj(t,e){const n=he(t);let r=!1;for(const s of e){const i=s.query,o=n.queries.get(i);if(o){for(const l of o.Sa)l.Fa(s)&&(r=!0);o.wa=s}}r&&rg(n)}function kj(t,e,n){const r=he(t),s=r.queries.get(e);if(s)for(const i of s.Sa)i.onError(n);r.queries.delete(e)}function rg(t){t.Ca.forEach(e=>{e.next()})}var hp,H_;(H_=hp||(hp={})).Ma="default",H_.Cache="cache";class sg{constructor(e,n,r){this.query=e,this.xa=n,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new Ao(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),n=!0):this.La(e,this.onlineState)&&(this.ka(e),n=!0),this.Na=e,n}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let n=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),n=!0),n}La(e,n){if(!e.fromCache||!this.Da())return!0;const r=n!=="Offline";return(!this.options.qa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const n=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}ka(e){e=Ao.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==hp.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eI{constructor(e){this.key=e}}class tI{constructor(e){this.key=e}}class Rj{constructor(e,n){this.query=e,this.Ya=n,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=Te(),this.mutatedKeys=Te(),this.eu=wT(e),this.tu=new fo(this.eu)}get nu(){return this.Ya}ru(e,n){const r=n?n.iu:new q_,s=n?n.tu:this.tu;let i=n?n.mutatedKeys:this.mutatedKeys,o=s,l=!1;const c=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,d=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((f,p)=>{const m=s.get(f),y=vd(this.query,p)?p:null,w=!!m&&this.mutatedKeys.has(m.key),A=!!y&&(y.hasLocalMutations||this.mutatedKeys.has(y.key)&&y.hasCommittedMutations);let b=!1;m&&y?m.data.isEqual(y.data)?w!==A&&(r.track({type:3,doc:y}),b=!0):this.su(m,y)||(r.track({type:2,doc:y}),b=!0,(c&&this.eu(y,c)>0||d&&this.eu(y,d)<0)&&(l=!0)):!m&&y?(r.track({type:0,doc:y}),b=!0):m&&!y&&(r.track({type:1,doc:m}),b=!0,(c||d)&&(l=!0)),b&&(y?(o=o.add(y),i=A?i.add(f):i.delete(f)):(o=o.delete(f),i=i.delete(f)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const f=this.query.limitType==="F"?o.last():o.first();o=o.delete(f.key),i=i.delete(f.key),r.track({type:1,doc:f})}return{tu:o,iu:r,Cs:l,mutatedKeys:i}}su(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,s){const i=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const o=e.iu.ya();o.sort((f,p)=>function(y,w){const A=b=>{switch(b){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ae(20277,{Rt:b})}};return A(y)-A(w)}(f.type,p.type)||this.eu(f.doc,p.doc)),this.ou(r),s=s??!1;const l=n&&!s?this._u():[],c=this.Xa.size===0&&this.current&&!s?1:0,d=c!==this.Za;return this.Za=c,o.length!==0||d?{snapshot:new Ao(this.query,e.tu,i,o,e.mutatedKeys,c===0,d,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:l}:{au:l}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new q_,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(n=>this.Ya=this.Ya.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ya=this.Ya.delete(n)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=Te(),this.tu.forEach(r=>{this.uu(r.key)&&(this.Xa=this.Xa.add(r.key))});const n=[];return e.forEach(r=>{this.Xa.has(r)||n.push(new tI(r))}),this.Xa.forEach(r=>{e.has(r)||n.push(new eI(r))}),n}cu(e){this.Ya=e.Qs,this.Xa=Te();const n=this.ru(e.documents);return this.applyChanges(n,!0)}lu(){return Ao.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const ig="SyncEngine";class Pj{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class jj{constructor(e){this.key=e,this.hu=!1}}class Dj{constructor(e,n,r,s,i,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new Ai(l=>_T(l),yd),this.Iu=new Map,this.Eu=new Set,this.du=new rt(ee.comparator),this.Au=new Map,this.Ru=new Wm,this.Vu={},this.mu=new Map,this.fu=bo.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function Oj(t,e,n=!0){const r=aI(t);let s;const i=r.Tu.get(e);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.lu()):s=await nI(r,e,n,!0),s}async function Vj(t,e){const n=aI(t);await nI(n,e,!0,!1)}async function nI(t,e,n,r){const s=await nj(t.localStore,yr(e)),i=s.targetId,o=t.sharedClientState.addLocalQueryTarget(i,n);let l;return r&&(l=await Lj(t,e,i,o==="current",s.resumeToken)),t.isPrimaryClient&&n&&KT(t.remoteStore,s),l}async function Lj(t,e,n,r,s){t.pu=(p,m,y)=>async function(A,b,E,v){let x=b.view.ru(E);x.Cs&&(x=await M_(A.localStore,b.query,!1).then(({documents:S})=>b.view.ru(S,x)));const R=v&&v.targetChanges.get(b.targetId),O=v&&v.targetMismatches.get(b.targetId)!=null,L=b.view.applyChanges(x,A.isPrimaryClient,R,O);return K_(A,b.targetId,L.au),L.snapshot}(t,p,m,y);const i=await M_(t.localStore,e,!0),o=new Rj(e,i.Qs),l=o.ru(i.documents),c=Tl.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",s),d=o.applyChanges(l,t.isPrimaryClient,c);K_(t,n,d.au);const f=new Pj(e,n,o);return t.Tu.set(e,f),t.Iu.has(n)?t.Iu.get(n).push(e):t.Iu.set(n,[e]),d.snapshot}async function Mj(t,e,n){const r=he(t),s=r.Tu.get(e),i=r.Iu.get(s.targetId);if(i.length>1)return r.Iu.set(s.targetId,i.filter(o=>!yd(o,e))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await cp(r.localStore,s.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(s.targetId),n&&Qm(r.remoteStore,s.targetId),fp(r,s.targetId)}).catch(Mo)):(fp(r,s.targetId),await cp(r.localStore,s.targetId,!0))}async function Uj(t,e){const n=he(t),r=n.Tu.get(e),s=n.Iu.get(r.targetId);n.isPrimaryClient&&s.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),Qm(n.remoteStore,r.targetId))}async function Fj(t,e,n){const r=Gj(t);try{const s=await function(o,l){const c=he(o),d=Be.now(),f=l.reduce((y,w)=>y.add(w.key),Te());let p,m;return c.persistence.runTransaction("Locally write mutations","readwrite",y=>{let w=Hr(),A=Te();return c.Ns.getEntries(y,f).next(b=>{w=b,w.forEach((E,v)=>{v.isValidDocument()||(A=A.add(E))})}).next(()=>c.localDocuments.getOverlayedDocuments(y,w)).next(b=>{p=b;const E=[];for(const v of l){const x=e2(v,p.get(v.key).overlayedDocument);x!=null&&E.push(new zs(v.key,x,cT(x.value.mapValue),en.exists(!0)))}return c.mutationQueue.addMutationBatch(y,d,E,l)}).next(b=>{m=b;const E=b.applyToLocalDocumentSet(p,A);return c.documentOverlayCache.saveOverlays(y,b.batchId,E)})}).then(()=>({batchId:m.batchId,changes:ET(p)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(o,l,c){let d=o.Vu[o.currentUser.toKey()];d||(d=new rt(Ee)),d=d.insert(l,c),o.Vu[o.currentUser.toKey()]=d}(r,s.batchId,n),await Sl(r,s.changes),await Sd(r.remoteStore)}catch(s){const i=eg(s,"Failed to persist write");n.reject(i)}}async function rI(t,e){const n=he(t);try{const r=await Z2(n.localStore,e);e.targetChanges.forEach((s,i)=>{const o=n.Au.get(i);o&&(je(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1,22616),s.addedDocuments.size>0?o.hu=!0:s.modifiedDocuments.size>0?je(o.hu,14607):s.removedDocuments.size>0&&(je(o.hu,42227),o.hu=!1))}),await Sl(n,r,e)}catch(r){await Mo(r)}}function G_(t,e,n){const r=he(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const s=[];r.Tu.forEach((i,o)=>{const l=o.view.va(e);l.snapshot&&s.push(l.snapshot)}),function(o,l){const c=he(o);c.onlineState=l;let d=!1;c.queries.forEach((f,p)=>{for(const m of p.Sa)m.va(l)&&(d=!0)}),d&&rg(c)}(r.eventManager,e),s.length&&r.Pu.H_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function $j(t,e,n){const r=he(t);r.sharedClientState.updateQueryState(e,"rejected",n);const s=r.Au.get(e),i=s&&s.key;if(i){let o=new rt(ee.comparator);o=o.insert(i,Wt.newNoDocument(i,fe.min()));const l=Te().add(i),c=new Ed(fe.min(),new Map,new rt(Ee),o,l);await rI(r,c),r.du=r.du.remove(i),r.Au.delete(e),og(r)}else await cp(r.localStore,e,!1).then(()=>fp(r,e,n)).catch(Mo)}async function Bj(t,e){const n=he(t),r=e.batch.batchId;try{const s=await X2(n.localStore,e);iI(n,r,null),sI(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await Sl(n,s)}catch(s){await Mo(s)}}async function zj(t,e,n){const r=he(t);try{const s=await function(o,l){const c=he(o);return c.persistence.runTransaction("Reject batch","readwrite-primary",d=>{let f;return c.mutationQueue.lookupMutationBatch(d,l).next(p=>(je(p!==null,37113),f=p.keys(),c.mutationQueue.removeMutationBatch(d,p))).next(()=>c.mutationQueue.performConsistencyCheck(d)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(d,f,l)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,f)).next(()=>c.localDocuments.getDocuments(d,f))})}(r.localStore,e);iI(r,e,n),sI(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await Sl(r,s)}catch(s){await Mo(s)}}function sI(t,e){(t.mu.get(e)||[]).forEach(n=>{n.resolve()}),t.mu.delete(e)}function iI(t,e,n){const r=he(t);let s=r.Vu[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(n?i.reject(n):i.resolve(),s=s.remove(e)),r.Vu[r.currentUser.toKey()]=s}}function fp(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Iu.get(e))t.Tu.delete(r),n&&t.Pu.yu(r,n);t.Iu.delete(e),t.isPrimaryClient&&t.Ru.jr(e).forEach(r=>{t.Ru.containsKey(r)||oI(t,r)})}function oI(t,e){t.Eu.delete(e.path.canonicalString());const n=t.du.get(e);n!==null&&(Qm(t.remoteStore,n),t.du=t.du.remove(e),t.Au.delete(n),og(t))}function K_(t,e,n){for(const r of n)r instanceof eI?(t.Ru.addReference(r.key,e),qj(t,r)):r instanceof tI?(Y(ig,"Document no longer in limbo: "+r.key),t.Ru.removeReference(r.key,e),t.Ru.containsKey(r.key)||oI(t,r.key)):ae(19791,{wu:r})}function qj(t,e){const n=e.key,r=n.path.canonicalString();t.du.get(n)||t.Eu.has(r)||(Y(ig,"New document in limbo: "+n),t.Eu.add(r),og(t))}function og(t){for(;t.Eu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const n=new ee(Ue.fromString(e)),r=t.fu.next();t.Au.set(r,new jj(n)),t.du=t.du.insert(n,r),KT(t.remoteStore,new ys(yr(gd(n.path)),r,"TargetPurposeLimboResolution",fd.ce))}}async function Sl(t,e,n){const r=he(t),s=[],i=[],o=[];r.Tu.isEmpty()||(r.Tu.forEach((l,c)=>{o.push(r.pu(c,e,n).then(d=>{var f;if((d||n)&&r.isPrimaryClient){const p=d?!d.fromCache:(f=n==null?void 0:n.targetChanges.get(c.targetId))==null?void 0:f.current;r.sharedClientState.updateQueryState(c.targetId,p?"current":"not-current")}if(d){s.push(d);const p=Gm.As(c.targetId,d);i.push(p)}}))}),await Promise.all(o),r.Pu.H_(s),await async function(c,d){const f=he(c);try{await f.persistence.runTransaction("notifyLocalViewChanges","readwrite",p=>U.forEach(d,m=>U.forEach(m.Es,y=>f.persistence.referenceDelegate.addReference(p,m.targetId,y)).next(()=>U.forEach(m.ds,y=>f.persistence.referenceDelegate.removeReference(p,m.targetId,y)))))}catch(p){if(!Uo(p))throw p;Y(Km,"Failed to update sequence numbers: "+p)}for(const p of d){const m=p.targetId;if(!p.fromCache){const y=f.Ms.get(m),w=y.snapshotVersion,A=y.withLastLimboFreeSnapshotVersion(w);f.Ms=f.Ms.insert(m,A)}}}(r.localStore,i))}async function Wj(t,e){const n=he(t);if(!n.currentUser.isEqual(e)){Y(ig,"User change. New user:",e.toKey());const r=await qT(n.localStore,e);n.currentUser=e,function(i,o){i.mu.forEach(l=>{l.forEach(c=>{c.reject(new H(M.CANCELLED,o))})}),i.mu.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Sl(n,r.Ls)}}function Hj(t,e){const n=he(t),r=n.Au.get(e);if(r&&r.hu)return Te().add(r.key);{let s=Te();const i=n.Iu.get(e);if(!i)return s;for(const o of i){const l=n.Tu.get(o);s=s.unionWith(l.view.nu)}return s}}function aI(t){const e=he(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=rI.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=Hj.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=$j.bind(null,e),e.Pu.H_=Cj.bind(null,e.eventManager),e.Pu.yu=kj.bind(null,e.eventManager),e}function Gj(t){const e=he(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=Bj.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=zj.bind(null,e),e}class Dc{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Td(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,n){return null}Mu(e,n){return null}vu(e){return J2(this.persistence,new K2,e.initialUser,this.serializer)}Cu(e){return new zT(Hm.mi,this.serializer)}Du(e){return new sj}async terminate(){var e,n;(e=this.gcScheduler)==null||e.stop(),(n=this.indexBackfillerScheduler)==null||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Dc.provider={build:()=>new Dc};class Kj extends Dc{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,n){je(this.persistence.referenceDelegate instanceof Pc,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new j2(r,e.asyncQueue,n)}Cu(e){const n=this.cacheSizeBytes!==void 0?sn.withCacheSize(this.cacheSizeBytes):sn.DEFAULT;return new zT(r=>Pc.mi(r,n),this.serializer)}}class pp{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>G_(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=Wj.bind(null,this.syncEngine),await Nj(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new Aj}()}createDatastore(e){const n=Td(e.databaseInfo.databaseId),r=function(i){return new uj(i)}(e.databaseInfo);return function(i,o,l,c){return new fj(i,o,l,c)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,s,i,o,l){return new mj(r,s,i,o,l)}(this.localStore,this.datastore,e.asyncQueue,n=>G_(this.syncEngine,n,0),function(){return $_.v()?new $_:new ij}())}createSyncEngine(e,n){return function(s,i,o,l,c,d,f){const p=new Dj(s,i,o,l,c,d);return f&&(p.gu=!0),p}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(s){const i=he(s);Y(vi,"RemoteStore shutting down."),i.Ea.add(5),await Il(i),i.Aa.shutdown(),i.Ra.set("Unknown")}(this.remoteStore),(e=this.datastore)==null||e.terminate(),(n=this.eventManager)==null||n.terminate()}}pp.provider={build:()=>new pp};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ag{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Wr("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ms="FirestoreClient";class Qj{constructor(e,n,r,s,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=s,this.user=zt.UNAUTHENTICATED,this.clientId=dd.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,async o=>{Y(Ms,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(Y(Ms,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new gr;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=eg(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function Vh(t,e){t.asyncQueue.verifyOperationInProgress(),Y(Ms,"Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async s=>{r.isEqual(s)||(await qT(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function Q_(t,e){t.asyncQueue.verifyOperationInProgress();const n=await Yj(t);Y(Ms,"Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>z_(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,s)=>z_(e.remoteStore,s)),t._onlineComponents=e}async function Yj(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){Y(Ms,"Using user provided OfflineComponentProvider");try{await Vh(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(s){return s.name==="FirebaseError"?s.code===M.FAILED_PRECONDITION||s.code===M.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(n))throw n;yi("Error using user provided cache. Falling back to memory cache: "+n),await Vh(t,new Dc)}}else Y(Ms,"Using default OfflineComponentProvider"),await Vh(t,new Kj(void 0));return t._offlineComponents}async function lg(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(Y(Ms,"Using user provided OnlineComponentProvider"),await Q_(t,t._uninitializedComponentsProvider._online)):(Y(Ms,"Using default OnlineComponentProvider"),await Q_(t,new pp))),t._onlineComponents}function Jj(t){return lg(t).then(e=>e.syncEngine)}function Xj(t){return lg(t).then(e=>e.datastore)}async function Oc(t){const e=await lg(t),n=e.eventManager;return n.onListen=Oj.bind(null,e.syncEngine),n.onUnlisten=Mj.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=Vj.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=Uj.bind(null,e.syncEngine),n}function Zj(t,e,n={}){const r=new gr;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,l,c,d){const f=new ag({next:m=>{f.Nu(),o.enqueueAndForget(()=>ng(i,p));const y=m.docs.has(l);!y&&m.fromCache?d.reject(new H(M.UNAVAILABLE,"Failed to get document because the client is offline.")):y&&m.fromCache&&c&&c.source==="server"?d.reject(new H(M.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):d.resolve(m)},error:m=>d.reject(m)}),p=new sg(gd(l.path),f,{includeMetadataChanges:!0,qa:!0});return tg(i,p)}(await Oc(t),t.asyncQueue,e,n,r)),r.promise}function eD(t,e,n={}){const r=new gr;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,l,c,d){const f=new ag({next:m=>{f.Nu(),o.enqueueAndForget(()=>ng(i,p)),m.fromCache&&c.source==="server"?d.reject(new H(M.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):d.resolve(m)},error:m=>d.reject(m)}),p=new sg(l,f,{includeMetadataChanges:!0,qa:!0});return tg(i,p)}(await Oc(t),t.asyncQueue,e,n,r)),r.promise}function tD(t,e,n){const r=new gr;return t.asyncQueue.enqueueAndForget(async()=>{try{const s=await Xj(t);r.resolve(async function(o,l,c){var A;const d=he(o),{request:f,gt:p,parent:m}=w2(d.serializer,UP(l),c);d.connection.$o||delete f.parent;const y=(await d.Ho("RunAggregationQuery",d.serializer.databaseId,m,f,1)).filter(b=>!!b.result);je(y.length===1,64727);const w=(A=y[0].result)==null?void 0:A.aggregateFields;return Object.keys(w).reduce((b,E)=>(b[p[E]]=w[E],b),{})}(s,e,n))}catch(s){r.reject(s)}}),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lI(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Y_=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uI="firestore.googleapis.com",J_=!0;class X_{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new H(M.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=uI,this.ssl=J_}else this.host=e.host,this.ssl=e.ssl??J_;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=BT;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<R2)throw new H(M.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}ZE("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=lI(e.experimentalLongPollingOptions??{}),function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new H(M.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new H(M.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new H(M.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,s){return r.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Nl{constructor(e,n,r,s){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new X_({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new H(M.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new H(M.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new X_(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new XE;switch(r.type){case"firstParty":return new aP(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new H(M.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=Y_.get(n);r&&(Y("ComponentProvider","Removing Datastore"),Y_.delete(n),r.terminate())}(this),Promise.resolve()}}function cI(t,e,n,r={}){var d;t=Ct(t,Nl);const s=Ii(e),i=t._getSettings(),o={...i,emulatorOptions:t._getEmulatorOptions()},l=`${e}:${n}`;s&&(mm(`https://${l}`),gm("Firestore",!0)),i.host!==uI&&i.host!==l&&yi("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const c={...i,host:l,ssl:s,emulatorOptions:r};if(!fi(c,o)&&(t._setSettings(c),r.mockUserToken)){let f,p;if(typeof r.mockUserToken=="string")f=r.mockUserToken,p=zt.MOCK_USER;else{f=p1(r.mockUserToken,(d=t._app)==null?void 0:d.options.projectId);const m=r.mockUserToken.sub||r.mockUserToken.user_id;if(!m)throw new H(M.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");p=new zt(m)}t._authCredentials=new sP(new JE(f,p))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sr{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new sr(this.firestore,e,this._query)}}class Ze{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Mr(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Ze(this.firestore,e,this._key)}toJSON(){return{type:Ze._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,n,r){if(xl(n,Ze._jsonSchema))return new Ze(e,r||null,new ee(Ue.fromString(n.referencePath)))}}Ze._jsonSchemaVersion="firestore/documentReference/1.0",Ze._jsonSchema={type:mt("string",Ze._jsonSchemaVersion),referencePath:mt("string")};class Mr extends sr{constructor(e,n,r){super(e,n,gd(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Ze(this.firestore,null,new ee(e))}withConverter(e){return new Mr(this.firestore,e,this._path)}}function pe(t,e,...n){if(t=De(t),Om("collection","path",e),t instanceof Nl){const r=Ue.fromString(e,...n);return d_(r),new Mr(t,null,r)}{if(!(t instanceof Ze||t instanceof Mr))throw new H(M.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Ue.fromString(e,...n));return d_(r),new Mr(t.firestore,null,r)}}function _r(t,e){if(t=Ct(t,Nl),Om("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new H(M.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new sr(t,null,function(r){return new bi(Ue.emptyPath(),r)}(e))}function G(t,e,...n){if(t=De(t),arguments.length===1&&(e=dd.newId()),Om("doc","path",e),t instanceof Nl){const r=Ue.fromString(e,...n);return c_(r),new Ze(t,null,new ee(r))}{if(!(t instanceof Ze||t instanceof Mr))throw new H(M.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Ue.fromString(e,...n));return c_(r),new Ze(t.firestore,t instanceof Mr?t.converter:null,new ee(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Z_="AsyncQueue";class ew{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new HT(this,"async_queue_retry"),this._c=()=>{const r=Oh();r&&Y(Z_,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const n=Oh();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const n=Oh();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const n=new gr;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!Uo(e))throw e;Y(Z_,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const n=this.ac.then(()=>(this.rc=!0,e().catch(r=>{throw this.nc=r,this.rc=!1,Wr("INTERNAL UNHANDLED ERROR: ",tw(r)),r}).then(r=>(this.rc=!1,r))));return this.ac=n,n}enqueueAfterDelay(e,n,r){this.uc(),this.oc.indexOf(e)>-1&&(n=0);const s=Zm.createAndSchedule(this,e,n,r,i=>this.hc(i));return this.tc.push(s),s}uc(){this.nc&&ae(47125,{Pc:tw(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const n of this.tc)if(n.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.tc)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const n=this.tc.indexOf(e);this.tc.splice(n,1)}}function tw(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nw(t){return function(n,r){if(typeof n!="object"||n===null)return!1;const s=n;for(const i of r)if(i in s&&typeof s[i]=="function")return!0;return!1}(t,["next","error","complete"])}class On extends Nl{constructor(e,n,r,s){super(e,n,r,s),this.type="firestore",this._queue=new ew,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new ew(e),this._firestoreClient=void 0,await e}}}function $e(t,e){const n=typeof t=="object"?t:gl(),r=typeof t=="string"?t:Nc,s=Ni(n,"firestore").getImmediate({identifier:r});if(!s._initialized){const i=Z0("firestore");i&&cI(s,...i)}return s}function ki(t){if(t._terminated)throw new H(M.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||nD(t),t._firestoreClient}function nD(t){var r,s,i;const e=t._freezeSettings(),n=function(l,c,d,f){return new IP(l,c,d,f.host,f.ssl,f.experimentalForceLongPolling,f.experimentalAutoDetectLongPolling,lI(f.experimentalLongPollingOptions),f.useFetchStreams,f.isUsingEmulator)}(t._databaseId,((r=t._app)==null?void 0:r.options.appId)||"",t._persistenceKey,e);t._componentsProvider||(s=e.localCache)!=null&&s._offlineComponentProvider&&((i=e.localCache)!=null&&i._onlineComponentProvider)&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new Qj(t._authCredentials,t._appCheckCredentials,t._queue,n,t._componentsProvider&&function(l){const c=l==null?void 0:l._online.build();return{_offline:l==null?void 0:l._offline.build(c),_online:c}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dI{constructor(e="count",n){this._internalFieldPath=n,this.type="AggregateField",this.aggregateType=e}}class hI{constructor(e,n,r){this._userDataWriter=n,this._data=r,this.type="AggregateQuerySnapshot",this.query=e}data(){return this._userDataWriter.convertObjectMap(this._data)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yn{constructor(e){this._byteString=e}static fromBase64String(e){try{return new yn(kt.fromBase64String(e))}catch(n){throw new H(M.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new yn(kt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:yn._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(xl(e,yn._jsonSchema))return yn.fromBase64String(e.bytes)}}yn._jsonSchemaVersion="firestore/bytes/1.0",yn._jsonSchema={type:mt("string",yn._jsonSchemaVersion),bytes:mt("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ri{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new H(M.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new bt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}function ug(){return new Ri(ep)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bl{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jn{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new H(M.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new H(M.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Ee(this._lat,e._lat)||Ee(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Jn._jsonSchemaVersion}}static fromJSON(e){if(xl(e,Jn._jsonSchema))return new Jn(e.latitude,e.longitude)}}Jn._jsonSchemaVersion="firestore/geoPoint/1.0",Jn._jsonSchema={type:mt("string",Jn._jsonSchemaVersion),latitude:mt("number"),longitude:mt("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xn{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,s){if(r.length!==s.length)return!1;for(let i=0;i<r.length;++i)if(r[i]!==s[i])return!1;return!0}(this._values,e._values)}toJSON(){return{type:Xn._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(xl(e,Xn._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(n=>typeof n=="number"))return new Xn(e.vectorValues);throw new H(M.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Xn._jsonSchemaVersion="firestore/vectorValue/1.0",Xn._jsonSchema={type:mt("string",Xn._jsonSchemaVersion),vectorValues:mt("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rD=/^__.*__$/;class sD{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new zs(e,this.data,this.fieldMask,n,this.fieldTransforms):new El(e,this.data,n,this.fieldTransforms)}}class fI{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new zs(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function pI(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ae(40011,{Ac:t})}}class cg{constructor(e,n,r,s,i,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.Rc(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new cg({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var s;const n=(s=this.path)==null?void 0:s.child(e),r=this.Vc({path:n,fc:!1});return r.gc(e),r}yc(e){var s;const n=(s=this.path)==null?void 0:s.child(e),r=this.Vc({path:n,fc:!1});return r.Rc(),r}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Vc(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(pI(this.Ac)&&rD.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class iD{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||Td(e)}Cc(e,n,r,s=!1){return new cg({Ac:e,methodName:n,Dc:r,path:bt.emptyPath(),fc:!1,bc:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Al(t){const e=t._freezeSettings(),n=Td(t._databaseId);return new iD(t._databaseId,!!e.ignoreUndefinedProperties,n)}function dg(t,e,n,r,s,i={}){const o=t.Cc(i.merge||i.mergeFields?2:0,e,n,s);fg("Data must be an object, but it was:",o,r);const l=yI(r,o);let c,d;if(i.merge)c=new _n(o.fieldMask),d=o.fieldTransforms;else if(i.mergeFields){const f=[];for(const p of i.mergeFields){const m=mp(e,p,n);if(!o.contains(m))throw new H(M.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);_I(f,m)||f.push(m)}c=new _n(f),d=o.fieldTransforms.filter(p=>c.covers(p.field))}else c=null,d=o.fieldTransforms;return new sD(new ln(l),c,d)}class Cl extends bl{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Cl}}class hg extends bl{_toFieldTransform(e){return new YP(e.path,new sl)}isEqual(e){return e instanceof hg}}function mI(t,e,n,r){const s=t.Cc(1,e,n);fg("Data must be an object, but it was:",s,r);const i=[],o=ln.empty();Bs(r,(c,d)=>{const f=pg(e,c,n);d=De(d);const p=s.yc(f);if(d instanceof Cl)i.push(f);else{const m=kl(d,p);m!=null&&(i.push(f),o.set(f,m))}});const l=new _n(i);return new fI(o,l,s.fieldTransforms)}function gI(t,e,n,r,s,i){const o=t.Cc(1,e,n),l=[mp(e,r,n)],c=[s];if(i.length%2!=0)throw new H(M.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let m=0;m<i.length;m+=2)l.push(mp(e,i[m])),c.push(i[m+1]);const d=[],f=ln.empty();for(let m=l.length-1;m>=0;--m)if(!_I(d,l[m])){const y=l[m];let w=c[m];w=De(w);const A=o.yc(y);if(w instanceof Cl)d.push(y);else{const b=kl(w,A);b!=null&&(d.push(y),f.set(y,b))}}const p=new _n(d);return new fI(f,p,o.fieldTransforms)}function oD(t,e,n,r=!1){return kl(n,t.Cc(r?4:3,e))}function kl(t,e){if(vI(t=De(t)))return fg("Unsupported field value:",e,t),yI(t,e);if(t instanceof bl)return function(r,s){if(!pI(s.Ac))throw s.Sc(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Sc(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return function(r,s){const i=[];let o=0;for(const l of r){let c=kl(l,s.wc(o));c==null&&(c={nullValue:"NULL_VALUE"}),i.push(c),o++}return{arrayValue:{values:i}}}(t,e)}return function(r,s){if((r=De(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return GP(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=Be.fromDate(r);return{timestampValue:Rc(s.serializer,i)}}if(r instanceof Be){const i=new Be(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Rc(s.serializer,i)}}if(r instanceof Jn)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof yn)return{bytesValue:DT(s.serializer,r._byteString)};if(r instanceof Ze){const i=s.databaseId,o=r.firestore._databaseId;if(!o.isEqual(i))throw s.Sc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:qm(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof Xn)return function(o,l){return{mapValue:{fields:{[lT]:{stringValue:uT},[bc]:{arrayValue:{values:o.toArray().map(d=>{if(typeof d!="number")throw l.Sc("VectorValues must only contain numeric values.");return $m(l.serializer,d)})}}}}}}(r,s);throw s.Sc(`Unsupported field value: ${hd(r)}`)}(t,e)}function yI(t,e){const n={};return nT(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Bs(t,(r,s)=>{const i=kl(s,e.mc(r));i!=null&&(n[r]=i)}),{mapValue:{fields:n}}}function vI(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof Be||t instanceof Jn||t instanceof yn||t instanceof Ze||t instanceof bl||t instanceof Xn)}function fg(t,e,n){if(!vI(n)||!eT(n)){const r=hd(n);throw r==="an object"?e.Sc(t+" a custom object"):e.Sc(t+" "+r)}}function mp(t,e,n){if((e=De(e))instanceof Ri)return e._internalPath;if(typeof e=="string")return pg(t,e);throw Vc("Field path arguments must be of type string or ",t,!1,void 0,n)}const aD=new RegExp("[~\\*/\\[\\]]");function pg(t,e,n){if(e.search(aD)>=0)throw Vc(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new Ri(...e.split("."))._internalPath}catch{throw Vc(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Vc(t,e,n,r,s){const i=r&&!r.isEmpty(),o=s!==void 0;let l=`Function ${e}() called with invalid data`;n&&(l+=" (via `toFirestore()`)"),l+=". ";let c="";return(i||o)&&(c+=" (found",i&&(c+=` in field ${r}`),o&&(c+=` in document ${s}`),c+=")"),new H(M.INVALID_ARGUMENT,l+t+c)}function _I(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wI{constructor(e,n,r,s,i){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Ze(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new lD(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(Nd("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class lD extends wI{data(){return super.data()}}function Nd(t,e){return typeof e=="string"?pg(t,e):e instanceof Ri?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xI(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new H(M.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class mg{}class bd extends mg{}function Je(t,e,...n){let r=[];e instanceof mg&&r.push(e),r=r.concat(n),function(i){const o=i.filter(c=>c instanceof Ad).length,l=i.filter(c=>c instanceof Rl).length;if(o>1||o>0&&l>0)throw new H(M.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const s of r)t=s._apply(t);return t}class Rl extends bd{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new Rl(e,n,r)}_apply(e){const n=this._parse(e);return EI(e._query,n),new sr(e.firestore,e.converter,ip(e._query,n))}_parse(e){const n=Al(e.firestore);return function(i,o,l,c,d,f,p){let m;if(d.isKeyField()){if(f==="array-contains"||f==="array-contains-any")throw new H(M.INVALID_ARGUMENT,`Invalid Query. You can't perform '${f}' queries on documentId().`);if(f==="in"||f==="not-in"){sw(p,f);const w=[];for(const A of p)w.push(rw(c,i,A));m={arrayValue:{values:w}}}else m=rw(c,i,p)}else f!=="in"&&f!=="not-in"&&f!=="array-contains-any"||sw(p,f),m=oD(l,o,p,f==="in"||f==="not-in");return pt.create(d,f,m)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function kn(t,e,n){const r=e,s=Nd("where",t);return Rl._create(s,r,n)}class Ad extends mg{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new Ad(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:tr.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(s,i){let o=s;const l=i.getFlattenedFilters();for(const c of l)EI(o,c),o=ip(o,c)}(e._query,n),new sr(e.firestore,e.converter,ip(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Cd extends bd{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new Cd(e,n)}_apply(e){const n=function(s,i,o){if(s.startAt!==null)throw new H(M.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new H(M.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new rl(i,o)}(e._query,this._field,this._direction);return new sr(e.firestore,e.converter,function(s,i){const o=s.explicitOrderBy.concat([i]);return new bi(s.path,s.collectionGroup,o,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)}(e._query,n))}}function Vn(t,e="asc"){const n=e,r=Nd("orderBy",t);return Cd._create(r,n)}class kd extends bd{constructor(e,n,r){super(),this.type=e,this._limit=n,this._limitType=r}static _create(e,n,r){return new kd(e,n,r)}_apply(e){return new sr(e.firestore,e.converter,Cc(e._query,this._limit,this._limitType))}}function qu(t){return kd._create("limit",t,"F")}function rw(t,e,n){if(typeof(n=De(n))=="string"){if(n==="")throw new H(M.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!yT(e)&&n.indexOf("/")!==-1)throw new H(M.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(Ue.fromString(n));if(!ee.isDocumentKey(r))throw new H(M.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return __(t,new ee(r))}if(n instanceof Ze)return __(t,n._key);throw new H(M.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${hd(n)}.`)}function sw(t,e){if(!Array.isArray(t)||t.length===0)throw new H(M.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function EI(t,e){const n=function(s,i){for(const o of s)for(const l of o.getFlattenedFilters())if(i.indexOf(l.op)>=0)return l.op;return null}(t.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new H(M.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new H(M.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class TI{convertValue(e,n="none"){switch(Vs(e)){case 0:return null;case 1:return e.booleanValue;case 2:return lt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(Os(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw ae(62114,{value:e})}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return Bs(e,(s,i)=>{r[s]=this.convertValue(i,n)}),r}convertVectorValue(e){var r,s,i;const n=(i=(s=(r=e.fields)==null?void 0:r[bc].arrayValue)==null?void 0:s.values)==null?void 0:i.map(o=>lt(o.doubleValue));return new Xn(n)}convertGeoPoint(e){return new Jn(lt(e.latitude),lt(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=md(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(tl(e));default:return null}}convertTimestamp(e){const n=Ds(e);return new Be(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=Ue.fromString(e);je($T(r),9688,{name:e});const s=new Io(r.get(1),r.get(3)),i=new ee(r.popFirst(5));return s.isEqual(n)||Wr(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gg(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}function II(){return new dI("count")}class to{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Cs extends wI{constructor(e,n,r,s,i,o){super(e,n,r,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new Ra(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(Nd("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new H(M.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,n={};return n.type=Cs._jsonSchemaVersion,n.bundle="",n.bundleSource="DocumentSnapshot",n.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?n:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),n.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),n)}}Cs._jsonSchemaVersion="firestore/documentSnapshot/1.0",Cs._jsonSchema={type:mt("string",Cs._jsonSchemaVersion),bundleSource:mt("string","DocumentSnapshot"),bundleName:mt("string"),bundle:mt("string")};class Ra extends Cs{data(e={}){return super.data(e)}}class ks{constructor(e,n,r,s){this._firestore=e,this._userDataWriter=n,this._snapshot=s,this.metadata=new to(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new Ra(this._firestore,this._userDataWriter,r.key,r,new to(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new H(M.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let o=0;return s._snapshot.docChanges.map(l=>{const c=new Ra(s._firestore,s._userDataWriter,l.doc.key,l.doc,new to(s._snapshot.mutatedKeys.has(l.doc.key),s._snapshot.fromCache),s.query.converter);return l.doc,{type:"added",doc:c,oldIndex:-1,newIndex:o++}})}{let o=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(l=>i||l.type!==3).map(l=>{const c=new Ra(s._firestore,s._userDataWriter,l.doc.key,l.doc,new to(s._snapshot.mutatedKeys.has(l.doc.key),s._snapshot.fromCache),s.query.converter);let d=-1,f=-1;return l.type!==0&&(d=o.indexOf(l.doc.key),o=o.delete(l.doc.key)),l.type!==1&&(o=o.add(l.doc),f=o.indexOf(l.doc.key)),{type:uD(l.type),doc:c,oldIndex:d,newIndex:f}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new H(M.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=ks._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=dd.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const n=[],r=[],s=[];return this.docs.forEach(i=>{i._document!==null&&(n.push(i._document),r.push(this._userDataWriter.convertObjectMap(i._document.data.value.mapValue.fields,"previous")),s.push(i.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function uD(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ae(61501,{type:t})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ae(t){t=Ct(t,Ze);const e=Ct(t.firestore,On);return Zj(ki(e),t._key).then(n=>SI(e,t,n))}ks._jsonSchemaVersion="firestore/querySnapshot/1.0",ks._jsonSchema={type:mt("string",ks._jsonSchemaVersion),bundleSource:mt("string","QuerySnapshot"),bundleName:mt("string"),bundle:mt("string")};class Rd extends TI{constructor(e){super(),this.firestore=e}convertBytes(e){return new yn(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Ze(this.firestore,null,n)}}function Fe(t){t=Ct(t,sr);const e=Ct(t.firestore,On),n=ki(e),r=new Rd(e);return xI(t._query),eD(n,t._query).then(s=>new ks(e,r,t,s))}function wt(t,e,n){t=Ct(t,Ze);const r=Ct(t.firestore,On),s=gg(t.converter,e,n);return $o(r,[dg(Al(r),"setDoc",t._key,s,t.converter!==null,n).toMutation(t._key,en.none())])}function yg(t,e,n,...r){t=Ct(t,Ze);const s=Ct(t.firestore,On),i=Al(s);let o;return o=typeof(e=De(e))=="string"||e instanceof Ri?gI(i,"updateDoc",t._key,e,n,r):mI(i,"updateDoc",t._key,e),$o(s,[o.toMutation(t._key,en.exists(!0))])}function Dt(t){return $o(Ct(t.firestore,On),[new xd(t._key,en.none())])}function Dr(t,e){const n=Ct(t.firestore,On),r=G(t),s=gg(t.converter,e);return $o(n,[dg(Al(t.firestore),"addDoc",r._key,s,t.converter!==null,{}).toMutation(r._key,en.exists(!1))]).then(()=>r)}function Xt(t,...e){var c,d,f;t=De(t);let n={includeMetadataChanges:!1,source:"default"},r=0;typeof e[r]!="object"||nw(e[r])||(n=e[r++]);const s={includeMetadataChanges:n.includeMetadataChanges,source:n.source};if(nw(e[r])){const p=e[r];e[r]=(c=p.next)==null?void 0:c.bind(p),e[r+1]=(d=p.error)==null?void 0:d.bind(p),e[r+2]=(f=p.complete)==null?void 0:f.bind(p)}let i,o,l;if(t instanceof Ze)o=Ct(t.firestore,On),l=gd(t._key.path),i={next:p=>{e[r]&&e[r](SI(o,t,p))},error:e[r+1],complete:e[r+2]};else{const p=Ct(t,sr);o=Ct(p.firestore,On),l=p._query;const m=new Rd(o);i={next:y=>{e[r]&&e[r](new ks(o,m,p,y))},error:e[r+1],complete:e[r+2]},xI(t._query)}return function(m,y,w,A){const b=new ag(A),E=new sg(y,b,w);return m.asyncQueue.enqueueAndForget(async()=>tg(await Oc(m),E)),()=>{b.Nu(),m.asyncQueue.enqueueAndForget(async()=>ng(await Oc(m),E))}}(ki(o),l,s,i)}function $o(t,e){return function(r,s){const i=new gr;return r.asyncQueue.enqueueAndForget(async()=>Fj(await Jj(r),s,i)),i.promise}(ki(t),e)}function SI(t,e,n){const r=n.docs.get(e._key),s=new Rd(t);return new Cs(t,s,e._key,r,new to(n.hasPendingWrites,n.fromCache),e.converter)}function Lc(t){return NI(t,{count:II()})}function NI(t,e){const n=Ct(t.firestore,On),r=ki(n),s=EP(e,(i,o)=>new s2(o,i.aggregateType,i._internalFieldPath));return tD(r,t._query,s).then(i=>function(l,c,d){const f=new Rd(l);return new hI(c,f,d)}(n,t,i))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bI{constructor(e,n){this._firestore=e,this._commitHandler=n,this._mutations=[],this._committed=!1,this._dataReader=Al(e)}set(e,n,r){this._verifyNotCommitted();const s=Lh(e,this._firestore),i=gg(s.converter,n,r),o=dg(this._dataReader,"WriteBatch.set",s._key,i,s.converter!==null,r);return this._mutations.push(o.toMutation(s._key,en.none())),this}update(e,n,r,...s){this._verifyNotCommitted();const i=Lh(e,this._firestore);let o;return o=typeof(n=De(n))=="string"||n instanceof Ri?gI(this._dataReader,"WriteBatch.update",i._key,n,r,s):mI(this._dataReader,"WriteBatch.update",i._key,n),this._mutations.push(o.toMutation(i._key,en.exists(!0))),this}delete(e){this._verifyNotCommitted();const n=Lh(e,this._firestore);return this._mutations=this._mutations.concat(new xd(n._key,en.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new H(M.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function Lh(t,e){if((t=De(t)).firestore!==e)throw new H(M.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gp(){return new Cl("deleteField")}function ke(){return new hg("serverTimestamp")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AI(t){return ki(t=Ct(t,On)),new bI(t,e=>$o(t,e))}(function(e,n=!0){(function(s){Lo=s})(Oo),er(new Dn("firestore",(r,{instanceIdentifier:s,options:i})=>{const o=r.getProvider("app").getImmediate(),l=new On(new iP(r.getProvider("auth-internal")),new lP(o,r.getProvider("app-check-internal")),function(d,f){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new H(M.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Io(d.options.projectId,f)}(o,s),o);return i={useFetchStreams:n,...i},l._setSettings(i),l},"PUBLIC").setMultipleInstances(!0)),pn(a_,l_,e),pn(a_,l_,"esm2020")})();const cD=Object.freeze(Object.defineProperty({__proto__:null,AbstractUserDataWriter:TI,AggregateField:dI,AggregateQuerySnapshot:hI,Bytes:yn,CollectionReference:Mr,DocumentReference:Ze,DocumentSnapshot:Cs,FieldPath:Ri,FieldValue:bl,Firestore:On,FirestoreError:H,GeoPoint:Jn,Query:sr,QueryCompositeFilterConstraint:Ad,QueryConstraint:bd,QueryDocumentSnapshot:Ra,QueryFieldFilterConstraint:Rl,QueryLimitConstraint:kd,QueryOrderByConstraint:Cd,QuerySnapshot:ks,SnapshotMetadata:to,Timestamp:Be,VectorValue:Xn,WriteBatch:bI,_AutoId:dd,_ByteString:kt,_DatabaseId:Io,_DocumentKey:ee,_EmptyAuthCredentialsProvider:XE,_FieldPath:bt,_cast:Ct,_logWarn:yi,_validateIsNotUsedTogether:ZE,addDoc:Dr,collection:pe,collectionGroup:_r,connectFirestoreEmulator:cI,count:II,deleteDoc:Dt,deleteField:gp,doc:G,documentId:ug,ensureFirestoreConfigured:ki,executeWrite:$o,getAggregateFromServer:NI,getCountFromServer:Lc,getDoc:Ae,getDocs:Fe,getFirestore:$e,limit:qu,onSnapshot:Xt,orderBy:Vn,query:Je,serverTimestamp:ke,setDoc:wt,updateDoc:yg,where:kn,writeBatch:AI},Symbol.toStringTag,{value:"Module"}));var dD="firebase",hD="12.1.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */pn(dD,hD,"app");const CI="@firebase/installations",vg="0.6.19";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kI=1e4,RI=`w:${vg}`,PI="FIS_v2",fD="https://firebaseinstallations.googleapis.com/v1",pD=60*60*1e3,mD="installations",gD="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yD={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},_i=new Si(mD,gD,yD);function jI(t){return t instanceof nr&&t.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DI({projectId:t}){return`${fD}/projects/${t}/installations`}function OI(t){return{token:t.token,requestStatus:2,expiresIn:_D(t.expiresIn),creationTime:Date.now()}}async function VI(t,e){const r=(await e.json()).error;return _i.create("request-failed",{requestName:t,serverCode:r.code,serverMessage:r.message,serverStatus:r.status})}function LI({apiKey:t}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}function vD(t,{refreshToken:e}){const n=LI(t);return n.append("Authorization",wD(e)),n}async function MI(t){const e=await t();return e.status>=500&&e.status<600?t():e}function _D(t){return Number(t.replace("s","000"))}function wD(t){return`${PI} ${t}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function xD({appConfig:t,heartbeatServiceProvider:e},{fid:n}){const r=DI(t),s=LI(t),i=e.getImmediate({optional:!0});if(i){const d=await i.getHeartbeatsHeader();d&&s.append("x-firebase-client",d)}const o={fid:n,authVersion:PI,appId:t.appId,sdkVersion:RI},l={method:"POST",headers:s,body:JSON.stringify(o)},c=await MI(()=>fetch(r,l));if(c.ok){const d=await c.json();return{fid:d.fid||n,registrationStatus:2,refreshToken:d.refreshToken,authToken:OI(d.authToken)}}else throw await VI("Create Installation",c)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UI(t){return new Promise(e=>{setTimeout(e,t)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ED(t){return btoa(String.fromCharCode(...t)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TD=/^[cdef][\w-]{21}$/,yp="";function ID(){try{const t=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(t),t[0]=112+t[0]%16;const n=SD(t);return TD.test(n)?n:yp}catch{return yp}}function SD(t){return ED(t).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pd(t){return`${t.appName}!${t.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FI=new Map;function $I(t,e){const n=Pd(t);BI(n,e),ND(n,e)}function BI(t,e){const n=FI.get(t);if(n)for(const r of n)r(e)}function ND(t,e){const n=bD();n&&n.postMessage({key:t,fid:e}),AD()}let ii=null;function bD(){return!ii&&"BroadcastChannel"in self&&(ii=new BroadcastChannel("[Firebase] FID Change"),ii.onmessage=t=>{BI(t.data.key,t.data.fid)}),ii}function AD(){FI.size===0&&ii&&(ii.close(),ii=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CD="firebase-installations-database",kD=1,wi="firebase-installations-store";let Mh=null;function _g(){return Mh||(Mh=ad(CD,kD,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(wi)}}})),Mh}async function Mc(t,e){const n=Pd(t),s=(await _g()).transaction(wi,"readwrite"),i=s.objectStore(wi),o=await i.get(n);return await i.put(e,n),await s.done,(!o||o.fid!==e.fid)&&$I(t,e.fid),e}async function zI(t){const e=Pd(t),r=(await _g()).transaction(wi,"readwrite");await r.objectStore(wi).delete(e),await r.done}async function jd(t,e){const n=Pd(t),s=(await _g()).transaction(wi,"readwrite"),i=s.objectStore(wi),o=await i.get(n),l=e(o);return l===void 0?await i.delete(n):await i.put(l,n),await s.done,l&&(!o||o.fid!==l.fid)&&$I(t,l.fid),l}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function wg(t){let e;const n=await jd(t.appConfig,r=>{const s=RD(r),i=PD(t,s);return e=i.registrationPromise,i.installationEntry});return n.fid===yp?{installationEntry:await e}:{installationEntry:n,registrationPromise:e}}function RD(t){const e=t||{fid:ID(),registrationStatus:0};return qI(e)}function PD(t,e){if(e.registrationStatus===0){if(!navigator.onLine){const s=Promise.reject(_i.create("app-offline"));return{installationEntry:e,registrationPromise:s}}const n={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},r=jD(t,n);return{installationEntry:n,registrationPromise:r}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:DD(t)}:{installationEntry:e}}async function jD(t,e){try{const n=await xD(t,e);return Mc(t.appConfig,n)}catch(n){throw jI(n)&&n.customData.serverCode===409?await zI(t.appConfig):await Mc(t.appConfig,{fid:e.fid,registrationStatus:0}),n}}async function DD(t){let e=await iw(t.appConfig);for(;e.registrationStatus===1;)await UI(100),e=await iw(t.appConfig);if(e.registrationStatus===0){const{installationEntry:n,registrationPromise:r}=await wg(t);return r||n}return e}function iw(t){return jd(t,e=>{if(!e)throw _i.create("installation-not-found");return qI(e)})}function qI(t){return OD(t)?{fid:t.fid,registrationStatus:0}:t}function OD(t){return t.registrationStatus===1&&t.registrationTime+kI<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function VD({appConfig:t,heartbeatServiceProvider:e},n){const r=LD(t,n),s=vD(t,n),i=e.getImmediate({optional:!0});if(i){const d=await i.getHeartbeatsHeader();d&&s.append("x-firebase-client",d)}const o={installation:{sdkVersion:RI,appId:t.appId}},l={method:"POST",headers:s,body:JSON.stringify(o)},c=await MI(()=>fetch(r,l));if(c.ok){const d=await c.json();return OI(d)}else throw await VI("Generate Auth Token",c)}function LD(t,{fid:e}){return`${DI(t)}/${e}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function xg(t,e=!1){let n;const r=await jd(t.appConfig,i=>{if(!WI(i))throw _i.create("not-registered");const o=i.authToken;if(!e&&FD(o))return i;if(o.requestStatus===1)return n=MD(t,e),i;{if(!navigator.onLine)throw _i.create("app-offline");const l=BD(i);return n=UD(t,l),l}});return n?await n:r.authToken}async function MD(t,e){let n=await ow(t.appConfig);for(;n.authToken.requestStatus===1;)await UI(100),n=await ow(t.appConfig);const r=n.authToken;return r.requestStatus===0?xg(t,e):r}function ow(t){return jd(t,e=>{if(!WI(e))throw _i.create("not-registered");const n=e.authToken;return zD(n)?{...e,authToken:{requestStatus:0}}:e})}async function UD(t,e){try{const n=await VD(t,e),r={...e,authToken:n};return await Mc(t.appConfig,r),n}catch(n){if(jI(n)&&(n.customData.serverCode===401||n.customData.serverCode===404))await zI(t.appConfig);else{const r={...e,authToken:{requestStatus:0}};await Mc(t.appConfig,r)}throw n}}function WI(t){return t!==void 0&&t.registrationStatus===2}function FD(t){return t.requestStatus===2&&!$D(t)}function $D(t){const e=Date.now();return e<t.creationTime||t.creationTime+t.expiresIn<e+pD}function BD(t){const e={requestStatus:1,requestTime:Date.now()};return{...t,authToken:e}}function zD(t){return t.requestStatus===1&&t.requestTime+kI<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function qD(t){const e=t,{installationEntry:n,registrationPromise:r}=await wg(e);return r?r.catch(console.error):xg(e).catch(console.error),n.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function WD(t,e=!1){const n=t;return await HD(n),(await xg(n,e)).token}async function HD(t){const{registrationPromise:e}=await wg(t);e&&await e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GD(t){if(!t||!t.options)throw Uh("App Configuration");if(!t.name)throw Uh("App Name");const e=["projectId","apiKey","appId"];for(const n of e)if(!t.options[n])throw Uh(n);return{appName:t.name,projectId:t.options.projectId,apiKey:t.options.apiKey,appId:t.options.appId}}function Uh(t){return _i.create("missing-app-config-values",{valueName:t})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HI="installations",KD="installations-internal",QD=t=>{const e=t.getProvider("app").getImmediate(),n=GD(e),r=Ni(e,"heartbeat");return{app:e,appConfig:n,heartbeatServiceProvider:r,_delete:()=>Promise.resolve()}},YD=t=>{const e=t.getProvider("app").getImmediate(),n=Ni(e,HI).getImmediate();return{getId:()=>qD(n),getToken:s=>WD(n,s)}};function JD(){er(new Dn(HI,QD,"PUBLIC")),er(new Dn(KD,YD,"PRIVATE"))}JD();pn(CI,vg);pn(CI,vg,"esm2020");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XD="/firebase-messaging-sw.js",ZD="/firebase-cloud-messaging-push-scope",GI="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",eO="https://fcmregistrations.googleapis.com/v1",KI="google.c.a.c_id",tO="google.c.a.c_l",nO="google.c.a.ts",rO="google.c.a.e",aw=1e4;var lw;(function(t){t[t.DATA_MESSAGE=1]="DATA_MESSAGE",t[t.DISPLAY_NOTIFICATION=3]="DISPLAY_NOTIFICATION"})(lw||(lw={}));/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file except
 * in compliance with the License. You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software distributed under the License
 * is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express
 * or implied. See the License for the specific language governing permissions and limitations under
 * the License.
 */var al;(function(t){t.PUSH_RECEIVED="push-received",t.NOTIFICATION_CLICKED="notification-clicked"})(al||(al={}));/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ar(t){const e=new Uint8Array(t);return btoa(String.fromCharCode(...e)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function sO(t){const e="=".repeat((4-t.length%4)%4),n=(t+e).replace(/\-/g,"+").replace(/_/g,"/"),r=atob(n),s=new Uint8Array(r.length);for(let i=0;i<r.length;++i)s[i]=r.charCodeAt(i);return s}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fh="fcm_token_details_db",iO=5,uw="fcm_token_object_Store";async function oO(t){if("databases"in indexedDB&&!(await indexedDB.databases()).map(i=>i.name).includes(Fh))return null;let e=null;return(await ad(Fh,iO,{upgrade:async(r,s,i,o)=>{if(s<2||!r.objectStoreNames.contains(uw))return;const l=o.objectStore(uw),c=await l.index("fcmSenderId").get(t);if(await l.clear(),!!c){if(s===2){const d=c;if(!d.auth||!d.p256dh||!d.endpoint)return;e={token:d.fcmToken,createTime:d.createTime??Date.now(),subscriptionOptions:{auth:d.auth,p256dh:d.p256dh,endpoint:d.endpoint,swScope:d.swScope,vapidKey:typeof d.vapidKey=="string"?d.vapidKey:Ar(d.vapidKey)}}}else if(s===3){const d=c;e={token:d.fcmToken,createTime:d.createTime,subscriptionOptions:{auth:Ar(d.auth),p256dh:Ar(d.p256dh),endpoint:d.endpoint,swScope:d.swScope,vapidKey:Ar(d.vapidKey)}}}else if(s===4){const d=c;e={token:d.fcmToken,createTime:d.createTime,subscriptionOptions:{auth:Ar(d.auth),p256dh:Ar(d.p256dh),endpoint:d.endpoint,swScope:d.swScope,vapidKey:Ar(d.vapidKey)}}}}}})).close(),await bh(Fh),await bh("fcm_vapid_details_db"),await bh("undefined"),aO(e)?e:null}function aO(t){if(!t||!t.subscriptionOptions)return!1;const{subscriptionOptions:e}=t;return typeof t.createTime=="number"&&t.createTime>0&&typeof t.token=="string"&&t.token.length>0&&typeof e.auth=="string"&&e.auth.length>0&&typeof e.p256dh=="string"&&e.p256dh.length>0&&typeof e.endpoint=="string"&&e.endpoint.length>0&&typeof e.swScope=="string"&&e.swScope.length>0&&typeof e.vapidKey=="string"&&e.vapidKey.length>0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lO="firebase-messaging-database",uO=1,ll="firebase-messaging-store";let $h=null;function QI(){return $h||($h=ad(lO,uO,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(ll)}}})),$h}async function cO(t){const e=YI(t),r=await(await QI()).transaction(ll).objectStore(ll).get(e);if(r)return r;{const s=await oO(t.appConfig.senderId);if(s)return await Eg(t,s),s}}async function Eg(t,e){const n=YI(t),s=(await QI()).transaction(ll,"readwrite");return await s.objectStore(ll).put(e,n),await s.done,e}function YI({appConfig:t}){return t.appId}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dO={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."},Ht=new Si("messaging","Messaging",dO);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function hO(t,e){const n=await Ig(t),r=JI(e),s={method:"POST",headers:n,body:JSON.stringify(r)};let i;try{i=await(await fetch(Tg(t.appConfig),s)).json()}catch(o){throw Ht.create("token-subscribe-failed",{errorInfo:o==null?void 0:o.toString()})}if(i.error){const o=i.error.message;throw Ht.create("token-subscribe-failed",{errorInfo:o})}if(!i.token)throw Ht.create("token-subscribe-no-token");return i.token}async function fO(t,e){const n=await Ig(t),r=JI(e.subscriptionOptions),s={method:"PATCH",headers:n,body:JSON.stringify(r)};let i;try{i=await(await fetch(`${Tg(t.appConfig)}/${e.token}`,s)).json()}catch(o){throw Ht.create("token-update-failed",{errorInfo:o==null?void 0:o.toString()})}if(i.error){const o=i.error.message;throw Ht.create("token-update-failed",{errorInfo:o})}if(!i.token)throw Ht.create("token-update-no-token");return i.token}async function pO(t,e){const r={method:"DELETE",headers:await Ig(t)};try{const i=await(await fetch(`${Tg(t.appConfig)}/${e}`,r)).json();if(i.error){const o=i.error.message;throw Ht.create("token-unsubscribe-failed",{errorInfo:o})}}catch(s){throw Ht.create("token-unsubscribe-failed",{errorInfo:s==null?void 0:s.toString()})}}function Tg({projectId:t}){return`${eO}/projects/${t}/registrations`}async function Ig({appConfig:t,installations:e}){const n=await e.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t.apiKey,"x-goog-firebase-installations-auth":`FIS ${n}`})}function JI({p256dh:t,auth:e,endpoint:n,vapidKey:r}){const s={web:{endpoint:n,auth:e,p256dh:t}};return r!==GI&&(s.web.applicationPubKey=r),s}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mO=7*24*60*60*1e3;async function gO(t){const e=await vO(t.swRegistration,t.vapidKey),n={vapidKey:t.vapidKey,swScope:t.swRegistration.scope,endpoint:e.endpoint,auth:Ar(e.getKey("auth")),p256dh:Ar(e.getKey("p256dh"))},r=await cO(t.firebaseDependencies);if(r){if(_O(r.subscriptionOptions,n))return Date.now()>=r.createTime+mO?yO(t,{token:r.token,createTime:Date.now(),subscriptionOptions:n}):r.token;try{await pO(t.firebaseDependencies,r.token)}catch(s){console.warn(s)}return cw(t.firebaseDependencies,n)}else return cw(t.firebaseDependencies,n)}async function yO(t,e){try{const n=await fO(t.firebaseDependencies,e),r={...e,token:n,createTime:Date.now()};return await Eg(t.firebaseDependencies,r),n}catch(n){throw n}}async function cw(t,e){const r={token:await hO(t,e),createTime:Date.now(),subscriptionOptions:e};return await Eg(t,r),r.token}async function vO(t,e){const n=await t.pushManager.getSubscription();return n||t.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:sO(e)})}function _O(t,e){const n=e.vapidKey===t.vapidKey,r=e.endpoint===t.endpoint,s=e.auth===t.auth,i=e.p256dh===t.p256dh;return n&&r&&s&&i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dw(t){const e={from:t.from,collapseKey:t.collapse_key,messageId:t.fcmMessageId};return wO(e,t),xO(e,t),EO(e,t),e}function wO(t,e){if(!e.notification)return;t.notification={};const n=e.notification.title;n&&(t.notification.title=n);const r=e.notification.body;r&&(t.notification.body=r);const s=e.notification.image;s&&(t.notification.image=s);const i=e.notification.icon;i&&(t.notification.icon=i)}function xO(t,e){e.data&&(t.data=e.data)}function EO(t,e){var s,i,o,l;if(!e.fcmOptions&&!((s=e.notification)!=null&&s.click_action))return;t.fcmOptions={};const n=((i=e.fcmOptions)==null?void 0:i.link)??((o=e.notification)==null?void 0:o.click_action);n&&(t.fcmOptions.link=n);const r=(l=e.fcmOptions)==null?void 0:l.analytics_label;r&&(t.fcmOptions.analyticsLabel=r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TO(t){return typeof t=="object"&&!!t&&KI in t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IO(t){if(!t||!t.options)throw Bh("App Configuration Object");if(!t.name)throw Bh("App Name");const e=["projectId","apiKey","appId","messagingSenderId"],{options:n}=t;for(const r of e)if(!n[r])throw Bh(r);return{appName:t.name,projectId:n.projectId,apiKey:n.apiKey,appId:n.appId,senderId:n.messagingSenderId}}function Bh(t){return Ht.create("missing-app-config-values",{valueName:t})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SO{constructor(e,n,r){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;const s=IO(e);this.firebaseDependencies={app:e,appConfig:s,installations:n,analyticsProvider:r}}_delete(){return Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function NO(t){try{t.swRegistration=await navigator.serviceWorker.register(XD,{scope:ZD}),t.swRegistration.update().catch(()=>{}),await bO(t.swRegistration)}catch(e){throw Ht.create("failed-service-worker-registration",{browserErrorMessage:e==null?void 0:e.message})}}async function bO(t){return new Promise((e,n)=>{const r=setTimeout(()=>n(new Error(`Service worker not registered after ${aw} ms`)),aw),s=t.installing||t.waiting;t.active?(clearTimeout(r),e()):s?s.onstatechange=i=>{var o;((o=i.target)==null?void 0:o.state)==="activated"&&(s.onstatechange=null,clearTimeout(r),e())}:(clearTimeout(r),n(new Error("No incoming service worker found.")))})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function AO(t,e){if(!e&&!t.swRegistration&&await NO(t),!(!e&&t.swRegistration)){if(!(e instanceof ServiceWorkerRegistration))throw Ht.create("invalid-sw-registration");t.swRegistration=e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function CO(t,e){e?t.vapidKey=e:t.vapidKey||(t.vapidKey=GI)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function XI(t,e){if(!navigator)throw Ht.create("only-available-in-window");if(Notification.permission==="default"&&await Notification.requestPermission(),Notification.permission!=="granted")throw Ht.create("permission-blocked");return await CO(t,e==null?void 0:e.vapidKey),await AO(t,e==null?void 0:e.serviceWorkerRegistration),gO(t)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function kO(t,e,n){const r=RO(e);(await t.firebaseDependencies.analyticsProvider.get()).logEvent(r,{message_id:n[KI],message_name:n[tO],message_time:n[nO],message_device_time:Math.floor(Date.now()/1e3)})}function RO(t){switch(t){case al.NOTIFICATION_CLICKED:return"notification_open";case al.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function PO(t,e){const n=e.data;if(!n.isFirebaseMessaging)return;t.onMessageHandler&&n.messageType===al.PUSH_RECEIVED&&(typeof t.onMessageHandler=="function"?t.onMessageHandler(dw(n)):t.onMessageHandler.next(dw(n)));const r=n.data;TO(r)&&r[rO]==="1"&&await kO(t,n.messageType,r)}const hw="@firebase/messaging",fw="0.12.23";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jO=t=>{const e=new SO(t.getProvider("app").getImmediate(),t.getProvider("installations-internal").getImmediate(),t.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",n=>PO(e,n)),e},DO=t=>{const e=t.getProvider("messaging").getImmediate();return{getToken:r=>XI(e,r)}};function OO(){er(new Dn("messaging",jO,"PUBLIC")),er(new Dn("messaging-internal",DO,"PRIVATE")),pn(hw,fw),pn(hw,fw,"esm2020")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ZI(){try{await rE()}catch{return!1}return typeof window<"u"&&nE()&&I1()&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VO(t,e){if(!navigator)throw Ht.create("only-available-in-window");return t.onMessageHandler=e,()=>{t.onMessageHandler=null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LO(t=gl()){return ZI().then(e=>{if(!e)throw Ht.create("unsupported-browser")},e=>{throw Ht.create("indexed-db-unsupported")}),Ni(De(t),"messaging").getImmediate()}async function MO(t,e){return t=De(t),XI(t,e)}function UO(t,e){return t=De(t),VO(t,e)}OO();const Sg={apiKey:"AIzaSyAvTkBdah-m0JBKF2hPh2ra95ZrFfFXPZs",authDomain:"immanuel-app.firebaseapp.com",projectId:"immanuel-app",storageBucket:"immanuel-app.firebasestorage.app",messagingSenderId:"815824103273",appId:"1:815824103273:web:3817385bebff5f704a3ff8",measurementId:"G-P6WR1NQRB8"};function FO(t){const e=Object.entries(t).filter(([,n])=>!n||String(n).trim()==="").map(([n])=>n);if(e.length){const n=Object.fromEntries(Object.entries(t).map(([r,s])=>[r,s&&(typeof s=="string"?s.slice(0,6)+"":s)]));throw console.error("[firebase] Missing config keys:",e,`
Loaded values:`,n),new Error("Firebase configuration is incomplete. Missing: "+e.join(", "))}}FO(Sg);const te=CC().length?gl():oE(Sg),ul=Ke(te),Ng=$e(te),$O=new An;$O.setCustomParameters({prompt:"select_account"});typeof window<"u"&&(window.__FIREBASE_CONFIG__=Sg);async function Dd(){try{return await ZI()?LO(te):null}catch{return null}}const eS=k.createContext(void 0);function BO({children:t}){const e=k.useMemo(()=>Ke(te),[]),n=k.useMemo(()=>$e(te),[]),[r,s]=k.useState(e.currentUser),[i,o]=k.useState(!0),[l,c]=k.useState(!1);async function d(A){if(!A){c(!1);return}try{const b=A.uid,v=(await Ae(G(n,"admins",b))).exists();let x=!1;try{const R=Je(_r(n,"groupAdmins"),kn("uid","==",b));x=!(await Fe(R)).empty}catch{x=!1}c(v||x)}catch{c(!1)}}k.useEffect(()=>{const A=Mn(e,async b=>{s(b),await d(b),o(!1)});return()=>A()},[e]);const f=async(A,b)=>{await RE(e,A,b),await d(e.currentUser)},p=async()=>{const A=new An;await jm(e,A),await d(e.currentUser)},m=async()=>{await Yf(e),c(!1)},y=async()=>{await d(e.currentUser)},w=k.useMemo(()=>({user:r,loading:i,isAdmin:l,login:f,signInWithGoogle:p,logout:m,refresh:y}),[r,i,l]);return u.jsx(eS.Provider,{value:w,children:t})}function Od(){const t=k.useContext(eS);if(!t)throw new Error("useAuth must be used within AuthProvider");return t}function ir({label:t="Loading..."}){return u.jsxs("div",{className:"flex items-center gap-3 text-slate-500 py-6",children:[u.jsxs("svg",{className:"animate-spin h-5 w-5",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[u.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),u.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"})]}),u.jsx("span",{children:t})]})}function Sn({children:t}){const e=Ke(te),[n,r]=$.useState(!1),[s,i]=$.useState(e.currentUser);return $.useEffect(()=>{const o=Mn(e,l=>{i(l),r(!0)});return()=>o()},[e]),n?s?u.jsx(u.Fragment,{children:t}):u.jsx(pr,{to:"/login",replace:!0}):u.jsx("div",{className:"max-w-xl mx-auto p-6",children:u.jsx(ir,{label:"Checking authentication"})})}function zO(){var l;const t=Ke(te),e=$e(te),[n,r]=k.useState(!0),[s,i]=k.useState(null),o=(l=t.currentUser)==null?void 0:l.uid;return k.useEffect(()=>{let c=!0;async function d(){if(!o){i(null),r(!1);return}r(!0);try{const f=G(e,"users",o),p=await Ae(f);if(p.exists()){if(!c)return;i(p.data()||{})}else{await wt(f,{createdAt:ke()},{merge:!0});const m=await Ae(f);if(!c)return;i(m.data()||{})}}finally{r(!1)}}return d(),()=>{c=!1}},[e,o]),{loading:n,profile:s,uid:o}}function qO(t){return t?!!(t.displayName&&String(t.displayName).trim().length>1):!1}function Yt({children:t}){const e=Ke(te),{loading:n,profile:r}=zO(),[s,i]=$.useState(!1),o=e.currentUser,l=Ln();if(k.useEffect(()=>{const f=Mn(e,()=>i(!0));return()=>f()},[e]),!s||n)return u.jsx("div",{className:"max-w-xl mx-auto p-6",children:u.jsx(ir,{label:"Loading your profile"})});if(!o)return u.jsx(pr,{to:"/login",replace:!0});const c=qO(r),d=l.pathname==="/welcome";return!c&&!d?u.jsx(pr,{to:"/welcome",replace:!0}):c&&d?u.jsx(pr,{to:"/dashboard",replace:!0}):u.jsx(u.Fragment,{children:t})}function WO({label:t="Checking admin access"}){return u.jsx("div",{className:"max-w-xl mx-auto p-6 text-slate-700",children:t})}function Ys({children:t}){const e=Ke(te),n=$e(te),[r,s]=$.useState(!1),[i,o]=$.useState(null),[l,c]=$.useState(null);return $.useEffect(()=>{const d=Mn(e,async f=>{if(s(!0),!f){o(!1);return}try{const p=await Ae(G(n,"admins",f.uid));o(p.exists())}catch(p){c((p==null?void 0:p.message)||String(p)),o(!1)}});return()=>d()},[e,n]),!r||i===null?u.jsx(WO,{}):e.currentUser?i?u.jsx(u.Fragment,{children:t}):u.jsx(pr,{to:"/dashboard",replace:!0}):u.jsx(pr,{to:"/login",replace:!0})}function HO({label:t="Checking access"}){return u.jsx("div",{className:"max-w-xl mx-auto p-6 text-slate-700",children:t})}function zh({children:t}){const{slug:e}=Ti(),n=e,r=Ke(te),s=$e(te),[i,o]=$.useState(!1),[l,c]=$.useState(null);return $.useEffect(()=>{const d=Mn(r,async f=>{if(o(!0),!f||!n){c(!1);return}try{if((await Ae(G(s,"admins",f.uid))).exists()){c(!0);return}const m=await Ae(G(s,`groups/${n}/groupAdmins/${f.uid}`));c(m.exists())}catch{c(!1)}});return()=>d()},[r,s,n]),!i||l===null?u.jsx(HO,{}):l?u.jsx(u.Fragment,{children:t}):u.jsx(pr,{to:"/dashboard",replace:!0})}function tS({group:t,isMember:e,footer:n}){const r=t.name||t.title||pw(t.id),s=t.description||"",i=t.parent?`Parent: ${pw(t.parent)}`:null;return u.jsxs("div",{className:"rounded-xl border border-border bg-card p-4 flex flex-col justify-between shadow-sm",children:[u.jsxs("div",{children:[u.jsxs("div",{className:"flex items-start justify-between gap-2",children:[u.jsx("h3",{className:"text-lg font-semibold text-accent",children:r}),e&&u.jsx("span",{className:"px-2 py-0.5 rounded-full text-xs bg-emerald-100 text-emerald-700 border border-emerald-200",children:"Member"})]}),i&&u.jsx("p",{className:"text-xs text-text2 mt-1",children:i}),s&&u.jsx("p",{className:"text-sm text-text2 mt-3",children:s})]}),u.jsxs("div",{className:"mt-4 flex items-center gap-2",children:[e?u.jsx(_e,{to:`/groups/${t.id}`,className:"inline-flex items-center rounded-lg bg-slate-900 text-white px-3 py-1.5 text-sm hover:bg-slate-800",children:"View"}):u.jsx("button",{type:"button",disabled:!0,className:"inline-flex items-center rounded-lg bg-slate-200 text-slate-500 px-3 py-1.5 text-sm cursor-not-allowed",title:"Join this group to view",children:"View"}),n]})]})}function pw(t){return t.replace(/[-_]/g," ").replace(/\b\w/g,e=>e.toUpperCase())}function GO({groupId:t,className:e=""}){var m;const n=k.useMemo(()=>Ke(te),[]),r=k.useMemo(()=>$e(te),[]),[s,i]=k.useState("checking"),[o,l]=k.useState(((m=n.currentUser)==null?void 0:m.uid)??null),[c,d]=k.useState(!1);k.useEffect(()=>{const y=Mn(n,w=>{l((w==null?void 0:w.uid)??null)});return()=>y()},[n]),k.useEffect(()=>{let y=!0;async function w(){if(!o){i("none");return}try{const A=await Ae(G(r,`users/${o}/memberships/${t}`));if(!y)return;if(A.exists()){i("member");return}const b=pe(r,`users/${o}/memberships`),E=Je(b,kn("groupId","==",t)),v=await Fe(E);if(!y)return;if(!v.empty){i("member");return}const x=await Ae(G(r,`users/${o}/membershipRequests/${t}`));if(!y)return;i(x.exists()?"pending":"none")}catch(A){console.warn("Unable to determine membership status; defaulting to 'none'.",A),y&&i("none")}}return w(),()=>{y=!1}},[r,o,t]);async function f(){if(o){d(!0);try{await wt(G(r,`users/${o}/membershipRequests/${t}`),{groupId:t,requestedAt:ke()},{merge:!0}),i("pending");try{await wt(G(r,`groups/${t}/membershipRequests/${o}`),{uid:o,requestedAt:ke()},{merge:!0})}catch(y){console.warn("Could not mirror to group joinRequests; ensure rules allow create.",y)}}finally{d(!1)}}}async function p(){if(o){d(!0);try{await Dt(G(r,`users/${o}/membershipRequests/${t}`));try{await Dt(G(r,`groups/${t}/membershipRequests/${o}`))}catch{}i("none")}finally{d(!1)}}}return s==="checking"?u.jsx("button",{className:`text-xs px-3 py-1.5 rounded-lg border border-border bg-muted text-text2 ${e}`,disabled:!0,children:"Checking"}):s==="member"?u.jsx("button",{className:`text-xs px-3 py-1.5 rounded-lg border border-border bg-muted text-text2 ${e}`,disabled:!0,children:"Member"}):s==="pending"?u.jsx("button",{onClick:p,className:`text-xs px-3 py-1.5 rounded-lg bg-slate-100 text-slate-900 hover:bg-slate-200 disabled:opacity-60 ${e}`,disabled:c,title:"Click to cancel your join request",children:"Pending  Cancel"}):u.jsx("button",{onClick:f,className:`text-xs px-3 py-1.5 rounded-lg bg-slate-100 text-slate-900 hover:bg-slate-200 disabled:opacity-60 ${e}`,disabled:c||!o,title:o?void 0:"Sign in to request",children:"Request to Join"})}function KO(){const t=k.useMemo(()=>$e(te),[]),e=Ke(te),[n,r]=k.useState([]),[s,i]=k.useState(new Set),[o,l]=k.useState(!0);k.useEffect(()=>{let d=!1;async function f(){try{const m=(await Fe(Je(pe(t,"groups"),Vn("name")))).docs.map(y=>({id:y.id,...y.data()}));if(d||r(m),e.currentUser){const y=e.currentUser.uid,w=await Fe(pe(t,`users/${y}/memberships`));d||i(new Set(w.docs.map(A=>A.id)))}}finally{d||l(!1)}}return f(),()=>{d=!0}},[t,e.currentUser]);const c=k.useMemo(()=>n.filter(d=>!s.has(d.id)),[n,s]);return o?u.jsx("div",{className:"container py-8",children:u.jsx("div",{className:"max-w-5xl mx-auto p-6",children:u.jsx(ir,{label:"Loading groups"})})}):u.jsx("div",{className:"container py-8 md:py-12",children:u.jsxs("div",{className:"max-w-5xl mx-auto",children:[u.jsx("h1",{className:"text-2xl font-semibold text-accent mb-4",children:"Explore Groups"}),c.length>0?u.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:c.map(d=>u.jsx(tS,{group:d,isMember:!1,footer:u.jsx(GO,{groupId:d.id})},d.id))}):u.jsx("div",{className:"rounded-xl border border-border bg-card p-6",children:u.jsx("p",{className:"text-text2",children:"Youve already joined all available groups."})})]})})}function QO(){var Hs;const{slug:t=""}=Ti(),e=$.useMemo(()=>$e(te),[]),n=Ke(te),[r,s]=$.useState(null),[i,o]=$.useState(!1),[l,c]=$.useState(!1),[d,f]=$.useState(!0),[p,m]=$.useState([]),[y,w]=$.useState([]),[A,b]=$.useState([]),[E,v]=$.useState(""),[x,R]=$.useState(!1),[O,L]=$.useState(!1),[S,_]=$.useState(null),[I,N]=$.useState([]),[P,j]=$.useState(""),[C,at]=$.useState(!1),[xt,Un]=$.useState({}),[Q,B]=$.useState(""),[K,J]=$.useState(""),[ye,de]=$.useState(""),[re,st]=$.useState(null),[Et,Qe]=$.useState(""),[Oe,Tt]=$.useState(""),[z,Z]=$.useState(""),[me,le]=$.useState(!1),[Se,ve]=$.useState(null),[oe,It]=$.useState(""),[Ie,Le]=$.useState({}),[qe,gt]=$.useState(""),[Qt,Fn]=$.useState(!1),[Jr,Tr]=$.useState(""),[Pl,ct]=$.useState(!1),dt=((Hs=n.currentUser)==null?void 0:Hs.uid)||null,$n=$.useMemo(()=>y.find(F=>F.uid===dt)||null,[y,dt]),[jl,Pi]=$.useState(!1);$.useEffect(()=>{Pi(!!($n!=null&&$n.muted))},[$n==null?void 0:$n.muted]);const Dl=$.useMemo(()=>Object.values(Ie).some(Boolean),[Ie]);function qs(F,se){return[F,se].sort().join("_")}async function ji(F){try{return(await Ae(F)).exists()}catch{return!1}}$.useEffect(()=>{let F=!1;async function se(){try{if(!t)return;try{const ue=await Ae(G(e,"groups",t));ue.exists()&&!F&&s({id:ue.id,...ue.data()})}catch(ue){console.error("Failed to load group doc",ue)}let ge=!1,ie=!1;const Re=n.currentUser;if(Re){const ue=Re.uid;if(await ji(G(e,"admins",ue)))ge=!0,ie=!0;else if(await ji(G(e,`groups/${t}/groupAdmins/${ue}`)))ge=!0,ie=!0;else if(await ji(G(e,`users/${ue}/memberships/${t}`)))ge=!0;else try{ge=(await Fe(pe(e,`users/${ue}/memberships`))).docs.some(Oi=>{const Xr=Oi.data();return(Xr==null?void 0:Xr.groupId)===t||(Xr==null?void 0:Xr.groupSlug)===t})}catch(rn){console.warn("Membership scan failed",rn)}}F||(c(ie),o(ge))}finally{F||f(!1)}}return se(),()=>{F=!0}},[e,n.currentUser,t]),$.useEffect(()=>{if(!i||!t)return;const F=Xt(pe(e,`groups/${t}/resources`),ie=>{const Re=ie.docs.map(ue=>{var ce,Lt,Ir;return{id:ue.id,title:((ce=ue.data())==null?void 0:ce.title)||ue.id,url:((Lt=ue.data())==null?void 0:Lt.url)||"#",note:((Ir=ue.data())==null?void 0:Ir.note)||""}});m(Re)}),se=Xt(pe(e,`groups/${t}/members`),ie=>{const Re=ie.docs.map(ue=>({uid:ue.id,...ue.data()}));w(Re)}),ge=Xt(Je(pe(e,`groups/${t}/messages`),Vn("createdAt","asc")),async ie=>{const Re=ie.docs.map(ce=>{var Lt,Ir,rn,Oi;return{id:ce.id,uid:(Lt=ce.data())==null?void 0:Lt.uid,displayName:(Ir=ce.data())==null?void 0:Ir.displayName,text:(rn=ce.data())==null?void 0:rn.text,createdAt:(Oi=ce.data())==null?void 0:Oi.createdAt}}),ue=await Promise.all(Re.map(async ce=>{var Lt;try{const rn=((Lt=(await Lc(pe(e,`groups/${t}/messages/${ce.id}/replies`))).data())==null?void 0:Lt.count)??0;return{...ce,replyCount:Number(rn)}}catch{return{...ce,replyCount:0}}}));b(ue)});return()=>{F(),se(),ge()}},[e,t,i]),$.useEffect(()=>{if(!i||!t||!n.currentUser)return;const F=n.currentUser.uid,se=Xt(Je(pe(e,`users/${F}/threadReads`),kn("groupId","==",t)),ge=>{const ie={};ge.forEach(Re=>{const ue=Re.data(),ce=(ue==null?void 0:ue.messageId)||"";ce&&(ie[ce]={lastReplyCount:ue.lastReplyCount,lastViewedAt:ue.lastViewedAt})}),Un(ie)});return()=>se()},[e,t,i,n.currentUser]);async function Ol(F){var ie;F.preventDefault(),ve(null);const se=Q.trim(),ge=K.trim();if(!se||!ge){ve("Please enter a title and URL.");return}le(!0);try{await Dr(pe(e,`groups/${t}/resources`),{title:se,url:ge,note:ye.trim()||"",createdAt:ke(),createdBy:((ie=n.currentUser)==null?void 0:ie.uid)||null}),B(""),J(""),de("")}catch(Re){const ue=(Re==null?void 0:Re.message)||"Could not add resource.";ve(ue)}finally{le(!1)}}async function Bo(){var ge;if(!re)return;ve(null);const F=Et.trim(),se=Oe.trim();if(!F||!se){ve("Please enter a title and URL.");return}le(!0);try{await yg(G(e,`groups/${t}/resources/${re}`),{title:F,url:se,note:z.trim()||"",updatedAt:ke(),updatedBy:((ge=n.currentUser)==null?void 0:ge.uid)||null}),st(null),Qe(""),Tt(""),Z("")}catch(ie){const Re=(ie==null?void 0:ie.message)||"Could not save changes.";ve(Re)}finally{le(!1)}}function Ld(F){st(F.id),Qe(F.title),Tt(F.url),Z(F.note||""),ve(null)}async function Md(F){if(ve(null),!!window.confirm("Delete this resource?"))try{await Dt(G(e,`groups/${t}/resources/${F}`))}catch(se){const ge=(se==null?void 0:se.message)||"Could not delete resource.";ve(ge)}}async function zo(F){F.preventDefault();const se=E.trim();if(!(!se||!n.currentUser)){R(!0);try{await Dr(pe(e,`groups/${t}/messages`),{uid:n.currentUser.uid,displayName:n.currentUser.displayName||"Member",text:se,createdAt:ke()}),v("")}finally{R(!1)}}}async function Vl(F){window.confirm("Delete this message?")&&await Dt(G(e,`groups/${t}/messages/${F}`))}const or=$.useRef(null);async function Ws(F){var ge;_(F),L(!0);try{if(n.currentUser){const ie=n.currentUser.uid,Re=await Lc(pe(e,`groups/${t}/messages/${F.id}/replies`)),ue=Number(((ge=Re.data())==null?void 0:ge.count)||0);await wt(G(e,`users/${ie}/threadReads/${t}__${F.id}`),{groupId:t,messageId:F.id,lastReplyCount:ue,lastViewedAt:ke()},{merge:!0})}}catch{}or.current&&(or.current(),or.current=null);const se=Xt(Je(pe(e,`groups/${t}/messages/${F.id}/replies`),Vn("createdAt","asc")),ie=>{const Re=ie.docs.map(ue=>{const ce=ue.data();return{id:ue.id,uid:(ce==null?void 0:ce.uid)||"",displayName:(ce==null?void 0:ce.displayName)||void 0,text:(ce==null?void 0:ce.text)||"",createdAt:ce==null?void 0:ce.createdAt}});N(Re)});or.current=se}function Di(){L(!1),_(null),N([]),or.current&&(or.current(),or.current=null)}async function qo(F){if(F.preventDefault(),!S||!n.currentUser)return;const se=P.trim();if(se){at(!0);try{await Dr(pe(e,`groups/${t}/messages/${S.id}/replies`),{uid:n.currentUser.uid,displayName:n.currentUser.displayName||"Member",text:se,createdAt:ke()}),j("")}catch(ge){alert(ge&&ge.message||"Could not post reply. Check Firestore rules and your connection.")}finally{at(!1)}}}const ar=$.useMemo(()=>{var ge;const F=(ge=n.currentUser)==null?void 0:ge.uid,se=oe.trim().toLowerCase();return y.filter(ie=>ie.uid!==F).filter(ie=>{if(!se)return!0;const Re=(ie.displayName||"").toLowerCase(),ue=(ie.email||"").toLowerCase();return Re.includes(se)||ue.includes(se)||ie.uid.toLowerCase().includes(se)})},[y,oe,n.currentUser]);async function Ll(F){var Re,ue;F.preventDefault(),Tr(""),ct(!1);const se=(Re=n.currentUser)==null?void 0:Re.uid;if(!se){Tr("You must be signed in.");return}const ge=qe.trim();if(!ge){Tr("Enter a message.");return}const ie=Object.entries(Ie).filter(([,ce])=>ce).map(([ce])=>ce);if(ie.length===0){Tr("Select at least one member.");return}Fn(!0);try{for(const ce of ie){const Lt=qs(se,ce);await Dr(pe(e,`groups/${t}/directMessages/${Lt}/messages`),{text:ge,from:se,to:ce,displayName:((ue=n.currentUser)==null?void 0:ue.displayName)||"Member",createdAt:ke()}),await wt(G(e,`groups/${t}/directMessages/${Lt}`),{users:[se,ce].sort(),lastText:ge,lastAt:ke(),lastSender:se},{merge:!0})}gt(""),Le({}),ct(!0),window.setTimeout(()=>ct(!1),2e3)}catch(ce){const Lt=(ce==null?void 0:ce.message)||"Failed to send DM(s).";Tr(Lt)}finally{Fn(!1)}}return d?u.jsx("div",{className:"container py-8",children:u.jsx("div",{className:"max-w-5xl mx-auto p-6",children:u.jsx(ir,{label:"Loading group"})})}):r?i?u.jsx("div",{className:"container py-8 md:py-12",children:u.jsxs("div",{className:"max-w-5xl mx-auto",children:[u.jsxs("div",{className:"flex items-start justify-between gap-3",children:[u.jsxs("div",{children:[u.jsx("h1",{className:"text-2xl font-semibold text-accent",children:r.name||t}),l&&u.jsx(_e,{to:`/admin/groups/${t}/edit`,className:"inline-flex items-center gap-1 rounded-lg border border-border px-3 py-1.5 text-sm hover:bg-muted",children:"Edit settings"}),r.description&&u.jsx("p",{className:"text-sm text-text2 mt-2",children:r.description})]}),dt&&u.jsx("div",{className:"mt-1",children:u.jsxs("label",{className:"inline-flex items-center gap-2 text-sm",children:[u.jsx("input",{type:"checkbox",checked:jl,onChange:async F=>{const se=F.target.checked;Pi(se);try{await wt(G(e,`groups/${t}/members/${dt}`),{muted:se},{merge:!0})}catch{Pi(!se),alert("Could not update notification setting.")}}}),u.jsx("span",{children:"Mute notifications for this group"})]})})]}),u.jsxs("section",{className:"mt-6 rounded-xl border border-border bg-card p-5",children:[u.jsx("div",{className:"flex items-center justify-between",children:u.jsx("h2",{className:"text-lg font-semibold text-accent",children:"Resources"})}),l&&u.jsxs("form",{onSubmit:Ol,className:"mt-3 grid gap-2 sm:grid-cols-6",children:[u.jsx("input",{className:"sm:col-span-2 rounded-lg border border-border bg-background px-3 py-2 text-sm outline-none",placeholder:"Title",value:Q,onChange:F=>B(F.target.value)}),u.jsx("input",{className:"sm:col-span-3 rounded-lg border border-border bg-background px-3 py-2 text-sm outline-none",placeholder:"https://...",value:K,onChange:F=>J(F.target.value)}),u.jsx("div",{className:"sm:col-span-6",children:u.jsx("textarea",{className:"w-full rounded-lg border border-border bg-background px-3 py-2 text-sm outline-none",placeholder:"Optional note (description)",value:ye,onChange:F=>de(F.target.value)})}),u.jsxs("div",{className:"sm:col-span-6",children:[u.jsx("button",{className:"rounded-lg bg-[#919FAA] hover:opacity-90 px-4 py-2 text-white text-sm",disabled:me,children:me?"Saving":"Add resource"}),Se&&u.jsx("span",{className:"ml-3 text-sm text-rose-700",children:Se})]})]}),u.jsxs("ul",{className:"mt-3 divide-y divide-border",children:[p.map(F=>u.jsxs("li",{className:"py-2 flex items-center justify-between gap-3",children:[u.jsxs("div",{children:[u.jsx("a",{href:F.url,target:"_blank",rel:"noreferrer",className:"text-sm text-accent underline underline-offset-2 break-all",children:F.title}),F.note&&u.jsx("p",{className:"text-xs text-text2 mt-1",children:F.note})]}),l&&u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("button",{type:"button",onClick:()=>Ld(F),className:"text-xs rounded-lg border border-border px-2 py-1 hover:bg-muted",children:"Edit"}),u.jsx("button",{type:"button",onClick:()=>Md(F.id),className:"text-xs rounded-lg border border-rose-300 text-rose-700 px-2 py-1 hover:bg-rose-50",children:"Remove"})]})]},F.id)),p.length===0&&u.jsx("li",{className:"py-2 text-sm text-text2",children:"No resources yet."})]}),re&&u.jsxs("form",{onSubmit:F=>{F.preventDefault(),Bo()},className:"mt-3 grid gap-2 sm:grid-cols-6",children:[u.jsx("input",{className:"sm:col-span-2 rounded-lg border border-border bg-background px-3 py-2 text-sm outline-none",placeholder:"Title",value:Et,onChange:F=>Qe(F.target.value)}),u.jsx("input",{className:"sm:col-span-3 rounded-lg border border-border bg-background px-3 py-2 text-sm outline-none",placeholder:"https://...",value:Oe,onChange:F=>Tt(F.target.value)}),u.jsx("div",{className:"sm:col-span-6",children:u.jsx("textarea",{className:"w-full rounded-lg border border-border bg-background px-3 py-2 text-sm outline-none",placeholder:"Optional note (description)",value:z,onChange:F=>Z(F.target.value)})}),u.jsxs("div",{className:"sm:col-span-6 flex items-center gap-2",children:[u.jsx("button",{className:"rounded-lg bg-[#919FAA] hover:opacity-90 px-4 py-2 text-white text-sm",disabled:me,children:me?"Saving":"Save changes"}),u.jsx("button",{type:"button",onClick:()=>{st(null),Qe(""),Tt(""),Z("")},className:"text-sm rounded-lg border border-border px-3 py-2 hover:bg-muted",children:"Cancel"}),Se&&u.jsx("span",{className:"text-sm text-rose-700",children:Se})]})]})]}),u.jsxs("section",{className:"mt-6 rounded-xl border border-border bg-card p-5 relative",children:[u.jsx("h2",{className:"text-lg font-semibold text-accent",children:"Messages"}),u.jsx("div",{className:"mt-3 space-y-2 max-h-80 overflow-auto pr-1",children:A.length>0?A.map(F=>{var Re,ue;const se=((Re=xt[F.id])==null?void 0:Re.lastReplyCount)||0,ge=F.replyCount||0,ie=ge>se;return u.jsx("div",{className:"rounded-lg border border-slate-700 px-3 py-2",children:u.jsxs("div",{className:"flex items-start justify-between gap-2",children:[u.jsxs("div",{children:[u.jsx("p",{className:"text-sm",children:u.jsx("span",{className:"font-medium",children:F.displayName||"Member"})}),u.jsx("p",{className:"text-sm text-slate-200 whitespace-pre-wrap",children:F.text})]}),u.jsxs("div",{className:"flex items-center gap-2",children:[ie&&ge>0&&u.jsx("span",{className:"text-[10px] px-2 py-0.5 rounded-full font-medium",style:{backgroundColor:"#919FAA",color:"#ffffff"},children:"New replies"}),u.jsx("button",{onClick:()=>{Ws(F)},className:"text-xs rounded-lg border border-border px-2 py-1 hover:bg-muted",title:"View thread / Reply",children:ge>0?`View thread (${ge})`:"Reply"}),(l||((ue=n.currentUser)==null?void 0:ue.uid)===F.uid)&&u.jsx("button",{onClick:()=>{Vl(F.id)},className:"text-xs rounded-lg border border-rose-300 text-rose-700 px-2 py-1 hover:bg-rose-50 h-fit",children:"Delete"})]})]})},F.id)}):u.jsx("p",{className:"text-sm text-text2",children:"No messages yet."})}),u.jsxs("form",{onSubmit:zo,className:"mt-3 flex gap-2",children:[u.jsx("input",{type:"text",value:E,onChange:F=>v(F.target.value),placeholder:"Write a message",className:"flex-1 rounded-lg border border-border bg-background px-3 py-2 text-sm outline-none"}),u.jsx("button",{type:"submit",disabled:x||!E.trim(),className:"rounded-lg bg-slate-900 text-white px-3 py-1.5 text-sm hover:bg-slate-800 disabled:opacity-60",children:x?"Sending":"Send"})]}),O&&S&&u.jsxs("div",{className:"fixed inset-0 z-50",children:[u.jsx("button",{className:"absolute inset-0 bg-black/60",onClick:Di,"aria-label":"Close thread overlay"}),u.jsxs("div",{className:"absolute right-0 top-0 h-full w-full sm:w-[28rem] bg-slate-900 text-white border-l border-slate-800 shadow-xl p-4 overflow-y-auto",children:[u.jsxs("div",{className:"flex items-start justify-between gap-2",children:[u.jsxs("div",{className:"pr-6",children:[u.jsx("p",{className:"text-sm",children:u.jsx("span",{className:"font-medium",children:S.displayName||"Member"})}),u.jsx("p",{className:"text-sm text-slate-200 whitespace-pre-wrap",children:S.text})]}),u.jsx("button",{onClick:Di,className:"p-2 rounded-md hover:bg-muted","aria-label":"Close thread",children:""})]}),u.jsx("div",{className:"mt-4 space-y-2",children:I.length===0?u.jsx("p",{className:"text-sm text-slate-200",children:"No replies yet."}):I.map(F=>u.jsxs("div",{className:"rounded-lg border border-slate-700 px-3 py-2",children:[u.jsx("p",{className:"text-sm",children:u.jsx("span",{className:"font-medium",children:F.displayName||"Member"})}),u.jsx("p",{className:"text-sm text-slate-200 whitespace-pre-wrap",children:F.text})]},F.id))}),u.jsxs("form",{onSubmit:qo,className:"mt-3 flex gap-2 sticky bottom-2 pt-2 bg-slate-900",children:[u.jsx("input",{type:"text",value:P,onChange:F=>j(F.target.value),placeholder:"Write a reply",className:"flex-1 rounded-lg border border-slate-700 bg-slate-800 px-3 py-2 text-sm outline-none text-white placeholder:text-slate-400"}),u.jsx("button",{type:"submit",disabled:C||!P.trim(),className:"rounded-lg bg-slate-100 text-slate-900 px-3 py-1.5 text-sm hover:bg-white disabled:opacity-60",children:C?"Sending":"Reply"})]})]})]})]}),u.jsxs("section",{className:"mt-6 rounded-xl border border-border bg-card p-5",children:[u.jsx("h2",{className:"text-lg font-semibold text-accent",children:"Direct Messages"}),u.jsx("p",{className:"text-sm text-text2 mt-1",children:"Select one or more members and send a private message."}),u.jsxs("div",{className:"mt-3 grid gap-2 sm:grid-cols-6",children:[u.jsx("input",{type:"text",value:oe,onChange:F=>It(F.target.value),placeholder:"Search members",className:"sm:col-span-3 rounded-lg border border-border bg-background px-3 py-2 text-sm outline-none","aria-label":"Filter members for DM"}),u.jsx("div",{className:"sm:col-span-3 max-h-48 overflow-auto rounded-lg border border-border bg-background p-2",children:ar.length===0?u.jsx("p",{className:"text-xs text-text2",children:"No members to message."}):u.jsx("ul",{className:"space-y-1",children:ar.map(F=>u.jsxs("li",{className:"flex items-center gap-2",children:[u.jsx("input",{id:`dm-${F.uid}`,type:"checkbox",checked:!!Ie[F.uid],onChange:se=>Le(ge=>({...ge,[F.uid]:se.target.checked})),className:"h-4 w-4"}),u.jsxs("label",{htmlFor:`dm-${F.uid}`,className:"text-sm",children:[F.displayName||F.uid,F.email?`  ${F.email}`:""]})]},F.uid))})})]}),u.jsxs("form",{onSubmit:Ll,className:"mt-3 grid gap-2 sm:grid-cols-6",children:[u.jsx("textarea",{value:qe,onChange:F=>gt(F.target.value),placeholder:"Write a private message",className:"sm:col-span-5 min-h-[3.25rem] rounded-lg border border-border bg-background px-3 py-2 text-sm outline-none"}),u.jsx("div",{className:"sm:col-span-1",children:u.jsx("button",{type:"submit",disabled:Qt||!Dl||!qe.trim(),className:"w-full rounded-lg bg-slate-900 text-white px-4 py-2 text-sm hover:bg-slate-800 disabled:opacity-60",title:Dl?void 0:"Select at least one member",children:Qt?"Sending":"Send DM"})})]}),Jr&&u.jsx("p",{className:"mt-2 text-sm text-rose-700",children:Jr}),Pl&&u.jsx("p",{className:"mt-2 text-sm text-emerald-700",children:"Message sent."})]}),u.jsxs("section",{className:"mt-6 rounded-xl border border-border bg-card p-5",children:[u.jsx("h2",{className:"text-lg font-semibold text-accent",children:"Team"}),y.length>0?u.jsx("ul",{className:"mt-3 grid grid-cols-1 sm:grid-cols-2 gap-2",children:y.map(F=>u.jsxs("li",{className:"rounded-lg border border-border px-3 py-2",children:[u.jsx("p",{className:"text-sm",children:F.displayName||F.uid}),F.role&&u.jsx("p",{className:"text-xs text-text2",children:F.role}),F.email&&u.jsx("p",{className:"text-xs text-text2",children:F.email}),"muted"in F&&u.jsx("p",{className:"text-[11px] text-text2 mt-1",children:F.muted?"Muted":"Notifications on"})]},F.uid))}):u.jsx("p",{className:"text-sm text-text2 mt-2",children:"No members are listed for this group yet."})]})]})}):u.jsx("div",{className:"container py-8",children:u.jsxs("div",{className:"max-w-3xl mx-auto rounded-xl border border-border bg-card p-6",children:[u.jsx("h1",{className:"text-xl font-semibold text-accent mb-2",children:r.name||t}),u.jsx("p",{className:"text-sm text-text2 mb-4",children:"Membership is required to view this group."}),u.jsx("p",{className:"text-sm text-text2",children:"Request to join from the Explore page."})]})}):u.jsx("div",{className:"container py-8",children:u.jsx("div",{className:"max-w-5xl mx-auto p-6",children:u.jsx("p",{className:"text-text2",children:"Group not found."})})})}const nS="/assets/Header_Logo-CWkkS3_r.png";function YO(){const[t,e]=k.useState(!1);return k.useEffect(()=>{const n=window.matchMedia&&window.matchMedia("(display-mode: standalone)"),r=navigator.standalone===!0,s=()=>e(!!(n&&n.matches||r));return s(),n&&n.addEventListener&&n.addEventListener("change",s),()=>{n&&n.removeEventListener&&n.removeEventListener("change",s)}},[]),t}function JO(){const t=YO();return u.jsxs(u.Fragment,{children:[t&&u.jsx("style",{children:`
          [data-app-header]{
            padding-top: env(safe-area-inset-top);
            padding-top: constant(safe-area-inset-top);
          }
        `}),u.jsx("header",{"data-app-header":!0,className:"w-full border-b border-border bg-[var(--bg)]",children:u.jsx("div",{className:"container py-2 md:py-3 flex items-center",children:u.jsx(_e,{to:"/login","aria-label":"Immanuel Members Home",className:"shrink-0",children:u.jsx("img",{src:nS,alt:"Immanuel Downtown",className:"h-14 sm:h-12 md:h-14 lg:h-16 w-auto object-contain"})})})})]})}function mw(t){return t&&t.trim().split(/\s+/)[0]||null}function XO(){const[t,e]=k.useState(!1);return k.useEffect(()=>{const n=window.matchMedia&&window.matchMedia("(display-mode: standalone)"),r=navigator.standalone===!0,s=()=>e(!!(n&&n.matches||r));return s(),n&&n.addEventListener&&n.addEventListener("change",s),()=>{n&&n.removeEventListener&&n.removeEventListener("change",s)}},[]),t}function ZO(){const{user:t,isAdmin:e}=Od(),n=Ln(),[r,s]=k.useState(""),[i,o]=k.useState(!1),l=XO(),c="inline-flex items-center justify-center min-h-[2.25rem] px-3 py-2 rounded-lg text-sm leading-tight text-center whitespace-normal md:whitespace-nowrap",d=f=>`${c} ${f?"bg-muted text-accent":"text-text hover:text-accent"}`;return k.useEffect(()=>{let f=!0;async function p(){if(!t){f&&s("");return}const m=mw(t.displayName);if(m){f&&s(m);return}try{const y=await Ae(G(Ng,"users",t.uid));if(y.exists()){const w=y.data(),A=(w==null?void 0:w.name)||[w==null?void 0:w.firstName,w==null?void 0:w.lastName].filter(Boolean).join(" ").trim(),b=mw(A);if(b){f&&s(b);return}}}catch{}f&&s("there")}return p(),()=>{f=!1}},[t]),k.useEffect(()=>{o(!1)},[n.pathname]),u.jsxs(u.Fragment,{children:[l&&u.jsx("style",{children:`
          [data-app-header] {
            padding-top: env(safe-area-inset-top);
            /* Safari < 11.2 fallback (rare now) */
            padding-top: constant(safe-area-inset-top);
          }
        `}),u.jsxs("header",{"data-app-header":!0,className:"w-full border-b border-border bg-[var(--bg)]",children:[u.jsxs("div",{className:"container py-2 md:py-3 grid grid-cols-2 md:grid-cols-3 grid-rows-2 md:grid-rows-1 items-center gap-x-3 gap-y-2",children:[u.jsx("div",{className:"col-start-1 row-start-1 md:col-span-1 flex items-center min-w-0",children:u.jsx(_e,{to:"/dashboard","aria-label":"Immanuel Members Home",className:"shrink-0",children:u.jsx("img",{src:nS,alt:"Immanuel Downtown",className:"h-14 sm:h-12 md:h-14 lg:h-16 w-auto object-contain"})})}),u.jsx("div",{className:"col-start-2 row-start-1 md:hidden flex justify-end",children:u.jsx("button",{"aria-label":"Open menu","aria-expanded":i,className:"p-2 rounded-md border border-border/70 bg-surface/40 hover:bg-surface/60 active:scale-[0.98] transition",onClick:()=>o(f=>!f),children:u.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none","aria-hidden":"true",children:u.jsx("path",{d:"M4 6h16M4 12h16M4 18h16",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})})})}),u.jsxs("nav",{className:"col-span-2 row-start-2 md:row-start-1 md:col-span-1 flex justify-center gap-4 text-sm",children:[u.jsx(mu,{to:"/dashboard",className:({isActive:f})=>d(f),children:"Dashboard"}),u.jsx(mu,{to:"/sunday-resources",className:({isActive:f})=>d(f),children:"Sunday White Papers"}),u.jsx(mu,{to:"/groups",className:({isActive:f})=>d(f),children:"Groups"}),e&&u.jsx(mu,{to:"/admin",className:({isActive:f})=>d(f),children:"Admin"})]}),u.jsx("div",{className:"hidden md:flex md:col-start-3 md:row-start-1 justify-end items-center gap-2",children:t?u.jsxs(u.Fragment,{children:[u.jsxs("span",{className:"text-sm text-text2",children:["Hi",r?`, ${r}`:""]}),u.jsx(_e,{to:"/profile",className:"btn btn-outline btn-md",children:"Profile"}),u.jsx("button",{className:"btn btn-outline btn-md",onClick:()=>Yf(ul),children:"Sign out"})]}):n.pathname!=="/login"&&u.jsx(_e,{to:"/login",className:"btn btn-outline btn-md",children:"Sign in"})})]}),i&&u.jsxs("div",{className:"fixed inset-0 z-50",children:[u.jsx("button",{"aria-label":"Close menu",className:"absolute inset-0 bg-black/40",onClick:()=>o(!1)}),u.jsxs("div",{className:"absolute top-2 right-2 w-64 rounded-xl border border-border bg-[var(--bg)] shadow-xl p-3",children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsx("div",{className:"text-sm text-text2",children:"Menu"}),u.jsx("button",{className:"p-2 rounded-md hover:bg-surface/60",onClick:()=>o(!1),"aria-label":"Close",children:u.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",children:u.jsx("path",{d:"M6 6l12 12M18 6l-12 12",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})})})]}),u.jsx("div",{className:"mt-2 border-t border-border/60 pt-2 grid gap-2",children:t?u.jsxs(u.Fragment,{children:[u.jsx(_e,{to:"/profile",className:"btn btn-outline btn-sm",onClick:()=>o(!1),children:"Profile"}),e&&u.jsx(_e,{to:"/admin",className:"btn btn-outline btn-sm",onClick:()=>o(!1),children:"Admin"}),u.jsx("button",{className:"btn btn-outline btn-sm",onClick:()=>{o(!1),Yf(ul)},children:"Sign out"})]}):n.pathname!=="/login"&&u.jsx(_e,{to:"/login",className:"btn btn-outline btn-sm",onClick:()=>o(!1),children:"Sign in"})})]})]})]})]})}function eV(){const t=Ke(te),e=Yr(),[n,r]=k.useState(""),[s,i]=k.useState(""),[o,l]=k.useState(!1),[c,d]=k.useState(!1),[f,p]=k.useState(!1),[m,y]=k.useState(null);k.useEffect(()=>Mn(t,E=>{E&&e("/dashboard",{replace:!0})}),[t,e]);async function w(){y(null),d(!0);try{const b=new An;await jm(t,b),e("/dashboard",{replace:!0})}catch{y("Google sign-in was cancelled or failed.")}finally{d(!1)}}async function A(b){if(b.preventDefault(),y(null),!n||!s){y("Please enter your email and password.");return}p(!0);try{await RE(t,n,s),e("/dashboard",{replace:!0})}catch(E){const v=String((E==null?void 0:E.code)||"");let x="Could not sign in with email and password.";v==="auth/invalid-email"?x="Please enter a valid email address.":(v==="auth/user-not-found"||v==="auth/wrong-password")&&(x="Email or password is incorrect."),y(x)}finally{p(!1)}}return u.jsx("div",{className:"container py-8 md:py-12",children:u.jsxs("div",{className:"mx-auto max-w-md rounded-xl border border-border bg-card p-6 shadow",children:[u.jsx("h1",{className:"text-2xl font-semibold text-accent mb-1",children:"Welcome back"}),u.jsx("p",{className:"text-sm text-text2 mb-6",children:"Sign in to continue."}),m&&u.jsx("div",{className:"mb-4 rounded-lg border border-red-300 bg-red-50 px-3 py-2 text-sm text-red-700",children:m}),u.jsxs("form",{onSubmit:A,className:"grid gap-3 mb-4",children:[u.jsxs("label",{className:"grid gap-1",children:[u.jsx("span",{className:"text-sm",children:"Email"}),u.jsx("input",{type:"email",value:n,onChange:b=>r(b.target.value),placeholder:"you@example.com",autoComplete:"email",className:"rounded-lg border border-border bg-background px-3 py-2 outline-none",required:!0})]}),u.jsxs("label",{className:"grid gap-1",children:[u.jsx("span",{className:"text-sm",children:"Password"}),u.jsxs("div",{className:"flex gap-2",children:[u.jsx("input",{type:o?"text":"password",value:s,onChange:b=>i(b.target.value),placeholder:"",autoComplete:"current-password",className:"flex-1 rounded-lg border border-border bg-background px-3 py-2 outline-none",required:!0}),u.jsx("button",{type:"button",onClick:()=>l(b=>!b),className:"rounded-lg border border-border px-3 py-2 text-sm",children:o?"Hide":"Show"})]})]}),u.jsx("button",{type:"submit",disabled:f,className:"rounded-lg bg-[#919FAA] hover:opacity-90 px-4 py-2 text-white disabled:opacity-60",children:f?"Signing in":"Sign in"})]}),u.jsx("button",{type:"button",onClick:w,disabled:c,className:"btn btn-outline w-full",children:c?"Please wait":"Sign in with Google"}),u.jsx("div",{className:"mt-2",children:u.jsx(_e,{to:"/signup",className:"btn btn-outline w-full",children:"Create account"})}),u.jsx("div",{className:"mt-6 text-center",children:u.jsx(_e,{to:"/forgot",className:"text-sm text-accent underline underline-offset-2",children:"Forgot password?"})})]})})}function tV(t){const e=t.trim().split(/\s+/).filter(Boolean);return e.length===0?{firstName:"",lastName:""}:e.length===1?{firstName:e[0],lastName:""}:{firstName:e[0],lastName:e.slice(1).join(" ")}}function nV(){const t=Ke(te),e=Yr(),[n,r]=k.useState(""),[s,i]=k.useState(""),[o,l]=k.useState(""),[c,d]=k.useState(""),[f,p]=k.useState(""),[m,y]=k.useState(!1),[w,A]=k.useState(null),[b,E]=k.useState(!1);k.useEffect(()=>Mn(t,O=>{O&&e("/dashboard",{replace:!0})}),[t,e]);async function v(R){R.preventDefault(),A(null);const O=n.trim(),L=s.trim();if(!O){A("Please enter your first name.");return}if(!o||!c){A("Please enter an email and password.");return}if(c!==f){A("Passwords do not match.");return}const S=(O+" "+L).trim();E(!0);try{const _=await qk(t,o,c);_.user&&await PE(_.user,{displayName:S});try{localStorage.setItem("signupName",S),localStorage.setItem("signupFirstName",O),localStorage.setItem("signupLastName",L)}catch{}e("/welcome",{replace:!0,state:{name:S,firstName:O,lastName:L}})}catch(_){const I=String((_==null?void 0:_.code)||"");let N="Could not create account.";I==="auth/email-already-in-use"?N="That email is already in use.":I==="auth/invalid-email"?N="Please enter a valid email address.":I==="auth/weak-password"&&(N="Password should be at least 6 characters."),A(N)}finally{E(!1)}}async function x(){var R;A(null),E(!0);try{const O=new An,S=((R=(await jm(t,O)).user)==null?void 0:R.displayName)||"",{firstName:_,lastName:I}=tV(S);try{S&&(localStorage.setItem("signupName",S),localStorage.setItem("signupFirstName",_),localStorage.setItem("signupLastName",I))}catch{}e("/welcome",{replace:!0,state:{name:S,firstName:_,lastName:I}})}catch{A("Google sign-in was cancelled or failed.")}finally{E(!1)}}return u.jsx("div",{className:"container py-8 md:py-12",children:u.jsxs("div",{className:"mx-auto max-w-md rounded-xl border border-border bg-card p-6 shadow",children:[u.jsx("h1",{className:"text-2xl font-semibold text-accent mb-1",children:"Create your account"}),u.jsx("p",{className:"text-sm text-text2 mb-6",children:"Join Immanuel Downtown to access your dashboard and groups."}),w&&u.jsx("div",{className:"mb-4 rounded-lg border border-red-300 bg-red-50 px-3 py-2 text-sm text-red-700",children:w}),u.jsxs("form",{onSubmit:v,className:"grid gap-3",children:[u.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[u.jsxs("label",{className:"grid gap-1",children:[u.jsx("span",{className:"text-sm",children:"First name"}),u.jsx("input",{type:"text",value:n,onChange:R=>r(R.target.value),placeholder:"Jordan",autoComplete:"given-name",required:!0,className:"rounded-lg border border-border bg-background px-3 py-2 outline-none"})]}),u.jsxs("label",{className:"grid gap-1",children:[u.jsx("span",{className:"text-sm",children:"Last name"}),u.jsx("input",{type:"text",value:s,onChange:R=>i(R.target.value),placeholder:"Smith",autoComplete:"family-name",className:"rounded-lg border border-border bg-background px-3 py-2 outline-none"})]})]}),u.jsxs("label",{className:"grid gap-1",children:[u.jsx("span",{className:"text-sm",children:"Email"}),u.jsx("input",{type:"email",value:o,onChange:R=>l(R.target.value),placeholder:"you@example.com",autoComplete:"email",required:!0,className:"rounded-lg border border-border bg-background px-3 py-2 outline-none"})]}),u.jsxs("label",{className:"grid gap-1",children:[u.jsx("span",{className:"text-sm",children:"Password"}),u.jsxs("div",{className:"flex gap-2",children:[u.jsx("input",{type:m?"text":"password",value:c,onChange:R=>d(R.target.value),placeholder:"",autoComplete:"new-password",required:!0,className:"flex-1 rounded-lg border border-border bg-background px-3 py-2 outline-none"}),u.jsx("button",{type:"button",onClick:()=>y(R=>!R),className:"rounded-lg border border-border px-3 py-2 text-sm",children:m?"Hide":"Show"})]})]}),u.jsxs("label",{className:"grid gap-1",children:[u.jsx("span",{className:"text-sm",children:"Confirm password"}),u.jsx("input",{type:m?"text":"password",value:f,onChange:R=>p(R.target.value),placeholder:"",autoComplete:"new-password",required:!0,className:"rounded-lg border border-border bg-background px-3 py-2 outline-none"})]}),u.jsx("button",{type:"submit",disabled:b,className:"mt-2 rounded-lg bg-accent px-4 py-2 text-white hover:opacity-90 disabled:opacity-60",children:b?"Creating":"Create account"})]}),u.jsx("div",{className:"mt-4",children:u.jsx("button",{type:"button",onClick:x,disabled:b,className:"w-full rounded-lg border border-border px-4 py-2 text-sm hover:bg-muted disabled:opacity-60",children:"Continue with Google"})}),u.jsxs("div",{className:"mt-4 text-sm text-text2",children:["Already have an account?"," ",u.jsx(_e,{to:"/login",className:"text-accent underline underline-offset-2",children:"Sign in"})]})]})})}function rV(){const t=k.useMemo(()=>$e(te),[]),{user:e,loading:n}=Od(),r=(e==null?void 0:e.uid)??null,[s,i]=k.useState(null);if(k.useEffect(()=>{if(!r){i([]);return}const l=Je(pe(t,`users/${r}/notifications`),Vn("createdAt","desc")),c=Xt(l,d=>{const f=d.docs.map(p=>({id:p.id,...p.data()}));i(f.filter(p=>!p.read))},d=>{console.error("Notifications listener error:",(d==null?void 0:d.message)||d),i([])});return()=>c()},[t,r]),s===null||n)return u.jsxs("div",{className:"p-1",children:[u.jsx("h2",{className:"text-xl font-semibold text-accent",children:"Notifications"}),u.jsx("div",{className:"mt-2",children:u.jsx(ir,{label:"Loading notifications"})})]});async function o(l){if(r)try{await yg(G(t,`users/${r}/notifications/${l}`),{read:!0,readAt:ke()})}catch{}}return u.jsxs("div",{children:[u.jsx("h2",{className:"text-xl font-semibold text-accent",children:"Notifications"}),s.length===0?u.jsx("p",{className:"text-text2 mt-2",children:"You have no new notifications."}):u.jsx("ul",{className:"mt-3 space-y-2",children:s.map(l=>{const c=u.jsxs("div",{className:"flex items-center justify-between gap-2",children:[u.jsxs("div",{children:[u.jsx("p",{className:"text-sm",children:l.text}),l.groupName&&u.jsxs("p",{className:"text-xs text-text2",children:["Group: ",l.groupName]})]}),u.jsx("span",{className:"text-[10px] px-1.5 py-0.5 rounded-full bg-emerald-100 text-emerald-700 border border-emerald-200",children:"new"})]});return u.jsx("li",{className:"rounded-lg border border-border bg-card px-3 py-2 ring-1 ring-emerald-300/40",children:l.href?u.jsx(_e,{to:l.href,onClick:()=>o(l.id),className:"block hover:opacity-90",children:c}):u.jsx("button",{onClick:()=>o(l.id),className:"block w-full text-left hover:opacity-90",children:c})},l.id)})})]})}const gw="https://calendar.google.com/calendar/embed?src=immanueldowntown@gmail.com",sV="America/New_York";function iV(){const{isAdmin:t}=Od(),e=k.useMemo(()=>Ke(te),[]),n=k.useMemo(()=>$e(te),[]),[r,s]=k.useState(!1);k.useEffect(()=>{let l=!1;async function c(){try{const d=e.currentUser;if(!d)return;const f=d.uid;let p=!1;if((await Ae(G(n,"admins",f))).exists()){try{(await Fe(Je(_r(n,"membershipRequests"),qu(1)))).size>0&&(p=!0)}catch{}try{(await Fe(Je(pe(n,"users"),kn("isCommunityApproved","==",!1),qu(1)))).size>0&&(p=!0)}catch{}}else try{const A=(await Fe(Je(_r(n,"groupAdmins"),kn(ug(),"==",f)))).docs.map(b=>{var E;return((E=b.ref.parent.parent)==null?void 0:E.id)||""}).filter(Boolean);for(const b of A)try{if((await Fe(Je(pe(n,`groups/${b}/membershipRequests`),qu(1)))).size>0){p=!0;break}}catch{}}catch{}l||s(p)}catch{l||s(!1)}}return c(),()=>{l=!0}},[e,n]);const i=`${gw}${gw.includes("?")?"&":"?"}ctz=${encodeURIComponent(sV)}`,o=r?"text-sm px-3 py-1.5 rounded-lg bg-amber-100 text-amber-900 border border-amber-300 hover:bg-amber-200":"text-sm px-3 py-1.5 rounded-lg bg-slate-100 text-slate-900 hover:bg-slate-200";return u.jsxs("div",{className:"container py-8 md:py-10",children:[u.jsx("div",{className:"text-center mb-6",children:u.jsx("h1",{className:"text-2xl md:text-3xl font-semibold",children:"Welcome!"})}),t&&u.jsxs("section",{className:"mb-6 border border-border p-5 rounded-xl flex items-center justify-between",children:[u.jsxs("div",{children:[u.jsx("h2",{className:"text-xl font-semibold text-accent",children:"Admin Tools"}),u.jsx("p",{className:"text-sm text-text2",children:r?"Attention needed: pending requests or new users.":"You have admin privileges."})]}),u.jsx(_e,{to:"/admin/groups",className:o,title:r?"Pending requests or new users need review":"Open Admin Console",children:"Admin Console"})]}),u.jsxs("section",{className:"border border-border p-5 rounded-xl",children:[u.jsx("h2",{className:"text-xl font-semibold text-accent",children:"General Announcements"}),u.jsxs("ul",{className:"mt-3 space-y-2 text-text",children:[u.jsx("li",{children:" Welcome to the Community Portal. Check your groups for updates. "}),u.jsx("li",{children:' Notifications are now working. Open your profile and click on "Enable notification" in order be kept up to speed on announcements and new resources and communications in your groups.'}),u.jsx("li",{children:" We are working on getting Direct Messaging working so everyone can communicate easily in one place."}),u.jsx("li",{children:" We are still in development. If you find bugs, or have features you'd like to see added, send Sam a DM."})]}),u.jsx("div",{className:"mt-6 pt-5 border-t border-border",children:u.jsx("div",{className:"mt-2",children:u.jsx(rV,{})})})]}),u.jsxs("section",{className:"mt-8 border border-border p-5 rounded-xl",children:[u.jsx("h2",{className:"text-xl font-semibold text-accent",children:"Calendar"}),u.jsx("p",{className:"text-text2 text-sm mt-1",children:"Synced from church Google Calendar."}),u.jsx("div",{className:"mt-4 w-full",children:i?u.jsx("iframe",{className:"w-full h-[440px] sm:h-[520px] md:h-[720px] rounded border-0",src:i,title:"Church Calendar",loading:"lazy",referrerPolicy:"no-referrer-when-downgrade"}):u.jsx("div",{className:"w-full h-[440px] sm:h-[520px] md:h-[720px] flex items-center justify-center text-center p-6 text-sm text-text2 rounded bg-surface/50",children:u.jsxs("div",{children:[u.jsx("div",{className:"font-medium text-text mb-1",children:"Calendar not configured"}),u.jsxs("div",{children:["Set ",u.jsx("code",{className:"px-1 py-0.5 rounded bg-surface/50",children:"VITE_GCAL_EMBED_URL"})," in your env. In Google Calendar  ",u.jsx("em",{children:"Settings  Integrate calendar"}),", copy the ",u.jsx("strong",{children:"Embed code"})," ",u.jsx("code",{children:"src"})," URL and paste it there."]})]})})})]})]})}function oV(){const t=Ke(te),e=k.useMemo(()=>$e(te),[]),[n,r]=k.useState(null),[s,i]=k.useState(!0);return k.useEffect(()=>{if(!t.currentUser)return;const o=t.currentUser.uid,l=Xt(pe(e,`users/${o}/memberships`),async c=>{const d=c.docs.map(p=>p.id);if(d.length===0){r([]),i(!1);return}const f=await Promise.all(d.map(async p=>{const m=await Ae(G(e,"groups",p));if(m.exists()){const y=m.data();return{id:m.id,...y}}return null}));r(f.filter(Boolean)),i(!1)});return()=>l()},[t.currentUser,e]),s?u.jsx("div",{className:"container py-8",children:u.jsx("div",{className:"max-w-5xl mx-auto p-6",children:u.jsx(ir,{label:"Loading your groups"})})}):u.jsx("div",{className:"container py-8 md:py-12",children:u.jsxs("div",{className:"max-w-5xl mx-auto",children:[u.jsx("h1",{className:"text-2xl font-semibold text-accent mb-4",children:"Your Groups"}),n&&n.length>0?u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:n.map(o=>u.jsx(tS,{group:o,isMember:!0},o.id))}),u.jsx("div",{className:"mt-6",children:u.jsx(_e,{to:"/groups/explore",className:"inline-flex rounded-lg border border-border px-3 py-1.5 text-sm hover:bg-muted",children:"Other Available Groups"})})]}):u.jsxs("div",{className:"rounded-xl border border-border bg-card p-6",children:[u.jsx("p",{className:"text-text2",children:"You havent joined any groups yet."}),u.jsx(_e,{to:"/groups/explore",className:"inline-flex mt-3 rounded-lg bg-slate-900 text-white px-3 py-1.5 text-sm hover:bg-slate-800",children:"View More Groups"})]})]})})}function aV(){return u.jsxs("div",{className:"container py-10",children:[u.jsx("h1",{className:"text-2xl font-semibold text-accent",children:"Forums"}),u.jsx("p",{className:"text-text2 mt-2",children:"Community discussions coming soon."})]})}function lV(){Ke(te);const t=$e(te),[e,n]=k.useState([]),[r,s]=k.useState(""),[i,o]=k.useState([]);k.useEffect(()=>{const p=Je(_r(t,"resources"),Vn("createdAt","desc"));return Xt(p,y=>{n(y.docs.map(w=>({id:w.id,...w.data(),__path:w.ref.path})))})},[t]);const l=k.useMemo(()=>{const p=new Set;return e.forEach(m=>(m.tags||[]).forEach(y=>p.add(y))),Array.from(p).sort()},[e]),c=p=>{o(m=>m.includes(p)?m.filter(y=>y!==p):[...m,p])},d=p=>{try{const m=p!=null&&p.toDate?p.toDate():p instanceof Date?p:null;if(!m)return!1;const y=7*24*60*60*1e3;return Date.now()-m.getTime()<y}catch{return!1}},f=k.useMemo(()=>{const p=r.trim().toLowerCase();return e.filter(m=>{const y=p.length===0||(m.title||"").toLowerCase().includes(p)||(m.description||"").toLowerCase().includes(p)||(m.url||"").toLowerCase().includes(p),w=i.length===0||i.every(A=>(m.tags||[]).includes(A));return y&&w})},[e,r,i]);return u.jsxs("div",{className:"container py-10",children:[u.jsx("h1",{className:"text-2xl font-semibold text-accent",children:"Resources"}),u.jsx("p",{className:"text-text2 mt-2",children:"Documents, links, and media you have access to."}),u.jsxs("div",{className:"mt-6 flex flex-col gap-3",children:[u.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[u.jsx("input",{className:"rounded-lg border border-slate-300 bg-white px-3 py-2 text-sm outline-none",placeholder:"Search by title, description, or URL",value:r,onChange:p=>s(p.target.value)}),i.length>0&&u.jsx("button",{type:"button",className:"rounded-lg border border-slate-300 px-3 py-2 text-sm hover:bg-slate-100",onClick:()=>o([]),children:"Clear tags"})]}),l.length>0&&u.jsx("div",{className:"flex flex-wrap gap-2",children:l.map(p=>u.jsxs("button",{type:"button",onClick:()=>c(p),className:`text-xs rounded-full px-3 py-1 border ${i.includes(p)?"border-slate-700 bg-slate-800 text-white":"border-slate-300 bg-white text-slate-700 hover:bg-slate-50"}`,"aria-pressed":i.includes(p),children:["#",p]},p))}),u.jsxs("ul",{className:"divide-y divide-slate-200 rounded-2xl border border-slate-200 bg-white/70",children:[f.map(p=>u.jsx("li",{className:"p-4 flex items-start justify-between gap-3",children:u.jsxs("div",{className:"min-w-0",children:[u.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[u.jsx("a",{href:p.url,target:"_blank",rel:"noreferrer",className:"text-sm text-accent underline underline-offset-2 break-all",children:p.title||p.url}),d(p.createdAt)&&u.jsx("span",{className:"text-[10px] uppercase tracking-wide rounded-full bg-green-100 text-green-800 px-2 py-0.5",children:"New"})]}),p.description&&u.jsx("p",{className:"mt-1 text-sm text-slate-600 whitespace-pre-wrap break-words",children:p.description}),p.tags&&p.tags.length>0&&u.jsx("div",{className:"mt-2 flex flex-wrap gap-1.5",children:p.tags.map(m=>u.jsxs("button",{type:"button",onClick:()=>c(m),className:`text-[11px] rounded-full px-2.5 py-1 border ${i.includes(m)?"border-slate-700 bg-slate-800 text-white":"border-slate-300 bg-white text-slate-700 hover:bg-slate-50"}`,"aria-pressed":i.includes(m),title:`Filter by #${m}`,children:["#",m]},m))})]})},p.__path||p.id)),f.length===0&&u.jsx("li",{className:"p-4 text-sm text-slate-600",children:"No resources match your filters."})]})]})]})}function uV(){return u.jsxs("div",{className:"container py-10",children:[u.jsx("h1",{className:"text-2xl font-semibold text-accent",children:"Events"}),u.jsx("p",{className:"text-text2 mt-2",children:"Calendar and upcoming gatherings."})]})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cV="type.googleapis.com/google.protobuf.Int64Value",dV="type.googleapis.com/google.protobuf.UInt64Value";function rS(t,e){const n={};for(const r in t)t.hasOwnProperty(r)&&(n[r]=e(t[r]));return n}function Uc(t){if(t==null)return null;if(t instanceof Number&&(t=t.valueOf()),typeof t=="number"&&isFinite(t)||t===!0||t===!1||Object.prototype.toString.call(t)==="[object String]")return t;if(t instanceof Date)return t.toISOString();if(Array.isArray(t))return t.map(e=>Uc(e));if(typeof t=="function"||typeof t=="object")return rS(t,e=>Uc(e));throw new Error("Data cannot be encoded in JSON: "+t)}function Co(t){if(t==null)return t;if(t["@type"])switch(t["@type"]){case cV:case dV:{const e=Number(t.value);if(isNaN(e))throw new Error("Data cannot be decoded from JSON: "+t);return e}default:throw new Error("Data cannot be decoded from JSON: "+t)}return Array.isArray(t)?t.map(e=>Co(e)):typeof t=="function"||typeof t=="object"?rS(t,e=>Co(e)):t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bg="functions";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yw={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class cn extends nr{constructor(e,n,r){super(`${bg}/${e}`,n||""),this.details=r,Object.setPrototypeOf(this,cn.prototype)}}function hV(t){if(t>=200&&t<300)return"ok";switch(t){case 0:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 500:return"internal";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}function Fc(t,e){let n=hV(t),r=n,s;try{const i=e&&e.error;if(i){const o=i.status;if(typeof o=="string"){if(!yw[o])return new cn("internal","internal");n=yw[o],r=o}const l=i.message;typeof l=="string"&&(r=l),s=i.details,s!==void 0&&(s=Co(s))}}catch{}return n==="ok"?null:new cn(n,r,s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fV{constructor(e,n,r,s){this.app=e,this.auth=null,this.messaging=null,this.appCheck=null,this.serverAppAppCheckToken=null,an(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.auth=n.getImmediate({optional:!0}),this.messaging=r.getImmediate({optional:!0}),this.auth||n.get().then(i=>this.auth=i,()=>{}),this.messaging||r.get().then(i=>this.messaging=i,()=>{}),this.appCheck||s==null||s.get().then(i=>this.appCheck=i,()=>{})}async getAuthToken(){if(this.auth)try{const e=await this.auth.getToken();return e==null?void 0:e.accessToken}catch{return}}async getMessagingToken(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return await this.messaging.getToken()}catch{return}}async getAppCheckToken(e){if(this.serverAppAppCheckToken)return this.serverAppAppCheckToken;if(this.appCheck){const n=e?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return n.error?null:n.token}return null}async getContext(e){const n=await this.getAuthToken(),r=await this.getMessagingToken(),s=await this.getAppCheckToken(e);return{authToken:n,messagingToken:r,appCheckToken:s}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vp="us-central1",pV=/^data: (.*?)(?:\n|$)/;function mV(t){let e=null;return{promise:new Promise((n,r)=>{e=setTimeout(()=>{r(new cn("deadline-exceeded","deadline-exceeded"))},t)}),cancel:()=>{e&&clearTimeout(e)}}}class gV{constructor(e,n,r,s,i=vp,o=(...l)=>fetch(...l)){this.app=e,this.fetchImpl=o,this.emulatorOrigin=null,this.contextProvider=new fV(e,n,r,s),this.cancelAllRequests=new Promise(l=>{this.deleteService=()=>Promise.resolve(l())});try{const l=new URL(i);this.customDomain=l.origin+(l.pathname==="/"?"":l.pathname),this.region=vp}catch{this.customDomain=null,this.region=i}}_delete(){return this.deleteService()}_url(e){const n=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${n}/${this.region}/${e}`:this.customDomain!==null?`${this.customDomain}/${e}`:`https://${this.region}-${n}.cloudfunctions.net/${e}`}}function yV(t,e,n){const r=Ii(e);t.emulatorOrigin=`http${r?"s":""}://${e}:${n}`,r&&(mm(t.emulatorOrigin),gm("Functions",!0))}function vV(t,e,n){const r=s=>wV(t,e,s,{});return r.stream=(s,i)=>EV(t,e,s,i),r}async function _V(t,e,n,r){n["Content-Type"]="application/json";let s;try{s=await r(t,{method:"POST",body:JSON.stringify(e),headers:n})}catch{return{status:0,json:null}}let i=null;try{i=await s.json()}catch{}return{status:s.status,json:i}}async function sS(t,e){const n={},r=await t.contextProvider.getContext(e.limitedUseAppCheckTokens);return r.authToken&&(n.Authorization="Bearer "+r.authToken),r.messagingToken&&(n["Firebase-Instance-ID-Token"]=r.messagingToken),r.appCheckToken!==null&&(n["X-Firebase-AppCheck"]=r.appCheckToken),n}function wV(t,e,n,r){const s=t._url(e);return xV(t,s,n,r)}async function xV(t,e,n,r){n=Uc(n);const s={data:n},i=await sS(t,r),o=r.timeout||7e4,l=mV(o),c=await Promise.race([_V(e,s,i,t.fetchImpl),l.promise,t.cancelAllRequests]);if(l.cancel(),!c)throw new cn("cancelled","Firebase Functions instance was deleted.");const d=Fc(c.status,c.json);if(d)throw d;if(!c.json)throw new cn("internal","Response is not valid JSON object.");let f=c.json.data;if(typeof f>"u"&&(f=c.json.result),typeof f>"u")throw new cn("internal","Response is missing data field.");return{data:Co(f)}}function EV(t,e,n,r){const s=t._url(e);return TV(t,s,n,r||{})}async function TV(t,e,n,r){var m;n=Uc(n);const s={data:n},i=await sS(t,r);i["Content-Type"]="application/json",i.Accept="text/event-stream";let o;try{o=await t.fetchImpl(e,{method:"POST",body:JSON.stringify(s),headers:i,signal:r==null?void 0:r.signal})}catch(y){if(y instanceof Error&&y.name==="AbortError"){const A=new cn("cancelled","Request was cancelled.");return{data:Promise.reject(A),stream:{[Symbol.asyncIterator](){return{next(){return Promise.reject(A)}}}}}}const w=Fc(0,null);return{data:Promise.reject(w),stream:{[Symbol.asyncIterator](){return{next(){return Promise.reject(w)}}}}}}let l,c;const d=new Promise((y,w)=>{l=y,c=w});(m=r==null?void 0:r.signal)==null||m.addEventListener("abort",()=>{const y=new cn("cancelled","Request was cancelled.");c(y)});const f=o.body.getReader(),p=IV(f,l,c,r==null?void 0:r.signal);return{stream:{[Symbol.asyncIterator](){const y=p.getReader();return{async next(){const{value:w,done:A}=await y.read();return{value:w,done:A}},async return(){return await y.cancel(),{done:!0,value:void 0}}}}},data:d}}function IV(t,e,n,r){const s=(o,l)=>{const c=o.match(pV);if(!c)return;const d=c[1];try{const f=JSON.parse(d);if("result"in f){e(Co(f.result));return}if("message"in f){l.enqueue(Co(f.message));return}if("error"in f){const p=Fc(0,f);l.error(p),n(p);return}}catch(f){if(f instanceof cn){l.error(f),n(f);return}}},i=new TextDecoder;return new ReadableStream({start(o){let l="";return c();async function c(){if(r!=null&&r.aborted){const d=new cn("cancelled","Request was cancelled");return o.error(d),n(d),Promise.resolve()}try{const{value:d,done:f}=await t.read();if(f){l.trim()&&s(l.trim(),o),o.close();return}if(r!=null&&r.aborted){const m=new cn("cancelled","Request was cancelled");o.error(m),n(m),await t.cancel();return}l+=i.decode(d,{stream:!0});const p=l.split(`
`);l=p.pop()||"";for(const m of p)m.trim()&&s(m.trim(),o);return c()}catch(d){const f=d instanceof cn?d:Fc(0,null);o.error(f),n(f)}}},cancel(){return t.cancel()}})}const vw="@firebase/functions",_w="0.13.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SV="auth-internal",NV="app-check-internal",bV="messaging-internal";function AV(t){const e=(n,{instanceIdentifier:r})=>{const s=n.getProvider("app").getImmediate(),i=n.getProvider(SV),o=n.getProvider(bV),l=n.getProvider(NV);return new gV(s,i,o,l,r)};er(new Dn(bg,e,"PUBLIC").setMultipleInstances(!0)),pn(vw,_w,t),pn(vw,_w,"esm2020")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ag(t=gl(),e=vp){const r=Ni(De(t),bg).getImmediate({identifier:e}),s=Z0("functions");return s&&CV(r,...s),r}function CV(t,e,n){yV(De(t),e,n)}function Vd(t,e,n){return vV(De(t),e)}AV();function kV(t){return t?"present":"missing"}async function RV(){const t=await(async()=>{try{return!!await Promise.resolve(Dd())}catch{return!1}})(),e=await navigator.serviceWorker.getRegistration("/sw.js"),s={permission:typeof Notification<"u"?Notification.permission:"unavailable",swRegistered:!!e,swScope:(e==null?void 0:e.scope)||null,messagingSupported:t,vapidKey:kV("BOhz8CwPpf6kstE2HWU-Pyb4bkPGM6OpdVzU3PYrhyMSGZKyds6UzoSlQN1lRYxrmtf-HGQwSw5DivQ0SjkdxCI")};return console.table(s),s}async function iS(){try{return!!await Promise.resolve(Dd())}catch(t){return console.warn("[push] getMessagingIfSupported threw:",t),!1}}async function PV(t){console.groupCollapsed("[push] enroll start");try{if(await RV(),!await iS())return console.warn("[push] messaging not supported in this environment"),null;let e=Notification.permission;if(e!=="granted"&&(e=await Notification.requestPermission()),console.log("[push] permission after request:",e),e!=="granted")return console.warn("[push] user did not grant permission"),null;let n=await navigator.serviceWorker.getRegistration("/sw.js");if(n)console.log("[push] using existing SW at",n.scope);else{console.log("[push] registering /sw.js");try{n=await navigator.serviceWorker.register("/sw.js"),console.log("[push] /sw.js registered at",n.scope)}catch(o){return console.warn("[push] failed to register /sw.js:",o),null}}const r=await Promise.resolve(Dd());if(!r)return console.warn("[push] getMessagingIfSupported returned null"),null;const s="BOhz8CwPpf6kstE2HWU-Pyb4bkPGM6OpdVzU3PYrhyMSGZKyds6UzoSlQN1lRYxrmtf-HGQwSw5DivQ0SjkdxCI";let i=null;try{i=await MO(r,{vapidKey:s,serviceWorkerRegistration:n})}catch(o){return console.warn("[push] getToken() threw:",o),null}if(!i)return console.warn("[push] getToken() returned null/empty"),null;console.log("[push] obtained token (truncated):",i.slice(0,10)+"...");try{const o=G(Ng,`users/${t}/pushTokens/${i}`);await wt(o,{token:i,createdAt:ke(),userAgent:navigator.userAgent||""},{merge:!0}),console.log("[push] token saved to Firestore (client)")}catch(o){console.warn("[push] failed to write token to Firestore (client):",o)}try{await Vd(Ag(te,"us-central1"),"registerPushToken")({token:i}),console.log("[push] token saved via callable (server)")}catch(o){console.warn("[push] registerPushToken callable failed (non-fatal):",o)}return i}finally{console.groupEnd()}}async function jV(t){if(!await iS())return()=>{};const e=await Promise.resolve(Dd());return e?UO(e,r=>{try{t(r)}catch(s){console.warn("[push] handler error:",s)}}):()=>{}}function DV(){const t=Ke(),e=t.currentUser,[n,r]=k.useState(null),[s,i]=k.useState(null);k.useEffect(()=>{if(!e)return;const l=G(Ng,"users",e.uid),c=Xt(l,d=>r(d.data()),d=>console.warn("Profile onSnapshot error:",d));return()=>c()},[e]),k.useEffect(()=>{if(!e)return;let l=null,c=!1;return(async()=>{try{const d=await jV(f=>{console.log("[push] Foreground message:",f);const p=(f==null?void 0:f.data)||{};i({title:p.title||"Notification",body:p.body||""}),setTimeout(()=>i(null),6e3)});c?typeof d=="function"&&d():l=typeof d=="function"?d:null}catch(d){console.warn("listenForegroundMessages failed:",d)}})(),()=>{if(c=!0,typeof l=="function")try{l()}catch{}}},[e]);const o=async()=>{try{const l=t.currentUser;if(!l)return;const c=await PV(l.uid);alert(c?"Notifications enabled on this device.":"Notifications not enabled (permission denied or unsupported).")}catch(l){console.error("Notification setup failed",l),alert("Could not enable notifications.")}};return u.jsx("div",{className:"container py-8",children:u.jsxs("div",{className:"max-w-3xl mx-auto rounded-xl border border-border bg-card p-6",children:[u.jsx("h1",{className:"text-xl font-semibold text-accent mb-4",children:"Profile"}),e&&u.jsxs("div",{className:"mb-4 text-sm text-text",children:[u.jsxs("p",{children:[u.jsx("span",{className:"font-medium",children:"Email:"})," ",e.email]}),u.jsxs("p",{children:[u.jsx("span",{className:"font-medium",children:"UID:"})," ",e.uid]})]}),n&&u.jsx("div",{className:"mb-6 text-sm text-text2",children:n.displayName&&u.jsxs("p",{children:[u.jsx("span",{className:"font-medium text-text",children:"Display Name:"})," ",n.displayName]})}),s&&u.jsxs("div",{className:"mb-4 rounded-lg border border-border bg-card p-3",children:[u.jsx("div",{className:"text-sm font-semibold text-accent",children:s.title}),u.jsx("div",{className:"text-sm text-text2",children:s.body})]}),u.jsxs("section",{className:"mt-2 rounded-xl border border-border bg-card p-5",children:[u.jsx("h2",{className:"text-lg font-semibold text-accent",children:"Notifications"}),u.jsx("p",{className:"text-sm text-text2 mt-1",children:"Enable push notifications on this device to get updates."}),u.jsx("div",{className:"mt-3 flex gap-3",children:u.jsx("button",{type:"button",onClick:o,className:"rounded-lg px-4 py-2 text-white text-sm",style:{backgroundColor:"#919FAA"},children:"Enable notifications on this device"})})]})]})})}function OV(){return u.jsxs("div",{className:"container py-10",children:[u.jsx("h1",{className:"text-2xl font-semibold text-accent",children:"Settings"}),u.jsx("p",{className:"text-text2 mt-2",children:"Preferences and app settings."})]})}function VV(){const[t,e]=k.useState(""),[n,r]=k.useState(!1),[s,i]=k.useState(null),[o,l]=k.useState(!1);async function c(d){d.preventDefault(),i(null),r(!0);try{await Fk(ul,t),l(!0)}catch(f){i((f==null?void 0:f.message)||"Failed to send reset email")}finally{r(!1)}}return u.jsx("div",{className:"flex flex-col items-center min-h-screen bg-[var(--bg)] text-white pt-[15vh]",children:u.jsxs("div",{className:"w-full max-w-sm",children:[u.jsx("h1",{className:"text-2xl font-bold mb-2 text-center",children:"Forgot password"}),u.jsx("p",{className:"mb-6 text-center text-text2",children:"Enter your account email and well send you a reset link."}),o?u.jsxs("div",{className:"border border-border p-4 text-center",children:[u.jsx("p",{className:"text-accent",children:"Check your email"}),u.jsxs("p",{className:"text-text2 text-sm mt-1",children:["If an account exists for ",u.jsx("span",{className:"text-text",children:t}),", youll receive a password reset link shortly."]}),u.jsx(_e,{to:"/login",className:"btn btn-outline mt-4 w-full",children:"Back to sign in"})]}):u.jsxs("form",{onSubmit:c,className:"space-y-3",children:[u.jsx("input",{type:"email",className:"input w-full",placeholder:"Email",value:t,onChange:d=>e(d.target.value),required:!0,autoComplete:"email"}),s&&u.jsx("div",{className:"text-red-400 text-sm",children:s}),u.jsx("button",{className:"btn btn-primary w-full",disabled:n,children:n?"Sending":"Send reset link"}),u.jsx("div",{className:"text-center",children:u.jsx(_e,{to:"/login",className:"text-sm underline text-text2",children:"Back to sign in"})})]})]})})}function LV(){const[t]=r1(),e=Yr(),n=t.get("oobCode")||"",[r,s]=k.useState(null),[i,o]=k.useState(""),[l,c]=k.useState(""),[d,f]=k.useState(!0),[p,m]=k.useState(null),[y,w]=k.useState(!1);k.useEffect(()=>{async function b(){try{const E=await zk(ul,n);s(E)}catch(E){m((E==null?void 0:E.message)||"Invalid or expired reset link.")}finally{f(!1)}}n?b():(m("Missing reset code."),f(!1))},[n]);async function A(b){if(b.preventDefault(),m(null),i.length<6){m("Password must be at least 6 characters.");return}if(i!==l){m("Passwords do not match.");return}try{await $k(ul,n,i),w(!0),setTimeout(()=>e("/login",{replace:!0}),1200)}catch(E){m((E==null?void 0:E.message)||"Failed to reset password.")}}return d?u.jsx("div",{className:"container py-20",children:"Checking reset link"}):u.jsx("div",{className:"flex flex-col items-center min-h-screen bg-[var(--bg)] text-white pt-[15vh]",children:u.jsxs("div",{className:"w-full max-w-sm",children:[u.jsx("h1",{className:"text-2xl font-bold mb-2 text-center",children:"Reset password"}),p&&u.jsxs("div",{className:"border border-border p-4 text-center",children:[u.jsx("p",{className:"text-red-400 text-sm",children:p}),u.jsx(_e,{to:"/forgot",className:"btn btn-outline mt-4 w-full",children:"Request a new link"})]}),!p&&!y&&u.jsxs(u.Fragment,{children:[u.jsxs("p",{className:"mb-6 text-center text-text2",children:["Resetting password for ",r]}),u.jsxs("form",{onSubmit:A,className:"space-y-3",children:[u.jsx("input",{type:"password",className:"input w-full",placeholder:"New password",value:i,onChange:b=>o(b.target.value),required:!0,autoComplete:"new-password"}),u.jsx("input",{type:"password",className:"input w-full",placeholder:"Confirm new password",value:l,onChange:b=>c(b.target.value),required:!0,autoComplete:"new-password"}),u.jsx("button",{className:"btn btn-primary w-full",children:"Set new password"})]})]}),y&&u.jsxs("div",{className:"border border-border p-4 text-center",children:[u.jsx("p",{className:"text-accent",children:"Password updated!"}),u.jsx("p",{className:"text-text2 text-sm mt-1",children:"Taking you back to sign in"})]})]})})}const no=[{id:"downtown",name:"Downtown"}];function MV(t){const e=t.trim().split(/\s+/).filter(Boolean);return e.length===0?{firstName:"",lastName:""}:e.length===1?{firstName:e[0],lastName:""}:{firstName:e[0],lastName:e.slice(1).join(" ")}}function UV(t){if(!t)return"";const e=String(t).trim();return no.some(n=>n.id.toLowerCase()===e.toLowerCase())?no.find(n=>n.id.toLowerCase()===e.toLowerCase()).id:no.some(n=>n.name.toLowerCase()===e.toLowerCase())?no.find(n=>n.name.toLowerCase()===e.toLowerCase()).id:""}function FV(){const t=Yr(),e=Ln(),n=Ke(te),r=$e(te),[s,i]=$.useState(!1),[o,l]=$.useState(n.currentUser),[c,d]=$.useState(""),[f,p]=$.useState(!1),[m,y]=$.useState(""),[w,A]=$.useState(""),[b,E]=$.useState(!1),[v,x]=$.useState(null);$.useEffect(()=>{const O=Mn(n,async L=>{var _;if(l(L),!L){i(!0);return}let S=L.displayName||((_=e.state)==null?void 0:_.name)||"";if(!S)try{const I=localStorage.getItem("signupName");I&&(S=I)}catch{}try{const I=await Ae(G(r,"users",L.uid)),N=I.exists()?I.data():null;!S&&(N!=null&&N.displayName)&&(S=String(N.displayName)),N!=null&&N.phone&&y(String(N.phone)),N!=null&&N.campus&&A(UV(String(N.campus)))}catch{}d(S||""),p(!!S),i(!0)});return()=>O()},[n,r,e.state]);async function R(){var I;if(x(null),!o){x("You are not signed in.");return}const O=c.trim();if(!f&&!O){x("Please enter your name.");return}const L=f?(o==null?void 0:o.displayName)||c:O,{firstName:S,lastName:_}=MV(L);E(!0);try{if(!f){if(!n.currentUser)throw new Error("No current user.");await PE(n.currentUser,{displayName:L})}await wt(G(r,"users",o.uid),{displayName:L,firstName:S,lastName:_,phone:m.trim()||null,campus:w||null,campusName:((I=no.find(N=>N.id===w))==null?void 0:I.name)||null,updatedAt:ke(),onboardedAt:ke()},{merge:!0});try{localStorage.removeItem("signupName"),localStorage.removeItem("signupFirstName"),localStorage.removeItem("signupLastName")}catch{}t("/dashboard",{replace:!0})}catch(N){x((N==null?void 0:N.message)||"Could not save your profile.")}finally{E(!1)}}return s?o?u.jsx("div",{className:"container py-8 md:py-12",children:u.jsxs("div",{className:"mx-auto max-w-md rounded-xl border border-border bg-card p-6 shadow",children:[u.jsx("h1",{className:"text-2xl font-semibold text-accent mb-2",children:"Welcome!"}),u.jsx("p",{className:"text-sm text-text2 mb-4",children:"Lets finish setting up your profile."}),f?u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"text-sm block text-text2",children:"Name"}),u.jsx("div",{className:"mt-1 rounded-lg border border-border bg-muted px-3 py-2 text-sm",children:c}),u.jsx("p",{className:"mt-1 text-xs text-text2",children:"Pulled from your sign-up. You can edit this later in Profile."})]}):u.jsxs("label",{className:"mb-4 block",children:[u.jsx("span",{className:"text-sm",children:"Name"}),u.jsx("input",{type:"text",value:c,onChange:O=>d(O.target.value),placeholder:"First Last",className:"mt-1 w-full rounded-lg border border-border bg-background px-3 py-2 text-sm outline-none"})]}),u.jsxs("label",{className:"mb-4 block",children:[u.jsx("span",{className:"text-sm",children:"Phone (optional)"}),u.jsx("input",{type:"tel",value:m,onChange:O=>y(O.target.value),placeholder:"(555) 555-5555",className:"mt-1 w-full rounded-lg border border-border bg-background px-3 py-2 text-sm outline-none"})]}),u.jsxs("label",{className:"mb-4 block",children:[u.jsx("span",{className:"text-sm",children:"Campus (optional)"}),u.jsxs("select",{value:w,onChange:O=>A(O.target.value),className:"mt-1 w-full rounded-lg border border-border bg-background px-3 py-2 text-sm outline-none",children:[u.jsx("option",{value:"",children:"Select a campus (optional)"}),no.map(O=>u.jsx("option",{value:O.id,children:O.name},O.id))]})]}),v&&u.jsx("p",{className:"text-sm text-rose-700 mb-2",children:v}),u.jsx("button",{onClick:R,disabled:b,className:"px-4 py-2 rounded-lg bg-slate-900 text-white hover:bg-slate-800 disabled:opacity-60",children:b?"Saving":"Save and continue"})]})}):u.jsx("div",{className:"container py-8",children:u.jsx("div",{className:"mx-auto max-w-md rounded-xl border border-border bg-card p-6",children:u.jsx("p",{className:"text-sm text-text2",children:"You are not signed in."})})}):u.jsx("div",{className:"container py-8",children:u.jsx("div",{className:"mx-auto max-w-md",children:u.jsx(ir,{label:"Loading your account"})})})}const $V="modulepreload",BV=function(t){return"/"+t},ww={},zV=function(e,n,r){let s=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));s=Promise.allSettled(n.map(c=>{if(c=BV(c),c in ww)return;ww[c]=!0;const d=c.endsWith(".css"),f=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${f}`))return;const p=document.createElement("link");if(p.rel=d?"stylesheet":$V,d||(p.as="script"),p.crossOrigin="",p.href=c,l&&p.setAttribute("nonce",l),document.head.appendChild(p),d)return new Promise((m,y)=>{p.addEventListener("load",m),p.addEventListener("error",()=>y(new Error(`Unable to preload CSS for ${c}`)))})}))}function i(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return s.then(o=>{for(const l of o||[])l.status==="rejected"&&i(l.reason);return e().catch(i)})};function qV(){const t=$.useMemo(()=>$e(te),[]),{user:e}=Od(),[n,r]=$.useState(null),[s,i]=$.useState(null),[o,l]=$.useState(""),[c,d]=$.useState(""),[f,p]=$.useState(""),[m,y]=$.useState(null),[w,A]=$.useState(!1);$.useEffect(()=>{let x;if(e!=null&&e.uid){const R=G(t,"admins",e.uid);zV(async()=>{const{onSnapshot:O}=await Promise.resolve().then(()=>cD);return{onSnapshot:O}},void 0).then(({onSnapshot:O})=>{x=O(R,L=>r(L.exists()))})}else r(!1);return()=>{x&&x()}},[t,e==null?void 0:e.uid]),$.useEffect(()=>{const x=Je(pe(t,"sundayResources"),Vn("createdAt","desc")),R=Xt(x,O=>{const L=O.docs.map(S=>({id:S.id,...S.data()}));i(L)});return()=>R()},[t]);async function b(x){if(x.preventDefault(),!!n){if(y(null),!o.trim()||!c.trim()){y("Title and URL are required.");return}try{A(!0),await Dr(pe(t,"sundayResources"),{title:o.trim(),url:c.trim(),note:f.trim()||null,createdAt:ke(),createdBy:(e==null?void 0:e.uid)??null,createdByName:(e==null?void 0:e.displayName)??null}),l(""),d(""),p("")}catch(R){y((R==null?void 0:R.message)||"Failed to add resource.")}finally{A(!1)}}}async function E(x){if(n)try{await Dt(G(t,"sundayResources",x))}catch{}}const v=n===!0;return s===null||n===null?u.jsx("div",{className:"container py-8 md:py-12",children:u.jsxs("div",{className:"max-w-4xl mx-auto",children:[u.jsx("h1",{className:"text-2xl font-semibold text-accent",children:"Sunday White Papers"}),u.jsx("div",{className:"mt-4",children:u.jsx(ir,{label:"Loading"})})]})}):u.jsx("div",{className:"container py-8 md:py-12",children:u.jsxs("div",{className:"max-w-4xl mx-auto",children:[u.jsx("h1",{className:"text-2xl font-semibold text-accent",children:"Sunday White Papers"}),u.jsx("p",{className:"text-text2 mt-2",children:"A curated library of Sunday white papers and study resources."}),v&&u.jsxs("section",{className:"mt-6 rounded-xl border border-border bg-card p-5",children:[u.jsx("h2",{className:"text-lg font-semibold text-accent",children:"Add a resource"}),m&&u.jsx("p",{className:"text-red-500 text-sm mt-2",children:m}),u.jsxs("form",{onSubmit:b,className:"mt-3 grid grid-cols-1 md:grid-cols-12 gap-3",children:[u.jsx("input",{type:"text",value:o,onChange:x=>l(x.target.value),placeholder:"Title",className:"md:col-span-3 rounded-lg border border-border bg-muted px-3 py-2 text-sm text-text focus:outline-none focus:ring-2 focus:ring-accent/30"}),u.jsx("input",{type:"url",value:c,onChange:x=>d(x.target.value),placeholder:"URL (Google Drive, video, article)",className:"md:col-span-6 rounded-lg border border-border bg-muted px-3 py-2 text-sm text-text focus:outline-none focus:ring-2 focus:ring-accent/30"}),u.jsx("input",{type:"text",value:f,onChange:x=>p(x.target.value),placeholder:"Note (optional)",className:"md:col-span-3 rounded-lg border border-border bg-muted px-3 py-2 text-sm text-text focus:outline-none focus:ring-2 focus:ring-accent/30"}),u.jsx("div",{className:"md:col-span-12 flex justify-end",children:u.jsx("button",{type:"submit",disabled:w,className:"text-sm px-3 py-1.5 rounded-lg bg-slate-900 text-white hover:bg-slate-800 disabled:opacity-60",children:w?"Adding":"Add resource"})})]})]}),u.jsxs("section",{className:"mt-6 rounded-xl border border-border bg-card p-5",children:[u.jsx("h2",{className:"text-lg font-semibold text-accent",children:"Resources"}),s.length===0?u.jsx("p",{className:"text-text2 text-sm mt-2",children:"No resources yet."}):u.jsx("ul",{className:"mt-3 space-y-2",children:s.map(x=>u.jsx("li",{className:"rounded-lg border border-border bg-muted px-3 py-2",children:u.jsxs("div",{className:"flex items-center justify-between gap-3",children:[u.jsxs("div",{className:"min-w-0",children:[u.jsx("p",{className:"text-sm font-medium truncate",children:u.jsx("a",{href:x.url,target:"_blank",rel:"noopener noreferrer",className:"hover:underline",children:x.title})}),x.note&&u.jsx("p",{className:"text-xs text-text2 mt-0.5",children:x.note})]}),u.jsxs("div",{className:"flex items-center gap-2 shrink-0",children:[u.jsx(_e,{to:x.url,target:"_blank",className:"text-xs px-2 py-1 rounded-md border border-border hover:bg-muted/70",children:"Open"}),v&&u.jsx("button",{onClick:()=>E(x.id),className:"text-xs px-2 py-1 rounded-md border border-border hover:bg-muted/70",title:"Delete",children:"Delete"})]})]})},x.id))})]})]})})}function WV(t,e){return[t,e].sort().join("_")}function HV(){var b;const{slug:t="",otherUid:e=""}=Ti(),n=$.useMemo(()=>$e(te),[]),r=Ke(te),[s,i]=$.useState(!0),[o,l]=$.useState(""),[c,d]=$.useState([]),[f,p]=$.useState(""),m=((b=r.currentUser)==null?void 0:b.uid)||"",y=$.useMemo(()=>m?WV(m,e):"",[m,e]);$.useEffect(()=>{let E=!1,v;async function x(){try{i(!0);try{const O=await Ae(G(n,"groups",t));if(O.exists()){const L=O.data();E||l((L==null?void 0:L.name)||t)}else E||l(t)}catch{E||l(t)}if(!m||!y)return;const R=Je(pe(n,`groups/${t}/directMessages/${y}/messages`),Vn("createdAt","asc"));v=Xt(R,O=>{const L=O.docs.map(S=>({id:S.id,...S.data()}));E||d(L)})}finally{E||i(!1)}}return x().catch(()=>{}),()=>{E=!0,v&&v()}},[n,t,m,y]);async function w(E){var v;if(E.preventDefault(),!(!f.trim()||!m||!y))try{await Dr(pe(n,`groups/${t}/directMessages/${y}/messages`),{text:f.trim(),from:m,to:e,displayName:((v=r.currentUser)==null?void 0:v.displayName)||"Member",createdAt:ke()}),p("")}catch(x){alert((x==null?void 0:x.message)||"Failed to send")}}async function A(E,v){v===m&&confirm("Delete this message?")&&await Dt(G(n,`groups/${t}/directMessages/${y}/messages/${E}`))}return s?u.jsx("div",{className:"max-w-4xl mx-auto p-6",children:u.jsx(ir,{label:"Loading direct messages"})}):u.jsx("div",{className:"container py-6",children:u.jsxs("div",{className:"max-w-4xl mx-auto rounded-xl border border-border bg-card p-5",children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsx("h1",{className:"text-lg font-semibold text-accent",children:"Direct Messages"}),u.jsx(_e,{to:`/groups/${t}`,className:"text-sm text-text2 underline",children:"Back to group"})]}),u.jsxs("p",{className:"text-sm text-text2 mt-1",children:["Group: ",o]}),u.jsx("div",{className:"mt-4 max-h-[60vh] overflow-auto space-y-2 pr-1",children:c.length===0?u.jsx("p",{className:"text-sm text-text2",children:"No messages yet."}):c.map(E=>u.jsx("div",{className:"rounded-lg px-3 py-2 border "+(E.from===m?"border-slate-300 bg-white":"border-slate-700 bg-slate-800 text-white"),children:u.jsxs("div",{className:"flex items-start justify-between gap-2",children:[u.jsxs("div",{children:[u.jsx("p",{className:"text-xs opacity-70",children:E.displayName||E.from}),u.jsx("p",{className:"text-sm whitespace-pre-wrap",children:E.text})]}),E.from===m&&u.jsx("button",{onClick:()=>A(E.id,E.from),className:"text-xs rounded-lg border border-rose-300 text-rose-700 px-2 py-1 hover:bg-rose-50 h-fit",children:"Delete"})]})},E.id))}),u.jsxs("form",{onSubmit:w,className:"mt-3 flex gap-2",children:[u.jsx("input",{type:"text",value:f,onChange:E=>p(E.target.value),placeholder:"Write a message",className:"flex-1 rounded-lg border border-border bg-background px-3 py-2 text-sm outline-none"}),u.jsx("button",{type:"submit",disabled:!f.trim(),className:"rounded-lg bg-slate-900 text-white px-3 py-1.5 text-sm hover:bg-slate-800 disabled:opacity-60",children:"Send"})]})]})})}const Eu=14;function xw(t){try{return t?t.toDate?t.toDate():t instanceof Date?t:null:null}catch{return null}}function Ew(t,e){if(!t)return!1;const n=e*24*60*60*1e3;return Date.now()-t.getTime()<=n}function GV(){const t=k.useMemo(()=>$e(te),[]),e=Ke(te),[n,r]=k.useState(!0),[s,i]=k.useState(!1),[o,l]=k.useState([]),[c,d]=k.useState(!1),[f,p]=k.useState([]);return k.useEffect(()=>{let m=!1;async function y(){var w;try{r(!0);const A=e.currentUser;if(!A){m||(i(!1),l([]));return}const b=A.uid,v=(await Ae(G(t,"admins",b))).exists();m||i(v);let x=[];if(v)x=(await Fe(Je(pe(t,"groups"),Vn("name")))).docs.map(L=>L.id);else{const L=(await Fe(Je(_r(t,"groupAdmins"),kn(ug(),"==",b)))).docs.map(S=>{var _;return((_=S.ref.parent.parent)==null?void 0:_.id)||""}).filter(Boolean);L.length?x=L:x=(await Fe(Je(_r(t,"groupAdmins"),kn("uid","==",b)))).docs.map(_=>{var I;return((I=_.ref.parent.parent)==null?void 0:I.id)||""}).filter(Boolean)}const R=[];for(const O of x)try{const S=(await Ae(G(t,"groups",O))).data()||{};let _=0;try{const I=await Lc(pe(t,`groups/${O}/membershipRequests`));_=Number(((w=I.data())==null?void 0:w.count)||0)}catch{}R.push({id:O,name:S.name||O,parent:S.parent||null,pendingRequests:_})}catch{}m||l(R)}finally{m||r(!1)}}return y(),()=>{m=!0}},[t,e.currentUser]),k.useEffect(()=>{let m=!1;async function y(){try{d(!0);const w={};for(const b of o){try{(await Fe(pe(t,`groups/${b.id}/members`))).forEach(v=>{const x=v.data(),R=v.id;w[R]||(w[R]={uid:R,name:x==null?void 0:x.displayName,email:x==null?void 0:x.email,groups:[],latestJoinAt:null}),w[R].groups.push({id:b.id,name:b.name||b.id});const O=xw(x==null?void 0:x.joinedAt);if(O){const L=w[R].latestJoinAt;(!L||O>L)&&(w[R].latestJoinAt=O)}})}catch{}if(m)return}let A=Object.values(w).sort((b,E)=>(b.name||b.uid).localeCompare(E.name||E.uid));if(s){const b=[];for(const E of A){try{const x=(await Ae(G(t,"users",E.uid))).data()||{},R=!!(x!=null&&x.isCommunityApproved),O=xw(x==null?void 0:x.createdAt),L=Ew(O,Eu);(!R||L)&&b.push(E)}catch{}if(m)return}A=b}else A=A.filter(b=>Ew(b.latestJoinAt||null,Eu));m||p(A)}finally{m||d(!1)}}return o.length?y():p([]),()=>{m=!0}},[t,o,s]),n?u.jsx("div",{className:"max-w-5xl mx-auto p-6",children:u.jsx(ir,{label:"Loading admin groups"})}):u.jsxs("div",{className:"max-w-5xl mx-auto p-6",children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{children:[u.jsx("h1",{className:"text-2xl font-semibold text-slate-900",children:s?"All Groups":"Your Groups"}),u.jsx("p",{className:"text-slate-600 mt-2",children:s?"You are a super admin.":"You are a group admin."})]}),u.jsxs("div",{className:"flex items-center gap-3",children:[s&&u.jsx(_e,{to:"/admin/groups/new",className:"text-sm px-3 py-2 rounded-lg bg-slate-900 text-white hover:bg-slate-800",title:"Create a new group",children:"New Group"}),u.jsx(_e,{to:"/admin/users",className:"text-sm text-slate-700 underline",children:"Users"})]})]}),o.length===0?u.jsx("p",{className:"text-slate-600 mt-4",children:"No groups to manage."}):u.jsx("ul",{className:"mt-4 divide-y divide-slate-200 rounded-xl border border-slate-200 bg-white/70",children:o.map(m=>{const y=m.pendingRequests||0,w="text-sm px-3 py-1.5 rounded-lg text-center leading-tight min-w-[9rem] whitespace-normal md:whitespace-nowrap",A=y>0?`${w} bg-amber-100 text-amber-900 border border-amber-300 hover:bg-amber-200`:`${w} bg-slate-100 text-slate-900 hover:bg-slate-200`;return u.jsxs("li",{className:"p-4 flex items-center justify-between",children:[u.jsxs("div",{className:"min-w-0",children:[u.jsx("div",{className:"font-medium text-slate-900 truncate",children:m.name||m.id}),m.parent&&u.jsxs("div",{className:"text-xs text-slate-500 truncate",children:["Parent: ",m.parent]})]}),u.jsxs("div",{className:"flex gap-2 shrink-0",children:[u.jsx(_e,{to:`/admin/groups/${m.id}/requests`,className:A,title:y>0?`${y} pending`:void 0,children:y>0?`View Requests (${y})`:"View Requests"}),u.jsx(_e,{to:`/admin/groups/${m.id}/members`,className:"text-sm px-3 py-1.5 rounded-lg bg-slate-100 text-slate-900 hover:bg-slate-200 whitespace-normal md:whitespace-nowrap leading-tight min-w-[8rem]",children:"Members"}),u.jsx(_e,{to:`/groups/${m.id}`,className:"text-sm px-3 py-1.5 rounded-lg bg-slate-100 text-slate-900 hover:bg-slate-200 whitespace-normal md:whitespace-nowrap leading-tight min-w-[8rem]",children:"Open Group"})]})]},m.id)})}),u.jsxs("section",{className:"mt-8 rounded-xl border border-slate-200 bg-white/70 p-5",children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsx("h2",{className:"text-lg font-semibold text-slate-900",children:"Users"}),u.jsx(_e,{to:"/admin/users",className:"text-sm text-slate-700 underline",children:"Open full users page"})]}),c?u.jsx("p",{className:"text-sm text-slate-600 mt-3",children:"Loading users"}):f.length===0?u.jsx("p",{className:"text-sm text-slate-600 mt-3",children:s?`No new or unapproved users in the last ${Eu} days.`:`No recently joined users (last ${Eu} days) in your groups.`}):u.jsx("ul",{className:"mt-3 divide-y divide-slate-200",children:f.map(m=>u.jsx("li",{className:"py-3",children:u.jsxs("div",{className:"flex items-start justify-between gap-3",children:[u.jsxs("div",{className:"min-w-0",children:[u.jsx("div",{className:"text-sm font-medium text-slate-900 break-all",children:m.name||m.uid}),m.email&&u.jsx("div",{className:"text-xs text-slate-600 break-all",children:m.email}),u.jsx("div",{className:"mt-1 flex flex-wrap gap-1",children:m.groups.map(y=>u.jsx(_e,{to:`/admin/groups/${y.id}/members`,className:"text-xs rounded-full bg-slate-100 px-2 py-0.5 text-slate-800 hover:bg-slate-200",title:"Manage members",children:y.name},y.id))})]}),u.jsx(_e,{to:`/admin/users?uid=${encodeURIComponent(m.uid)}`,className:"text-xs rounded-lg border border-slate-300 px-2 py-1 hover:bg-slate-100 shrink-0",children:"View"})]})},m.uid))})]})]})}const oS=Ag(te,"us-central1");async function Tw(t,e,n){const s=await Vd(oS,"setUserDisabled")({targetUid:t,disabled:e,reason:n});return(s==null?void 0:s.data)??null}async function KV(t,e=!1){const r=await Vd(oS,"deleteUserAccount")({targetUid:t,hardDelete:e});return(r==null?void 0:r.data)??null}function QV(){const t=k.useMemo(()=>$e(te),[]),e=Ke(te),[n,r]=k.useState(!0),[s,i]=k.useState(!1),[o,l]=k.useState([]),[c,d]=k.useState(""),[f,p]=k.useState(""),{search:m}=Ln();k.useEffect(()=>{const x=new URLSearchParams(m).get("uid")||"";x&&d(x)},[m]),k.useEffect(()=>{let v=!1;async function x(){try{r(!0);const R=e.currentUser;if(!R){v||(l([]),i(!1));return}const L=(await Ae(G(t,"admins",R.uid))).exists();v||i(L);const _=(await Fe(pe(t,"users"))).docs.map(I=>{const N=I.data();return{uid:I.id,displayName:(N==null?void 0:N.displayName)||(N==null?void 0:N.name)||"",email:(N==null?void 0:N.email)||"",status:(N==null?void 0:N.status)||"active",isCommunityApproved:!!(N!=null&&N.isCommunityApproved),groups:[]}});for(const I of _){try{const N=await Fe(pe(t,`users/${I.uid}/memberships`)),P=[];for(const j of N.docs){const C=j.id;try{const xt=(await Ae(G(t,"groups",C))).data()||{};P.push({id:C,name:(xt==null?void 0:xt.name)||C})}catch{P.push({id:C,name:C})}}I.groups=P.sort((j,C)=>j.name.localeCompare(C.name))}catch{I.groups=[]}if(v)return}_.sort((I,N)=>(I.displayName||I.email||I.uid).localeCompare(N.displayName||N.email||N.uid)),v||l(_)}finally{v||r(!1)}}return x(),()=>{v=!0}},[t,e.currentUser]);const y=o.filter(v=>{const x=c.trim().toLowerCase();return x?v.uid.toLowerCase().includes(x)||(v.displayName||"").toLowerCase().includes(x)||(v.email||"").toLowerCase().includes(x)||v.groups.some(R=>R.name.toLowerCase().includes(x)||R.id.toLowerCase().includes(x)):!0});async function w(v){if(!s)return;const x=window.prompt("Reason for inactivation? (optional)")||void 0;p(`disable:${v}`);try{await Tw(v,!0,x),l(R=>R.map(O=>O.uid===v?{...O,status:"inactive"}:O))}catch{alert("Failed to inactivate user.")}finally{p("")}}async function A(v){if(s&&window.confirm("Reactivate this user?")){p(`enable:${v}`);try{await Tw(v,!1),l(x=>x.map(R=>R.uid===v?{...R,status:"active"}:R))}catch{alert("Failed to reactivate user.")}finally{p("")}}}async function b(v){if(!(!s||!window.confirm("Delete this user? This will remove their authentication account and related data.")||!(window.prompt('Type "DELETE" to confirm.')==="DELETE"))){p(`delete:${v}`);try{await KV(v,!1),l(O=>O.filter(L=>L.uid!==v))}catch{alert("Failed to delete user.")}finally{p("")}}}async function E(v,x){var R;if(s){p(`approve:${v}`);try{const O=((R=e.currentUser)==null?void 0:R.uid)||"",L=x?{isCommunityApproved:!0,dmApprovedAt:ke(),dmApprovedBy:O}:{isCommunityApproved:!1,dmApprovedAt:gp(),dmApprovedBy:gp()};await wt(G(t,"users",v),L,{merge:!0}),l(S=>S.map(_=>_.uid===v?{..._,isCommunityApproved:x}:_))}catch{alert("Failed to update approval.")}finally{p("")}}}return n?u.jsx("div",{className:"max-w-5xl mx-auto p-6",children:u.jsx(ir,{label:"Loading users"})}):u.jsxs("div",{className:"max-w-5xl mx-auto p-6",children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsx("h1",{className:"text-2xl font-semibold text-slate-900",children:"Users"}),u.jsx("input",{value:c,onChange:v=>d(v.target.value),placeholder:"Search users",className:"rounded-lg border border-slate-300 bg-white/80 px-3 py-2 text-sm outline-none w-56","aria-label":"Search users"})]}),u.jsxs("div",{className:"mt-4 rounded-xl border border-slate-200 bg-white/70 overflow-hidden",children:[u.jsxs("div",{className:"grid grid-cols-12 gap-2 px-4 py-2 text-xs font-medium text-slate-600",children:[u.jsx("div",{className:"col-span-4",children:"Name"}),u.jsx("div",{className:"col-span-3",children:"Email"}),u.jsx("div",{className:"col-span-3",children:"Groups"}),u.jsx("div",{className:"col-span-2 text-right",children:"Actions"})]}),u.jsx("div",{className:"divide-y divide-slate-200",children:y.length===0?u.jsx("div",{className:"px-4 py-4 text-sm text-slate-600",children:"No users found."}):y.map(v=>u.jsxs("div",{className:"grid grid-cols-12 gap-2 px-4 py-3 items-start",children:[u.jsxs("div",{className:"col-span-4 min-w-0",children:[u.jsx("div",{className:"text-sm text-slate-900 truncate",children:v.displayName||v.uid}),v.email&&u.jsx("div",{className:"text-xs text-slate-600 truncate",children:v.email}),u.jsxs("div",{className:"text-[11px] text-slate-500 mt-0.5",children:["Status: ",v.status||"active"]}),u.jsxs("div",{className:"text-[11px] text-slate-500 mt-0.5",children:["DM access: ",u.jsx("b",{children:v.isCommunityApproved?"Approved":"Not approved"})]})]}),u.jsx("div",{className:"col-span-3 min-w-0",children:u.jsxs("div",{className:"flex flex-wrap gap-1",children:[v.groups.map(x=>u.jsx(_e,{to:`/admin/groups/${x.id}/members`,className:"text-xs rounded-full bg-slate-100 px-2 py-0.5 text-slate-800 hover:bg-slate-200",title:"Manage members",children:x.name},x.id)),v.groups.length===0&&u.jsx("span",{className:"text-xs text-slate-600",children:""})]})}),u.jsx("div",{className:"col-span-3 min-w-0",children:u.jsx("span",{className:"text-xs break-all",children:v.uid})}),u.jsx("div",{className:"col-span-2 text-right",children:u.jsxs("div",{className:"inline-flex flex-col gap-1 items-end",children:[u.jsxs("label",{className:"inline-flex items-center gap-2 text-xs select-none",children:[u.jsx("input",{type:"checkbox",checked:!!v.isCommunityApproved,onChange:x=>void E(v.uid,x.target.checked),disabled:!s||!!f}),u.jsx("span",{children:"Approved for DMs"})]}),u.jsx(_e,{to:`/admin/users?uid=${encodeURIComponent(v.uid)}`,className:"text-xs rounded-lg border border-slate-300 px-2 py-1 hover:bg-slate-100",children:"View"}),s&&u.jsxs("div",{className:"flex flex-wrap gap-1 justify-end",children:[v.status==="inactive"?u.jsx("button",{onClick:()=>A(v.uid),disabled:!!f,className:"text-xs rounded-lg px-2 py-1 text-white",style:{backgroundColor:"#919FAA",opacity:f?.6:1},children:f===`enable:${v.uid}`?"Working":"Reactivate"}):u.jsx("button",{onClick:()=>w(v.uid),disabled:!!f,className:"text-xs rounded-lg px-2 py-1 text-white",style:{backgroundColor:"#919FAA",opacity:f?.6:1},children:f===`disable:${v.uid}`?"Working":"Inactivate"}),u.jsx("button",{onClick:()=>b(v.uid),disabled:!!f,className:"text-xs rounded-lg px-2 py-1 bg-rose-100 text-rose-800 hover:bg-rose-200",style:{opacity:f?.6:1},title:"Soft delete (Auth account removed; user doc marked deleted)",children:f===`delete:${v.uid}`?"Deleting":"Delete"})]})]})})]},v.uid))})]})]})}function YV(){const{slug:t}=Ti(),e=$e(te),[n,r]=k.useState(""),[s,i]=k.useState([]),[o,l]=k.useState(!0),[c,d]=k.useState(""),f=t;k.useEffect(()=>{let y=!0;async function w(){if(f){l(!0);try{const A=G(e,"groups",f),b=await Ae(A);r(b.exists()&&b.data().name||JV(f));const E=pe(e,`groups/${f}/membershipRequests`),v=await Fe(E);if(!y)return;const x=[];v.forEach(R=>x.push(R.data())),i(x)}finally{l(!1)}}}return w(),()=>{y=!1}},[e,f]);async function p(y){d(y.uid);try{await wt(G(e,`users/${y.uid}/memberships/${f}`),{groupId:f,approvedAt:ke(),approvedBy:"admin"},{merge:!0}),await wt(G(e,`groups/${f}/members/${y.uid}`),{uid:y.uid,displayName:y.displayName||"Member",joinedAt:ke()},{merge:!0}),await Promise.all([Dt(G(e,`groups/${f}/membershipRequests/${y.uid}`)),Dt(G(e,`users/${y.uid}/membershipRequests/${f}`))]),i(w=>w.filter(A=>A.uid!==y.uid))}finally{d("")}}async function m(y){d(y.uid);try{await Promise.all([Dt(G(e,`groups/${f}/membershipRequests/${y.uid}`)),Dt(G(e,`users/${y.uid}/membershipRequests/${f}`))]),i(w=>w.filter(A=>A.uid!==y.uid))}finally{d("")}}return f?u.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[u.jsx("div",{className:"mb-4",children:u.jsxs(_e,{to:"/admin",className:"inline-flex items-center gap-2 rounded-lg border border-border px-3 py-1.5 text-sm hover:bg-muted",children:[u.jsx("span",{"aria-hidden":!0,children:""}),u.jsx("span",{children:"Return to Admin Console"})]})}),u.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[u.jsxs("div",{children:[u.jsx("h1",{className:"text-2xl font-semibold text-slate-900",children:"Pending Requests"}),u.jsxs("p",{className:"text-slate-600",children:["Group: ",n]})]}),u.jsx(_e,{to:`/groups/${f}`,className:"text-sm text-slate-700 underline",children:"Back to group"})]}),o?u.jsx("p",{className:"text-slate-600",children:"Loading"}):s.length===0?u.jsx("p",{className:"text-slate-600",children:"No pending requests."}):u.jsx("ul",{className:"divide-y divide-slate-200 rounded-xl border border-slate-200 bg-white/70",children:s.map(y=>u.jsxs("li",{className:"p-4 flex items-center justify-between",children:[u.jsxs("div",{children:[u.jsx("div",{className:"font-medium text-slate-900",children:y.displayName||y.uid}),u.jsx("div",{className:"text-xs text-slate-500 truncate",children:y.uid})]}),u.jsxs("div",{className:"flex gap-2",children:[u.jsx("button",{onClick:()=>p(y),disabled:!!c,className:"text-xs px-3 py-1.5 rounded-lg bg-green-600 text-white hover:bg-green-700 disabled:opacity-60",children:c===y.uid?"Working":"Approve"}),u.jsx("button",{onClick:()=>m(y),disabled:!!c,className:"text-xs px-3 py-1.5 rounded-lg bg-rose-100 text-rose-800 hover:bg-rose-200 disabled:opacity-60",children:"Deny"})]})]},y.uid))})]}):u.jsx("div",{className:"p-6",children:"Missing group slug."})}function JV(t){return t.replace(/[-_]/g," ").replace(/\b\w/g,e=>e.toUpperCase())}function XV(){const{slug:t}=Ti(),e=k.useMemo(()=>$e(te),[]),n=Ke(te),[r,s]=k.useState(""),[i,o]=k.useState([]),[l,c]=k.useState({}),[d,f]=k.useState(!0),[p,m]=k.useState(""),[y,w]=k.useState(""),[A,b]=k.useState(!1),[E,v]=k.useState(""),[x,R]=k.useState([]),[O,L]=k.useState(""),[S,_]=k.useState(""),I=(t||"").trim();k.useEffect(()=>{let Q=!0;async function B(){if(I){f(!0),w("");try{const J=G(e,"groups",I),ye=await Ae(J);s(ye.exists()&&ye.data().name||ZV(I));const de=n.currentUser;if(de){const Oe=de.uid;if((await Ae(G(e,"admins",Oe))).exists())b(!0);else{const z=await Ae(G(e,`groups/${I}/groupAdmins/${Oe}`));b(z.exists())}}else b(!1);const re=await Fe(pe(e,`groups/${I}/members`));if(!Q)return;const st=[],Et=await Fe(pe(e,`groups/${I}/groupAdmins`)),Qe={};Et.forEach(Oe=>{Qe[Oe.id]=!0}),c(Qe),re.forEach(Oe=>st.push({uid:Oe.id,...Oe.data()})),st.sort((Oe,Tt)=>(Oe.displayName||Oe.uid).localeCompare(Tt.displayName||Tt.uid)),o(st)}catch(J){w((J==null?void 0:J.message)||"Failed to load members.")}finally{f(!1)}}}B();async function K(){try{const ye=(await Fe(pe(e,"users"))).docs.map(de=>{const re=de.data();return{uid:de.id,displayName:(re==null?void 0:re.displayName)||(re==null?void 0:re.name)||"",email:(re==null?void 0:re.email)||""}});ye.sort((de,re)=>(de.displayName||de.email||de.uid).localeCompare(re.displayName||re.email||re.uid)),R(ye)}catch{R([])}}return K(),()=>{Q=!1}},[e,I]);async function N(Q,B,K){var ye,de;const J=Q.trim();if(J){w(""),m("add");try{const re=AI(e),st=G(e,`groups/${I}/members/${J}`);{const Qe={uid:J,displayName:B||J,role:"member",joinedAt:ke(),addedBy:((ye=n.currentUser)==null?void 0:ye.uid)||"unknown"};K&&(Qe.email=K),re.set(st,Qe,{merge:!0})}const Et=G(e,`users/${J}/memberships/${I}`);re.set(Et,{groupId:I,approvedAt:ke(),approvedBy:((de=n.currentUser)==null?void 0:de.uid)||"admin"},{merge:!0}),await re.commit(),o(Qe=>{const Oe=[...Qe.filter(Tt=>Tt.uid!==J),{uid:J,displayName:B||J,email:K}];return Oe.sort((Tt,z)=>(Tt.displayName||Tt.uid).localeCompare(z.displayName||z.uid)),Oe}),v(""),_("")}catch(re){w((re==null?void 0:re.message)||"Failed to add member. Check Firestore rules.")}finally{m("")}}}async function P(){await N(E)}async function j(Q){if(Q.preventDefault(),!S)return;const B=x.find(K=>K.uid===S);await N(S,B==null?void 0:B.displayName,B==null?void 0:B.email)}async function C(Q){var B;m(`admin:${Q}`),w("");try{await wt(G(e,`groups/${I}/groupAdmins/${Q}`),{uid:Q,grantedBy:((B=n.currentUser)==null?void 0:B.uid)||"unknown",createdAt:ke()},{merge:!0}),c(K=>({...K,[Q]:!0}))}catch(K){w((K==null?void 0:K.message)||"Failed to grant admin.")}finally{m("")}}async function at(Q){m(`admin:${Q}`),w("");try{await Dt(G(e,`groups/${I}/groupAdmins/${Q}`)),c(B=>{const K={...B};return delete K[Q],K})}catch(B){w((B==null?void 0:B.message)||"Failed to remove admin.")}finally{m("")}}async function xt(Q){m(Q),w("");try{await Dt(G(e,`groups/${I}/members/${Q}`)),await Dt(G(e,`users/${Q}/memberships/${I}`)),o(B=>B.filter(K=>K.uid!==Q))}catch(B){w((B==null?void 0:B.message)||"Failed to remove member.")}finally{m("")}}if(!I)return u.jsx("div",{className:"p-6",children:"Missing group slug."});const Un=k.useMemo(()=>{const Q=O.trim().toLowerCase();return Q?x.filter(B=>{const K=(B.displayName||"").toLowerCase(),J=(B.email||"").toLowerCase();return K.includes(Q)||J.includes(Q)||B.uid.toLowerCase().includes(Q)}):x},[x,O]);return u.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[u.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[u.jsxs("div",{children:[u.jsx("h1",{className:"text-2xl font-semibold text-slate-900",children:"Group Members"}),u.jsxs("p",{className:"text-slate-600",children:["Group: ",r]})]}),u.jsx(_e,{to:"/admin/groups",className:"text-sm text-slate-700 underline",children:"Back to groups"})]}),y&&u.jsx("div",{className:"mb-3 rounded-lg border border-rose-200 bg-rose-50 px-3 py-2 text-sm text-rose-800",children:y}),u.jsxs("div",{className:"rounded-xl border border-slate-200 bg-white/70 p-4 mb-6",children:[u.jsx("h2",{className:"font-medium text-slate-900",children:"Add Member (by Name)"}),u.jsxs("form",{onSubmit:j,className:"mt-2 grid gap-2 sm:grid-cols-6",children:[u.jsx("input",{value:O,onChange:Q=>L(Q.target.value),placeholder:"Search users by name, email, or UID",className:"sm:col-span-2 rounded-lg border border-slate-300 px-3 py-2 text-sm","aria-label":"Filter users",disabled:!A}),u.jsxs("select",{className:"sm:col-span-3 rounded-lg border border-slate-300 px-2 py-2 text-sm",value:S,onChange:Q=>_(Q.target.value),"aria-label":"Select user to add",disabled:!A,children:[u.jsx("option",{value:"",children:"Select a user"}),Un.map(Q=>u.jsx("option",{value:Q.uid,children:(Q.displayName||"Unnamed")+(Q.email?`  ${Q.email}`:"")},Q.uid))]}),u.jsx("div",{className:"sm:col-span-1",children:u.jsx("button",{type:"submit",disabled:!S||!!p||!A,className:"rounded-lg bg-slate-900 text-white px-4 py-2 text-sm hover:bg-slate-800 disabled:opacity-60",children:p==="add"?"Adding":"Add to group"})})]}),u.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Admins: choose a user to add them to this group."})]}),u.jsxs("div",{className:"rounded-xl border border-slate-200 bg-white/70 p-4 mb-6",children:[u.jsx("h2",{className:"font-medium text-slate-900",children:"Add Member (by UID)"}),u.jsxs("div",{className:"mt-2 flex gap-2",children:[u.jsx("input",{value:E,onChange:Q=>v(Q.target.value),placeholder:"Paste a user's UID",className:"flex-1 rounded-lg border border-slate-300 px-3 py-2 text-sm",disabled:!A}),u.jsx("button",{onClick:P,disabled:!E.trim()||!!p||!A,className:"text-sm px-3 py-2 rounded-lg bg-slate-900 text-white hover:bg-slate-800 disabled:opacity-60",children:p==="add"?"Adding":"Add"})]}),u.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Tip: you can find a user's UID in Firebase  Authentication."})]}),d?u.jsx("p",{className:"text-slate-600",children:"Loading"}):i.length===0?u.jsx("p",{className:"text-slate-600",children:"No members yet."}):u.jsx("ul",{className:"divide-y divide-slate-200 rounded-xl border border-slate-200 bg-white/70",children:i.map(Q=>u.jsxs("li",{className:"p-4 flex items-center justify-between",children:[u.jsxs("div",{children:[u.jsx("div",{className:"font-medium text-slate-900",children:Q.displayName||Q.uid}),u.jsx("div",{className:"text-xs text-slate-500 truncate",children:Q.uid})]}),u.jsxs("div",{className:"flex items-center gap-2",children:[l[Q.uid]?u.jsx("button",{onClick:()=>at(Q.uid),disabled:!!p||!A,className:"text-xs px-3 py-1.5 rounded-lg bg-amber-100 text-amber-800 hover:bg-amber-200 disabled:opacity-60",children:p===`admin:${Q.uid}`?"Updating":"Remove admin"}):u.jsx("button",{onClick:()=>C(Q.uid),disabled:!!p||!A,className:"text-xs px-3 py-1.5 rounded-lg bg-slate-900 text-white hover:bg-slate-800 disabled:opacity-60",children:p===`admin:${Q.uid}`?"Updating":"Make admin"}),u.jsx("button",{onClick:()=>xt(Q.uid),disabled:!!p||!A,className:"text-xs px-3 py-1.5 rounded-lg bg-rose-100 text-rose-800 hover:bg-rose-200 disabled:opacity-60",children:p===Q.uid?"Removing":"Remove"})]})]},Q.uid))})]})}function ZV(t){return t.replace(/[-_]/g," ").replace(/\b\w/g,e=>e.toUpperCase())}function eL(){const{slug:t}=Ti(),e=$e(te),n=t,[r,s]=k.useState([]),[i,o]=k.useState(!0);return k.useEffect(()=>{let l=!0;async function c(){if(n){o(!0);try{const d=pe(e,`groups/${n}/groupEvents`),f=Je(d,Vn("at","desc")),p=await Fe(f);if(!l)return;const m=[];p.forEach(y=>m.push({id:y.id,...y.data()})),s(m)}finally{o(!1)}}}return c(),()=>{l=!1}},[e,n]),u.jsxs("div",{className:"max-w-4xl mx-auto p-6",children:[u.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[u.jsxs("div",{children:[u.jsx("h1",{className:"text-2xl font-semibold text-slate-900",children:"Audit Log"}),u.jsx("p",{className:"text-slate-600",children:"Recent events for this group."})]}),u.jsx(_e,{to:"/admin/groups",className:"text-sm text-slate-700 underline",children:"Back to groups"})]}),i?u.jsx("p",{className:"text-slate-600",children:"Loading"}):r.length===0?u.jsx("p",{className:"text-slate-600",children:"No events yet."}):u.jsx("ul",{className:"divide-y divide-slate-200 rounded-xl border border-slate-200 bg-white/70",children:r.map(l=>{var c;return u.jsxs("li",{className:"p-4",children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsx("div",{className:"font-medium text-slate-900",children:l.type.replace(/_/g," ")}),u.jsx("div",{className:"text-xs text-slate-500",children:(c=l.at)!=null&&c.toDate?l.at.toDate().toLocaleString():""})]}),u.jsx("div",{className:"text-xs text-slate-600 mt-1",children:l.uid&&u.jsxs(u.Fragment,{children:["User: ",u.jsx("code",{children:l.uid})]})}),l.payload&&u.jsx("pre",{className:"mt-2 text-xs bg-slate-50 rounded-lg p-2 overflow-auto",children:JSON.stringify(l.payload,null,2)})]},l.id)})})]})}function tL(){const t=Ag(te),e=$e(te),[n,r]=k.useState(""),[s,i]=k.useState(""),[o,l]=k.useState([]),[c,d]=k.useState(!1),[f,p]=k.useState(null);k.useEffect(()=>{async function y(){const w=await Fe(pe(e,"groups")),A=[];w.forEach(b=>A.push({id:b.id,...b.data()})),A.sort((b,E)=>(b.name||b.id).localeCompare(E.name||E.id)),l(A)}y()},[e]);async function m(){d(!0),p(null);try{const w=await Vd(t,"grantGroupAdminByEmail")({email:n,groupId:s});p(` Granted admin to ${n} (uid=${w.data.uid})`),r("")}catch(y){p(` ${(y==null?void 0:y.message)||"Failed"}`)}finally{d(!1)}}return u.jsxs("div",{className:"max-w-xl mx-auto p-6",children:[u.jsx("h1",{className:"text-2xl font-semibold text-slate-900",children:"Grant Group Admin (by email)"}),u.jsxs("div",{className:"mt-4 grid gap-3 rounded-2xl border border-slate-200 bg-white/70 p-4",children:[u.jsxs("label",{className:"block text-sm",children:[u.jsx("span",{className:"font-medium text-slate-700",children:"User email"}),u.jsx("input",{value:n,onChange:y=>r(y.target.value),placeholder:"user@example.com",className:"mt-1 w-full rounded-lg border border-slate-300 px-3 py-2 text-sm"})]}),u.jsxs("label",{className:"block text-sm",children:[u.jsx("span",{className:"font-medium text-slate-700",children:"Group"}),u.jsxs("select",{value:s,onChange:y=>i(y.target.value),className:"mt-1 w-full rounded-lg border border-slate-300 bg-white/70 px-3 py-2 text-sm",children:[u.jsx("option",{value:"",children:"Select a group"}),o.map(y=>u.jsx("option",{value:y.id,children:y.name||y.id},y.id))]})]}),u.jsxs("div",{className:"flex gap-3 items-center",children:[u.jsx("button",{onClick:m,disabled:!n||!s||c,className:"px-4 py-2 rounded-lg bg-slate-900 text-white hover:bg-slate-800 disabled:opacity-60",children:c?"Working":"Grant admin"}),f&&u.jsx("p",{className:"text-sm text-slate-700",children:f})]})]})]})}function nL(t){return t.toLowerCase().trim().replace(/[^a-z0-9]+/g,"-").replace(/(^-|-$)+/g,"")}function Iw(){const t=$e(te),e=Yr(),[n,r]=k.useState(""),[s,i]=k.useState(""),[o,l]=k.useState(""),[c,d]=k.useState(""),[f,p]=k.useState(""),[m,y]=k.useState(""),[w,A]=k.useState(""),[b,E]=k.useState(""),[v,x]=k.useState(!1),[R,O]=k.useState(null),L=k.useMemo(()=>s||nL(n),[s,n]);async function S(){const _=L.trim();if(!n.trim()||!_){O(" Name and slug are required.");return}x(!0),O(null);try{const I=G(t,"groups",_);if((await Ae(I)).exists()){O(" A group with that slug already exists."),x(!1);return}await wt(I,{id:_,name:n.trim(),slug:_,description:o.trim()||null,parent:c||null,campus:f||null,meetingDay:m||null,meetingTime:w||null,imageUrl:b||null,createdAt:ke(),updatedAt:ke()}),e(`/admin/groups/${_}/edit`,{replace:!0})}catch(I){O(" "+((I==null?void 0:I.message)||"Failed to create group."))}finally{x(!1)}}return u.jsxs("div",{className:"max-w-3xl mx-auto p-6",children:[u.jsx("h1",{className:"text-2xl font-semibold text-slate-900",children:"Create Group"}),u.jsxs("div",{className:"mt-4 grid gap-3",children:[u.jsxs(ss,{label:"Name",children:[u.jsx("input",{value:n,onChange:_=>r(_.target.value),className:"w-full rounded-lg border border-slate-300 px-3 py-2 text-sm"}),u.jsxs("p",{className:"mt-1 text-xs text-slate-500",children:["Slug preview: ",u.jsx("code",{children:L||""})]})]}),u.jsx(ss,{label:"Slug (optional)",children:u.jsx("input",{value:s,onChange:_=>i(_.target.value),className:"w-full rounded-lg border border-slate-300 px-3 py-2 text-sm",placeholder:"auto from name if blank"})}),u.jsx(ss,{label:"Description",children:u.jsx("textarea",{value:o,onChange:_=>l(_.target.value),rows:4,className:"w-full rounded-lg border border-slate-300 px-3 py-2 text-sm"})}),u.jsxs("div",{className:"grid sm:grid-cols-2 gap-3",children:[u.jsx(ss,{label:"Parent ministry (optional)",children:u.jsx("input",{value:c,onChange:_=>d(_.target.value),className:"w-full rounded-lg border border-slate-300 px-3 py-2 text-sm"})}),u.jsx(ss,{label:"Campus (optional)",children:u.jsx("input",{value:f,onChange:_=>p(_.target.value),className:"w-full rounded-lg border border-slate-300 px-3 py-2 text-sm"})})]}),u.jsxs("div",{className:"grid sm:grid-cols-2 gap-3",children:[u.jsx(ss,{label:"Meeting day (optional)",children:u.jsxs("select",{value:m,onChange:_=>y(_.target.value),className:"w-full rounded-lg border border-slate-300 px-3 py-2 text-sm bg-white/70",children:[u.jsx("option",{value:"",children:""}),["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"].map(_=>u.jsx("option",{value:_,children:_},_))]})}),u.jsx(ss,{label:"Meeting time (optional)",children:u.jsx("input",{value:w,onChange:_=>A(_.target.value),className:"w-full rounded-lg border border-slate-300 px-3 py-2 text-sm",placeholder:"e.g., 7:00pm"})})]}),u.jsx(ss,{label:"Image URL (optional)",children:u.jsx("input",{value:b,onChange:_=>E(_.target.value),className:"w-full rounded-lg border border-slate-300 px-3 py-2 text-sm",placeholder:"https://"})}),R&&u.jsx("p",{className:"text-sm text-slate-700",children:R}),u.jsx("div",{className:"flex gap-3",children:u.jsx("button",{onClick:S,disabled:v,className:"px-4 py-2 rounded-lg bg-slate-900 text-white hover:bg-slate-800 disabled:opacity-60",children:v?"Creating":"Create group"})})]})]})}function ss({label:t,children:e}){return u.jsxs("label",{className:"block",children:[u.jsx("div",{className:"text-sm font-medium text-slate-700",children:t}),u.jsx("div",{className:"mt-1",children:e})]})}function rL(){const{slug:t}=Ti(),e=$e(te),n=Yr(),[r,s]=k.useState(null),[i,o]=k.useState(!0),[l,c]=k.useState(!1),[d,f]=k.useState(null);k.useEffect(()=>{let y=!0;async function w(){if(!t)return;o(!0);const A=await Ae(G(e,"groups",t));if(!y)return;const b=A.exists()?A.data():{};s({name:(b==null?void 0:b.name)||"",description:(b==null?void 0:b.description)??"",parent:(b==null?void 0:b.parent)??"",campus:(b==null?void 0:b.campus)??"",meetingDay:(b==null?void 0:b.meetingDay)??"",meetingTime:(b==null?void 0:b.meetingTime)??"",meetingFrequency:(b==null?void 0:b.meetingFrequency)??"",imageUrl:(b==null?void 0:b.imageUrl)??""}),o(!1)}return w(),()=>{y=!1}},[e,t]);async function p(){var y,w,A,b,E,v;if(!(!t||!r)){c(!0),f(null);try{const x={...r,name:String((r==null?void 0:r.name)||"").trim(),description:((y=(r==null?void 0:r.description)||"")==null?void 0:y.trim())||null,parent:((w=(r==null?void 0:r.parent)||"")==null?void 0:w.trim())||null,campus:((A=(r==null?void 0:r.campus)||"")==null?void 0:A.trim())||null,meetingDay:((b=(r==null?void 0:r.meetingDay)||"")==null?void 0:b.trim())||null,meetingTime:((E=(r==null?void 0:r.meetingTime)||"")==null?void 0:E.trim())||null,meetingFrequency:(r==null?void 0:r.meetingFrequency)||"",imageUrl:((v=(r==null?void 0:r.imageUrl)||"")==null?void 0:v.trim())||null,updatedAt:ke()};await wt(G(e,"groups",t),x,{merge:!0}),f(" Saved")}catch(x){const R=(x==null?void 0:x.message)||"Failed to save.";f(R)}finally{c(!1)}}}async function m(){if(t&&confirm("Delete this group? This cannot be undone."))try{await Dt(G(e,"groups",t)),n("/admin/groups",{replace:!0})}catch(y){const w=(y==null?void 0:y.message)||"Failed to delete.";f(w)}}return i?u.jsx("div",{className:"max-w-3xl mx-auto p-6",children:"Loading"}):r?u.jsxs("div",{className:"max-w-3xl mx-auto p-6",children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsx("h1",{className:"text-2xl font-semibold text-slate-900",children:"Edit Group"}),u.jsx(_e,{to:"/admin/groups",className:"text-sm text-slate-700 underline",children:"Back to groups"})]}),u.jsxs("div",{className:"mt-4 grid gap-3",children:[u.jsx(is,{label:"Name",children:u.jsx("input",{value:(r==null?void 0:r.name)||"",onChange:y=>s(w=>({...w,name:y.target.value})),className:"w-full rounded-lg border border-slate-300 px-3 py-2 text-sm"})}),u.jsx(is,{label:"Description",children:u.jsx("textarea",{value:(r==null?void 0:r.description)||"",onChange:y=>s(w=>({...w,description:y.target.value})),rows:4,className:"w-full rounded-lg border border-slate-300 px-3 py-2 text-sm"})}),u.jsxs("div",{className:"grid sm:grid-cols-2 gap-3",children:[u.jsx(is,{label:"Parent ministry",children:u.jsx("input",{value:(r==null?void 0:r.parent)||"",onChange:y=>s(w=>({...w,parent:y.target.value})),className:"w-full rounded-lg border border-slate-300 px-3 py-2 text-sm"})}),u.jsx(is,{label:"Campus",children:u.jsx("input",{value:(r==null?void 0:r.campus)||"",onChange:y=>s(w=>({...w,campus:y.target.value})),className:"w-full rounded-lg border border-slate-300 px-3 py-2 text-sm"})})]}),u.jsxs("div",{className:"grid sm:grid-cols-3 gap-3",children:[u.jsx(is,{label:"Meeting day",children:u.jsxs("select",{value:(r==null?void 0:r.meetingDay)||"",onChange:y=>s(w=>({...w,meetingDay:y.target.value})),className:"w-full rounded-lg border border-slate-300 px-3 py-2 text-sm bg-white/70",children:[u.jsx("option",{value:"",children:""}),["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"].map(y=>u.jsx("option",{value:y,children:y},y))]})}),u.jsx(is,{label:"Meeting time",children:u.jsx("input",{value:(r==null?void 0:r.meetingTime)||"",onChange:y=>s(w=>({...w,meetingTime:y.target.value})),className:"w-full rounded-lg border border-slate-300 px-3 py-2 text-sm",placeholder:"e.g., 7:00pm"})}),u.jsx(is,{label:"Meeting frequency",children:u.jsxs("select",{value:(r==null?void 0:r.meetingFrequency)||"",onChange:y=>s(w=>({...w,meetingFrequency:y.target.value})),className:"w-full rounded-lg border border-slate-300 px-3 py-2 text-sm bg-white/70",children:[u.jsx("option",{value:"",children:""}),u.jsx("option",{value:"weekly",children:"Weekly"}),u.jsx("option",{value:"biweekly",children:"Biweekly"}),u.jsx("option",{value:"monthly",children:"Monthly"})]})})]}),u.jsx(is,{label:"Image URL",children:u.jsx("input",{value:(r==null?void 0:r.imageUrl)||"",onChange:y=>s(w=>({...w,imageUrl:y.target.value})),className:"w-full rounded-lg border border-slate-300 px-3 py-2 text-sm",placeholder:"https://"})}),d&&u.jsx("p",{className:"text-sm text-slate-700",children:d}),u.jsxs("div",{className:"flex gap-3",children:[u.jsx("button",{onClick:p,disabled:l,className:"px-4 py-2 rounded-lg bg-slate-900 text-white hover:bg-slate-800 disabled:opacity-60",children:l?"Saving":"Save changes"}),u.jsx("button",{onClick:m,className:"px-4 py-2 rounded-lg bg-rose-100 text-rose-800 hover:bg-rose-200",children:"Delete group"})]})]})]}):u.jsx("div",{className:"max-w-3xl mx-auto p-6",children:"Not found."})}function is({label:t,children:e}){return u.jsxs("label",{className:"block",children:[u.jsx("div",{className:"text-sm font-medium text-slate-700",children:t}),u.jsx("div",{className:"mt-1",children:e})]})}function sL(){const t=$e(te),e=Ke(te),[n,r]=k.useState([]),[s,i]=k.useState(!0),[o,l]=k.useState(""),[c,d]=k.useState("");async function f(){i(!0);const y=await Fe(pe(t,"admins")),w=[];y.forEach(A=>w.push({uid:A.id,...A.data()})),w.sort((A,b)=>A.uid.localeCompare(b.uid)),r(w),i(!1)}k.useEffect(()=>{f()},[]);async function p(){var w;const y=c.trim();if(y){l("add");try{await wt(G(t,"admins",y),{createdAt:ke(),createdBy:((w=e.currentUser)==null?void 0:w.uid)||"unknown"},{merge:!0}),d(""),await f()}finally{l("")}}}async function m(y){l(y);try{await Dt(G(t,"admins",y)),await f()}finally{l("")}}return u.jsxs("div",{className:"max-w-3xl mx-auto p-6",children:[u.jsx("h1",{className:"text-2xl font-semibold text-slate-900",children:"Super Admins"}),u.jsx("p",{className:"text-slate-600 mt-1",children:"Add or remove super admins by UID."}),u.jsxs("div",{className:"mt-4 rounded-2xl border border-slate-200 bg-white/70 p-4",children:[u.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"Add by UID"}),u.jsxs("div",{className:"mt-2 flex gap-2",children:[u.jsx("input",{value:c,onChange:y=>d(y.target.value),placeholder:"Paste UID from Firebase Authentication  Users",className:"flex-1 rounded-lg border border-slate-300 px-3 py-2 text-sm"}),u.jsx("button",{onClick:p,disabled:!c.trim()||!!o,className:"px-3 py-2 rounded-lg text-sm bg-slate-900 text-white hover:bg-slate-800 disabled:opacity-60",children:o==="add"?"Adding":"Add"})]})]}),u.jsx("div",{className:"mt-4 rounded-2xl border border-slate-200 bg-white/70",children:s?u.jsx("div",{className:"p-4 text-slate-600",children:"Loading"}):n.length===0?u.jsx("div",{className:"p-4 text-slate-600",children:"No super admins yet."}):u.jsx("ul",{className:"divide-y divide-slate-200",children:n.map(y=>u.jsxs("li",{className:"p-4 flex items-center justify-between",children:[u.jsxs("div",{children:[u.jsx("div",{className:"font-medium text-slate-900",children:y.uid}),u.jsxs("div",{className:"text-xs text-slate-500",children:["Created by: ",y.createdBy||""]})]}),u.jsx("button",{onClick:()=>m(y.uid),disabled:!!o,className:"text-xs px-3 py-1.5 rounded-lg bg-rose-100 text-rose-800 hover:bg-rose-200 disabled:opacity-60",children:o===y.uid?"Removing":"Remove"})]},y.uid))})})]})}function iL({children:t}){const e=Ke(te),n=$e(te),[r,s]=$.useState(!1),[i,o]=$.useState(null),[l,c]=$.useState(null),[d,f]=$.useState(null);return $.useEffect(()=>{const p=Mn(e,async m=>{if(s(!0),!m){o(null),c(!1);return}o(m.uid);try{const y=await Ae(G(n,"admins",m.uid));c(y.exists())}catch(y){f((y==null?void 0:y.message)||String(y)),c(!1)}});return()=>p()},[e,n]),!r||l===null?u.jsx("div",{className:"max-w-xl mx-auto p-6",children:"Checking"}):l?u.jsx(u.Fragment,{children:t}):u.jsxs("div",{className:"max-w-xl mx-auto p-6 rounded-2xl border border-slate-200 bg-white/70",children:[u.jsx("h2",{className:"text-lg font-semibold text-slate-900",children:"AdminRouteDebug"}),u.jsxs("p",{className:"text-sm text-slate-700 mt-2",children:["UID: ",u.jsx("code",{children:i||""})]}),u.jsxs("p",{className:"text-sm text-slate-700",children:["admins/UID exists? ",u.jsx("strong",{children:l?"YES":"NO"})]}),!i&&u.jsx("p",{className:"mt-3 text-sm text-rose-700",children:"You are not signed in."}),i&&!l&&u.jsxs("p",{className:"mt-3 text-sm text-amber-700",children:["Signed in, but no document at ",u.jsxs("code",{children:["admins/","{uid}"]}),". Create that doc in Firestore for this project."]}),d&&u.jsxs("p",{className:"mt-3 text-sm text-rose-700",children:["Error reading ",u.jsxs("code",{children:["admins/","{uid}"]}),": ",d]})]})}function Sw(t,e){return[t,e].sort().join("_")}function oL(){var Tt;const t=$.useMemo(()=>$e(te),[]),e=$.useMemo(()=>Ke(te),[]),[n,r]=$.useState(((Tt=e.currentUser)==null?void 0:Tt.uid)??null),[s,i]=$.useState(!1),[o,l]=$.useState(!1);$.useEffect(()=>{const z=Mn(e,async Z=>{var me;if(r((Z==null?void 0:Z.uid)??null),Z!=null&&Z.uid){try{const le=await Ae(G(t,"users",Z.uid));i(!!((me=le.data())!=null&&me.isCommunityApproved))}catch{i(!1)}try{const le=await Ae(G(t,"admins",Z.uid));l(le.exists())}catch{l(!1)}}else i(!1),l(!1)});return()=>z()},[e,t]);const[c,d]=$.useState(!1),[f,p]=$.useState("list"),[m,y]=$.useState([]),[w,A]=$.useState(null),[b,E]=$.useState([]),[v,x]=$.useState(""),R=$.useRef(null),[O,L]=$.useState([]),[S,_]=$.useState([]),[I,N]=$.useState({}),[P,j]=$.useState(""),[C,at]=$.useState(!1),[xt,Un]=$.useState(""),Q=$.useRef({});async function B(z){var Z,me;if(Q.current[z])return Q.current[z];try{const le=await Ae(G(t,"users",z)),Se=((Z=le.data())==null?void 0:Z.displayName)||((me=le.data())==null?void 0:me.name)||z;return Q.current[z]=Se,Se}catch{return z}}async function K(z){try{const Z=Je(_r(t,"messages"),kn("from","==",z)),me=Je(_r(t,"messages"),kn("to","==",z)),[le,Se]=await Promise.all([Fe(Z),Fe(me)]),ve=[...le.docs,...Se.docs],oe=[];for(const It of ve){const Ie=It.data(),Le=It.ref.path.split("/");if(Le.length<6)continue;const qe=Le[1],gt=Le[3],Qt=Ie.from===z?Ie.to:Ie.from;if(!Qt)continue;const Fn=[z,Qt].sort(),Jr=G(pe(t,`groups/${qe}/directMessages`),gt);oe.push(wt(Jr,{users:Fn,lastText:Ie.text||"",lastAt:Ie.createdAt||ke(),lastSender:Ie.from||z},{merge:!0}))}await Promise.allSettled(oe)}catch{}}const J=$.useRef([]);function ye(){J.current.forEach(z=>{try{z()}catch{}}),J.current=[]}function de(z,Z){ye();const me={};Z.forEach(le=>{try{const Se=Je(pe(t,`groups/${le.id}/directMessages`),kn("users","array-contains",z)),ve=Xt(Se,oe=>{oe.docs.forEach(Ie=>{const Le=Ie.data(),qe=(Le==null?void 0:Le.users)||[],gt=qe.find(Fn=>Fn!==z)||"",Qt={id:Ie.id,groupId:le.id,users:qe,lastText:(Le==null?void 0:Le.lastText)||"",lastAt:Le==null?void 0:Le.lastAt,otherUid:gt,otherName:Q.current[gt]};me[`${le.id}__${Ie.id}`]=Qt});const It=Object.values(me).sort((Ie,Le)=>{var Qt,Fn;const qe=(Qt=Ie.lastAt)!=null&&Qt.toMillis?Ie.lastAt.toMillis():0;return((Fn=Le.lastAt)!=null&&Fn.toMillis?Le.lastAt.toMillis():0)-qe});y(It),It.forEach(Ie=>{Ie.otherUid&&!Ie.otherName&&B(Ie.otherUid).then(Le=>{y(qe=>qe.map(gt=>gt.id===Ie.id&&gt.groupId===Ie.groupId?{...gt,otherName:Le}:gt))})})},oe=>{oe&&oe.code!=="permission-denied"&&console.warn("DM per-group listener error:",oe)});J.current.push(ve)}catch{}})}$.useEffect(()=>{(async()=>{if(n)try{const z=await Fe(pe(t,`users/${n}/memberships`)),Z=[];for(const Se of z.docs){const ve=Se.id;Z.push({id:ve})}L(Z);const me={},le=[];for(const Se of Z)try{const ve=await Fe(pe(t,`groups/${Se.id}/members`));for(const oe of ve.docs){if(oe.id===n||me[oe.id])continue;me[oe.id]=!0;let It,Ie;try{const qe=(await Ae(G(t,"users",oe.id))).data();It=(qe==null?void 0:qe.displayName)||void 0,Ie=(qe==null?void 0:qe.email)||void 0}catch{}le.push({uid:oe.id,displayName:It,email:Ie})}}catch{}_(le)}catch{L([]),_([])}})()},[t,n]),$.useEffect(()=>{if(!n||!s)return;let z=null,Z=!1;return(async()=>{try{try{const me=Je(_r(t,"directMessages"),kn("users","array-contains",n),Vn("lastAt","desc"));z=Xt(me,async le=>{const Se=[];for(const ve of le.docs){const oe=ve.data(),It=ve.ref.path.split("/"),Ie=It.length>=2?It[1]:"",Le=(oe==null?void 0:oe.users)||[],qe=Le.find(Qt=>Qt!==n)||"",gt={id:ve.id,groupId:Ie,users:Le,lastText:(oe==null?void 0:oe.lastText)||"",lastAt:oe==null?void 0:oe.lastAt,otherUid:qe,otherName:Q.current[qe]};Se.push(gt)}for(const ve of Se)ve.otherUid&&!ve.otherName&&B(ve.otherUid).then(oe=>{y(It=>It.map(Ie=>Ie.id===ve.id?{...Ie,otherName:oe}:Ie))});Z||y(Se),Se.length===0&&await K(n)},le=>{le&&(le.code==="permission-denied"||le.code==="failed-precondition")?de(n,O):console.warn("DM listener error:",le)})}catch{de(n,O)}}catch{}})(),()=>{z&&z(),ye()}},[t,n,s,O]),$.useEffect(()=>{if(!w||!n){R.current&&(R.current(),R.current=null),E([]);return}R.current&&(R.current(),R.current=null);const z=pe(t,`groups/${w.groupId}/directMessages/${w.id}/messages`),Z=Je(z,Vn("createdAt","asc")),me=Xt(Z,le=>{const Se=le.docs.map(ve=>{const oe=ve.data();return{id:ve.id,text:(oe==null?void 0:oe.text)||"",from:(oe==null?void 0:oe.from)||"",to:(oe==null?void 0:oe.to)||"",displayName:(oe==null?void 0:oe.displayName)||"",createdAt:oe==null?void 0:oe.createdAt}});E(Se)});return R.current=me,()=>{R.current&&(R.current(),R.current=null)}},[t,w==null?void 0:w.groupId,w==null?void 0:w.id,n]);async function re(z){var le;if(!n)throw new Error("No user");const Z=m.find(Se=>Se.otherUid===z);if(Z)return{groupId:Z.groupId,pid:Z.id};for(const Se of O)try{if((await Ae(G(t,`groups/${Se.id}/members`,z))).exists())return{groupId:Se.id,pid:Sw(n,z)}}catch{}const me=(le=O[0])==null?void 0:le.id;if(!me)throw new Error("No group memberships found");return{groupId:me,pid:Sw(n,z)}}async function st(){var me;if(!w||!n)return;const z=v.trim();if(!z)return;const Z=w.otherUid;try{const le=pe(t,`groups/${w.groupId}/directMessages/${w.id}/messages`);await Dr(le,{text:z,from:n,to:Z,displayName:((me=e.currentUser)==null?void 0:me.displayName)||"Member",createdAt:ke()}),await wt(G(pe(t,`groups/${w.groupId}/directMessages`),w.id),{users:[n,Z].sort(),lastText:z,lastAt:ke(),lastSender:n},{merge:!0}),x("")}catch{alert("Could not send message.")}}async function Et(){var me;if(!n)return;const z=Object.entries(I).filter(([,le])=>le).map(([le])=>le),Z=P.trim();if(!(z.length===0||!Z)){at(!0);try{for(const le of z){const{groupId:Se,pid:ve}=await re(le);await Dr(pe(t,`groups/${Se}/directMessages/${ve}/messages`),{text:Z,from:n,to:le,displayName:((me=e.currentUser)==null?void 0:me.displayName)||"Member",createdAt:ke()}),await wt(G(t,`groups/${Se}/directMessages/${ve}`),{users:[n,le].sort(),lastText:Z,lastAt:ke(),lastSender:n},{merge:!0})}j(""),N({}),p("list")}catch{alert("Failed to send message(s).")}finally{at(!1)}}}async function Qe(z){if(!w||!n)return;const Z=b.find(me=>me.id===z);if(Z&&(Z.from===n||o))try{await Dt(G(t,`groups/${w.groupId}/directMessages/${w.id}/messages/${z}`))}catch{alert("Failed to delete message (check rules).")}}if(!n||!s)return null;const Oe=S.filter(z=>{const Z=xt.trim().toLowerCase();if(!Z)return!0;const me=(z.displayName||"").toLowerCase(),le=(z.email||"").toLowerCase();return me.includes(Z)||le.includes(Z)||z.uid.toLowerCase().includes(Z)});return u.jsxs(u.Fragment,{children:[u.jsx("button",{type:"button",onClick:()=>{d(z=>!z),c||p("list")},className:`fixed bottom-4 right-4 z-[1100] shadow-lg rounded-full px-4 py-2 text-white text-sm md:text-[13px] ${c?"hidden md:inline-flex":"inline-flex"}`,style:{backgroundColor:"#919FAA"},"aria-label":c?"Close direct messages":"Open direct messages",children:c?"Close DMs":"Open DMs"}),c&&u.jsxs("div",{className:`fixed z-[1000] md:right-4 md:bottom-16 md:w-[780px] md:h-[480px] md:rounded-xl
                     inset-x-0 bottom-0 w-screen h-[85vh] rounded-t-2xl
                     border border-slate-800 bg-slate-900 text-white shadow-xl overflow-hidden
                     flex md:flex-row flex-col`,style:{paddingBottom:"env(safe-area-inset-bottom)"},children:[u.jsxs("div",{className:"md:hidden flex items-center justify-between px-3 py-2 border-b border-slate-800",children:[u.jsx("button",{type:"button",onClick:()=>d(!1),className:"text-xs rounded-md border border-slate-700 px-2 py-1","aria-label":"Close direct messages",children:"Close"}),u.jsx("div",{className:"text-sm font-semibold",children:"Direct Messages"}),f!=="compose"?u.jsx("button",{type:"button",onClick:()=>p("compose"),className:"text-xs rounded-md border border-slate-700 px-2 py-1","aria-label":"New message",children:"New"}):u.jsx("button",{type:"button",onClick:()=>p("list"),className:"text-xs rounded-md border border-slate-700 px-2 py-1","aria-label":"Back to conversations",children:"Back"})]}),f==="list"&&u.jsxs("div",{className:"md:w-64 md:border-r md:border-slate-800 h-[40vh] md:h-full overflow-auto",children:[u.jsxs("div",{className:"hidden md:flex px-3 py-2 text-sm font-semibold items-center justify-between",children:[u.jsx("span",{children:"Conversations"}),u.jsx("button",{type:"button",onClick:()=>p("compose"),className:"text-xs rounded-md border border-slate-700 px-2 py-1 hover:bg-slate-800",title:"New message",children:"New"})]}),m.length===0?u.jsx("div",{className:"px-3 py-2 text-sm text-slate-300",children:"No conversations yet."}):u.jsx("ul",{children:m.map(z=>u.jsx("li",{children:u.jsxs("button",{type:"button",onClick:()=>{A(z),p("chat")},className:`w-full text-left px-3 py-2 text-sm hover:bg-slate-800 ${w&&w.id===z.id&&w.groupId===z.groupId?"bg-slate-800":""}`,children:[u.jsx("div",{className:"font-medium truncate",children:z.otherName||z.otherUid}),u.jsx("div",{className:"text-xs text-slate-300 truncate",children:z.lastText||""}),u.jsxs("div",{className:"text-[10px] text-slate-400 mt-0.5",children:["Group: ",z.groupId]})]})},`${z.groupId}__${z.id}`))})]}),u.jsxs("div",{className:"flex-1 h-full flex flex-col",children:[f==="chat"&&w&&u.jsxs(u.Fragment,{children:[u.jsxs("div",{className:"px-3 py-2 border-b border-slate-800 flex items-center gap-2",children:[u.jsx("button",{type:"button",onClick:()=>p("list"),className:"text-xs rounded-md border border-slate-700 px-2 py-1 hover:bg-slate-800 md:hidden",children:" Back"}),u.jsx("div",{className:"text-sm font-semibold truncate",children:w.otherName||w.otherUid}),u.jsxs("div",{className:"text-xs text-slate-400 ml-auto hidden md:block",children:["Group: ",w.groupId]})]}),u.jsxs("div",{className:"flex-1 overflow-auto p-3 space-y-2",children:[b.map(z=>{const Z=z.from===n;return u.jsxs("div",{className:`max-w-[85%] md:max-w-[80%] rounded-lg px-3 py-2 text-sm relative ${Z?"ml-auto border border-slate-700":"bg-slate-800"}`,children:[z.text,(Z||o)&&u.jsx("button",{type:"button",onClick:()=>void Qe(z.id),className:"absolute -top-2 -right-2 text-[10px] rounded-full border border-slate-700 bg-slate-900 px-1.5 py-0.5 hover:bg-slate-800",title:"Delete message",children:""})]},z.id)}),b.length===0&&u.jsx("div",{className:"text-sm text-slate-300",children:"No messages in this conversation yet."})]}),u.jsxs("div",{className:"border-t border-slate-800 p-2 flex gap-2",children:[u.jsx("textarea",{value:v,onChange:z=>x(z.target.value),placeholder:"Write a message",className:"flex-1 rounded-lg border border-slate-700 bg-slate-800 px-3 py-2 text-sm outline-none text-white placeholder:text-slate-400 h-10 md:h-auto md:min-h-[40px] max-h-28",onKeyDown:z=>{z.key==="Enter"&&!z.shiftKey&&(z.preventDefault(),st())}}),u.jsx("button",{type:"button",onClick:()=>void st(),className:"rounded-lg px-3 py-2 text-white text-sm hover:opacity-90",style:{backgroundColor:"#919FAA"},disabled:!v.trim(),children:"Send"})]})]}),f==="compose"&&u.jsxs(u.Fragment,{children:[u.jsxs("div",{className:"px-3 py-2 border-b border-slate-800 flex items-center gap-2",children:[u.jsx("button",{type:"button",onClick:()=>p("list"),className:"text-xs rounded-md border border-slate-700 px-2 py-1 hover:bg-slate-800",children:" Back"}),u.jsx("div",{className:"text-sm font-semibold",children:"New message"})]}),u.jsxs("div",{className:"flex-1 p-3 grid grid-cols-1 md:grid-cols-5 gap-3 overflow-auto",children:[u.jsxs("div",{className:"md:col-span-2",children:[u.jsx("label",{className:"text-xs text-slate-300",children:"Recipients"}),u.jsx("input",{value:xt,onChange:z=>Un(z.target.value),placeholder:"Search by screen name",className:"mt-1 w-full rounded-lg border border-slate-700 bg-slate-800 px-2 py-1.5 text-sm outline-none"}),u.jsx("div",{className:"mt-2 h-56 md:h-48 overflow-auto rounded-lg border border-slate-700",children:Oe.length===0?u.jsx("div",{className:"px-2 py-2 text-xs text-slate-400",children:"No matching users."}):u.jsx("ul",{className:"p-2 space-y-1",children:Oe.map(z=>u.jsxs("li",{className:"flex items-center gap-2",children:[u.jsx("input",{id:`sel-${z.uid}`,type:"checkbox",className:"h-4 w-4 accent-[#919FAA]",checked:!!I[z.uid],onChange:Z=>N(me=>({...me,[z.uid]:Z.target.checked}))}),u.jsxs("label",{htmlFor:`sel-${z.uid}`,className:"text-sm truncate",children:[z.displayName||z.uid,z.email?`  ${z.email}`:""]})]},z.uid))})})]}),u.jsxs("div",{className:"md:col-span-3 flex flex-col",children:[u.jsx("label",{className:"text-xs text-slate-300",children:"Message"}),u.jsx("textarea",{value:P,onChange:z=>j(z.target.value),placeholder:"Write your message",className:"mt-1 flex-1 rounded-lg border border-slate-700 bg-slate-800 px-3 py-2 text-sm outline-none h-40 md:h-auto"})]})]}),u.jsxs("div",{className:"border-t border-slate-800 p-2 flex items-center justify-end gap-2",children:[u.jsx("button",{type:"button",onClick:()=>p("list"),className:"rounded-lg border border-slate-700 px-3 py-2 text-sm hover:bg-slate-800",children:"Cancel"}),u.jsx("button",{type:"button",onClick:()=>void Et(),disabled:C||!P.trim()||!Object.values(I).some(Boolean),className:"rounded-lg px-3 py-2 text-white text-sm hover:opacity-90 disabled:opacity-60",style:{backgroundColor:"#919FAA"},children:C?"Sending":"Send"})]})]}),f==="list"&&!w&&u.jsxs("div",{className:"hidden md:grid place-items-center flex-1 text-sm text-slate-300",children:["Select a conversation or click ",u.jsx("b",{className:"mx-1",children:"New"})," to start one."]})]})]})]})}function aL(){var d,f,p;const t=Ke(te),[e,n]=k.useState(!1),[r,s]=k.useState(((d=t.currentUser)==null?void 0:d.uid)||null),[i,o]=k.useState(((f=t.currentUser)==null?void 0:f.email)||null);k.useEffect(()=>{const m=Mn(t,y=>{s((y==null?void 0:y.uid)||null),o((y==null?void 0:y.email)||null),n(!0)});return()=>m()},[t]);const l=(p=te.options)==null?void 0:p.projectId;return u.jsxs("div",{className:"max-w-xl mx-auto p-6 rounded-2xl border border-slate-200 bg-white/70",children:[u.jsx("h1",{className:"text-lg font-semibold text-slate-900",children:"Auth Debug: WhoAmI"}),u.jsxs("div",{className:"mt-2 text-sm text-slate-700",children:[u.jsxs("div",{children:[u.jsx("span",{className:"font-medium",children:"ready:"})," ",String(e)]}),u.jsxs("div",{children:[u.jsx("span",{className:"font-medium",children:"email:"})," ",i||""]}),u.jsxs("div",{children:[u.jsx("span",{className:"font-medium",children:"uid:"})," ",u.jsx("code",{children:r||""})]}),u.jsxs("div",{className:"mt-2",children:[u.jsx("span",{className:"font-medium",children:"SDK projectId:"})," ",u.jsx("code",{children:l||""})]}),u.jsxs("div",{children:[u.jsx("span",{className:"font-medium",children:"ENV projectId:"})," ",u.jsx("code",{children:String("immanuel-app")})]})]})]})}function lL({children:t}){const e=Ln(),n=e.pathname==="/login"||e.pathname==="/signup"||e.pathname==="/forgot"||e.pathname==="/reset";return u.jsxs(u.Fragment,{children:[n?u.jsx(JO,{}):u.jsx(ZO,{}),!n&&u.jsx(oL,{}),t]})}function uL(){return u.jsx(XA,{children:u.jsx(BO,{children:u.jsx(lL,{children:u.jsxs(zA,{children:[u.jsx(Pe,{path:"/",element:u.jsx(pr,{to:"/login",replace:!0})}),u.jsx(Pe,{path:"/login",element:u.jsx(eV,{})}),u.jsx(Pe,{path:"/signup",element:u.jsx(nV,{})}),u.jsx(Pe,{path:"/forgot",element:u.jsx(VV,{})}),u.jsx(Pe,{path:"/reset",element:u.jsx(LV,{})}),u.jsx(Pe,{path:"/welcome",element:u.jsx(Sn,{children:u.jsx(FV,{})})}),u.jsx(Pe,{path:"/dashboard",element:u.jsx(Sn,{children:u.jsx(Yt,{children:u.jsx(iV,{})})})}),u.jsx(Pe,{path:"/groups",element:u.jsx(Sn,{children:u.jsx(Yt,{children:u.jsx(oV,{})})})}),u.jsx(Pe,{path:"/forums",element:u.jsx(Sn,{children:u.jsx(Yt,{children:u.jsx(aV,{})})})}),u.jsx(Pe,{path:"/resources",element:u.jsx(Sn,{children:u.jsx(Yt,{children:u.jsx(lV,{})})})}),u.jsx(Pe,{path:"/events",element:u.jsx(Sn,{children:u.jsx(Yt,{children:u.jsx(uV,{})})})}),u.jsx(Pe,{path:"/profile",element:u.jsx(Sn,{children:u.jsx(Yt,{children:u.jsx(DV,{})})})}),u.jsx(Pe,{path:"/settings",element:u.jsx(Sn,{children:u.jsx(Yt,{children:u.jsx(OV,{})})})}),u.jsx(Pe,{path:"/sunday-resources",element:u.jsx(Sn,{children:u.jsx(Yt,{children:u.jsx(qV,{})})})}),u.jsx(Pe,{path:"/groups/explore",element:u.jsx(Sn,{children:u.jsx(Yt,{children:u.jsx(KO,{})})})}),u.jsx(Pe,{path:"/groups/:slug",element:u.jsx(Sn,{children:u.jsx(Yt,{children:u.jsx(QO,{})})})}),u.jsx(Pe,{path:"/groups/:slug/dm/:otherUid",element:u.jsx(Sn,{children:u.jsx(Yt,{children:u.jsx(HV,{})})})}),u.jsx(Pe,{path:"/admin",element:u.jsx(Ys,{children:u.jsx(pr,{to:"/admin/groups",replace:!0})})}),u.jsx(Pe,{path:"/admin/groups",element:u.jsx(Ys,{children:u.jsx(Yt,{children:u.jsx(GV,{})})})}),u.jsx(Pe,{path:"/admin/groups/:slug/requests",element:u.jsx(zh,{children:u.jsx(Yt,{children:u.jsx(YV,{})})})}),u.jsx(Pe,{path:"/admin/groups/:slug/members",element:u.jsx(zh,{children:u.jsx(Yt,{children:u.jsx(XV,{})})})}),u.jsx(Pe,{path:"/admin/groups/:slug/events",element:u.jsx(zh,{children:u.jsx(Yt,{children:u.jsx(eL,{})})})}),u.jsx(Pe,{path:"/admin/super-admins",element:u.jsx(Ys,{children:u.jsx(sL,{})})}),u.jsx(Pe,{path:"/admin/group-admins/by-email",element:u.jsx(Ys,{children:u.jsx(tL,{})})}),u.jsx(Pe,{path:"/admin/users",element:u.jsx(Ys,{children:u.jsx(QV,{})})}),u.jsx(Pe,{path:"/admin/groups/new",element:u.jsx(Ys,{children:u.jsx(Iw,{})})}),u.jsx(Pe,{path:"/admin/groups/:slug/edit",element:u.jsx(Ys,{children:u.jsx(rL,{})})}),u.jsx(Pe,{path:"/__whoami",element:u.jsx(aL,{})}),u.jsx(Pe,{path:"/__admin/new",element:u.jsx(iL,{children:u.jsx(Iw,{})})}),u.jsx(Pe,{path:"*",element:u.jsx(pr,{to:"/dashboard",replace:!0})})]})})})})}"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/sw.js").catch(t=>{console.error("SW registration failed",t)})});qh.createRoot(document.getElementById("root")).render(u.jsx($.StrictMode,{children:u.jsx(uL,{})}));
