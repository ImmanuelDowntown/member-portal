function gb(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in t)){const i=Object.getOwnPropertyDescriptor(r,s);i&&Object.defineProperty(t,s,i.get?i:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();function yb(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Fw={exports:{}},Dc={},$w={exports:{}},Se={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ol=Symbol.for("react.element"),vb=Symbol.for("react.portal"),_b=Symbol.for("react.fragment"),wb=Symbol.for("react.strict_mode"),xb=Symbol.for("react.profiler"),Eb=Symbol.for("react.provider"),Tb=Symbol.for("react.context"),Sb=Symbol.for("react.forward_ref"),Ib=Symbol.for("react.suspense"),bb=Symbol.for("react.memo"),Nb=Symbol.for("react.lazy"),Sy=Symbol.iterator;function Ab(t){return t===null||typeof t!="object"?null:(t=Sy&&t[Sy]||t["@@iterator"],typeof t=="function"?t:null)}var Bw={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},zw=Object.assign,qw={};function wo(t,e,n){this.props=t,this.context=e,this.refs=qw,this.updater=n||Bw}wo.prototype.isReactComponent={};wo.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};wo.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function Ww(){}Ww.prototype=wo.prototype;function yp(t,e,n){this.props=t,this.context=e,this.refs=qw,this.updater=n||Bw}var vp=yp.prototype=new Ww;vp.constructor=yp;zw(vp,wo.prototype);vp.isPureReactComponent=!0;var Iy=Array.isArray,Hw=Object.prototype.hasOwnProperty,_p={current:null},Gw={key:!0,ref:!0,__self:!0,__source:!0};function Kw(t,e,n){var r,s={},i=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)Hw.call(e,r)&&!Gw.hasOwnProperty(r)&&(s[r]=e[r]);var a=arguments.length-2;if(a===1)s.children=n;else if(1<a){for(var c=Array(a),d=0;d<a;d++)c[d]=arguments[d+2];s.children=c}if(t&&t.defaultProps)for(r in a=t.defaultProps,a)s[r]===void 0&&(s[r]=a[r]);return{$$typeof:ol,type:t,key:i,ref:o,props:s,_owner:_p.current}}function Cb(t,e){return{$$typeof:ol,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function wp(t){return typeof t=="object"&&t!==null&&t.$$typeof===ol}function Rb(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var by=/\/+/g;function Qd(t,e){return typeof t=="object"&&t!==null&&t.key!=null?Rb(""+t.key):e.toString(36)}function vu(t,e,n,r,s){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case ol:case vb:o=!0}}if(o)return o=t,s=s(o),t=r===""?"."+Qd(o,0):r,Iy(s)?(n="",t!=null&&(n=t.replace(by,"$&/")+"/"),vu(s,e,n,"",function(d){return d})):s!=null&&(wp(s)&&(s=Cb(s,n+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(by,"$&/")+"/")+t)),e.push(s)),1;if(o=0,r=r===""?".":r+":",Iy(t))for(var a=0;a<t.length;a++){i=t[a];var c=r+Qd(i,a);o+=vu(i,e,n,c,s)}else if(c=Ab(t),typeof c=="function")for(t=c.call(t),a=0;!(i=t.next()).done;)i=i.value,c=r+Qd(i,a++),o+=vu(i,e,n,c,s);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Wl(t,e,n){if(t==null)return t;var r=[],s=0;return vu(t,r,"","",function(i){return e.call(n,i,s++)}),r}function kb(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var en={current:null},_u={transition:null},Pb={ReactCurrentDispatcher:en,ReactCurrentBatchConfig:_u,ReactCurrentOwner:_p};function Qw(){throw Error("act(...) is not supported in production builds of React.")}Se.Children={map:Wl,forEach:function(t,e,n){Wl(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Wl(t,function(){e++}),e},toArray:function(t){return Wl(t,function(e){return e})||[]},only:function(t){if(!wp(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Se.Component=wo;Se.Fragment=_b;Se.Profiler=xb;Se.PureComponent=yp;Se.StrictMode=wb;Se.Suspense=Ib;Se.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Pb;Se.act=Qw;Se.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=zw({},t.props),s=t.key,i=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=_p.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(c in e)Hw.call(e,c)&&!Gw.hasOwnProperty(c)&&(r[c]=e[c]===void 0&&a!==void 0?a[c]:e[c])}var c=arguments.length-2;if(c===1)r.children=n;else if(1<c){a=Array(c);for(var d=0;d<c;d++)a[d]=arguments[d+2];r.children=a}return{$$typeof:ol,type:t.type,key:s,ref:i,props:r,_owner:o}};Se.createContext=function(t){return t={$$typeof:Tb,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:Eb,_context:t},t.Consumer=t};Se.createElement=Kw;Se.createFactory=function(t){var e=Kw.bind(null,t);return e.type=t,e};Se.createRef=function(){return{current:null}};Se.forwardRef=function(t){return{$$typeof:Sb,render:t}};Se.isValidElement=wp;Se.lazy=function(t){return{$$typeof:Nb,_payload:{_status:-1,_result:t},_init:kb}};Se.memo=function(t,e){return{$$typeof:bb,type:t,compare:e===void 0?null:e}};Se.startTransition=function(t){var e=_u.transition;_u.transition={};try{t()}finally{_u.transition=e}};Se.unstable_act=Qw;Se.useCallback=function(t,e){return en.current.useCallback(t,e)};Se.useContext=function(t){return en.current.useContext(t)};Se.useDebugValue=function(){};Se.useDeferredValue=function(t){return en.current.useDeferredValue(t)};Se.useEffect=function(t,e){return en.current.useEffect(t,e)};Se.useId=function(){return en.current.useId()};Se.useImperativeHandle=function(t,e,n){return en.current.useImperativeHandle(t,e,n)};Se.useInsertionEffect=function(t,e){return en.current.useInsertionEffect(t,e)};Se.useLayoutEffect=function(t,e){return en.current.useLayoutEffect(t,e)};Se.useMemo=function(t,e){return en.current.useMemo(t,e)};Se.useReducer=function(t,e,n){return en.current.useReducer(t,e,n)};Se.useRef=function(t){return en.current.useRef(t)};Se.useState=function(t){return en.current.useState(t)};Se.useSyncExternalStore=function(t,e,n){return en.current.useSyncExternalStore(t,e,n)};Se.useTransition=function(){return en.current.useTransition()};Se.version="18.3.1";$w.exports=Se;var R=$w.exports;const H=yb(R),jb=gb({__proto__:null,default:H},[R]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Db=R,Ob=Symbol.for("react.element"),Lb=Symbol.for("react.fragment"),Vb=Object.prototype.hasOwnProperty,Mb=Db.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Ub={key:!0,ref:!0,__self:!0,__source:!0};function Yw(t,e,n){var r,s={},i=null,o=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)Vb.call(e,r)&&!Ub.hasOwnProperty(r)&&(s[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:Ob,type:t,key:i,ref:o,props:s,_owner:Mb.current}}Dc.Fragment=Lb;Dc.jsx=Yw;Dc.jsxs=Yw;Fw.exports=Dc;var u=Fw.exports,qh={},Xw={exports:{}},En={},Jw={exports:{}},Zw={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(F,K){var ne=F.length;F.push(K);e:for(;0<ne;){var ge=ne-1>>>1,me=F[ge];if(0<s(me,K))F[ge]=K,F[ne]=me,ne=ge;else break e}}function n(F){return F.length===0?null:F[0]}function r(F){if(F.length===0)return null;var K=F[0],ne=F.pop();if(ne!==K){F[0]=ne;e:for(var ge=0,me=F.length,ue=me>>>1;ge<ue;){var Y=2*(ge+1)-1,M=F[Y],z=Y+1,Z=F[z];if(0>s(M,ne))z<me&&0>s(Z,M)?(F[ge]=Z,F[z]=ne,ge=z):(F[ge]=M,F[Y]=ne,ge=Y);else if(z<me&&0>s(Z,ne))F[ge]=Z,F[z]=ne,ge=z;else break e}}return K}function s(F,K){var ne=F.sortIndex-K.sortIndex;return ne!==0?ne:F.id-K.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var c=[],d=[],h=1,p=null,m=3,y=!1,T=!1,b=!1,I=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,w=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function _(F){for(var K=n(d);K!==null;){if(K.callback===null)r(d);else if(K.startTime<=F)r(d),K.sortIndex=K.expirationTime,e(c,K);else break;K=n(d)}}function E(F){if(b=!1,_(F),!T)if(n(c)!==null)T=!0,Ee(j);else{var K=n(d);K!==null&&J(E,K.startTime-F)}}function j(F,K){T=!1,b&&(b=!1,v(x),x=-1),y=!0;var ne=m;try{for(_(K),p=n(c);p!==null&&(!(p.expirationTime>K)||F&&!P());){var ge=p.callback;if(typeof ge=="function"){p.callback=null,m=p.priorityLevel;var me=ge(p.expirationTime<=K);K=t.unstable_now(),typeof me=="function"?p.callback=me:p===n(c)&&r(c),_(K)}else r(c);p=n(c)}if(p!==null)var ue=!0;else{var Y=n(d);Y!==null&&J(E,Y.startTime-K),ue=!1}return ue}finally{p=null,m=ne,y=!1}}var O=!1,S=null,x=-1,N=5,k=-1;function P(){return!(t.unstable_now()-k<N)}function D(){if(S!==null){var F=t.unstable_now();k=F;var K=!0;try{K=S(!0,F)}finally{K?C():(O=!1,S=null)}}else O=!1}var C;if(typeof w=="function")C=function(){w(D)};else if(typeof MessageChannel<"u"){var pe=new MessageChannel,Ae=pe.port2;pe.port1.onmessage=D,C=function(){Ae.postMessage(null)}}else C=function(){I(D,0)};function Ee(F){S=F,O||(O=!0,C())}function J(F,K){x=I(function(){F(t.unstable_now())},K)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(F){F.callback=null},t.unstable_continueExecution=function(){T||y||(T=!0,Ee(j))},t.unstable_forceFrameRate=function(F){0>F||125<F?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):N=0<F?Math.floor(1e3/F):5},t.unstable_getCurrentPriorityLevel=function(){return m},t.unstable_getFirstCallbackNode=function(){return n(c)},t.unstable_next=function(F){switch(m){case 1:case 2:case 3:var K=3;break;default:K=m}var ne=m;m=K;try{return F()}finally{m=ne}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(F,K){switch(F){case 1:case 2:case 3:case 4:case 5:break;default:F=3}var ne=m;m=F;try{return K()}finally{m=ne}},t.unstable_scheduleCallback=function(F,K,ne){var ge=t.unstable_now();switch(typeof ne=="object"&&ne!==null?(ne=ne.delay,ne=typeof ne=="number"&&0<ne?ge+ne:ge):ne=ge,F){case 1:var me=-1;break;case 2:me=250;break;case 5:me=1073741823;break;case 4:me=1e4;break;default:me=5e3}return me=ne+me,F={id:h++,callback:K,priorityLevel:F,startTime:ne,expirationTime:me,sortIndex:-1},ne>ge?(F.sortIndex=ne,e(d,F),n(c)===null&&F===n(d)&&(b?(v(x),x=-1):b=!0,J(E,ne-ge))):(F.sortIndex=me,e(c,F),T||y||(T=!0,Ee(j))),F},t.unstable_shouldYield=P,t.unstable_wrapCallback=function(F){var K=m;return function(){var ne=m;m=K;try{return F.apply(this,arguments)}finally{m=ne}}}})(Zw);Jw.exports=Zw;var Fb=Jw.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $b=R,_n=Fb;function W(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var ex=new Set,Aa={};function mi(t,e){no(t,e),no(t+"Capture",e)}function no(t,e){for(Aa[t]=e,t=0;t<e.length;t++)ex.add(e[t])}var kr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Wh=Object.prototype.hasOwnProperty,Bb=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Ny={},Ay={};function zb(t){return Wh.call(Ay,t)?!0:Wh.call(Ny,t)?!1:Bb.test(t)?Ay[t]=!0:(Ny[t]=!0,!1)}function qb(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function Wb(t,e,n,r){if(e===null||typeof e>"u"||qb(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function tn(t,e,n,r,s,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var kt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){kt[t]=new tn(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];kt[e]=new tn(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){kt[t]=new tn(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){kt[t]=new tn(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){kt[t]=new tn(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){kt[t]=new tn(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){kt[t]=new tn(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){kt[t]=new tn(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){kt[t]=new tn(t,5,!1,t.toLowerCase(),null,!1,!1)});var xp=/[\-:]([a-z])/g;function Ep(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(xp,Ep);kt[e]=new tn(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(xp,Ep);kt[e]=new tn(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(xp,Ep);kt[e]=new tn(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){kt[t]=new tn(t,1,!1,t.toLowerCase(),null,!1,!1)});kt.xlinkHref=new tn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){kt[t]=new tn(t,1,!1,t.toLowerCase(),null,!0,!0)});function Tp(t,e,n,r){var s=kt.hasOwnProperty(e)?kt[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(Wb(e,n,s,r)&&(n=null),r||s===null?zb(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):s.mustUseProperty?t[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?t.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var Ur=$b.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Hl=Symbol.for("react.element"),Pi=Symbol.for("react.portal"),ji=Symbol.for("react.fragment"),Sp=Symbol.for("react.strict_mode"),Hh=Symbol.for("react.profiler"),tx=Symbol.for("react.provider"),nx=Symbol.for("react.context"),Ip=Symbol.for("react.forward_ref"),Gh=Symbol.for("react.suspense"),Kh=Symbol.for("react.suspense_list"),bp=Symbol.for("react.memo"),Xr=Symbol.for("react.lazy"),rx=Symbol.for("react.offscreen"),Cy=Symbol.iterator;function Go(t){return t===null||typeof t!="object"?null:(t=Cy&&t[Cy]||t["@@iterator"],typeof t=="function"?t:null)}var nt=Object.assign,Yd;function na(t){if(Yd===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Yd=e&&e[1]||""}return`
`+Yd+t}var Xd=!1;function Jd(t,e){if(!t||Xd)return"";Xd=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(d){var r=d}Reflect.construct(t,[],e)}else{try{e.call()}catch(d){r=d}t.call(e.prototype)}else{try{throw Error()}catch(d){r=d}t()}}catch(d){if(d&&r&&typeof d.stack=="string"){for(var s=d.stack.split(`
`),i=r.stack.split(`
`),o=s.length-1,a=i.length-1;1<=o&&0<=a&&s[o]!==i[a];)a--;for(;1<=o&&0<=a;o--,a--)if(s[o]!==i[a]){if(o!==1||a!==1)do if(o--,a--,0>a||s[o]!==i[a]){var c=`
`+s[o].replace(" at new "," at ");return t.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",t.displayName)),c}while(1<=o&&0<=a);break}}}finally{Xd=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?na(t):""}function Hb(t){switch(t.tag){case 5:return na(t.type);case 16:return na("Lazy");case 13:return na("Suspense");case 19:return na("SuspenseList");case 0:case 2:case 15:return t=Jd(t.type,!1),t;case 11:return t=Jd(t.type.render,!1),t;case 1:return t=Jd(t.type,!0),t;default:return""}}function Qh(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case ji:return"Fragment";case Pi:return"Portal";case Hh:return"Profiler";case Sp:return"StrictMode";case Gh:return"Suspense";case Kh:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case nx:return(t.displayName||"Context")+".Consumer";case tx:return(t._context.displayName||"Context")+".Provider";case Ip:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case bp:return e=t.displayName||null,e!==null?e:Qh(t.type)||"Memo";case Xr:e=t._payload,t=t._init;try{return Qh(t(e))}catch{}}return null}function Gb(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Qh(e);case 8:return e===Sp?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Ts(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function sx(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function Kb(t){var e=sx(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(o){r=""+o,i.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Gl(t){t._valueTracker||(t._valueTracker=Kb(t))}function ix(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=sx(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function Uu(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Yh(t,e){var n=e.checked;return nt({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function Ry(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Ts(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function ox(t,e){e=e.checked,e!=null&&Tp(t,"checked",e,!1)}function Xh(t,e){ox(t,e);var n=Ts(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Jh(t,e.type,n):e.hasOwnProperty("defaultValue")&&Jh(t,e.type,Ts(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function ky(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Jh(t,e,n){(e!=="number"||Uu(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var ra=Array.isArray;function Hi(t,e,n,r){if(t=t.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=e.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Ts(n),e=null,s=0;s<t.length;s++){if(t[s].value===n){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function Zh(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(W(91));return nt({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Py(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(W(92));if(ra(n)){if(1<n.length)throw Error(W(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Ts(n)}}function ax(t,e){var n=Ts(e.value),r=Ts(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function jy(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function lx(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ef(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?lx(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Kl,ux=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Kl=Kl||document.createElement("div"),Kl.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Kl.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Ca(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var da={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Qb=["Webkit","ms","Moz","O"];Object.keys(da).forEach(function(t){Qb.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),da[e]=da[t]})});function cx(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||da.hasOwnProperty(t)&&da[t]?(""+e).trim():e+"px"}function dx(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=cx(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,s):t[n]=s}}var Yb=nt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function tf(t,e){if(e){if(Yb[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(W(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(W(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(W(61))}if(e.style!=null&&typeof e.style!="object")throw Error(W(62))}}function nf(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var rf=null;function Np(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var sf=null,Gi=null,Ki=null;function Dy(t){if(t=ul(t)){if(typeof sf!="function")throw Error(W(280));var e=t.stateNode;e&&(e=Uc(e),sf(t.stateNode,t.type,e))}}function hx(t){Gi?Ki?Ki.push(t):Ki=[t]:Gi=t}function fx(){if(Gi){var t=Gi,e=Ki;if(Ki=Gi=null,Dy(t),e)for(t=0;t<e.length;t++)Dy(e[t])}}function px(t,e){return t(e)}function mx(){}var Zd=!1;function gx(t,e,n){if(Zd)return t(e,n);Zd=!0;try{return px(t,e,n)}finally{Zd=!1,(Gi!==null||Ki!==null)&&(mx(),fx())}}function Ra(t,e){var n=t.stateNode;if(n===null)return null;var r=Uc(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(W(231,e,typeof n));return n}var of=!1;if(kr)try{var Ko={};Object.defineProperty(Ko,"passive",{get:function(){of=!0}}),window.addEventListener("test",Ko,Ko),window.removeEventListener("test",Ko,Ko)}catch{of=!1}function Xb(t,e,n,r,s,i,o,a,c){var d=Array.prototype.slice.call(arguments,3);try{e.apply(n,d)}catch(h){this.onError(h)}}var ha=!1,Fu=null,$u=!1,af=null,Jb={onError:function(t){ha=!0,Fu=t}};function Zb(t,e,n,r,s,i,o,a,c){ha=!1,Fu=null,Xb.apply(Jb,arguments)}function eN(t,e,n,r,s,i,o,a,c){if(Zb.apply(this,arguments),ha){if(ha){var d=Fu;ha=!1,Fu=null}else throw Error(W(198));$u||($u=!0,af=d)}}function gi(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function yx(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Oy(t){if(gi(t)!==t)throw Error(W(188))}function tN(t){var e=t.alternate;if(!e){if(e=gi(t),e===null)throw Error(W(188));return e!==t?null:t}for(var n=t,r=e;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return Oy(s),t;if(i===r)return Oy(s),e;i=i.sibling}throw Error(W(188))}if(n.return!==r.return)n=s,r=i;else{for(var o=!1,a=s.child;a;){if(a===n){o=!0,n=s,r=i;break}if(a===r){o=!0,r=s,n=i;break}a=a.sibling}if(!o){for(a=i.child;a;){if(a===n){o=!0,n=i,r=s;break}if(a===r){o=!0,r=i,n=s;break}a=a.sibling}if(!o)throw Error(W(189))}}if(n.alternate!==r)throw Error(W(190))}if(n.tag!==3)throw Error(W(188));return n.stateNode.current===n?t:e}function vx(t){return t=tN(t),t!==null?_x(t):null}function _x(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=_x(t);if(e!==null)return e;t=t.sibling}return null}var wx=_n.unstable_scheduleCallback,Ly=_n.unstable_cancelCallback,nN=_n.unstable_shouldYield,rN=_n.unstable_requestPaint,ut=_n.unstable_now,sN=_n.unstable_getCurrentPriorityLevel,Ap=_n.unstable_ImmediatePriority,xx=_n.unstable_UserBlockingPriority,Bu=_n.unstable_NormalPriority,iN=_n.unstable_LowPriority,Ex=_n.unstable_IdlePriority,Oc=null,ir=null;function oN(t){if(ir&&typeof ir.onCommitFiberRoot=="function")try{ir.onCommitFiberRoot(Oc,t,void 0,(t.current.flags&128)===128)}catch{}}var qn=Math.clz32?Math.clz32:uN,aN=Math.log,lN=Math.LN2;function uN(t){return t>>>=0,t===0?32:31-(aN(t)/lN|0)|0}var Ql=64,Yl=4194304;function sa(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function zu(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,s=t.suspendedLanes,i=t.pingedLanes,o=n&268435455;if(o!==0){var a=o&~s;a!==0?r=sa(a):(i&=o,i!==0&&(r=sa(i)))}else o=n&~s,o!==0?r=sa(o):i!==0&&(r=sa(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-qn(e),s=1<<n,r|=t[n],e&=~s;return r}function cN(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function dN(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,i=t.pendingLanes;0<i;){var o=31-qn(i),a=1<<o,c=s[o];c===-1?(!(a&n)||a&r)&&(s[o]=cN(a,e)):c<=e&&(t.expiredLanes|=a),i&=~a}}function lf(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function Tx(){var t=Ql;return Ql<<=1,!(Ql&4194240)&&(Ql=64),t}function eh(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function al(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-qn(e),t[e]=n}function hN(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-qn(n),i=1<<s;e[s]=0,r[s]=-1,t[s]=-1,n&=~i}}function Cp(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-qn(n),s=1<<r;s&e|t[r]&e&&(t[r]|=e),n&=~s}}var $e=0;function Sx(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var Ix,Rp,bx,Nx,Ax,uf=!1,Xl=[],cs=null,ds=null,hs=null,ka=new Map,Pa=new Map,Zr=[],fN="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Vy(t,e){switch(t){case"focusin":case"focusout":cs=null;break;case"dragenter":case"dragleave":ds=null;break;case"mouseover":case"mouseout":hs=null;break;case"pointerover":case"pointerout":ka.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Pa.delete(e.pointerId)}}function Qo(t,e,n,r,s,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},e!==null&&(e=ul(e),e!==null&&Rp(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function pN(t,e,n,r,s){switch(e){case"focusin":return cs=Qo(cs,t,e,n,r,s),!0;case"dragenter":return ds=Qo(ds,t,e,n,r,s),!0;case"mouseover":return hs=Qo(hs,t,e,n,r,s),!0;case"pointerover":var i=s.pointerId;return ka.set(i,Qo(ka.get(i)||null,t,e,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,Pa.set(i,Qo(Pa.get(i)||null,t,e,n,r,s)),!0}return!1}function Cx(t){var e=Hs(t.target);if(e!==null){var n=gi(e);if(n!==null){if(e=n.tag,e===13){if(e=yx(n),e!==null){t.blockedOn=e,Ax(t.priority,function(){bx(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function wu(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=cf(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);rf=r,n.target.dispatchEvent(r),rf=null}else return e=ul(n),e!==null&&Rp(e),t.blockedOn=n,!1;e.shift()}return!0}function My(t,e,n){wu(t)&&n.delete(e)}function mN(){uf=!1,cs!==null&&wu(cs)&&(cs=null),ds!==null&&wu(ds)&&(ds=null),hs!==null&&wu(hs)&&(hs=null),ka.forEach(My),Pa.forEach(My)}function Yo(t,e){t.blockedOn===e&&(t.blockedOn=null,uf||(uf=!0,_n.unstable_scheduleCallback(_n.unstable_NormalPriority,mN)))}function ja(t){function e(s){return Yo(s,t)}if(0<Xl.length){Yo(Xl[0],t);for(var n=1;n<Xl.length;n++){var r=Xl[n];r.blockedOn===t&&(r.blockedOn=null)}}for(cs!==null&&Yo(cs,t),ds!==null&&Yo(ds,t),hs!==null&&Yo(hs,t),ka.forEach(e),Pa.forEach(e),n=0;n<Zr.length;n++)r=Zr[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Zr.length&&(n=Zr[0],n.blockedOn===null);)Cx(n),n.blockedOn===null&&Zr.shift()}var Qi=Ur.ReactCurrentBatchConfig,qu=!0;function gN(t,e,n,r){var s=$e,i=Qi.transition;Qi.transition=null;try{$e=1,kp(t,e,n,r)}finally{$e=s,Qi.transition=i}}function yN(t,e,n,r){var s=$e,i=Qi.transition;Qi.transition=null;try{$e=4,kp(t,e,n,r)}finally{$e=s,Qi.transition=i}}function kp(t,e,n,r){if(qu){var s=cf(t,e,n,r);if(s===null)ch(t,e,r,Wu,n),Vy(t,r);else if(pN(s,t,e,n,r))r.stopPropagation();else if(Vy(t,r),e&4&&-1<fN.indexOf(t)){for(;s!==null;){var i=ul(s);if(i!==null&&Ix(i),i=cf(t,e,n,r),i===null&&ch(t,e,r,Wu,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else ch(t,e,r,null,n)}}var Wu=null;function cf(t,e,n,r){if(Wu=null,t=Np(r),t=Hs(t),t!==null)if(e=gi(t),e===null)t=null;else if(n=e.tag,n===13){if(t=yx(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Wu=t,null}function Rx(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(sN()){case Ap:return 1;case xx:return 4;case Bu:case iN:return 16;case Ex:return 536870912;default:return 16}default:return 16}}var os=null,Pp=null,xu=null;function kx(){if(xu)return xu;var t,e=Pp,n=e.length,r,s="value"in os?os.value:os.textContent,i=s.length;for(t=0;t<n&&e[t]===s[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===s[i-r];r++);return xu=s.slice(t,1<r?1-r:void 0)}function Eu(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Jl(){return!0}function Uy(){return!1}function Tn(t){function e(n,r,s,i,o){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(i):i[a]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Jl:Uy,this.isPropagationStopped=Uy,this}return nt(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Jl)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Jl)},persist:function(){},isPersistent:Jl}),e}var xo={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},jp=Tn(xo),ll=nt({},xo,{view:0,detail:0}),vN=Tn(ll),th,nh,Xo,Lc=nt({},ll,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Dp,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Xo&&(Xo&&t.type==="mousemove"?(th=t.screenX-Xo.screenX,nh=t.screenY-Xo.screenY):nh=th=0,Xo=t),th)},movementY:function(t){return"movementY"in t?t.movementY:nh}}),Fy=Tn(Lc),_N=nt({},Lc,{dataTransfer:0}),wN=Tn(_N),xN=nt({},ll,{relatedTarget:0}),rh=Tn(xN),EN=nt({},xo,{animationName:0,elapsedTime:0,pseudoElement:0}),TN=Tn(EN),SN=nt({},xo,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),IN=Tn(SN),bN=nt({},xo,{data:0}),$y=Tn(bN),NN={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},AN={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},CN={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function RN(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=CN[t])?!!e[t]:!1}function Dp(){return RN}var kN=nt({},ll,{key:function(t){if(t.key){var e=NN[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Eu(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?AN[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Dp,charCode:function(t){return t.type==="keypress"?Eu(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Eu(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),PN=Tn(kN),jN=nt({},Lc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),By=Tn(jN),DN=nt({},ll,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Dp}),ON=Tn(DN),LN=nt({},xo,{propertyName:0,elapsedTime:0,pseudoElement:0}),VN=Tn(LN),MN=nt({},Lc,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),UN=Tn(MN),FN=[9,13,27,32],Op=kr&&"CompositionEvent"in window,fa=null;kr&&"documentMode"in document&&(fa=document.documentMode);var $N=kr&&"TextEvent"in window&&!fa,Px=kr&&(!Op||fa&&8<fa&&11>=fa),zy=" ",qy=!1;function jx(t,e){switch(t){case"keyup":return FN.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Dx(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Di=!1;function BN(t,e){switch(t){case"compositionend":return Dx(e);case"keypress":return e.which!==32?null:(qy=!0,zy);case"textInput":return t=e.data,t===zy&&qy?null:t;default:return null}}function zN(t,e){if(Di)return t==="compositionend"||!Op&&jx(t,e)?(t=kx(),xu=Pp=os=null,Di=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Px&&e.locale!=="ko"?null:e.data;default:return null}}var qN={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Wy(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!qN[t.type]:e==="textarea"}function Ox(t,e,n,r){hx(r),e=Hu(e,"onChange"),0<e.length&&(n=new jp("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var pa=null,Da=null;function WN(t){Hx(t,0)}function Vc(t){var e=Vi(t);if(ix(e))return t}function HN(t,e){if(t==="change")return e}var Lx=!1;if(kr){var sh;if(kr){var ih="oninput"in document;if(!ih){var Hy=document.createElement("div");Hy.setAttribute("oninput","return;"),ih=typeof Hy.oninput=="function"}sh=ih}else sh=!1;Lx=sh&&(!document.documentMode||9<document.documentMode)}function Gy(){pa&&(pa.detachEvent("onpropertychange",Vx),Da=pa=null)}function Vx(t){if(t.propertyName==="value"&&Vc(Da)){var e=[];Ox(e,Da,t,Np(t)),gx(WN,e)}}function GN(t,e,n){t==="focusin"?(Gy(),pa=e,Da=n,pa.attachEvent("onpropertychange",Vx)):t==="focusout"&&Gy()}function KN(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Vc(Da)}function QN(t,e){if(t==="click")return Vc(e)}function YN(t,e){if(t==="input"||t==="change")return Vc(e)}function XN(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Qn=typeof Object.is=="function"?Object.is:XN;function Oa(t,e){if(Qn(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!Wh.call(e,s)||!Qn(t[s],e[s]))return!1}return!0}function Ky(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Qy(t,e){var n=Ky(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Ky(n)}}function Mx(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?Mx(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function Ux(){for(var t=window,e=Uu();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Uu(t.document)}return e}function Lp(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function JN(t){var e=Ux(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&Mx(n.ownerDocument.documentElement,n)){if(r!==null&&Lp(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!t.extend&&i>r&&(s=r,r=i,i=s),s=Qy(n,i);var o=Qy(n,r);s&&o&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),i>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var ZN=kr&&"documentMode"in document&&11>=document.documentMode,Oi=null,df=null,ma=null,hf=!1;function Yy(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;hf||Oi==null||Oi!==Uu(r)||(r=Oi,"selectionStart"in r&&Lp(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),ma&&Oa(ma,r)||(ma=r,r=Hu(df,"onSelect"),0<r.length&&(e=new jp("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Oi)))}function Zl(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Li={animationend:Zl("Animation","AnimationEnd"),animationiteration:Zl("Animation","AnimationIteration"),animationstart:Zl("Animation","AnimationStart"),transitionend:Zl("Transition","TransitionEnd")},oh={},Fx={};kr&&(Fx=document.createElement("div").style,"AnimationEvent"in window||(delete Li.animationend.animation,delete Li.animationiteration.animation,delete Li.animationstart.animation),"TransitionEvent"in window||delete Li.transitionend.transition);function Mc(t){if(oh[t])return oh[t];if(!Li[t])return t;var e=Li[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in Fx)return oh[t]=e[n];return t}var $x=Mc("animationend"),Bx=Mc("animationiteration"),zx=Mc("animationstart"),qx=Mc("transitionend"),Wx=new Map,Xy="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ks(t,e){Wx.set(t,e),mi(e,[t])}for(var ah=0;ah<Xy.length;ah++){var lh=Xy[ah],eA=lh.toLowerCase(),tA=lh[0].toUpperCase()+lh.slice(1);ks(eA,"on"+tA)}ks($x,"onAnimationEnd");ks(Bx,"onAnimationIteration");ks(zx,"onAnimationStart");ks("dblclick","onDoubleClick");ks("focusin","onFocus");ks("focusout","onBlur");ks(qx,"onTransitionEnd");no("onMouseEnter",["mouseout","mouseover"]);no("onMouseLeave",["mouseout","mouseover"]);no("onPointerEnter",["pointerout","pointerover"]);no("onPointerLeave",["pointerout","pointerover"]);mi("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));mi("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));mi("onBeforeInput",["compositionend","keypress","textInput","paste"]);mi("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));mi("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));mi("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ia="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),nA=new Set("cancel close invalid load scroll toggle".split(" ").concat(ia));function Jy(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,eN(r,e,void 0,t),t.currentTarget=null}function Hx(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],s=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var o=r.length-1;0<=o;o--){var a=r[o],c=a.instance,d=a.currentTarget;if(a=a.listener,c!==i&&s.isPropagationStopped())break e;Jy(s,a,d),i=c}else for(o=0;o<r.length;o++){if(a=r[o],c=a.instance,d=a.currentTarget,a=a.listener,c!==i&&s.isPropagationStopped())break e;Jy(s,a,d),i=c}}}if($u)throw t=af,$u=!1,af=null,t}function Qe(t,e){var n=e[yf];n===void 0&&(n=e[yf]=new Set);var r=t+"__bubble";n.has(r)||(Gx(e,t,2,!1),n.add(r))}function uh(t,e,n){var r=0;e&&(r|=4),Gx(n,t,r,e)}var eu="_reactListening"+Math.random().toString(36).slice(2);function La(t){if(!t[eu]){t[eu]=!0,ex.forEach(function(n){n!=="selectionchange"&&(nA.has(n)||uh(n,!1,t),uh(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[eu]||(e[eu]=!0,uh("selectionchange",!1,e))}}function Gx(t,e,n,r){switch(Rx(e)){case 1:var s=gN;break;case 4:s=yN;break;default:s=kp}n=s.bind(null,e,n,t),s=void 0,!of||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(e,n,{capture:!0,passive:s}):t.addEventListener(e,n,!0):s!==void 0?t.addEventListener(e,n,{passive:s}):t.addEventListener(e,n,!1)}function ch(t,e,n,r,s){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var a=r.stateNode.containerInfo;if(a===s||a.nodeType===8&&a.parentNode===s)break;if(o===4)for(o=r.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===s||c.nodeType===8&&c.parentNode===s))return;o=o.return}for(;a!==null;){if(o=Hs(a),o===null)return;if(c=o.tag,c===5||c===6){r=i=o;continue e}a=a.parentNode}}r=r.return}gx(function(){var d=i,h=Np(n),p=[];e:{var m=Wx.get(t);if(m!==void 0){var y=jp,T=t;switch(t){case"keypress":if(Eu(n)===0)break e;case"keydown":case"keyup":y=PN;break;case"focusin":T="focus",y=rh;break;case"focusout":T="blur",y=rh;break;case"beforeblur":case"afterblur":y=rh;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":y=Fy;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":y=wN;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":y=ON;break;case $x:case Bx:case zx:y=TN;break;case qx:y=VN;break;case"scroll":y=vN;break;case"wheel":y=UN;break;case"copy":case"cut":case"paste":y=IN;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":y=By}var b=(e&4)!==0,I=!b&&t==="scroll",v=b?m!==null?m+"Capture":null:m;b=[];for(var w=d,_;w!==null;){_=w;var E=_.stateNode;if(_.tag===5&&E!==null&&(_=E,v!==null&&(E=Ra(w,v),E!=null&&b.push(Va(w,E,_)))),I)break;w=w.return}0<b.length&&(m=new y(m,T,null,n,h),p.push({event:m,listeners:b}))}}if(!(e&7)){e:{if(m=t==="mouseover"||t==="pointerover",y=t==="mouseout"||t==="pointerout",m&&n!==rf&&(T=n.relatedTarget||n.fromElement)&&(Hs(T)||T[Pr]))break e;if((y||m)&&(m=h.window===h?h:(m=h.ownerDocument)?m.defaultView||m.parentWindow:window,y?(T=n.relatedTarget||n.toElement,y=d,T=T?Hs(T):null,T!==null&&(I=gi(T),T!==I||T.tag!==5&&T.tag!==6)&&(T=null)):(y=null,T=d),y!==T)){if(b=Fy,E="onMouseLeave",v="onMouseEnter",w="mouse",(t==="pointerout"||t==="pointerover")&&(b=By,E="onPointerLeave",v="onPointerEnter",w="pointer"),I=y==null?m:Vi(y),_=T==null?m:Vi(T),m=new b(E,w+"leave",y,n,h),m.target=I,m.relatedTarget=_,E=null,Hs(h)===d&&(b=new b(v,w+"enter",T,n,h),b.target=_,b.relatedTarget=I,E=b),I=E,y&&T)t:{for(b=y,v=T,w=0,_=b;_;_=Ai(_))w++;for(_=0,E=v;E;E=Ai(E))_++;for(;0<w-_;)b=Ai(b),w--;for(;0<_-w;)v=Ai(v),_--;for(;w--;){if(b===v||v!==null&&b===v.alternate)break t;b=Ai(b),v=Ai(v)}b=null}else b=null;y!==null&&Zy(p,m,y,b,!1),T!==null&&I!==null&&Zy(p,I,T,b,!0)}}e:{if(m=d?Vi(d):window,y=m.nodeName&&m.nodeName.toLowerCase(),y==="select"||y==="input"&&m.type==="file")var j=HN;else if(Wy(m))if(Lx)j=YN;else{j=KN;var O=GN}else(y=m.nodeName)&&y.toLowerCase()==="input"&&(m.type==="checkbox"||m.type==="radio")&&(j=QN);if(j&&(j=j(t,d))){Ox(p,j,n,h);break e}O&&O(t,m,d),t==="focusout"&&(O=m._wrapperState)&&O.controlled&&m.type==="number"&&Jh(m,"number",m.value)}switch(O=d?Vi(d):window,t){case"focusin":(Wy(O)||O.contentEditable==="true")&&(Oi=O,df=d,ma=null);break;case"focusout":ma=df=Oi=null;break;case"mousedown":hf=!0;break;case"contextmenu":case"mouseup":case"dragend":hf=!1,Yy(p,n,h);break;case"selectionchange":if(ZN)break;case"keydown":case"keyup":Yy(p,n,h)}var S;if(Op)e:{switch(t){case"compositionstart":var x="onCompositionStart";break e;case"compositionend":x="onCompositionEnd";break e;case"compositionupdate":x="onCompositionUpdate";break e}x=void 0}else Di?jx(t,n)&&(x="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(x="onCompositionStart");x&&(Px&&n.locale!=="ko"&&(Di||x!=="onCompositionStart"?x==="onCompositionEnd"&&Di&&(S=kx()):(os=h,Pp="value"in os?os.value:os.textContent,Di=!0)),O=Hu(d,x),0<O.length&&(x=new $y(x,t,null,n,h),p.push({event:x,listeners:O}),S?x.data=S:(S=Dx(n),S!==null&&(x.data=S)))),(S=$N?BN(t,n):zN(t,n))&&(d=Hu(d,"onBeforeInput"),0<d.length&&(h=new $y("onBeforeInput","beforeinput",null,n,h),p.push({event:h,listeners:d}),h.data=S))}Hx(p,e)})}function Va(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Hu(t,e){for(var n=e+"Capture",r=[];t!==null;){var s=t,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=Ra(t,n),i!=null&&r.unshift(Va(t,i,s)),i=Ra(t,e),i!=null&&r.push(Va(t,i,s))),t=t.return}return r}function Ai(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Zy(t,e,n,r,s){for(var i=e._reactName,o=[];n!==null&&n!==r;){var a=n,c=a.alternate,d=a.stateNode;if(c!==null&&c===r)break;a.tag===5&&d!==null&&(a=d,s?(c=Ra(n,i),c!=null&&o.unshift(Va(n,c,a))):s||(c=Ra(n,i),c!=null&&o.push(Va(n,c,a)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var rA=/\r\n?/g,sA=/\u0000|\uFFFD/g;function ev(t){return(typeof t=="string"?t:""+t).replace(rA,`
`).replace(sA,"")}function tu(t,e,n){if(e=ev(e),ev(t)!==e&&n)throw Error(W(425))}function Gu(){}var ff=null,pf=null;function mf(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var gf=typeof setTimeout=="function"?setTimeout:void 0,iA=typeof clearTimeout=="function"?clearTimeout:void 0,tv=typeof Promise=="function"?Promise:void 0,oA=typeof queueMicrotask=="function"?queueMicrotask:typeof tv<"u"?function(t){return tv.resolve(null).then(t).catch(aA)}:gf;function aA(t){setTimeout(function(){throw t})}function dh(t,e){var n=e,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){t.removeChild(s),ja(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);ja(e)}function fs(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function nv(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Eo=Math.random().toString(36).slice(2),rr="__reactFiber$"+Eo,Ma="__reactProps$"+Eo,Pr="__reactContainer$"+Eo,yf="__reactEvents$"+Eo,lA="__reactListeners$"+Eo,uA="__reactHandles$"+Eo;function Hs(t){var e=t[rr];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Pr]||n[rr]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=nv(t);t!==null;){if(n=t[rr])return n;t=nv(t)}return e}t=n,n=t.parentNode}return null}function ul(t){return t=t[rr]||t[Pr],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Vi(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(W(33))}function Uc(t){return t[Ma]||null}var vf=[],Mi=-1;function Ps(t){return{current:t}}function Ye(t){0>Mi||(t.current=vf[Mi],vf[Mi]=null,Mi--)}function He(t,e){Mi++,vf[Mi]=t.current,t.current=e}var Ss={},zt=Ps(Ss),un=Ps(!1),ti=Ss;function ro(t,e){var n=t.type.contextTypes;if(!n)return Ss;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=e[i];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function cn(t){return t=t.childContextTypes,t!=null}function Ku(){Ye(un),Ye(zt)}function rv(t,e,n){if(zt.current!==Ss)throw Error(W(168));He(zt,e),He(un,n)}function Kx(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(W(108,Gb(t)||"Unknown",s));return nt({},n,r)}function Qu(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Ss,ti=zt.current,He(zt,t),He(un,un.current),!0}function sv(t,e,n){var r=t.stateNode;if(!r)throw Error(W(169));n?(t=Kx(t,e,ti),r.__reactInternalMemoizedMergedChildContext=t,Ye(un),Ye(zt),He(zt,t)):Ye(un),He(un,n)}var xr=null,Fc=!1,hh=!1;function Qx(t){xr===null?xr=[t]:xr.push(t)}function cA(t){Fc=!0,Qx(t)}function js(){if(!hh&&xr!==null){hh=!0;var t=0,e=$e;try{var n=xr;for($e=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}xr=null,Fc=!1}catch(s){throw xr!==null&&(xr=xr.slice(t+1)),wx(Ap,js),s}finally{$e=e,hh=!1}}return null}var Ui=[],Fi=0,Yu=null,Xu=0,Sn=[],In=0,ni=null,Er=1,Tr="";function zs(t,e){Ui[Fi++]=Xu,Ui[Fi++]=Yu,Yu=t,Xu=e}function Yx(t,e,n){Sn[In++]=Er,Sn[In++]=Tr,Sn[In++]=ni,ni=t;var r=Er;t=Tr;var s=32-qn(r)-1;r&=~(1<<s),n+=1;var i=32-qn(e)+s;if(30<i){var o=s-s%5;i=(r&(1<<o)-1).toString(32),r>>=o,s-=o,Er=1<<32-qn(e)+s|n<<s|r,Tr=i+t}else Er=1<<i|n<<s|r,Tr=t}function Vp(t){t.return!==null&&(zs(t,1),Yx(t,1,0))}function Mp(t){for(;t===Yu;)Yu=Ui[--Fi],Ui[Fi]=null,Xu=Ui[--Fi],Ui[Fi]=null;for(;t===ni;)ni=Sn[--In],Sn[In]=null,Tr=Sn[--In],Sn[In]=null,Er=Sn[--In],Sn[In]=null}var vn=null,mn=null,Xe=!1,Bn=null;function Xx(t,e){var n=Nn(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function iv(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,vn=t,mn=fs(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,vn=t,mn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=ni!==null?{id:Er,overflow:Tr}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Nn(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,vn=t,mn=null,!0):!1;default:return!1}}function _f(t){return(t.mode&1)!==0&&(t.flags&128)===0}function wf(t){if(Xe){var e=mn;if(e){var n=e;if(!iv(t,e)){if(_f(t))throw Error(W(418));e=fs(n.nextSibling);var r=vn;e&&iv(t,e)?Xx(r,n):(t.flags=t.flags&-4097|2,Xe=!1,vn=t)}}else{if(_f(t))throw Error(W(418));t.flags=t.flags&-4097|2,Xe=!1,vn=t}}}function ov(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;vn=t}function nu(t){if(t!==vn)return!1;if(!Xe)return ov(t),Xe=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!mf(t.type,t.memoizedProps)),e&&(e=mn)){if(_f(t))throw Jx(),Error(W(418));for(;e;)Xx(t,e),e=fs(e.nextSibling)}if(ov(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(W(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){mn=fs(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}mn=null}}else mn=vn?fs(t.stateNode.nextSibling):null;return!0}function Jx(){for(var t=mn;t;)t=fs(t.nextSibling)}function so(){mn=vn=null,Xe=!1}function Up(t){Bn===null?Bn=[t]:Bn.push(t)}var dA=Ur.ReactCurrentBatchConfig;function Jo(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(W(309));var r=n.stateNode}if(!r)throw Error(W(147,t));var s=r,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var a=s.refs;o===null?delete a[i]:a[i]=o},e._stringRef=i,e)}if(typeof t!="string")throw Error(W(284));if(!n._owner)throw Error(W(290,t))}return t}function ru(t,e){throw t=Object.prototype.toString.call(e),Error(W(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function av(t){var e=t._init;return e(t._payload)}function Zx(t){function e(v,w){if(t){var _=v.deletions;_===null?(v.deletions=[w],v.flags|=16):_.push(w)}}function n(v,w){if(!t)return null;for(;w!==null;)e(v,w),w=w.sibling;return null}function r(v,w){for(v=new Map;w!==null;)w.key!==null?v.set(w.key,w):v.set(w.index,w),w=w.sibling;return v}function s(v,w){return v=ys(v,w),v.index=0,v.sibling=null,v}function i(v,w,_){return v.index=_,t?(_=v.alternate,_!==null?(_=_.index,_<w?(v.flags|=2,w):_):(v.flags|=2,w)):(v.flags|=1048576,w)}function o(v){return t&&v.alternate===null&&(v.flags|=2),v}function a(v,w,_,E){return w===null||w.tag!==6?(w=_h(_,v.mode,E),w.return=v,w):(w=s(w,_),w.return=v,w)}function c(v,w,_,E){var j=_.type;return j===ji?h(v,w,_.props.children,E,_.key):w!==null&&(w.elementType===j||typeof j=="object"&&j!==null&&j.$$typeof===Xr&&av(j)===w.type)?(E=s(w,_.props),E.ref=Jo(v,w,_),E.return=v,E):(E=Cu(_.type,_.key,_.props,null,v.mode,E),E.ref=Jo(v,w,_),E.return=v,E)}function d(v,w,_,E){return w===null||w.tag!==4||w.stateNode.containerInfo!==_.containerInfo||w.stateNode.implementation!==_.implementation?(w=wh(_,v.mode,E),w.return=v,w):(w=s(w,_.children||[]),w.return=v,w)}function h(v,w,_,E,j){return w===null||w.tag!==7?(w=Zs(_,v.mode,E,j),w.return=v,w):(w=s(w,_),w.return=v,w)}function p(v,w,_){if(typeof w=="string"&&w!==""||typeof w=="number")return w=_h(""+w,v.mode,_),w.return=v,w;if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Hl:return _=Cu(w.type,w.key,w.props,null,v.mode,_),_.ref=Jo(v,null,w),_.return=v,_;case Pi:return w=wh(w,v.mode,_),w.return=v,w;case Xr:var E=w._init;return p(v,E(w._payload),_)}if(ra(w)||Go(w))return w=Zs(w,v.mode,_,null),w.return=v,w;ru(v,w)}return null}function m(v,w,_,E){var j=w!==null?w.key:null;if(typeof _=="string"&&_!==""||typeof _=="number")return j!==null?null:a(v,w,""+_,E);if(typeof _=="object"&&_!==null){switch(_.$$typeof){case Hl:return _.key===j?c(v,w,_,E):null;case Pi:return _.key===j?d(v,w,_,E):null;case Xr:return j=_._init,m(v,w,j(_._payload),E)}if(ra(_)||Go(_))return j!==null?null:h(v,w,_,E,null);ru(v,_)}return null}function y(v,w,_,E,j){if(typeof E=="string"&&E!==""||typeof E=="number")return v=v.get(_)||null,a(w,v,""+E,j);if(typeof E=="object"&&E!==null){switch(E.$$typeof){case Hl:return v=v.get(E.key===null?_:E.key)||null,c(w,v,E,j);case Pi:return v=v.get(E.key===null?_:E.key)||null,d(w,v,E,j);case Xr:var O=E._init;return y(v,w,_,O(E._payload),j)}if(ra(E)||Go(E))return v=v.get(_)||null,h(w,v,E,j,null);ru(w,E)}return null}function T(v,w,_,E){for(var j=null,O=null,S=w,x=w=0,N=null;S!==null&&x<_.length;x++){S.index>x?(N=S,S=null):N=S.sibling;var k=m(v,S,_[x],E);if(k===null){S===null&&(S=N);break}t&&S&&k.alternate===null&&e(v,S),w=i(k,w,x),O===null?j=k:O.sibling=k,O=k,S=N}if(x===_.length)return n(v,S),Xe&&zs(v,x),j;if(S===null){for(;x<_.length;x++)S=p(v,_[x],E),S!==null&&(w=i(S,w,x),O===null?j=S:O.sibling=S,O=S);return Xe&&zs(v,x),j}for(S=r(v,S);x<_.length;x++)N=y(S,v,x,_[x],E),N!==null&&(t&&N.alternate!==null&&S.delete(N.key===null?x:N.key),w=i(N,w,x),O===null?j=N:O.sibling=N,O=N);return t&&S.forEach(function(P){return e(v,P)}),Xe&&zs(v,x),j}function b(v,w,_,E){var j=Go(_);if(typeof j!="function")throw Error(W(150));if(_=j.call(_),_==null)throw Error(W(151));for(var O=j=null,S=w,x=w=0,N=null,k=_.next();S!==null&&!k.done;x++,k=_.next()){S.index>x?(N=S,S=null):N=S.sibling;var P=m(v,S,k.value,E);if(P===null){S===null&&(S=N);break}t&&S&&P.alternate===null&&e(v,S),w=i(P,w,x),O===null?j=P:O.sibling=P,O=P,S=N}if(k.done)return n(v,S),Xe&&zs(v,x),j;if(S===null){for(;!k.done;x++,k=_.next())k=p(v,k.value,E),k!==null&&(w=i(k,w,x),O===null?j=k:O.sibling=k,O=k);return Xe&&zs(v,x),j}for(S=r(v,S);!k.done;x++,k=_.next())k=y(S,v,x,k.value,E),k!==null&&(t&&k.alternate!==null&&S.delete(k.key===null?x:k.key),w=i(k,w,x),O===null?j=k:O.sibling=k,O=k);return t&&S.forEach(function(D){return e(v,D)}),Xe&&zs(v,x),j}function I(v,w,_,E){if(typeof _=="object"&&_!==null&&_.type===ji&&_.key===null&&(_=_.props.children),typeof _=="object"&&_!==null){switch(_.$$typeof){case Hl:e:{for(var j=_.key,O=w;O!==null;){if(O.key===j){if(j=_.type,j===ji){if(O.tag===7){n(v,O.sibling),w=s(O,_.props.children),w.return=v,v=w;break e}}else if(O.elementType===j||typeof j=="object"&&j!==null&&j.$$typeof===Xr&&av(j)===O.type){n(v,O.sibling),w=s(O,_.props),w.ref=Jo(v,O,_),w.return=v,v=w;break e}n(v,O);break}else e(v,O);O=O.sibling}_.type===ji?(w=Zs(_.props.children,v.mode,E,_.key),w.return=v,v=w):(E=Cu(_.type,_.key,_.props,null,v.mode,E),E.ref=Jo(v,w,_),E.return=v,v=E)}return o(v);case Pi:e:{for(O=_.key;w!==null;){if(w.key===O)if(w.tag===4&&w.stateNode.containerInfo===_.containerInfo&&w.stateNode.implementation===_.implementation){n(v,w.sibling),w=s(w,_.children||[]),w.return=v,v=w;break e}else{n(v,w);break}else e(v,w);w=w.sibling}w=wh(_,v.mode,E),w.return=v,v=w}return o(v);case Xr:return O=_._init,I(v,w,O(_._payload),E)}if(ra(_))return T(v,w,_,E);if(Go(_))return b(v,w,_,E);ru(v,_)}return typeof _=="string"&&_!==""||typeof _=="number"?(_=""+_,w!==null&&w.tag===6?(n(v,w.sibling),w=s(w,_),w.return=v,v=w):(n(v,w),w=_h(_,v.mode,E),w.return=v,v=w),o(v)):n(v,w)}return I}var io=Zx(!0),eE=Zx(!1),Ju=Ps(null),Zu=null,$i=null,Fp=null;function $p(){Fp=$i=Zu=null}function Bp(t){var e=Ju.current;Ye(Ju),t._currentValue=e}function xf(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Yi(t,e){Zu=t,Fp=$i=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(an=!0),t.firstContext=null)}function Rn(t){var e=t._currentValue;if(Fp!==t)if(t={context:t,memoizedValue:e,next:null},$i===null){if(Zu===null)throw Error(W(308));$i=t,Zu.dependencies={lanes:0,firstContext:t}}else $i=$i.next=t;return e}var Gs=null;function zp(t){Gs===null?Gs=[t]:Gs.push(t)}function tE(t,e,n,r){var s=e.interleaved;return s===null?(n.next=n,zp(e)):(n.next=s.next,s.next=n),e.interleaved=n,jr(t,r)}function jr(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Jr=!1;function qp(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function nE(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function br(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function ps(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,Oe&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,jr(t,n)}return s=r.interleaved,s===null?(e.next=e,zp(r)):(e.next=s.next,s.next=e),r.interleaved=e,jr(t,n)}function Tu(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Cp(t,n)}}function lv(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=o:i=i.next=o,n=n.next}while(n!==null);i===null?s=i=e:i=i.next=e}else s=i=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function ec(t,e,n,r){var s=t.updateQueue;Jr=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,a=s.shared.pending;if(a!==null){s.shared.pending=null;var c=a,d=c.next;c.next=null,o===null?i=d:o.next=d,o=c;var h=t.alternate;h!==null&&(h=h.updateQueue,a=h.lastBaseUpdate,a!==o&&(a===null?h.firstBaseUpdate=d:a.next=d,h.lastBaseUpdate=c))}if(i!==null){var p=s.baseState;o=0,h=d=c=null,a=i;do{var m=a.lane,y=a.eventTime;if((r&m)===m){h!==null&&(h=h.next={eventTime:y,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var T=t,b=a;switch(m=e,y=n,b.tag){case 1:if(T=b.payload,typeof T=="function"){p=T.call(y,p,m);break e}p=T;break e;case 3:T.flags=T.flags&-65537|128;case 0:if(T=b.payload,m=typeof T=="function"?T.call(y,p,m):T,m==null)break e;p=nt({},p,m);break e;case 2:Jr=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,m=s.effects,m===null?s.effects=[a]:m.push(a))}else y={eventTime:y,lane:m,tag:a.tag,payload:a.payload,callback:a.callback,next:null},h===null?(d=h=y,c=p):h=h.next=y,o|=m;if(a=a.next,a===null){if(a=s.shared.pending,a===null)break;m=a,a=m.next,m.next=null,s.lastBaseUpdate=m,s.shared.pending=null}}while(!0);if(h===null&&(c=p),s.baseState=c,s.firstBaseUpdate=d,s.lastBaseUpdate=h,e=s.shared.interleaved,e!==null){s=e;do o|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);si|=o,t.lanes=o,t.memoizedState=p}}function uv(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(W(191,s));s.call(r)}}}var cl={},or=Ps(cl),Ua=Ps(cl),Fa=Ps(cl);function Ks(t){if(t===cl)throw Error(W(174));return t}function Wp(t,e){switch(He(Fa,e),He(Ua,t),He(or,cl),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:ef(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=ef(e,t)}Ye(or),He(or,e)}function oo(){Ye(or),Ye(Ua),Ye(Fa)}function rE(t){Ks(Fa.current);var e=Ks(or.current),n=ef(e,t.type);e!==n&&(He(Ua,t),He(or,n))}function Hp(t){Ua.current===t&&(Ye(or),Ye(Ua))}var Je=Ps(0);function tc(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var fh=[];function Gp(){for(var t=0;t<fh.length;t++)fh[t]._workInProgressVersionPrimary=null;fh.length=0}var Su=Ur.ReactCurrentDispatcher,ph=Ur.ReactCurrentBatchConfig,ri=0,et=null,yt=null,xt=null,nc=!1,ga=!1,$a=0,hA=0;function Ot(){throw Error(W(321))}function Kp(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Qn(t[n],e[n]))return!1;return!0}function Qp(t,e,n,r,s,i){if(ri=i,et=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Su.current=t===null||t.memoizedState===null?gA:yA,t=n(r,s),ga){i=0;do{if(ga=!1,$a=0,25<=i)throw Error(W(301));i+=1,xt=yt=null,e.updateQueue=null,Su.current=vA,t=n(r,s)}while(ga)}if(Su.current=rc,e=yt!==null&&yt.next!==null,ri=0,xt=yt=et=null,nc=!1,e)throw Error(W(300));return t}function Yp(){var t=$a!==0;return $a=0,t}function tr(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return xt===null?et.memoizedState=xt=t:xt=xt.next=t,xt}function kn(){if(yt===null){var t=et.alternate;t=t!==null?t.memoizedState:null}else t=yt.next;var e=xt===null?et.memoizedState:xt.next;if(e!==null)xt=e,yt=t;else{if(t===null)throw Error(W(310));yt=t,t={memoizedState:yt.memoizedState,baseState:yt.baseState,baseQueue:yt.baseQueue,queue:yt.queue,next:null},xt===null?et.memoizedState=xt=t:xt=xt.next=t}return xt}function Ba(t,e){return typeof e=="function"?e(t):e}function mh(t){var e=kn(),n=e.queue;if(n===null)throw Error(W(311));n.lastRenderedReducer=t;var r=yt,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var a=o=null,c=null,d=i;do{var h=d.lane;if((ri&h)===h)c!==null&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),r=d.hasEagerState?d.eagerState:t(r,d.action);else{var p={lane:h,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};c===null?(a=c=p,o=r):c=c.next=p,et.lanes|=h,si|=h}d=d.next}while(d!==null&&d!==i);c===null?o=r:c.next=a,Qn(r,e.memoizedState)||(an=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=c,n.lastRenderedState=r}if(t=n.interleaved,t!==null){s=t;do i=s.lane,et.lanes|=i,si|=i,s=s.next;while(s!==t)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function gh(t){var e=kn(),n=e.queue;if(n===null)throw Error(W(311));n.lastRenderedReducer=t;var r=n.dispatch,s=n.pending,i=e.memoizedState;if(s!==null){n.pending=null;var o=s=s.next;do i=t(i,o.action),o=o.next;while(o!==s);Qn(i,e.memoizedState)||(an=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,r]}function sE(){}function iE(t,e){var n=et,r=kn(),s=e(),i=!Qn(r.memoizedState,s);if(i&&(r.memoizedState=s,an=!0),r=r.queue,Xp(lE.bind(null,n,r,t),[t]),r.getSnapshot!==e||i||xt!==null&&xt.memoizedState.tag&1){if(n.flags|=2048,za(9,aE.bind(null,n,r,s,e),void 0,null),Tt===null)throw Error(W(349));ri&30||oE(n,e,s)}return s}function oE(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=et.updateQueue,e===null?(e={lastEffect:null,stores:null},et.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function aE(t,e,n,r){e.value=n,e.getSnapshot=r,uE(e)&&cE(t)}function lE(t,e,n){return n(function(){uE(e)&&cE(t)})}function uE(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Qn(t,n)}catch{return!0}}function cE(t){var e=jr(t,1);e!==null&&Wn(e,t,1,-1)}function cv(t){var e=tr();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ba,lastRenderedState:t},e.queue=t,t=t.dispatch=mA.bind(null,et,t),[e.memoizedState,t]}function za(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=et.updateQueue,e===null?(e={lastEffect:null,stores:null},et.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function dE(){return kn().memoizedState}function Iu(t,e,n,r){var s=tr();et.flags|=t,s.memoizedState=za(1|e,n,void 0,r===void 0?null:r)}function $c(t,e,n,r){var s=kn();r=r===void 0?null:r;var i=void 0;if(yt!==null){var o=yt.memoizedState;if(i=o.destroy,r!==null&&Kp(r,o.deps)){s.memoizedState=za(e,n,i,r);return}}et.flags|=t,s.memoizedState=za(1|e,n,i,r)}function dv(t,e){return Iu(8390656,8,t,e)}function Xp(t,e){return $c(2048,8,t,e)}function hE(t,e){return $c(4,2,t,e)}function fE(t,e){return $c(4,4,t,e)}function pE(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function mE(t,e,n){return n=n!=null?n.concat([t]):null,$c(4,4,pE.bind(null,e,t),n)}function Jp(){}function gE(t,e){var n=kn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Kp(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function yE(t,e){var n=kn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Kp(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function vE(t,e,n){return ri&21?(Qn(n,e)||(n=Tx(),et.lanes|=n,si|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,an=!0),t.memoizedState=n)}function fA(t,e){var n=$e;$e=n!==0&&4>n?n:4,t(!0);var r=ph.transition;ph.transition={};try{t(!1),e()}finally{$e=n,ph.transition=r}}function _E(){return kn().memoizedState}function pA(t,e,n){var r=gs(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},wE(t))xE(e,n);else if(n=tE(t,e,n,r),n!==null){var s=Jt();Wn(n,t,r,s),EE(n,e,r)}}function mA(t,e,n){var r=gs(t),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(wE(t))xE(e,s);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,a=i(o,n);if(s.hasEagerState=!0,s.eagerState=a,Qn(a,o)){var c=e.interleaved;c===null?(s.next=s,zp(e)):(s.next=c.next,c.next=s),e.interleaved=s;return}}catch{}finally{}n=tE(t,e,s,r),n!==null&&(s=Jt(),Wn(n,t,r,s),EE(n,e,r))}}function wE(t){var e=t.alternate;return t===et||e!==null&&e===et}function xE(t,e){ga=nc=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function EE(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Cp(t,n)}}var rc={readContext:Rn,useCallback:Ot,useContext:Ot,useEffect:Ot,useImperativeHandle:Ot,useInsertionEffect:Ot,useLayoutEffect:Ot,useMemo:Ot,useReducer:Ot,useRef:Ot,useState:Ot,useDebugValue:Ot,useDeferredValue:Ot,useTransition:Ot,useMutableSource:Ot,useSyncExternalStore:Ot,useId:Ot,unstable_isNewReconciler:!1},gA={readContext:Rn,useCallback:function(t,e){return tr().memoizedState=[t,e===void 0?null:e],t},useContext:Rn,useEffect:dv,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Iu(4194308,4,pE.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Iu(4194308,4,t,e)},useInsertionEffect:function(t,e){return Iu(4,2,t,e)},useMemo:function(t,e){var n=tr();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=tr();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=pA.bind(null,et,t),[r.memoizedState,t]},useRef:function(t){var e=tr();return t={current:t},e.memoizedState=t},useState:cv,useDebugValue:Jp,useDeferredValue:function(t){return tr().memoizedState=t},useTransition:function(){var t=cv(!1),e=t[0];return t=fA.bind(null,t[1]),tr().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=et,s=tr();if(Xe){if(n===void 0)throw Error(W(407));n=n()}else{if(n=e(),Tt===null)throw Error(W(349));ri&30||oE(r,e,n)}s.memoizedState=n;var i={value:n,getSnapshot:e};return s.queue=i,dv(lE.bind(null,r,i,t),[t]),r.flags|=2048,za(9,aE.bind(null,r,i,n,e),void 0,null),n},useId:function(){var t=tr(),e=Tt.identifierPrefix;if(Xe){var n=Tr,r=Er;n=(r&~(1<<32-qn(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=$a++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=hA++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},yA={readContext:Rn,useCallback:gE,useContext:Rn,useEffect:Xp,useImperativeHandle:mE,useInsertionEffect:hE,useLayoutEffect:fE,useMemo:yE,useReducer:mh,useRef:dE,useState:function(){return mh(Ba)},useDebugValue:Jp,useDeferredValue:function(t){var e=kn();return vE(e,yt.memoizedState,t)},useTransition:function(){var t=mh(Ba)[0],e=kn().memoizedState;return[t,e]},useMutableSource:sE,useSyncExternalStore:iE,useId:_E,unstable_isNewReconciler:!1},vA={readContext:Rn,useCallback:gE,useContext:Rn,useEffect:Xp,useImperativeHandle:mE,useInsertionEffect:hE,useLayoutEffect:fE,useMemo:yE,useReducer:gh,useRef:dE,useState:function(){return gh(Ba)},useDebugValue:Jp,useDeferredValue:function(t){var e=kn();return yt===null?e.memoizedState=t:vE(e,yt.memoizedState,t)},useTransition:function(){var t=gh(Ba)[0],e=kn().memoizedState;return[t,e]},useMutableSource:sE,useSyncExternalStore:iE,useId:_E,unstable_isNewReconciler:!1};function Fn(t,e){if(t&&t.defaultProps){e=nt({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function Ef(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:nt({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Bc={isMounted:function(t){return(t=t._reactInternals)?gi(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=Jt(),s=gs(t),i=br(r,s);i.payload=e,n!=null&&(i.callback=n),e=ps(t,i,s),e!==null&&(Wn(e,t,s,r),Tu(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=Jt(),s=gs(t),i=br(r,s);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=ps(t,i,s),e!==null&&(Wn(e,t,s,r),Tu(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Jt(),r=gs(t),s=br(n,r);s.tag=2,e!=null&&(s.callback=e),e=ps(t,s,r),e!==null&&(Wn(e,t,r,n),Tu(e,t,r))}};function hv(t,e,n,r,s,i,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,i,o):e.prototype&&e.prototype.isPureReactComponent?!Oa(n,r)||!Oa(s,i):!0}function TE(t,e,n){var r=!1,s=Ss,i=e.contextType;return typeof i=="object"&&i!==null?i=Rn(i):(s=cn(e)?ti:zt.current,r=e.contextTypes,i=(r=r!=null)?ro(t,s):Ss),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Bc,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=i),e}function fv(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Bc.enqueueReplaceState(e,e.state,null)}function Tf(t,e,n,r){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs={},qp(t);var i=e.contextType;typeof i=="object"&&i!==null?s.context=Rn(i):(i=cn(e)?ti:zt.current,s.context=ro(t,i)),s.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(Ef(t,e,i,n),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&Bc.enqueueReplaceState(s,s.state,null),ec(t,n,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function ao(t,e){try{var n="",r=e;do n+=Hb(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:s,digest:null}}function yh(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function Sf(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var _A=typeof WeakMap=="function"?WeakMap:Map;function SE(t,e,n){n=br(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){ic||(ic=!0,Df=r),Sf(t,e)},n}function IE(t,e,n){n=br(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){Sf(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){Sf(t,e),typeof r!="function"&&(ms===null?ms=new Set([this]):ms.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function pv(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new _A;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),t=jA.bind(null,t,e,n),e.then(t,t))}function mv(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function gv(t,e,n,r,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=br(-1,1),e.tag=2,ps(n,e,1))),n.lanes|=1),t)}var wA=Ur.ReactCurrentOwner,an=!1;function Yt(t,e,n,r){e.child=t===null?eE(e,null,n,r):io(e,t.child,n,r)}function yv(t,e,n,r,s){n=n.render;var i=e.ref;return Yi(e,s),r=Qp(t,e,n,r,i,s),n=Yp(),t!==null&&!an?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Dr(t,e,s)):(Xe&&n&&Vp(e),e.flags|=1,Yt(t,e,r,s),e.child)}function vv(t,e,n,r,s){if(t===null){var i=n.type;return typeof i=="function"&&!om(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,bE(t,e,i,r,s)):(t=Cu(n.type,null,r,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&s)){var o=i.memoizedProps;if(n=n.compare,n=n!==null?n:Oa,n(o,r)&&t.ref===e.ref)return Dr(t,e,s)}return e.flags|=1,t=ys(i,r),t.ref=e.ref,t.return=e,e.child=t}function bE(t,e,n,r,s){if(t!==null){var i=t.memoizedProps;if(Oa(i,r)&&t.ref===e.ref)if(an=!1,e.pendingProps=r=i,(t.lanes&s)!==0)t.flags&131072&&(an=!0);else return e.lanes=t.lanes,Dr(t,e,s)}return If(t,e,n,r,s)}function NE(t,e,n){var r=e.pendingProps,s=r.children,i=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},He(zi,fn),fn|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,He(zi,fn),fn|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,He(zi,fn),fn|=r}else i!==null?(r=i.baseLanes|n,e.memoizedState=null):r=n,He(zi,fn),fn|=r;return Yt(t,e,s,n),e.child}function AE(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function If(t,e,n,r,s){var i=cn(n)?ti:zt.current;return i=ro(e,i),Yi(e,s),n=Qp(t,e,n,r,i,s),r=Yp(),t!==null&&!an?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Dr(t,e,s)):(Xe&&r&&Vp(e),e.flags|=1,Yt(t,e,n,s),e.child)}function _v(t,e,n,r,s){if(cn(n)){var i=!0;Qu(e)}else i=!1;if(Yi(e,s),e.stateNode===null)bu(t,e),TE(e,n,r),Tf(e,n,r,s),r=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var c=o.context,d=n.contextType;typeof d=="object"&&d!==null?d=Rn(d):(d=cn(n)?ti:zt.current,d=ro(e,d));var h=n.getDerivedStateFromProps,p=typeof h=="function"||typeof o.getSnapshotBeforeUpdate=="function";p||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==r||c!==d)&&fv(e,o,r,d),Jr=!1;var m=e.memoizedState;o.state=m,ec(e,r,o,s),c=e.memoizedState,a!==r||m!==c||un.current||Jr?(typeof h=="function"&&(Ef(e,n,h,r),c=e.memoizedState),(a=Jr||hv(e,n,a,r,m,c,d))?(p||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=c),o.props=r,o.state=c,o.context=d,r=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,nE(t,e),a=e.memoizedProps,d=e.type===e.elementType?a:Fn(e.type,a),o.props=d,p=e.pendingProps,m=o.context,c=n.contextType,typeof c=="object"&&c!==null?c=Rn(c):(c=cn(n)?ti:zt.current,c=ro(e,c));var y=n.getDerivedStateFromProps;(h=typeof y=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==p||m!==c)&&fv(e,o,r,c),Jr=!1,m=e.memoizedState,o.state=m,ec(e,r,o,s);var T=e.memoizedState;a!==p||m!==T||un.current||Jr?(typeof y=="function"&&(Ef(e,n,y,r),T=e.memoizedState),(d=Jr||hv(e,n,d,r,m,T,c)||!1)?(h||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,T,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,T,c)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&m===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=T),o.props=r,o.state=T,o.context=c,r=d):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&m===t.memoizedState||(e.flags|=1024),r=!1)}return bf(t,e,n,r,i,s)}function bf(t,e,n,r,s,i){AE(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return s&&sv(e,n,!1),Dr(t,e,i);r=e.stateNode,wA.current=e;var a=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=io(e,t.child,null,i),e.child=io(e,null,a,i)):Yt(t,e,a,i),e.memoizedState=r.state,s&&sv(e,n,!0),e.child}function CE(t){var e=t.stateNode;e.pendingContext?rv(t,e.pendingContext,e.pendingContext!==e.context):e.context&&rv(t,e.context,!1),Wp(t,e.containerInfo)}function wv(t,e,n,r,s){return so(),Up(s),e.flags|=256,Yt(t,e,n,r),e.child}var Nf={dehydrated:null,treeContext:null,retryLane:0};function Af(t){return{baseLanes:t,cachePool:null,transitions:null}}function RE(t,e,n){var r=e.pendingProps,s=Je.current,i=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(s&2)!==0),a?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),He(Je,s&1),t===null)return wf(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,i?(r=e.mode,i=e.child,o={mode:"hidden",children:o},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=Wc(o,r,0,null),t=Zs(t,r,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=Af(n),e.memoizedState=Nf,t):Zp(e,o));if(s=t.memoizedState,s!==null&&(a=s.dehydrated,a!==null))return xA(t,e,o,r,a,s,n);if(i){i=r.fallback,o=e.mode,s=t.child,a=s.sibling;var c={mode:"hidden",children:r.children};return!(o&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=c,e.deletions=null):(r=ys(s,c),r.subtreeFlags=s.subtreeFlags&14680064),a!==null?i=ys(a,i):(i=Zs(i,o,n,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,o=t.child.memoizedState,o=o===null?Af(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=t.childLanes&~n,e.memoizedState=Nf,r}return i=t.child,t=i.sibling,r=ys(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function Zp(t,e){return e=Wc({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function su(t,e,n,r){return r!==null&&Up(r),io(e,t.child,null,n),t=Zp(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function xA(t,e,n,r,s,i,o){if(n)return e.flags&256?(e.flags&=-257,r=yh(Error(W(422))),su(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=r.fallback,s=e.mode,r=Wc({mode:"visible",children:r.children},s,0,null),i=Zs(i,s,o,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&io(e,t.child,null,o),e.child.memoizedState=Af(o),e.memoizedState=Nf,i);if(!(e.mode&1))return su(t,e,o,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var a=r.dgst;return r=a,i=Error(W(419)),r=yh(i,r,void 0),su(t,e,o,r)}if(a=(o&t.childLanes)!==0,an||a){if(r=Tt,r!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|o)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,jr(t,s),Wn(r,t,s,-1))}return im(),r=yh(Error(W(421))),su(t,e,o,r)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=DA.bind(null,t),s._reactRetry=e,null):(t=i.treeContext,mn=fs(s.nextSibling),vn=e,Xe=!0,Bn=null,t!==null&&(Sn[In++]=Er,Sn[In++]=Tr,Sn[In++]=ni,Er=t.id,Tr=t.overflow,ni=e),e=Zp(e,r.children),e.flags|=4096,e)}function xv(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),xf(t.return,e,n)}function vh(t,e,n,r,s){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function kE(t,e,n){var r=e.pendingProps,s=r.revealOrder,i=r.tail;if(Yt(t,e,r.children,n),r=Je.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&xv(t,n,e);else if(t.tag===19)xv(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(He(Je,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)t=n.alternate,t!==null&&tc(t)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),vh(e,!1,s,n,i);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&tc(t)===null){e.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}vh(e,!0,n,null,i);break;case"together":vh(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function bu(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Dr(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),si|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(W(153));if(e.child!==null){for(t=e.child,n=ys(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=ys(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function EA(t,e,n){switch(e.tag){case 3:CE(e),so();break;case 5:rE(e);break;case 1:cn(e.type)&&Qu(e);break;case 4:Wp(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;He(Ju,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(He(Je,Je.current&1),e.flags|=128,null):n&e.child.childLanes?RE(t,e,n):(He(Je,Je.current&1),t=Dr(t,e,n),t!==null?t.sibling:null);He(Je,Je.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return kE(t,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),He(Je,Je.current),r)break;return null;case 22:case 23:return e.lanes=0,NE(t,e,n)}return Dr(t,e,n)}var PE,Cf,jE,DE;PE=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Cf=function(){};jE=function(t,e,n,r){var s=t.memoizedProps;if(s!==r){t=e.stateNode,Ks(or.current);var i=null;switch(n){case"input":s=Yh(t,s),r=Yh(t,r),i=[];break;case"select":s=nt({},s,{value:void 0}),r=nt({},r,{value:void 0}),i=[];break;case"textarea":s=Zh(t,s),r=Zh(t,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=Gu)}tf(n,r);var o;n=null;for(d in s)if(!r.hasOwnProperty(d)&&s.hasOwnProperty(d)&&s[d]!=null)if(d==="style"){var a=s[d];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(Aa.hasOwnProperty(d)?i||(i=[]):(i=i||[]).push(d,null));for(d in r){var c=r[d];if(a=s!=null?s[d]:void 0,r.hasOwnProperty(d)&&c!==a&&(c!=null||a!=null))if(d==="style")if(a){for(o in a)!a.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in c)c.hasOwnProperty(o)&&a[o]!==c[o]&&(n||(n={}),n[o]=c[o])}else n||(i||(i=[]),i.push(d,n)),n=c;else d==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,a=a?a.__html:void 0,c!=null&&a!==c&&(i=i||[]).push(d,c)):d==="children"?typeof c!="string"&&typeof c!="number"||(i=i||[]).push(d,""+c):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(Aa.hasOwnProperty(d)?(c!=null&&d==="onScroll"&&Qe("scroll",t),i||a===c||(i=[])):(i=i||[]).push(d,c))}n&&(i=i||[]).push("style",n);var d=i;(e.updateQueue=d)&&(e.flags|=4)}};DE=function(t,e,n,r){n!==r&&(e.flags|=4)};function Zo(t,e){if(!Xe)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Lt(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function TA(t,e,n){var r=e.pendingProps;switch(Mp(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Lt(e),null;case 1:return cn(e.type)&&Ku(),Lt(e),null;case 3:return r=e.stateNode,oo(),Ye(un),Ye(zt),Gp(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(nu(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Bn!==null&&(Vf(Bn),Bn=null))),Cf(t,e),Lt(e),null;case 5:Hp(e);var s=Ks(Fa.current);if(n=e.type,t!==null&&e.stateNode!=null)jE(t,e,n,r,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(W(166));return Lt(e),null}if(t=Ks(or.current),nu(e)){r=e.stateNode,n=e.type;var i=e.memoizedProps;switch(r[rr]=e,r[Ma]=i,t=(e.mode&1)!==0,n){case"dialog":Qe("cancel",r),Qe("close",r);break;case"iframe":case"object":case"embed":Qe("load",r);break;case"video":case"audio":for(s=0;s<ia.length;s++)Qe(ia[s],r);break;case"source":Qe("error",r);break;case"img":case"image":case"link":Qe("error",r),Qe("load",r);break;case"details":Qe("toggle",r);break;case"input":Ry(r,i),Qe("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},Qe("invalid",r);break;case"textarea":Py(r,i),Qe("invalid",r)}tf(n,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var a=i[o];o==="children"?typeof a=="string"?r.textContent!==a&&(i.suppressHydrationWarning!==!0&&tu(r.textContent,a,t),s=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(i.suppressHydrationWarning!==!0&&tu(r.textContent,a,t),s=["children",""+a]):Aa.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&Qe("scroll",r)}switch(n){case"input":Gl(r),ky(r,i,!0);break;case"textarea":Gl(r),jy(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=Gu)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=lx(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[rr]=e,t[Ma]=r,PE(t,e,!1,!1),e.stateNode=t;e:{switch(o=nf(n,r),n){case"dialog":Qe("cancel",t),Qe("close",t),s=r;break;case"iframe":case"object":case"embed":Qe("load",t),s=r;break;case"video":case"audio":for(s=0;s<ia.length;s++)Qe(ia[s],t);s=r;break;case"source":Qe("error",t),s=r;break;case"img":case"image":case"link":Qe("error",t),Qe("load",t),s=r;break;case"details":Qe("toggle",t),s=r;break;case"input":Ry(t,r),s=Yh(t,r),Qe("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=nt({},r,{value:void 0}),Qe("invalid",t);break;case"textarea":Py(t,r),s=Zh(t,r),Qe("invalid",t);break;default:s=r}tf(n,s),a=s;for(i in a)if(a.hasOwnProperty(i)){var c=a[i];i==="style"?dx(t,c):i==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&ux(t,c)):i==="children"?typeof c=="string"?(n!=="textarea"||c!=="")&&Ca(t,c):typeof c=="number"&&Ca(t,""+c):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(Aa.hasOwnProperty(i)?c!=null&&i==="onScroll"&&Qe("scroll",t):c!=null&&Tp(t,i,c,o))}switch(n){case"input":Gl(t),ky(t,r,!1);break;case"textarea":Gl(t),jy(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Ts(r.value));break;case"select":t.multiple=!!r.multiple,i=r.value,i!=null?Hi(t,!!r.multiple,i,!1):r.defaultValue!=null&&Hi(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=Gu)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Lt(e),null;case 6:if(t&&e.stateNode!=null)DE(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(W(166));if(n=Ks(Fa.current),Ks(or.current),nu(e)){if(r=e.stateNode,n=e.memoizedProps,r[rr]=e,(i=r.nodeValue!==n)&&(t=vn,t!==null))switch(t.tag){case 3:tu(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&tu(r.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[rr]=e,e.stateNode=r}return Lt(e),null;case 13:if(Ye(Je),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Xe&&mn!==null&&e.mode&1&&!(e.flags&128))Jx(),so(),e.flags|=98560,i=!1;else if(i=nu(e),r!==null&&r.dehydrated!==null){if(t===null){if(!i)throw Error(W(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(W(317));i[rr]=e}else so(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Lt(e),i=!1}else Bn!==null&&(Vf(Bn),Bn=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||Je.current&1?vt===0&&(vt=3):im())),e.updateQueue!==null&&(e.flags|=4),Lt(e),null);case 4:return oo(),Cf(t,e),t===null&&La(e.stateNode.containerInfo),Lt(e),null;case 10:return Bp(e.type._context),Lt(e),null;case 17:return cn(e.type)&&Ku(),Lt(e),null;case 19:if(Ye(Je),i=e.memoizedState,i===null)return Lt(e),null;if(r=(e.flags&128)!==0,o=i.rendering,o===null)if(r)Zo(i,!1);else{if(vt!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=tc(t),o!==null){for(e.flags|=128,Zo(i,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)i=n,t=r,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,t=o.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return He(Je,Je.current&1|2),e.child}t=t.sibling}i.tail!==null&&ut()>lo&&(e.flags|=128,r=!0,Zo(i,!1),e.lanes=4194304)}else{if(!r)if(t=tc(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Zo(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!Xe)return Lt(e),null}else 2*ut()-i.renderingStartTime>lo&&n!==1073741824&&(e.flags|=128,r=!0,Zo(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(n=i.last,n!==null?n.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=ut(),e.sibling=null,n=Je.current,He(Je,r?n&1|2:n&1),e):(Lt(e),null);case 22:case 23:return sm(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?fn&1073741824&&(Lt(e),e.subtreeFlags&6&&(e.flags|=8192)):Lt(e),null;case 24:return null;case 25:return null}throw Error(W(156,e.tag))}function SA(t,e){switch(Mp(e),e.tag){case 1:return cn(e.type)&&Ku(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return oo(),Ye(un),Ye(zt),Gp(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Hp(e),null;case 13:if(Ye(Je),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(W(340));so()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Ye(Je),null;case 4:return oo(),null;case 10:return Bp(e.type._context),null;case 22:case 23:return sm(),null;case 24:return null;default:return null}}var iu=!1,Ut=!1,IA=typeof WeakSet=="function"?WeakSet:Set,re=null;function Bi(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){it(t,e,r)}else n.current=null}function Rf(t,e,n){try{n()}catch(r){it(t,e,r)}}var Ev=!1;function bA(t,e){if(ff=qu,t=Ux(),Lp(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var o=0,a=-1,c=-1,d=0,h=0,p=t,m=null;t:for(;;){for(var y;p!==n||s!==0&&p.nodeType!==3||(a=o+s),p!==i||r!==0&&p.nodeType!==3||(c=o+r),p.nodeType===3&&(o+=p.nodeValue.length),(y=p.firstChild)!==null;)m=p,p=y;for(;;){if(p===t)break t;if(m===n&&++d===s&&(a=o),m===i&&++h===r&&(c=o),(y=p.nextSibling)!==null)break;p=m,m=p.parentNode}p=y}n=a===-1||c===-1?null:{start:a,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(pf={focusedElem:t,selectionRange:n},qu=!1,re=e;re!==null;)if(e=re,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,re=t;else for(;re!==null;){e=re;try{var T=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(T!==null){var b=T.memoizedProps,I=T.memoizedState,v=e.stateNode,w=v.getSnapshotBeforeUpdate(e.elementType===e.type?b:Fn(e.type,b),I);v.__reactInternalSnapshotBeforeUpdate=w}break;case 3:var _=e.stateNode.containerInfo;_.nodeType===1?_.textContent="":_.nodeType===9&&_.documentElement&&_.removeChild(_.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(W(163))}}catch(E){it(e,e.return,E)}if(t=e.sibling,t!==null){t.return=e.return,re=t;break}re=e.return}return T=Ev,Ev=!1,T}function ya(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var i=s.destroy;s.destroy=void 0,i!==void 0&&Rf(e,n,i)}s=s.next}while(s!==r)}}function zc(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function kf(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function OE(t){var e=t.alternate;e!==null&&(t.alternate=null,OE(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[rr],delete e[Ma],delete e[yf],delete e[lA],delete e[uA])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function LE(t){return t.tag===5||t.tag===3||t.tag===4}function Tv(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||LE(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Pf(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=Gu));else if(r!==4&&(t=t.child,t!==null))for(Pf(t,e,n),t=t.sibling;t!==null;)Pf(t,e,n),t=t.sibling}function jf(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(jf(t,e,n),t=t.sibling;t!==null;)jf(t,e,n),t=t.sibling}var At=null,$n=!1;function Qr(t,e,n){for(n=n.child;n!==null;)VE(t,e,n),n=n.sibling}function VE(t,e,n){if(ir&&typeof ir.onCommitFiberUnmount=="function")try{ir.onCommitFiberUnmount(Oc,n)}catch{}switch(n.tag){case 5:Ut||Bi(n,e);case 6:var r=At,s=$n;At=null,Qr(t,e,n),At=r,$n=s,At!==null&&($n?(t=At,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):At.removeChild(n.stateNode));break;case 18:At!==null&&($n?(t=At,n=n.stateNode,t.nodeType===8?dh(t.parentNode,n):t.nodeType===1&&dh(t,n),ja(t)):dh(At,n.stateNode));break;case 4:r=At,s=$n,At=n.stateNode.containerInfo,$n=!0,Qr(t,e,n),At=r,$n=s;break;case 0:case 11:case 14:case 15:if(!Ut&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&Rf(n,e,o),s=s.next}while(s!==r)}Qr(t,e,n);break;case 1:if(!Ut&&(Bi(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){it(n,e,a)}Qr(t,e,n);break;case 21:Qr(t,e,n);break;case 22:n.mode&1?(Ut=(r=Ut)||n.memoizedState!==null,Qr(t,e,n),Ut=r):Qr(t,e,n);break;default:Qr(t,e,n)}}function Sv(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new IA),e.forEach(function(r){var s=OA.bind(null,t,r);n.has(r)||(n.add(r),r.then(s,s))})}}function Un(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:At=a.stateNode,$n=!1;break e;case 3:At=a.stateNode.containerInfo,$n=!0;break e;case 4:At=a.stateNode.containerInfo,$n=!0;break e}a=a.return}if(At===null)throw Error(W(160));VE(i,o,s),At=null,$n=!1;var c=s.alternate;c!==null&&(c.return=null),s.return=null}catch(d){it(s,e,d)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)ME(e,t),e=e.sibling}function ME(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Un(e,t),er(t),r&4){try{ya(3,t,t.return),zc(3,t)}catch(b){it(t,t.return,b)}try{ya(5,t,t.return)}catch(b){it(t,t.return,b)}}break;case 1:Un(e,t),er(t),r&512&&n!==null&&Bi(n,n.return);break;case 5:if(Un(e,t),er(t),r&512&&n!==null&&Bi(n,n.return),t.flags&32){var s=t.stateNode;try{Ca(s,"")}catch(b){it(t,t.return,b)}}if(r&4&&(s=t.stateNode,s!=null)){var i=t.memoizedProps,o=n!==null?n.memoizedProps:i,a=t.type,c=t.updateQueue;if(t.updateQueue=null,c!==null)try{a==="input"&&i.type==="radio"&&i.name!=null&&ox(s,i),nf(a,o);var d=nf(a,i);for(o=0;o<c.length;o+=2){var h=c[o],p=c[o+1];h==="style"?dx(s,p):h==="dangerouslySetInnerHTML"?ux(s,p):h==="children"?Ca(s,p):Tp(s,h,p,d)}switch(a){case"input":Xh(s,i);break;case"textarea":ax(s,i);break;case"select":var m=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var y=i.value;y!=null?Hi(s,!!i.multiple,y,!1):m!==!!i.multiple&&(i.defaultValue!=null?Hi(s,!!i.multiple,i.defaultValue,!0):Hi(s,!!i.multiple,i.multiple?[]:"",!1))}s[Ma]=i}catch(b){it(t,t.return,b)}}break;case 6:if(Un(e,t),er(t),r&4){if(t.stateNode===null)throw Error(W(162));s=t.stateNode,i=t.memoizedProps;try{s.nodeValue=i}catch(b){it(t,t.return,b)}}break;case 3:if(Un(e,t),er(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{ja(e.containerInfo)}catch(b){it(t,t.return,b)}break;case 4:Un(e,t),er(t);break;case 13:Un(e,t),er(t),s=t.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(nm=ut())),r&4&&Sv(t);break;case 22:if(h=n!==null&&n.memoizedState!==null,t.mode&1?(Ut=(d=Ut)||h,Un(e,t),Ut=d):Un(e,t),er(t),r&8192){if(d=t.memoizedState!==null,(t.stateNode.isHidden=d)&&!h&&t.mode&1)for(re=t,h=t.child;h!==null;){for(p=re=h;re!==null;){switch(m=re,y=m.child,m.tag){case 0:case 11:case 14:case 15:ya(4,m,m.return);break;case 1:Bi(m,m.return);var T=m.stateNode;if(typeof T.componentWillUnmount=="function"){r=m,n=m.return;try{e=r,T.props=e.memoizedProps,T.state=e.memoizedState,T.componentWillUnmount()}catch(b){it(r,n,b)}}break;case 5:Bi(m,m.return);break;case 22:if(m.memoizedState!==null){bv(p);continue}}y!==null?(y.return=m,re=y):bv(p)}h=h.sibling}e:for(h=null,p=t;;){if(p.tag===5){if(h===null){h=p;try{s=p.stateNode,d?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(a=p.stateNode,c=p.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,a.style.display=cx("display",o))}catch(b){it(t,t.return,b)}}}else if(p.tag===6){if(h===null)try{p.stateNode.nodeValue=d?"":p.memoizedProps}catch(b){it(t,t.return,b)}}else if((p.tag!==22&&p.tag!==23||p.memoizedState===null||p===t)&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===t)break e;for(;p.sibling===null;){if(p.return===null||p.return===t)break e;h===p&&(h=null),p=p.return}h===p&&(h=null),p.sibling.return=p.return,p=p.sibling}}break;case 19:Un(e,t),er(t),r&4&&Sv(t);break;case 21:break;default:Un(e,t),er(t)}}function er(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(LE(n)){var r=n;break e}n=n.return}throw Error(W(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(Ca(s,""),r.flags&=-33);var i=Tv(t);jf(t,i,s);break;case 3:case 4:var o=r.stateNode.containerInfo,a=Tv(t);Pf(t,a,o);break;default:throw Error(W(161))}}catch(c){it(t,t.return,c)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function NA(t,e,n){re=t,UE(t)}function UE(t,e,n){for(var r=(t.mode&1)!==0;re!==null;){var s=re,i=s.child;if(s.tag===22&&r){var o=s.memoizedState!==null||iu;if(!o){var a=s.alternate,c=a!==null&&a.memoizedState!==null||Ut;a=iu;var d=Ut;if(iu=o,(Ut=c)&&!d)for(re=s;re!==null;)o=re,c=o.child,o.tag===22&&o.memoizedState!==null?Nv(s):c!==null?(c.return=o,re=c):Nv(s);for(;i!==null;)re=i,UE(i),i=i.sibling;re=s,iu=a,Ut=d}Iv(t)}else s.subtreeFlags&8772&&i!==null?(i.return=s,re=i):Iv(t)}}function Iv(t){for(;re!==null;){var e=re;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Ut||zc(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Ut)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:Fn(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&uv(e,i,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}uv(e,o,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var d=e.alternate;if(d!==null){var h=d.memoizedState;if(h!==null){var p=h.dehydrated;p!==null&&ja(p)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(W(163))}Ut||e.flags&512&&kf(e)}catch(m){it(e,e.return,m)}}if(e===t){re=null;break}if(n=e.sibling,n!==null){n.return=e.return,re=n;break}re=e.return}}function bv(t){for(;re!==null;){var e=re;if(e===t){re=null;break}var n=e.sibling;if(n!==null){n.return=e.return,re=n;break}re=e.return}}function Nv(t){for(;re!==null;){var e=re;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{zc(4,e)}catch(c){it(e,n,c)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(c){it(e,s,c)}}var i=e.return;try{kf(e)}catch(c){it(e,i,c)}break;case 5:var o=e.return;try{kf(e)}catch(c){it(e,o,c)}}}catch(c){it(e,e.return,c)}if(e===t){re=null;break}var a=e.sibling;if(a!==null){a.return=e.return,re=a;break}re=e.return}}var AA=Math.ceil,sc=Ur.ReactCurrentDispatcher,em=Ur.ReactCurrentOwner,Cn=Ur.ReactCurrentBatchConfig,Oe=0,Tt=null,ht=null,Rt=0,fn=0,zi=Ps(0),vt=0,qa=null,si=0,qc=0,tm=0,va=null,sn=null,nm=0,lo=1/0,_r=null,ic=!1,Df=null,ms=null,ou=!1,as=null,oc=0,_a=0,Of=null,Nu=-1,Au=0;function Jt(){return Oe&6?ut():Nu!==-1?Nu:Nu=ut()}function gs(t){return t.mode&1?Oe&2&&Rt!==0?Rt&-Rt:dA.transition!==null?(Au===0&&(Au=Tx()),Au):(t=$e,t!==0||(t=window.event,t=t===void 0?16:Rx(t.type)),t):1}function Wn(t,e,n,r){if(50<_a)throw _a=0,Of=null,Error(W(185));al(t,n,r),(!(Oe&2)||t!==Tt)&&(t===Tt&&(!(Oe&2)&&(qc|=n),vt===4&&es(t,Rt)),dn(t,r),n===1&&Oe===0&&!(e.mode&1)&&(lo=ut()+500,Fc&&js()))}function dn(t,e){var n=t.callbackNode;dN(t,e);var r=zu(t,t===Tt?Rt:0);if(r===0)n!==null&&Ly(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&Ly(n),e===1)t.tag===0?cA(Av.bind(null,t)):Qx(Av.bind(null,t)),oA(function(){!(Oe&6)&&js()}),n=null;else{switch(Sx(r)){case 1:n=Ap;break;case 4:n=xx;break;case 16:n=Bu;break;case 536870912:n=Ex;break;default:n=Bu}n=GE(n,FE.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function FE(t,e){if(Nu=-1,Au=0,Oe&6)throw Error(W(327));var n=t.callbackNode;if(Xi()&&t.callbackNode!==n)return null;var r=zu(t,t===Tt?Rt:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=ac(t,r);else{e=r;var s=Oe;Oe|=2;var i=BE();(Tt!==t||Rt!==e)&&(_r=null,lo=ut()+500,Js(t,e));do try{kA();break}catch(a){$E(t,a)}while(!0);$p(),sc.current=i,Oe=s,ht!==null?e=0:(Tt=null,Rt=0,e=vt)}if(e!==0){if(e===2&&(s=lf(t),s!==0&&(r=s,e=Lf(t,s))),e===1)throw n=qa,Js(t,0),es(t,r),dn(t,ut()),n;if(e===6)es(t,r);else{if(s=t.current.alternate,!(r&30)&&!CA(s)&&(e=ac(t,r),e===2&&(i=lf(t),i!==0&&(r=i,e=Lf(t,i))),e===1))throw n=qa,Js(t,0),es(t,r),dn(t,ut()),n;switch(t.finishedWork=s,t.finishedLanes=r,e){case 0:case 1:throw Error(W(345));case 2:qs(t,sn,_r);break;case 3:if(es(t,r),(r&130023424)===r&&(e=nm+500-ut(),10<e)){if(zu(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){Jt(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=gf(qs.bind(null,t,sn,_r),e);break}qs(t,sn,_r);break;case 4:if(es(t,r),(r&4194240)===r)break;for(e=t.eventTimes,s=-1;0<r;){var o=31-qn(r);i=1<<o,o=e[o],o>s&&(s=o),r&=~i}if(r=s,r=ut()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*AA(r/1960))-r,10<r){t.timeoutHandle=gf(qs.bind(null,t,sn,_r),r);break}qs(t,sn,_r);break;case 5:qs(t,sn,_r);break;default:throw Error(W(329))}}}return dn(t,ut()),t.callbackNode===n?FE.bind(null,t):null}function Lf(t,e){var n=va;return t.current.memoizedState.isDehydrated&&(Js(t,e).flags|=256),t=ac(t,e),t!==2&&(e=sn,sn=n,e!==null&&Vf(e)),t}function Vf(t){sn===null?sn=t:sn.push.apply(sn,t)}function CA(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!Qn(i(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function es(t,e){for(e&=~tm,e&=~qc,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-qn(e),r=1<<n;t[n]=-1,e&=~r}}function Av(t){if(Oe&6)throw Error(W(327));Xi();var e=zu(t,0);if(!(e&1))return dn(t,ut()),null;var n=ac(t,e);if(t.tag!==0&&n===2){var r=lf(t);r!==0&&(e=r,n=Lf(t,r))}if(n===1)throw n=qa,Js(t,0),es(t,e),dn(t,ut()),n;if(n===6)throw Error(W(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,qs(t,sn,_r),dn(t,ut()),null}function rm(t,e){var n=Oe;Oe|=1;try{return t(e)}finally{Oe=n,Oe===0&&(lo=ut()+500,Fc&&js())}}function ii(t){as!==null&&as.tag===0&&!(Oe&6)&&Xi();var e=Oe;Oe|=1;var n=Cn.transition,r=$e;try{if(Cn.transition=null,$e=1,t)return t()}finally{$e=r,Cn.transition=n,Oe=e,!(Oe&6)&&js()}}function sm(){fn=zi.current,Ye(zi)}function Js(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,iA(n)),ht!==null)for(n=ht.return;n!==null;){var r=n;switch(Mp(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Ku();break;case 3:oo(),Ye(un),Ye(zt),Gp();break;case 5:Hp(r);break;case 4:oo();break;case 13:Ye(Je);break;case 19:Ye(Je);break;case 10:Bp(r.type._context);break;case 22:case 23:sm()}n=n.return}if(Tt=t,ht=t=ys(t.current,null),Rt=fn=e,vt=0,qa=null,tm=qc=si=0,sn=va=null,Gs!==null){for(e=0;e<Gs.length;e++)if(n=Gs[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var o=i.next;i.next=s,r.next=o}n.pending=r}Gs=null}return t}function $E(t,e){do{var n=ht;try{if($p(),Su.current=rc,nc){for(var r=et.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}nc=!1}if(ri=0,xt=yt=et=null,ga=!1,$a=0,em.current=null,n===null||n.return===null){vt=1,qa=e,ht=null;break}e:{var i=t,o=n.return,a=n,c=e;if(e=Rt,a.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var d=c,h=a,p=h.tag;if(!(h.mode&1)&&(p===0||p===11||p===15)){var m=h.alternate;m?(h.updateQueue=m.updateQueue,h.memoizedState=m.memoizedState,h.lanes=m.lanes):(h.updateQueue=null,h.memoizedState=null)}var y=mv(o);if(y!==null){y.flags&=-257,gv(y,o,a,i,e),y.mode&1&&pv(i,d,e),e=y,c=d;var T=e.updateQueue;if(T===null){var b=new Set;b.add(c),e.updateQueue=b}else T.add(c);break e}else{if(!(e&1)){pv(i,d,e),im();break e}c=Error(W(426))}}else if(Xe&&a.mode&1){var I=mv(o);if(I!==null){!(I.flags&65536)&&(I.flags|=256),gv(I,o,a,i,e),Up(ao(c,a));break e}}i=c=ao(c,a),vt!==4&&(vt=2),va===null?va=[i]:va.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var v=SE(i,c,e);lv(i,v);break e;case 1:a=c;var w=i.type,_=i.stateNode;if(!(i.flags&128)&&(typeof w.getDerivedStateFromError=="function"||_!==null&&typeof _.componentDidCatch=="function"&&(ms===null||!ms.has(_)))){i.flags|=65536,e&=-e,i.lanes|=e;var E=IE(i,a,e);lv(i,E);break e}}i=i.return}while(i!==null)}qE(n)}catch(j){e=j,ht===n&&n!==null&&(ht=n=n.return);continue}break}while(!0)}function BE(){var t=sc.current;return sc.current=rc,t===null?rc:t}function im(){(vt===0||vt===3||vt===2)&&(vt=4),Tt===null||!(si&268435455)&&!(qc&268435455)||es(Tt,Rt)}function ac(t,e){var n=Oe;Oe|=2;var r=BE();(Tt!==t||Rt!==e)&&(_r=null,Js(t,e));do try{RA();break}catch(s){$E(t,s)}while(!0);if($p(),Oe=n,sc.current=r,ht!==null)throw Error(W(261));return Tt=null,Rt=0,vt}function RA(){for(;ht!==null;)zE(ht)}function kA(){for(;ht!==null&&!nN();)zE(ht)}function zE(t){var e=HE(t.alternate,t,fn);t.memoizedProps=t.pendingProps,e===null?qE(t):ht=e,em.current=null}function qE(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=SA(n,e),n!==null){n.flags&=32767,ht=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{vt=6,ht=null;return}}else if(n=TA(n,e,fn),n!==null){ht=n;return}if(e=e.sibling,e!==null){ht=e;return}ht=e=t}while(e!==null);vt===0&&(vt=5)}function qs(t,e,n){var r=$e,s=Cn.transition;try{Cn.transition=null,$e=1,PA(t,e,n,r)}finally{Cn.transition=s,$e=r}return null}function PA(t,e,n,r){do Xi();while(as!==null);if(Oe&6)throw Error(W(327));n=t.finishedWork;var s=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(W(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(hN(t,i),t===Tt&&(ht=Tt=null,Rt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||ou||(ou=!0,GE(Bu,function(){return Xi(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=Cn.transition,Cn.transition=null;var o=$e;$e=1;var a=Oe;Oe|=4,em.current=null,bA(t,n),ME(n,t),JN(pf),qu=!!ff,pf=ff=null,t.current=n,NA(n),rN(),Oe=a,$e=o,Cn.transition=i}else t.current=n;if(ou&&(ou=!1,as=t,oc=s),i=t.pendingLanes,i===0&&(ms=null),oN(n.stateNode),dn(t,ut()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(ic)throw ic=!1,t=Df,Df=null,t;return oc&1&&t.tag!==0&&Xi(),i=t.pendingLanes,i&1?t===Of?_a++:(_a=0,Of=t):_a=0,js(),null}function Xi(){if(as!==null){var t=Sx(oc),e=Cn.transition,n=$e;try{if(Cn.transition=null,$e=16>t?16:t,as===null)var r=!1;else{if(t=as,as=null,oc=0,Oe&6)throw Error(W(331));var s=Oe;for(Oe|=4,re=t.current;re!==null;){var i=re,o=i.child;if(re.flags&16){var a=i.deletions;if(a!==null){for(var c=0;c<a.length;c++){var d=a[c];for(re=d;re!==null;){var h=re;switch(h.tag){case 0:case 11:case 15:ya(8,h,i)}var p=h.child;if(p!==null)p.return=h,re=p;else for(;re!==null;){h=re;var m=h.sibling,y=h.return;if(OE(h),h===d){re=null;break}if(m!==null){m.return=y,re=m;break}re=y}}}var T=i.alternate;if(T!==null){var b=T.child;if(b!==null){T.child=null;do{var I=b.sibling;b.sibling=null,b=I}while(b!==null)}}re=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,re=o;else e:for(;re!==null;){if(i=re,i.flags&2048)switch(i.tag){case 0:case 11:case 15:ya(9,i,i.return)}var v=i.sibling;if(v!==null){v.return=i.return,re=v;break e}re=i.return}}var w=t.current;for(re=w;re!==null;){o=re;var _=o.child;if(o.subtreeFlags&2064&&_!==null)_.return=o,re=_;else e:for(o=w;re!==null;){if(a=re,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:zc(9,a)}}catch(j){it(a,a.return,j)}if(a===o){re=null;break e}var E=a.sibling;if(E!==null){E.return=a.return,re=E;break e}re=a.return}}if(Oe=s,js(),ir&&typeof ir.onPostCommitFiberRoot=="function")try{ir.onPostCommitFiberRoot(Oc,t)}catch{}r=!0}return r}finally{$e=n,Cn.transition=e}}return!1}function Cv(t,e,n){e=ao(n,e),e=SE(t,e,1),t=ps(t,e,1),e=Jt(),t!==null&&(al(t,1,e),dn(t,e))}function it(t,e,n){if(t.tag===3)Cv(t,t,n);else for(;e!==null;){if(e.tag===3){Cv(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(ms===null||!ms.has(r))){t=ao(n,t),t=IE(e,t,1),e=ps(e,t,1),t=Jt(),e!==null&&(al(e,1,t),dn(e,t));break}}e=e.return}}function jA(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=Jt(),t.pingedLanes|=t.suspendedLanes&n,Tt===t&&(Rt&n)===n&&(vt===4||vt===3&&(Rt&130023424)===Rt&&500>ut()-nm?Js(t,0):tm|=n),dn(t,e)}function WE(t,e){e===0&&(t.mode&1?(e=Yl,Yl<<=1,!(Yl&130023424)&&(Yl=4194304)):e=1);var n=Jt();t=jr(t,e),t!==null&&(al(t,e,n),dn(t,n))}function DA(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),WE(t,n)}function OA(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(W(314))}r!==null&&r.delete(e),WE(t,n)}var HE;HE=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||un.current)an=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return an=!1,EA(t,e,n);an=!!(t.flags&131072)}else an=!1,Xe&&e.flags&1048576&&Yx(e,Xu,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;bu(t,e),t=e.pendingProps;var s=ro(e,zt.current);Yi(e,n),s=Qp(null,e,r,t,s,n);var i=Yp();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,cn(r)?(i=!0,Qu(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,qp(e),s.updater=Bc,e.stateNode=s,s._reactInternals=e,Tf(e,r,t,n),e=bf(null,e,r,!0,i,n)):(e.tag=0,Xe&&i&&Vp(e),Yt(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch(bu(t,e),t=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=VA(r),t=Fn(r,t),s){case 0:e=If(null,e,r,t,n);break e;case 1:e=_v(null,e,r,t,n);break e;case 11:e=yv(null,e,r,t,n);break e;case 14:e=vv(null,e,r,Fn(r.type,t),n);break e}throw Error(W(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Fn(r,s),If(t,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Fn(r,s),_v(t,e,r,s,n);case 3:e:{if(CE(e),t===null)throw Error(W(387));r=e.pendingProps,i=e.memoizedState,s=i.element,nE(t,e),ec(e,r,null,n);var o=e.memoizedState;if(r=o.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=ao(Error(W(423)),e),e=wv(t,e,r,n,s);break e}else if(r!==s){s=ao(Error(W(424)),e),e=wv(t,e,r,n,s);break e}else for(mn=fs(e.stateNode.containerInfo.firstChild),vn=e,Xe=!0,Bn=null,n=eE(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(so(),r===s){e=Dr(t,e,n);break e}Yt(t,e,r,n)}e=e.child}return e;case 5:return rE(e),t===null&&wf(e),r=e.type,s=e.pendingProps,i=t!==null?t.memoizedProps:null,o=s.children,mf(r,s)?o=null:i!==null&&mf(r,i)&&(e.flags|=32),AE(t,e),Yt(t,e,o,n),e.child;case 6:return t===null&&wf(e),null;case 13:return RE(t,e,n);case 4:return Wp(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=io(e,null,r,n):Yt(t,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Fn(r,s),yv(t,e,r,s,n);case 7:return Yt(t,e,e.pendingProps,n),e.child;case 8:return Yt(t,e,e.pendingProps.children,n),e.child;case 12:return Yt(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,i=e.memoizedProps,o=s.value,He(Ju,r._currentValue),r._currentValue=o,i!==null)if(Qn(i.value,o)){if(i.children===s.children&&!un.current){e=Dr(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var a=i.dependencies;if(a!==null){o=i.child;for(var c=a.firstContext;c!==null;){if(c.context===r){if(i.tag===1){c=br(-1,n&-n),c.tag=2;var d=i.updateQueue;if(d!==null){d=d.shared;var h=d.pending;h===null?c.next=c:(c.next=h.next,h.next=c),d.pending=c}}i.lanes|=n,c=i.alternate,c!==null&&(c.lanes|=n),xf(i.return,n,e),a.lanes|=n;break}c=c.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(W(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),xf(o,n,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}Yt(t,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,Yi(e,n),s=Rn(s),r=r(s),e.flags|=1,Yt(t,e,r,n),e.child;case 14:return r=e.type,s=Fn(r,e.pendingProps),s=Fn(r.type,s),vv(t,e,r,s,n);case 15:return bE(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Fn(r,s),bu(t,e),e.tag=1,cn(r)?(t=!0,Qu(e)):t=!1,Yi(e,n),TE(e,r,s),Tf(e,r,s,n),bf(null,e,r,!0,t,n);case 19:return kE(t,e,n);case 22:return NE(t,e,n)}throw Error(W(156,e.tag))};function GE(t,e){return wx(t,e)}function LA(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Nn(t,e,n,r){return new LA(t,e,n,r)}function om(t){return t=t.prototype,!(!t||!t.isReactComponent)}function VA(t){if(typeof t=="function")return om(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Ip)return 11;if(t===bp)return 14}return 2}function ys(t,e){var n=t.alternate;return n===null?(n=Nn(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Cu(t,e,n,r,s,i){var o=2;if(r=t,typeof t=="function")om(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case ji:return Zs(n.children,s,i,e);case Sp:o=8,s|=8;break;case Hh:return t=Nn(12,n,e,s|2),t.elementType=Hh,t.lanes=i,t;case Gh:return t=Nn(13,n,e,s),t.elementType=Gh,t.lanes=i,t;case Kh:return t=Nn(19,n,e,s),t.elementType=Kh,t.lanes=i,t;case rx:return Wc(n,s,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case tx:o=10;break e;case nx:o=9;break e;case Ip:o=11;break e;case bp:o=14;break e;case Xr:o=16,r=null;break e}throw Error(W(130,t==null?t:typeof t,""))}return e=Nn(o,n,e,s),e.elementType=t,e.type=r,e.lanes=i,e}function Zs(t,e,n,r){return t=Nn(7,t,r,e),t.lanes=n,t}function Wc(t,e,n,r){return t=Nn(22,t,r,e),t.elementType=rx,t.lanes=n,t.stateNode={isHidden:!1},t}function _h(t,e,n){return t=Nn(6,t,null,e),t.lanes=n,t}function wh(t,e,n){return e=Nn(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function MA(t,e,n,r,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=eh(0),this.expirationTimes=eh(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=eh(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function am(t,e,n,r,s,i,o,a,c){return t=new MA(t,e,n,a,c),e===1?(e=1,i===!0&&(e|=8)):e=0,i=Nn(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},qp(i),t}function UA(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Pi,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function KE(t){if(!t)return Ss;t=t._reactInternals;e:{if(gi(t)!==t||t.tag!==1)throw Error(W(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(cn(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(W(171))}if(t.tag===1){var n=t.type;if(cn(n))return Kx(t,n,e)}return e}function QE(t,e,n,r,s,i,o,a,c){return t=am(n,r,!0,t,s,i,o,a,c),t.context=KE(null),n=t.current,r=Jt(),s=gs(n),i=br(r,s),i.callback=e??null,ps(n,i,s),t.current.lanes=s,al(t,s,r),dn(t,r),t}function Hc(t,e,n,r){var s=e.current,i=Jt(),o=gs(s);return n=KE(n),e.context===null?e.context=n:e.pendingContext=n,e=br(i,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=ps(s,e,o),t!==null&&(Wn(t,s,o,i),Tu(t,s,o)),o}function lc(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Rv(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function lm(t,e){Rv(t,e),(t=t.alternate)&&Rv(t,e)}function FA(){return null}var YE=typeof reportError=="function"?reportError:function(t){console.error(t)};function um(t){this._internalRoot=t}Gc.prototype.render=um.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(W(409));Hc(t,e,null,null)};Gc.prototype.unmount=um.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;ii(function(){Hc(null,t,null,null)}),e[Pr]=null}};function Gc(t){this._internalRoot=t}Gc.prototype.unstable_scheduleHydration=function(t){if(t){var e=Nx();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Zr.length&&e!==0&&e<Zr[n].priority;n++);Zr.splice(n,0,t),n===0&&Cx(t)}};function cm(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Kc(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function kv(){}function $A(t,e,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var d=lc(o);i.call(d)}}var o=QE(e,r,t,0,null,!1,!1,"",kv);return t._reactRootContainer=o,t[Pr]=o.current,La(t.nodeType===8?t.parentNode:t),ii(),o}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var a=r;r=function(){var d=lc(c);a.call(d)}}var c=am(t,0,!1,null,null,!1,!1,"",kv);return t._reactRootContainer=c,t[Pr]=c.current,La(t.nodeType===8?t.parentNode:t),ii(function(){Hc(e,c,n,r)}),c}function Qc(t,e,n,r,s){var i=n._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var a=s;s=function(){var c=lc(o);a.call(c)}}Hc(e,o,t,s)}else o=$A(n,e,t,s,r);return lc(o)}Ix=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=sa(e.pendingLanes);n!==0&&(Cp(e,n|1),dn(e,ut()),!(Oe&6)&&(lo=ut()+500,js()))}break;case 13:ii(function(){var r=jr(t,1);if(r!==null){var s=Jt();Wn(r,t,1,s)}}),lm(t,1)}};Rp=function(t){if(t.tag===13){var e=jr(t,134217728);if(e!==null){var n=Jt();Wn(e,t,134217728,n)}lm(t,134217728)}};bx=function(t){if(t.tag===13){var e=gs(t),n=jr(t,e);if(n!==null){var r=Jt();Wn(n,t,e,r)}lm(t,e)}};Nx=function(){return $e};Ax=function(t,e){var n=$e;try{return $e=t,e()}finally{$e=n}};sf=function(t,e,n){switch(e){case"input":if(Xh(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var s=Uc(r);if(!s)throw Error(W(90));ix(r),Xh(r,s)}}}break;case"textarea":ax(t,n);break;case"select":e=n.value,e!=null&&Hi(t,!!n.multiple,e,!1)}};px=rm;mx=ii;var BA={usingClientEntryPoint:!1,Events:[ul,Vi,Uc,hx,fx,rm]},ea={findFiberByHostInstance:Hs,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},zA={bundleType:ea.bundleType,version:ea.version,rendererPackageName:ea.rendererPackageName,rendererConfig:ea.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Ur.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=vx(t),t===null?null:t.stateNode},findFiberByHostInstance:ea.findFiberByHostInstance||FA,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var au=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!au.isDisabled&&au.supportsFiber)try{Oc=au.inject(zA),ir=au}catch{}}En.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=BA;En.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!cm(e))throw Error(W(200));return UA(t,e,null,n)};En.createRoot=function(t,e){if(!cm(t))throw Error(W(299));var n=!1,r="",s=YE;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=am(t,1,!1,null,null,n,!1,r,s),t[Pr]=e.current,La(t.nodeType===8?t.parentNode:t),new um(e)};En.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(W(188)):(t=Object.keys(t).join(","),Error(W(268,t)));return t=vx(e),t=t===null?null:t.stateNode,t};En.flushSync=function(t){return ii(t)};En.hydrate=function(t,e,n){if(!Kc(e))throw Error(W(200));return Qc(null,t,e,!0,n)};En.hydrateRoot=function(t,e,n){if(!cm(t))throw Error(W(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",o=YE;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=QE(e,null,t,1,n??null,s,!1,i,o),t[Pr]=e.current,La(t),r)for(t=0;t<r.length;t++)n=r[t],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new Gc(e)};En.render=function(t,e,n){if(!Kc(e))throw Error(W(200));return Qc(null,t,e,!1,n)};En.unmountComponentAtNode=function(t){if(!Kc(t))throw Error(W(40));return t._reactRootContainer?(ii(function(){Qc(null,null,t,!1,function(){t._reactRootContainer=null,t[Pr]=null})}),!0):!1};En.unstable_batchedUpdates=rm;En.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Kc(n))throw Error(W(200));if(t==null||t._reactInternals===void 0)throw Error(W(38));return Qc(t,e,n,!1,r)};En.version="18.3.1-next-f1338f8080-20240426";function XE(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(XE)}catch(t){console.error(t)}}XE(),Xw.exports=En;var qA=Xw.exports,Pv=qA;qh.createRoot=Pv.createRoot,qh.hydrateRoot=Pv.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Wa(){return Wa=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Wa.apply(this,arguments)}var ls;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(ls||(ls={}));const jv="popstate";function WA(t){t===void 0&&(t={});function e(r,s){let{pathname:i,search:o,hash:a}=r.location;return Mf("",{pathname:i,search:o,hash:a},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function n(r,s){return typeof s=="string"?s:uc(s)}return GA(e,n,null,t)}function tt(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function JE(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function HA(){return Math.random().toString(36).substr(2,8)}function Dv(t,e){return{usr:t.state,key:t.key,idx:e}}function Mf(t,e,n,r){return n===void 0&&(n=null),Wa({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?To(e):e,{state:n,key:e&&e.key||r||HA()})}function uc(t){let{pathname:e="/",search:n="",hash:r=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function To(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substr(r),t=t.substr(0,r)),t&&(e.pathname=t)}return e}function GA(t,e,n,r){r===void 0&&(r={});let{window:s=document.defaultView,v5Compat:i=!1}=r,o=s.history,a=ls.Pop,c=null,d=h();d==null&&(d=0,o.replaceState(Wa({},o.state,{idx:d}),""));function h(){return(o.state||{idx:null}).idx}function p(){a=ls.Pop;let I=h(),v=I==null?null:I-d;d=I,c&&c({action:a,location:b.location,delta:v})}function m(I,v){a=ls.Push;let w=Mf(b.location,I,v);d=h()+1;let _=Dv(w,d),E=b.createHref(w);try{o.pushState(_,"",E)}catch(j){if(j instanceof DOMException&&j.name==="DataCloneError")throw j;s.location.assign(E)}i&&c&&c({action:a,location:b.location,delta:1})}function y(I,v){a=ls.Replace;let w=Mf(b.location,I,v);d=h();let _=Dv(w,d),E=b.createHref(w);o.replaceState(_,"",E),i&&c&&c({action:a,location:b.location,delta:0})}function T(I){let v=s.location.origin!=="null"?s.location.origin:s.location.href,w=typeof I=="string"?I:uc(I);return w=w.replace(/ $/,"%20"),tt(v,"No window.location.(origin|href) available to create URL for href: "+w),new URL(w,v)}let b={get action(){return a},get location(){return t(s,o)},listen(I){if(c)throw new Error("A history only accepts one active listener");return s.addEventListener(jv,p),c=I,()=>{s.removeEventListener(jv,p),c=null}},createHref(I){return e(s,I)},createURL:T,encodeLocation(I){let v=T(I);return{pathname:v.pathname,search:v.search,hash:v.hash}},push:m,replace:y,go(I){return o.go(I)}};return b}var Ov;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(Ov||(Ov={}));function KA(t,e,n){return n===void 0&&(n="/"),QA(t,e,n)}function QA(t,e,n,r){let s=typeof e=="string"?To(e):e,i=uo(s.pathname||"/",n);if(i==null)return null;let o=ZE(t);YA(o);let a=null;for(let c=0;a==null&&c<o.length;++c){let d=aC(i);a=iC(o[c],d)}return a}function ZE(t,e,n,r){e===void 0&&(e=[]),n===void 0&&(n=[]),r===void 0&&(r="");let s=(i,o,a)=>{let c={relativePath:a===void 0?i.path||"":a,caseSensitive:i.caseSensitive===!0,childrenIndex:o,route:i};c.relativePath.startsWith("/")&&(tt(c.relativePath.startsWith(r),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(r.length));let d=vs([r,c.relativePath]),h=n.concat(c);i.children&&i.children.length>0&&(tt(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+d+'".')),ZE(i.children,e,h,d)),!(i.path==null&&!i.index)&&e.push({path:d,score:rC(d,i.index),routesMeta:h})};return t.forEach((i,o)=>{var a;if(i.path===""||!((a=i.path)!=null&&a.includes("?")))s(i,o);else for(let c of e0(i.path))s(i,o,c)}),e}function e0(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,s=n.endsWith("?"),i=n.replace(/\?$/,"");if(r.length===0)return s?[i,""]:[i];let o=e0(r.join("/")),a=[];return a.push(...o.map(c=>c===""?i:[i,c].join("/"))),s&&a.push(...o),a.map(c=>t.startsWith("/")&&c===""?"/":c)}function YA(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:sC(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const XA=/^:[\w-]+$/,JA=3,ZA=2,eC=1,tC=10,nC=-2,Lv=t=>t==="*";function rC(t,e){let n=t.split("/"),r=n.length;return n.some(Lv)&&(r+=nC),e&&(r+=ZA),n.filter(s=>!Lv(s)).reduce((s,i)=>s+(XA.test(i)?JA:i===""?eC:tC),r)}function sC(t,e){return t.length===e.length&&t.slice(0,-1).every((r,s)=>r===e[s])?t[t.length-1]-e[e.length-1]:0}function iC(t,e,n){let{routesMeta:r}=t,s={},i="/",o=[];for(let a=0;a<r.length;++a){let c=r[a],d=a===r.length-1,h=i==="/"?e:e.slice(i.length)||"/",p=Uf({path:c.relativePath,caseSensitive:c.caseSensitive,end:d},h),m=c.route;if(!p)return null;Object.assign(s,p.params),o.push({params:s,pathname:vs([i,p.pathname]),pathnameBase:dC(vs([i,p.pathnameBase])),route:m}),p.pathnameBase!=="/"&&(i=vs([i,p.pathnameBase]))}return o}function Uf(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=oC(t.path,t.caseSensitive,t.end),s=e.match(n);if(!s)return null;let i=s[0],o=i.replace(/(.)\/+$/,"$1"),a=s.slice(1);return{params:r.reduce((d,h,p)=>{let{paramName:m,isOptional:y}=h;if(m==="*"){let b=a[p]||"";o=i.slice(0,i.length-b.length).replace(/(.)\/+$/,"$1")}const T=a[p];return y&&!T?d[m]=void 0:d[m]=(T||"").replace(/%2F/g,"/"),d},{}),pathname:i,pathnameBase:o,pattern:t}}function oC(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),JE(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let r=[],s="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,a,c)=>(r.push({paramName:a,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(r.push({paramName:"*"}),s+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?s+="\\/*$":t!==""&&t!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),r]}function aC(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return JE(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function uo(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}function lC(t,e){e===void 0&&(e="/");let{pathname:n,search:r="",hash:s=""}=typeof t=="string"?To(t):t;return{pathname:n?n.startsWith("/")?n:uC(n,e):e,search:hC(r),hash:fC(s)}}function uC(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(s=>{s===".."?n.length>1&&n.pop():s!=="."&&n.push(s)}),n.length>1?n.join("/"):"/"}function xh(t,e,n,r){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function cC(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function dm(t,e){let n=cC(t);return e?n.map((r,s)=>s===n.length-1?r.pathname:r.pathnameBase):n.map(r=>r.pathnameBase)}function hm(t,e,n,r){r===void 0&&(r=!1);let s;typeof t=="string"?s=To(t):(s=Wa({},t),tt(!s.pathname||!s.pathname.includes("?"),xh("?","pathname","search",s)),tt(!s.pathname||!s.pathname.includes("#"),xh("#","pathname","hash",s)),tt(!s.search||!s.search.includes("#"),xh("#","search","hash",s)));let i=t===""||s.pathname==="",o=i?"/":s.pathname,a;if(o==null)a=n;else{let p=e.length-1;if(!r&&o.startsWith("..")){let m=o.split("/");for(;m[0]==="..";)m.shift(),p-=1;s.pathname=m.join("/")}a=p>=0?e[p]:"/"}let c=lC(s,a),d=o&&o!=="/"&&o.endsWith("/"),h=(i||o===".")&&n.endsWith("/");return!c.pathname.endsWith("/")&&(d||h)&&(c.pathname+="/"),c}const vs=t=>t.join("/").replace(/\/\/+/g,"/"),dC=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),hC=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,fC=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function pC(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const t0=["post","put","patch","delete"];new Set(t0);const mC=["get",...t0];new Set(mC);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Ha(){return Ha=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Ha.apply(this,arguments)}const Yc=R.createContext(null),n0=R.createContext(null),Fr=R.createContext(null),Xc=R.createContext(null),$r=R.createContext({outlet:null,matches:[],isDataRoute:!1}),r0=R.createContext(null);function gC(t,e){let{relative:n}=e===void 0?{}:e;So()||tt(!1);let{basename:r,navigator:s}=R.useContext(Fr),{hash:i,pathname:o,search:a}=Jc(t,{relative:n}),c=o;return r!=="/"&&(c=o==="/"?r:vs([r,o])),s.createHref({pathname:c,search:a,hash:i})}function So(){return R.useContext(Xc)!=null}function On(){return So()||tt(!1),R.useContext(Xc).location}function s0(t){R.useContext(Fr).static||R.useLayoutEffect(t)}function Br(){let{isDataRoute:t}=R.useContext($r);return t?CC():yC()}function yC(){So()||tt(!1);let t=R.useContext(Yc),{basename:e,future:n,navigator:r}=R.useContext(Fr),{matches:s}=R.useContext($r),{pathname:i}=On(),o=JSON.stringify(dm(s,n.v7_relativeSplatPath)),a=R.useRef(!1);return s0(()=>{a.current=!0}),R.useCallback(function(d,h){if(h===void 0&&(h={}),!a.current)return;if(typeof d=="number"){r.go(d);return}let p=hm(d,JSON.parse(o),i,h.relative==="path");t==null&&e!=="/"&&(p.pathname=p.pathname==="/"?e:vs([e,p.pathname])),(h.replace?r.replace:r.push)(p,h.state,h)},[e,r,o,i,t])}function Ds(){let{matches:t}=R.useContext($r),e=t[t.length-1];return e?e.params:{}}function Jc(t,e){let{relative:n}=e===void 0?{}:e,{future:r}=R.useContext(Fr),{matches:s}=R.useContext($r),{pathname:i}=On(),o=JSON.stringify(dm(s,r.v7_relativeSplatPath));return R.useMemo(()=>hm(t,JSON.parse(o),i,n==="path"),[t,o,i,n])}function vC(t,e){return _C(t,e)}function _C(t,e,n,r){So()||tt(!1);let{navigator:s}=R.useContext(Fr),{matches:i}=R.useContext($r),o=i[i.length-1],a=o?o.params:{};o&&o.pathname;let c=o?o.pathnameBase:"/";o&&o.route;let d=On(),h;if(e){var p;let I=typeof e=="string"?To(e):e;c==="/"||(p=I.pathname)!=null&&p.startsWith(c)||tt(!1),h=I}else h=d;let m=h.pathname||"/",y=m;if(c!=="/"){let I=c.replace(/^\//,"").split("/");y="/"+m.replace(/^\//,"").split("/").slice(I.length).join("/")}let T=KA(t,{pathname:y}),b=SC(T&&T.map(I=>Object.assign({},I,{params:Object.assign({},a,I.params),pathname:vs([c,s.encodeLocation?s.encodeLocation(I.pathname).pathname:I.pathname]),pathnameBase:I.pathnameBase==="/"?c:vs([c,s.encodeLocation?s.encodeLocation(I.pathnameBase).pathname:I.pathnameBase])})),i,n,r);return e&&b?R.createElement(Xc.Provider,{value:{location:Ha({pathname:"/",search:"",hash:"",state:null,key:"default"},h),navigationType:ls.Pop}},b):b}function wC(){let t=AC(),e=pC(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return R.createElement(R.Fragment,null,R.createElement("h2",null,"Unexpected Application Error!"),R.createElement("h3",{style:{fontStyle:"italic"}},e),n?R.createElement("pre",{style:s},n):null,null)}const xC=R.createElement(wC,null);class EC extends R.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?R.createElement($r.Provider,{value:this.props.routeContext},R.createElement(r0.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function TC(t){let{routeContext:e,match:n,children:r}=t,s=R.useContext(Yc);return s&&s.static&&s.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=n.route.id),R.createElement($r.Provider,{value:e},r)}function SC(t,e,n,r){var s;if(e===void 0&&(e=[]),n===void 0&&(n=null),r===void 0&&(r=null),t==null){var i;if(!n)return null;if(n.errors)t=n.matches;else if((i=r)!=null&&i.v7_partialHydration&&e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let o=t,a=(s=n)==null?void 0:s.errors;if(a!=null){let h=o.findIndex(p=>p.route.id&&(a==null?void 0:a[p.route.id])!==void 0);h>=0||tt(!1),o=o.slice(0,Math.min(o.length,h+1))}let c=!1,d=-1;if(n&&r&&r.v7_partialHydration)for(let h=0;h<o.length;h++){let p=o[h];if((p.route.HydrateFallback||p.route.hydrateFallbackElement)&&(d=h),p.route.id){let{loaderData:m,errors:y}=n,T=p.route.loader&&m[p.route.id]===void 0&&(!y||y[p.route.id]===void 0);if(p.route.lazy||T){c=!0,d>=0?o=o.slice(0,d+1):o=[o[0]];break}}}return o.reduceRight((h,p,m)=>{let y,T=!1,b=null,I=null;n&&(y=a&&p.route.id?a[p.route.id]:void 0,b=p.route.errorElement||xC,c&&(d<0&&m===0?(RC("route-fallback"),T=!0,I=null):d===m&&(T=!0,I=p.route.hydrateFallbackElement||null)));let v=e.concat(o.slice(0,m+1)),w=()=>{let _;return y?_=b:T?_=I:p.route.Component?_=R.createElement(p.route.Component,null):p.route.element?_=p.route.element:_=h,R.createElement(TC,{match:p,routeContext:{outlet:h,matches:v,isDataRoute:n!=null},children:_})};return n&&(p.route.ErrorBoundary||p.route.errorElement||m===0)?R.createElement(EC,{location:n.location,revalidation:n.revalidation,component:b,error:y,children:w(),routeContext:{outlet:null,matches:v,isDataRoute:!0}}):w()},null)}var i0=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(i0||{}),o0=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(o0||{});function IC(t){let e=R.useContext(Yc);return e||tt(!1),e}function bC(t){let e=R.useContext(n0);return e||tt(!1),e}function NC(t){let e=R.useContext($r);return e||tt(!1),e}function a0(t){let e=NC(),n=e.matches[e.matches.length-1];return n.route.id||tt(!1),n.route.id}function AC(){var t;let e=R.useContext(r0),n=bC(),r=a0();return e!==void 0?e:(t=n.errors)==null?void 0:t[r]}function CC(){let{router:t}=IC(i0.UseNavigateStable),e=a0(o0.UseNavigateStable),n=R.useRef(!1);return s0(()=>{n.current=!0}),R.useCallback(function(s,i){i===void 0&&(i={}),n.current&&(typeof s=="number"?t.navigate(s):t.navigate(s,Ha({fromRouteId:e},i)))},[t,e])}const Vv={};function RC(t,e,n){Vv[t]||(Vv[t]=!0)}function kC(t,e){t==null||t.v7_startTransition,t==null||t.v7_relativeSplatPath}function Nr(t){let{to:e,replace:n,state:r,relative:s}=t;So()||tt(!1);let{future:i,static:o}=R.useContext(Fr),{matches:a}=R.useContext($r),{pathname:c}=On(),d=Br(),h=hm(e,dm(a,i.v7_relativeSplatPath),c,s==="path"),p=JSON.stringify(h);return R.useEffect(()=>d(JSON.parse(p),{replace:n,state:r,relative:s}),[d,p,s,n,r]),null}function je(t){tt(!1)}function PC(t){let{basename:e="/",children:n=null,location:r,navigationType:s=ls.Pop,navigator:i,static:o=!1,future:a}=t;So()&&tt(!1);let c=e.replace(/^\/*/,"/"),d=R.useMemo(()=>({basename:c,navigator:i,static:o,future:Ha({v7_relativeSplatPath:!1},a)}),[c,a,i,o]);typeof r=="string"&&(r=To(r));let{pathname:h="/",search:p="",hash:m="",state:y=null,key:T="default"}=r,b=R.useMemo(()=>{let I=uo(h,c);return I==null?null:{location:{pathname:I,search:p,hash:m,state:y,key:T},navigationType:s}},[c,h,p,m,y,T,s]);return b==null?null:R.createElement(Fr.Provider,{value:d},R.createElement(Xc.Provider,{children:n,value:b}))}function jC(t){let{children:e,location:n}=t;return vC(Ff(e),n)}new Promise(()=>{});function Ff(t,e){e===void 0&&(e=[]);let n=[];return R.Children.forEach(t,(r,s)=>{if(!R.isValidElement(r))return;let i=[...e,s];if(r.type===R.Fragment){n.push.apply(n,Ff(r.props.children,i));return}r.type!==je&&tt(!1),!r.props.index||!r.props.children||tt(!1);let o={id:r.props.id||i.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(o.children=Ff(r.props.children,i)),n.push(o)}),n}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function cc(){return cc=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},cc.apply(this,arguments)}function l0(t,e){if(t==null)return{};var n={},r=Object.keys(t),s,i;for(i=0;i<r.length;i++)s=r[i],!(e.indexOf(s)>=0)&&(n[s]=t[s]);return n}function DC(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function OC(t,e){return t.button===0&&(!e||e==="_self")&&!DC(t)}function $f(t){return t===void 0&&(t=""),new URLSearchParams(typeof t=="string"||Array.isArray(t)||t instanceof URLSearchParams?t:Object.keys(t).reduce((e,n)=>{let r=t[n];return e.concat(Array.isArray(r)?r.map(s=>[n,s]):[[n,r]])},[]))}function LC(t,e){let n=$f(t);return e&&e.forEach((r,s)=>{n.has(s)||e.getAll(s).forEach(i=>{n.append(s,i)})}),n}const VC=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],MC=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],UC="6";try{window.__reactRouterVersion=UC}catch{}const FC=R.createContext({isTransitioning:!1}),$C="startTransition",Mv=jb[$C];function BC(t){let{basename:e,children:n,future:r,window:s}=t,i=R.useRef();i.current==null&&(i.current=WA({window:s,v5Compat:!0}));let o=i.current,[a,c]=R.useState({action:o.action,location:o.location}),{v7_startTransition:d}=r||{},h=R.useCallback(p=>{d&&Mv?Mv(()=>c(p)):c(p)},[c,d]);return R.useLayoutEffect(()=>o.listen(h),[o,h]),R.useEffect(()=>kC(r),[r]),R.createElement(PC,{basename:e,children:n,location:a.location,navigationType:a.action,navigator:o,future:r})}const zC=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",qC=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,_e=R.forwardRef(function(e,n){let{onClick:r,relative:s,reloadDocument:i,replace:o,state:a,target:c,to:d,preventScrollReset:h,viewTransition:p}=e,m=l0(e,VC),{basename:y}=R.useContext(Fr),T,b=!1;if(typeof d=="string"&&qC.test(d)&&(T=d,zC))try{let _=new URL(window.location.href),E=d.startsWith("//")?new URL(_.protocol+d):new URL(d),j=uo(E.pathname,y);E.origin===_.origin&&j!=null?d=j+E.search+E.hash:b=!0}catch{}let I=gC(d,{relative:s}),v=HC(d,{replace:o,state:a,target:c,preventScrollReset:h,relative:s,viewTransition:p});function w(_){r&&r(_),_.defaultPrevented||v(_)}return R.createElement("a",cc({},m,{href:T||I,onClick:b||i?r:w,ref:n,target:c}))}),lu=R.forwardRef(function(e,n){let{"aria-current":r="page",caseSensitive:s=!1,className:i="",end:o=!1,style:a,to:c,viewTransition:d,children:h}=e,p=l0(e,MC),m=Jc(c,{relative:p.relative}),y=On(),T=R.useContext(n0),{navigator:b,basename:I}=R.useContext(Fr),v=T!=null&&KC(m)&&d===!0,w=b.encodeLocation?b.encodeLocation(m).pathname:m.pathname,_=y.pathname,E=T&&T.navigation&&T.navigation.location?T.navigation.location.pathname:null;s||(_=_.toLowerCase(),E=E?E.toLowerCase():null,w=w.toLowerCase()),E&&I&&(E=uo(E,I)||E);const j=w!=="/"&&w.endsWith("/")?w.length-1:w.length;let O=_===w||!o&&_.startsWith(w)&&_.charAt(j)==="/",S=E!=null&&(E===w||!o&&E.startsWith(w)&&E.charAt(w.length)==="/"),x={isActive:O,isPending:S,isTransitioning:v},N=O?r:void 0,k;typeof i=="function"?k=i(x):k=[i,O?"active":null,S?"pending":null,v?"transitioning":null].filter(Boolean).join(" ");let P=typeof a=="function"?a(x):a;return R.createElement(_e,cc({},p,{"aria-current":N,className:k,ref:n,style:P,to:c,viewTransition:d}),typeof h=="function"?h(x):h)});var Bf;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(Bf||(Bf={}));var Uv;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(Uv||(Uv={}));function WC(t){let e=R.useContext(Yc);return e||tt(!1),e}function HC(t,e){let{target:n,replace:r,state:s,preventScrollReset:i,relative:o,viewTransition:a}=e===void 0?{}:e,c=Br(),d=On(),h=Jc(t,{relative:o});return R.useCallback(p=>{if(OC(p,n)){p.preventDefault();let m=r!==void 0?r:uc(d)===uc(h);c(t,{replace:m,state:s,preventScrollReset:i,relative:o,viewTransition:a})}},[d,c,h,r,s,n,t,i,o,a])}function GC(t){let e=R.useRef($f(t)),n=R.useRef(!1),r=On(),s=R.useMemo(()=>LC(r.search,n.current?null:e.current),[r.search]),i=Br(),o=R.useCallback((a,c)=>{const d=$f(typeof a=="function"?a(s):a);n.current=!0,i("?"+d,c)},[i,s]);return[s,o]}function KC(t,e){e===void 0&&(e={});let n=R.useContext(FC);n==null&&tt(!1);let{basename:r}=WC(Bf.useViewTransitionState),s=Jc(t,{relative:e.relative});if(!n.isTransitioning)return!1;let i=uo(n.currentLocation.pathname,r)||n.currentLocation.pathname,o=uo(n.nextLocation.pathname,r)||n.nextLocation.pathname;return Uf(s.pathname,o)!=null||Uf(s.pathname,i)!=null}const QC=()=>{};var Fv={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const u0=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},YC=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[n++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[n++],o=t[n++],a=t[n++],c=((s&7)<<18|(i&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(c>>10)),e[r++]=String.fromCharCode(56320+(c&1023))}else{const i=t[n++],o=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},c0={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const i=t[s],o=s+1<t.length,a=o?t[s+1]:0,c=s+2<t.length,d=c?t[s+2]:0,h=i>>2,p=(i&3)<<4|a>>4;let m=(a&15)<<2|d>>6,y=d&63;c||(y=64,o||(m=64)),r.push(n[h],n[p],n[m],n[y])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(u0(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):YC(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const i=n[t.charAt(s++)],a=s<t.length?n[t.charAt(s)]:0;++s;const d=s<t.length?n[t.charAt(s)]:64;++s;const p=s<t.length?n[t.charAt(s)]:64;if(++s,i==null||a==null||d==null||p==null)throw new XC;const m=i<<2|a>>4;if(r.push(m),d!==64){const y=a<<4&240|d>>2;if(r.push(y),p!==64){const T=d<<6&192|p;r.push(T)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class XC extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const JC=function(t){const e=u0(t);return c0.encodeByteArray(e,!0)},dc=function(t){return JC(t).replace(/\./g,"")},d0=function(t){try{return c0.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZC(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const e1=()=>ZC().__FIREBASE_DEFAULTS__,t1=()=>{if(typeof process>"u"||typeof Fv>"u")return;const t=Fv.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},n1=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&d0(t[1]);return e&&JSON.parse(e)},Zc=()=>{try{return QC()||e1()||t1()||n1()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},h0=t=>{var e,n;return(n=(e=Zc())==null?void 0:e.emulatorHosts)==null?void 0:n[t]},fm=t=>{const e=h0(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},f0=()=>{var t;return(t=Zc())==null?void 0:t.config},p0=t=>{var e;return(e=Zc())==null?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r1{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zr(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function ed(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function m0(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",s=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}},...t};return[dc(JSON.stringify(n)),dc(JSON.stringify(o)),""].join(".")}const wa={};function s1(){const t={prod:[],emulator:[]};for(const e of Object.keys(wa))wa[e]?t.emulator.push(e):t.prod.push(e);return t}function i1(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let $v=!1;function td(t,e){if(typeof window>"u"||typeof document>"u"||!zr(window.location.host)||wa[t]===e||wa[t]||$v)return;wa[t]=e;function n(m){return`__firebase__banner__${m}`}const r="__firebase__banner",i=s1().prod.length>0;function o(){const m=document.getElementById(r);m&&m.remove()}function a(m){m.style.display="flex",m.style.background="#7faaf0",m.style.position="fixed",m.style.bottom="5px",m.style.left="5px",m.style.padding=".5em",m.style.borderRadius="5px",m.style.alignItems="center"}function c(m,y){m.setAttribute("width","24"),m.setAttribute("id",y),m.setAttribute("height","24"),m.setAttribute("viewBox","0 0 24 24"),m.setAttribute("fill","none"),m.style.marginLeft="-6px"}function d(){const m=document.createElement("span");return m.style.cursor="pointer",m.style.marginLeft="16px",m.style.fontSize="24px",m.innerHTML=" &times;",m.onclick=()=>{$v=!0,o()},m}function h(m,y){m.setAttribute("id",y),m.innerText="Learn more",m.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",m.setAttribute("target","__blank"),m.style.paddingLeft="5px",m.style.textDecoration="underline"}function p(){const m=i1(r),y=n("text"),T=document.getElementById(y)||document.createElement("span"),b=n("learnmore"),I=document.getElementById(b)||document.createElement("a"),v=n("preprendIcon"),w=document.getElementById(v)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(m.created){const _=m.element;a(_),h(I,b);const E=d();c(w,v),_.append(w,T,I,E),document.body.appendChild(_)}i?(T.innerText="Preview backend disconnected.",w.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(w.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,T.innerText="Preview backend running in this workspace."),T.setAttribute("id",y)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",p):p()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qt(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function o1(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(qt())}function a1(){var e;const t=(e=Zc())==null?void 0:e.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function l1(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function u1(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function c1(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function d1(){const t=qt();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function h1(){return!a1()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function g0(){try{return typeof indexedDB=="object"}catch{return!1}}function y0(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var i;e(((i=s.error)==null?void 0:i.message)||"")}}catch(n){e(n)}})}function f1(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const p1="FirebaseError";class Ln extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=p1,Object.setPrototypeOf(this,Ln.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,yi.prototype.create)}}class yi{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?m1(i,r):"Error",a=`${this.serviceName}: ${o} (${s}).`;return new Ln(s,a,r)}}function m1(t,e){return t.replace(g1,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const g1=/\{\$([^}]+)}/g;function y1(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function oi(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const s of n){if(!r.includes(s))return!1;const i=t[s],o=e[s];if(Bv(i)&&Bv(o)){if(!oi(i,o))return!1}else if(i!==o)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function Bv(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dl(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function oa(t){const e={};return t.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[s,i]=r.split("=");e[decodeURIComponent(s)]=decodeURIComponent(i)}}),e}function aa(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}function v1(t,e){const n=new _1(t,e);return n.subscribe.bind(n)}class _1{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let s;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");w1(e,["next","error","complete"])?s=e:s={next:e,error:n,complete:r},s.next===void 0&&(s.next=Eh),s.error===void 0&&(s.error=Eh),s.complete===void 0&&(s.complete=Eh);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function w1(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function Eh(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Re(t){return t&&t._delegate?t._delegate:t}class wn{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ws="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x1{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new r1;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),r=(e==null?void 0:e.optional)??!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(s){if(r)return null;throw s}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(T1(e))try{this.getOrInitializeService({instanceIdentifier:Ws})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=Ws){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Ws){return this.instances.has(e)}getOptions(e=Ws){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[i,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(i);r===a&&o.resolve(s)}return s}onInit(e,n){const r=this.normalizeInstanceIdentifier(n),s=this.onInitCallbacks.get(r)??new Set;s.add(e),this.onInitCallbacks.set(r,s);const i=this.instances.get(r);return i&&e(i,r),()=>{s.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const s of r)try{s(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:E1(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Ws){return this.component?this.component.multipleInstances?e:Ws:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function E1(t){return t===Ws?void 0:t}function T1(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S1{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new x1(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ie;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Ie||(Ie={}));const I1={debug:Ie.DEBUG,verbose:Ie.VERBOSE,info:Ie.INFO,warn:Ie.WARN,error:Ie.ERROR,silent:Ie.SILENT},b1=Ie.INFO,N1={[Ie.DEBUG]:"log",[Ie.VERBOSE]:"log",[Ie.INFO]:"info",[Ie.WARN]:"warn",[Ie.ERROR]:"error"},A1=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),s=N1[e];if(s)console[s](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class pm{constructor(e){this.name=e,this._logLevel=b1,this._logHandler=A1,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ie))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?I1[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ie.DEBUG,...e),this._logHandler(this,Ie.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ie.VERBOSE,...e),this._logHandler(this,Ie.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ie.INFO,...e),this._logHandler(this,Ie.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ie.WARN,...e),this._logHandler(this,Ie.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ie.ERROR,...e),this._logHandler(this,Ie.ERROR,...e)}}const C1=(t,e)=>e.some(n=>t instanceof n);let zv,qv;function R1(){return zv||(zv=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function k1(){return qv||(qv=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const v0=new WeakMap,zf=new WeakMap,_0=new WeakMap,Th=new WeakMap,mm=new WeakMap;function P1(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{n(Ar(t.result)),s()},o=()=>{r(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&v0.set(n,t)}).catch(()=>{}),mm.set(e,t),e}function j1(t){if(zf.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{n(),s()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)});zf.set(t,e)}let qf={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return zf.get(t);if(e==="objectStoreNames")return t.objectStoreNames||_0.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Ar(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function D1(t){qf=t(qf)}function O1(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(Sh(this),e,...n);return _0.set(r,e.sort?e.sort():[e]),Ar(r)}:k1().includes(t)?function(...e){return t.apply(Sh(this),e),Ar(v0.get(this))}:function(...e){return Ar(t.apply(Sh(this),e))}}function L1(t){return typeof t=="function"?O1(t):(t instanceof IDBTransaction&&j1(t),C1(t,R1())?new Proxy(t,qf):t)}function Ar(t){if(t instanceof IDBRequest)return P1(t);if(Th.has(t))return Th.get(t);const e=L1(t);return e!==t&&(Th.set(t,e),mm.set(e,t)),e}const Sh=t=>mm.get(t);function nd(t,e,{blocked:n,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(t,e),a=Ar(o);return r&&o.addEventListener("upgradeneeded",c=>{r(Ar(o.result),c.oldVersion,c.newVersion,Ar(o.transaction),c)}),n&&o.addEventListener("blocked",c=>n(c.oldVersion,c.newVersion,c)),a.then(c=>{i&&c.addEventListener("close",()=>i()),s&&c.addEventListener("versionchange",d=>s(d.oldVersion,d.newVersion,d))}).catch(()=>{}),a}function Ih(t,{blocked:e}={}){const n=indexedDB.deleteDatabase(t);return e&&n.addEventListener("blocked",r=>e(r.oldVersion,r)),Ar(n).then(()=>{})}const V1=["get","getKey","getAll","getAllKeys","count"],M1=["put","add","delete","clear"],bh=new Map;function Wv(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(bh.get(e))return bh.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=M1.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||V1.includes(n)))return;const i=async function(o,...a){const c=this.transaction(o,s?"readwrite":"readonly");let d=c.store;return r&&(d=d.index(a.shift())),(await Promise.all([d[n](...a),s&&c.done]))[0]};return bh.set(e,i),i}D1(t=>({...t,get:(e,n,r)=>Wv(e,n)||t.get(e,n,r),has:(e,n)=>!!Wv(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U1{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(F1(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function F1(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Wf="@firebase/app",Hv="0.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Or=new pm("@firebase/app"),$1="@firebase/app-compat",B1="@firebase/analytics-compat",z1="@firebase/analytics",q1="@firebase/app-check-compat",W1="@firebase/app-check",H1="@firebase/auth",G1="@firebase/auth-compat",K1="@firebase/database",Q1="@firebase/data-connect",Y1="@firebase/database-compat",X1="@firebase/functions",J1="@firebase/functions-compat",Z1="@firebase/installations",eR="@firebase/installations-compat",tR="@firebase/messaging",nR="@firebase/messaging-compat",rR="@firebase/performance",sR="@firebase/performance-compat",iR="@firebase/remote-config",oR="@firebase/remote-config-compat",aR="@firebase/storage",lR="@firebase/storage-compat",uR="@firebase/firestore",cR="@firebase/ai",dR="@firebase/firestore-compat",hR="firebase",fR="12.1.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hf="[DEFAULT]",pR={[Wf]:"fire-core",[$1]:"fire-core-compat",[z1]:"fire-analytics",[B1]:"fire-analytics-compat",[W1]:"fire-app-check",[q1]:"fire-app-check-compat",[H1]:"fire-auth",[G1]:"fire-auth-compat",[K1]:"fire-rtdb",[Q1]:"fire-data-connect",[Y1]:"fire-rtdb-compat",[X1]:"fire-fn",[J1]:"fire-fn-compat",[Z1]:"fire-iid",[eR]:"fire-iid-compat",[tR]:"fire-fcm",[nR]:"fire-fcm-compat",[rR]:"fire-perf",[sR]:"fire-perf-compat",[iR]:"fire-rc",[oR]:"fire-rc-compat",[aR]:"fire-gcs",[lR]:"fire-gcs-compat",[uR]:"fire-fst",[dR]:"fire-fst-compat",[cR]:"fire-vertex","fire-js":"fire-js",[hR]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ga=new Map,mR=new Map,Gf=new Map;function Gv(t,e){try{t.container.addComponent(e)}catch(n){Or.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function Pn(t){const e=t.name;if(Gf.has(e))return Or.debug(`There were multiple attempts to register component ${e}.`),!1;Gf.set(e,t);for(const n of Ga.values())Gv(n,t);for(const n of mR.values())Gv(n,t);return!0}function Os(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function Xt(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gR={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},_s=new yi("app","Firebase",gR);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yR{constructor(e,n,r){this._isDeleted=!1,this._options={...e},this._config={...n},this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new wn("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw _s.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vi=fR;function w0(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r={name:Hf,automaticDataCollectionEnabled:!0,...e},s=r.name;if(typeof s!="string"||!s)throw _s.create("bad-app-name",{appName:String(s)});if(n||(n=f0()),!n)throw _s.create("no-options");const i=Ga.get(s);if(i){if(oi(n,i.options)&&oi(r,i.config))return i;throw _s.create("duplicate-app",{appName:s})}const o=new S1(s);for(const c of Gf.values())o.addComponent(c);const a=new yR(n,r,o);return Ga.set(s,a),a}function Io(t=Hf){const e=Ga.get(t);if(!e&&t===Hf&&f0())return w0();if(!e)throw _s.create("no-app",{appName:t});return e}function vR(){return Array.from(Ga.values())}function $t(t,e,n){let r=pR[t]??t;n&&(r+=`-${n}`);const s=r.match(/\s|\//),i=e.match(/\s|\//);if(s||i){const o=[`Unable to register library "${r}" with version "${e}":`];s&&o.push(`library name "${r}" contains illegal characters (whitespace or "/")`),s&&i&&o.push("and"),i&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Or.warn(o.join(" "));return}Pn(new wn(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _R="firebase-heartbeat-database",wR=1,Ka="firebase-heartbeat-store";let Nh=null;function x0(){return Nh||(Nh=nd(_R,wR,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Ka)}catch(n){console.warn(n)}}}}).catch(t=>{throw _s.create("idb-open",{originalErrorMessage:t.message})})),Nh}async function xR(t){try{const n=(await x0()).transaction(Ka),r=await n.objectStore(Ka).get(E0(t));return await n.done,r}catch(e){if(e instanceof Ln)Or.warn(e.message);else{const n=_s.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Or.warn(n.message)}}}async function Kv(t,e){try{const r=(await x0()).transaction(Ka,"readwrite");await r.objectStore(Ka).put(e,E0(t)),await r.done}catch(n){if(n instanceof Ln)Or.warn(n.message);else{const r=_s.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});Or.warn(r.message)}}}function E0(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ER=1024,TR=30;class SR{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new bR(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=Qv();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)==null?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats.length>TR){const o=NR(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){Or.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=Qv(),{heartbeatsToSend:r,unsentEntries:s}=IR(this._heartbeatsCache.heartbeats),i=dc(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(n){return Or.warn(n),""}}}function Qv(){return new Date().toISOString().substring(0,10)}function IR(t,e=ER){const n=[];let r=t.slice();for(const s of t){const i=n.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),Yv(n)>e){i.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),Yv(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class bR{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return g0()?y0().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await xR(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return Kv(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return Kv(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function Yv(t){return dc(JSON.stringify({version:2,heartbeats:t})).length}function NR(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let r=1;r<t.length;r++)t[r].date<n&&(n=t[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AR(t){Pn(new wn("platform-logger",e=>new U1(e),"PRIVATE")),Pn(new wn("heartbeat",e=>new SR(e),"PRIVATE")),$t(Wf,Hv,t),$t(Wf,Hv,"esm2020"),$t("fire-js","")}AR("");function T0(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const CR=T0,S0=new yi("auth","Firebase",T0());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hc=new pm("@firebase/auth");function RR(t,...e){hc.logLevel<=Ie.WARN&&hc.warn(`Auth (${vi}): ${t}`,...e)}function Ru(t,...e){hc.logLevel<=Ie.ERROR&&hc.error(`Auth (${vi}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xn(t,...e){throw ym(t,...e)}function Hn(t,...e){return ym(t,...e)}function gm(t,e,n){const r={...CR(),[e]:n};return new yi("auth","Firebase",r).create(e,{appName:t.name})}function Cr(t){return gm(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function kR(t,e,n){const r=n;if(!(e instanceof r))throw r.name!==e.constructor.name&&xn(t,"argument-error"),gm(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function ym(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return S0.create(t,...e)}function de(t,e,...n){if(!t)throw ym(e,...n)}function Sr(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Ru(e),new Error(e)}function Lr(t,e){t||Sr(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kf(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.href)||""}function PR(){return Xv()==="http:"||Xv()==="https:"}function Xv(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jR(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(PR()||u1()||"connection"in navigator)?navigator.onLine:!0}function DR(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hl{constructor(e,n){this.shortDelay=e,this.longDelay=n,Lr(n>e,"Short delay should be less than long delay!"),this.isMobile=o1()||c1()}get(){return jR()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vm(t,e){Lr(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I0{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Sr("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Sr("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Sr("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OR={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LR=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],VR=new hl(3e4,6e4);function hr(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function Xn(t,e,n,r,s={}){return b0(t,s,async()=>{let i={},o={};r&&(e==="GET"?o=r:i={body:JSON.stringify(r)});const a=dl({key:t.config.apiKey,...o}).slice(1),c=await t._getAdditionalHeaders();c["Content-Type"]="application/json",t.languageCode&&(c["X-Firebase-Locale"]=t.languageCode);const d={method:e,headers:c,...i};return l1()||(d.referrerPolicy="no-referrer"),t.emulatorConfig&&zr(t.emulatorConfig.host)&&(d.credentials="include"),I0.fetch()(await N0(t,t.config.apiHost,n,a),d)})}async function b0(t,e,n){t._canInitEmulator=!1;const r={...OR,...e};try{const s=new UR(t),i=await Promise.race([n(),s.promise]);s.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw uu(t,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const a=i.ok?o.errorMessage:o.error.message,[c,d]=a.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw uu(t,"credential-already-in-use",o);if(c==="EMAIL_EXISTS")throw uu(t,"email-already-in-use",o);if(c==="USER_DISABLED")throw uu(t,"user-disabled",o);const h=r[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw gm(t,h,d);xn(t,h)}}catch(s){if(s instanceof Ln)throw s;xn(t,"network-request-failed",{message:String(s)})}}async function fl(t,e,n,r,s={}){const i=await Xn(t,e,n,r,s);return"mfaPendingCredential"in i&&xn(t,"multi-factor-auth-required",{_serverResponse:i}),i}async function N0(t,e,n,r){const s=`${e}${n}?${r}`,i=t,o=i.config.emulator?vm(t.config,s):`${t.config.apiScheme}://${s}`;return LR.includes(n)&&(await i._persistenceManagerAvailable,i._getPersistenceType()==="COOKIE")?i._getPersistence()._getFinalTarget(o).toString():o}function MR(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class UR{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(Hn(this.auth,"network-request-failed")),VR.get())})}}function uu(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const s=Hn(t,e,r);return s.customData._tokenResponse=n,s}function Jv(t){return t!==void 0&&t.enterprise!==void 0}class FR{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return MR(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function $R(t,e){return Xn(t,"GET","/v2/recaptchaConfig",hr(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function BR(t,e){return Xn(t,"POST","/v1/accounts:delete",e)}async function fc(t,e){return Xn(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xa(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function zR(t,e=!1){const n=Re(t),r=await n.getIdToken(e),s=_m(r);de(s&&s.exp&&s.auth_time&&s.iat,n.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,o=i==null?void 0:i.sign_in_provider;return{claims:s,token:r,authTime:xa(Ah(s.auth_time)),issuedAtTime:xa(Ah(s.iat)),expirationTime:xa(Ah(s.exp)),signInProvider:o||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function Ah(t){return Number(t)*1e3}function _m(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return Ru("JWT malformed, contained fewer than 3 sections"),null;try{const s=d0(n);return s?JSON.parse(s):(Ru("Failed to decode base64 JWT payload"),null)}catch(s){return Ru("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function Zv(t){const e=_m(t);return de(e,"internal-error"),de(typeof e.exp<"u","internal-error"),de(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function co(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof Ln&&qR(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function qR({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WR{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qf{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=xa(this.lastLoginAt),this.creationTime=xa(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function pc(t){var p;const e=t.auth,n=await t.getIdToken(),r=await co(t,fc(e,{idToken:n}));de(r==null?void 0:r.users.length,e,"internal-error");const s=r.users[0];t._notifyReloadListener(s);const i=(p=s.providerUserInfo)!=null&&p.length?A0(s.providerUserInfo):[],o=GR(t.providerData,i),a=t.isAnonymous,c=!(t.email&&s.passwordHash)&&!(o!=null&&o.length),d=a?c:!1,h={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new Qf(s.createdAt,s.lastLoginAt),isAnonymous:d};Object.assign(t,h)}async function HR(t){const e=Re(t);await pc(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function GR(t,e){return[...t.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function A0(t){return t.map(({providerId:e,...n})=>({providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function KR(t,e){const n=await b0(t,{},async()=>{const r=dl({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=t.config,o=await N0(t,s,"/v1/token",`key=${i}`),a=await t._getAdditionalHeaders();a["Content-Type"]="application/x-www-form-urlencoded";const c={method:"POST",headers:a,body:r};return t.emulatorConfig&&zr(t.emulatorConfig.host)&&(c.credentials="include"),I0.fetch()(o,c)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function QR(t,e){return Xn(t,"POST","/v2/accounts:revokeToken",hr(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ji{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){de(e.idToken,"internal-error"),de(typeof e.idToken<"u","internal-error"),de(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Zv(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){de(e.length!==0,"internal-error");const n=Zv(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(de(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:s,expiresIn:i}=await KR(e,n);this.updateTokensAndExpiration(r,s,Number(i))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:s,expirationTime:i}=n,o=new Ji;return r&&(de(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),s&&(de(typeof s=="string","internal-error",{appName:e}),o.accessToken=s),i&&(de(typeof i=="number","internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Ji,this.toJSON())}_performRefresh(){return Sr("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yr(t,e){de(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class zn{constructor({uid:e,auth:n,stsTokenManager:r,...s}){this.providerId="firebase",this.proactiveRefresh=new WR(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new Qf(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const n=await co(this,this.stsTokenManager.getToken(this.auth,e));return de(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return zR(this,e)}reload(){return HR(this)}_assign(e){this!==e&&(de(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>({...n})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new zn({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return n.metadata._copy(this.metadata),n}_onReload(e){de(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await pc(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Xt(this.auth.app))return Promise.reject(Cr(this.auth));const e=await this.getIdToken();return await co(this,BR(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){const r=n.displayName??void 0,s=n.email??void 0,i=n.phoneNumber??void 0,o=n.photoURL??void 0,a=n.tenantId??void 0,c=n._redirectEventId??void 0,d=n.createdAt??void 0,h=n.lastLoginAt??void 0,{uid:p,emailVerified:m,isAnonymous:y,providerData:T,stsTokenManager:b}=n;de(p&&b,e,"internal-error");const I=Ji.fromJSON(this.name,b);de(typeof p=="string",e,"internal-error"),Yr(r,e.name),Yr(s,e.name),de(typeof m=="boolean",e,"internal-error"),de(typeof y=="boolean",e,"internal-error"),Yr(i,e.name),Yr(o,e.name),Yr(a,e.name),Yr(c,e.name),Yr(d,e.name),Yr(h,e.name);const v=new zn({uid:p,auth:e,email:s,emailVerified:m,displayName:r,isAnonymous:y,photoURL:o,phoneNumber:i,tenantId:a,stsTokenManager:I,createdAt:d,lastLoginAt:h});return T&&Array.isArray(T)&&(v.providerData=T.map(w=>({...w}))),c&&(v._redirectEventId=c),v}static async _fromIdTokenResponse(e,n,r=!1){const s=new Ji;s.updateFromServerResponse(n);const i=new zn({uid:n.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await pc(i),i}static async _fromGetAccountInfoResponse(e,n,r){const s=n.users[0];de(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?A0(s.providerUserInfo):[],o=!(s.email&&s.passwordHash)&&!(i!=null&&i.length),a=new Ji;a.updateFromIdToken(r);const c=new zn({uid:s.localId,auth:e,stsTokenManager:a,isAnonymous:o}),d={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new Qf(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(i!=null&&i.length)};return Object.assign(c,d),c}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const e_=new Map;function Ir(t){Lr(t instanceof Function,"Expected a class definition");let e=e_.get(t);return e?(Lr(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,e_.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C0{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}C0.type="NONE";const t_=C0;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ku(t,e,n){return`firebase:${t}:${e}:${n}`}class Zi{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:s,name:i}=this.auth;this.fullUserKey=ku(this.userKey,s.apiKey,i),this.fullPersistenceKey=ku("persistence",s.apiKey,i),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const n=await fc(this.auth,{idToken:e}).catch(()=>{});return n?zn._fromGetAccountInfoResponse(this.auth,n,e):null}return zn._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new Zi(Ir(t_),e,r);const s=(await Promise.all(n.map(async d=>{if(await d._isAvailable())return d}))).filter(d=>d);let i=s[0]||Ir(t_);const o=ku(r,e.config.apiKey,e.name);let a=null;for(const d of n)try{const h=await d._get(o);if(h){let p;if(typeof h=="string"){const m=await fc(e,{idToken:h}).catch(()=>{});if(!m)break;p=await zn._fromGetAccountInfoResponse(e,m,h)}else p=zn._fromJSON(e,h);d!==i&&(a=p),i=d;break}}catch{}const c=s.filter(d=>d._shouldAllowMigration);return!i._shouldAllowMigration||!c.length?new Zi(i,e,r):(i=c[0],a&&await i._set(o,a.toJSON()),await Promise.all(n.map(async d=>{if(d!==i)try{await d._remove(o)}catch{}})),new Zi(i,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function n_(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(j0(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(R0(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(O0(e))return"Blackberry";if(L0(e))return"Webos";if(k0(e))return"Safari";if((e.includes("chrome/")||P0(e))&&!e.includes("edge/"))return"Chrome";if(D0(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function R0(t=qt()){return/firefox\//i.test(t)}function k0(t=qt()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function P0(t=qt()){return/crios\//i.test(t)}function j0(t=qt()){return/iemobile/i.test(t)}function D0(t=qt()){return/android/i.test(t)}function O0(t=qt()){return/blackberry/i.test(t)}function L0(t=qt()){return/webos/i.test(t)}function wm(t=qt()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function YR(t=qt()){var e;return wm(t)&&!!((e=window.navigator)!=null&&e.standalone)}function XR(){return d1()&&document.documentMode===10}function V0(t=qt()){return wm(t)||D0(t)||L0(t)||O0(t)||/windows phone/i.test(t)||j0(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function M0(t,e=[]){let n;switch(t){case"Browser":n=n_(qt());break;case"Worker":n=`${n_(qt())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${vi}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JR{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=i=>new Promise((o,a)=>{try{const c=e(i);o(c)}catch(c){a(c)}});r.onAbort=n,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const s of n)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ZR(t,e={}){return Xn(t,"GET","/v2/passwordPolicy",hr(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ek=6;class tk{constructor(e){var r;const n=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=n.minPasswordLength??ek,n.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=n.maxPasswordLength),n.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=n.containsLowercaseCharacter),n.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=n.containsUppercaseCharacter),n.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=n.containsNumericCharacter),n.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=n.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((r=e.allowedNonAlphanumericCharacters)==null?void 0:r.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const n={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,n),this.validatePasswordCharacterOptions(e,n),n.isValid&&(n.isValid=n.meetsMinPasswordLength??!0),n.isValid&&(n.isValid=n.meetsMaxPasswordLength??!0),n.isValid&&(n.isValid=n.containsLowercaseLetter??!0),n.isValid&&(n.isValid=n.containsUppercaseLetter??!0),n.isValid&&(n.isValid=n.containsNumericCharacter??!0),n.isValid&&(n.isValid=n.containsNonAlphanumericCharacter??!0),n}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),s&&(n.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nk{constructor(e,n,r,s){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new r_(this),this.idTokenSubscription=new r_(this),this.beforeStateQueue=new JR(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=S0,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(i=>this._resolvePersistenceManagerAvailable=i)}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=Ir(n)),this._initializationPromise=this.queue(async()=>{var r,s,i;if(!this._deleted&&(this.persistenceManager=await Zi.create(this,e),(r=this._resolvePersistenceManagerAvailable)==null||r.call(this),!this._deleted)){if((s=this._popupRedirectResolver)!=null&&s._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((i=this.currentUser)==null?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await fc(this,{idToken:e}),r=await zn._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var i;if(Xt(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let r=n,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(i=this.redirectUser)==null?void 0:i._redirectEventId,a=r==null?void 0:r._redirectEventId,c=await this.tryRedirectSignIn(e);(!o||o===a)&&(c!=null&&c.user)&&(r=c.user,s=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(r)}catch(o){r=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return de(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await pc(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=DR()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Xt(this.app))return Promise.reject(Cr(this));const n=e?Re(e):null;return n&&de(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&de(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Xt(this.app)?Promise.reject(Cr(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Xt(this.app)?Promise.reject(Cr(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Ir(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await ZR(this),n=new tk(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new yi("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await QR(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&Ir(e)||this._popupRedirectResolver;de(n,this,"argument-error"),this.redirectPersistenceManager=await Zi.create(this,[Ir(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)==null?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)==null?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((n=this.currentUser)==null?void 0:n.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,s){if(this._deleted)return()=>{};const i=typeof n=="function"?n:n.next.bind(n);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(de(a,this,"internal-error"),a.then(()=>{o||i(this.currentUser)}),typeof n=="function"){const c=e.addObserver(n,r,s);return()=>{o=!0,c()}}else{const c=e.addObserver(n);return()=>{o=!0,c()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return de(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=M0(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var s;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const n=await((s=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:s.getHeartbeatsHeader());n&&(e["X-Firebase-Client"]=n);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){var n;if(Xt(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((n=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:n.getToken());return e!=null&&e.error&&RR(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function fr(t){return Re(t)}class r_{constructor(e){this.auth=e,this.observer=null,this.addObserver=v1(n=>this.observer=n)}get next(){return de(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let rd={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function rk(t){rd=t}function U0(t){return rd.loadJS(t)}function sk(){return rd.recaptchaEnterpriseScript}function ik(){return rd.gapiScript}function ok(t){return`__${t}${Math.floor(Math.random()*1e6)}`}class ak{constructor(){this.enterprise=new lk}ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}class lk{ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}const uk="recaptcha-enterprise",F0="NO_RECAPTCHA";class ck{constructor(e){this.type=uk,this.auth=fr(e)}async verify(e="verify",n=!1){async function r(i){if(!n){if(i.tenantId==null&&i._agentRecaptchaConfig!=null)return i._agentRecaptchaConfig.siteKey;if(i.tenantId!=null&&i._tenantRecaptchaConfigs[i.tenantId]!==void 0)return i._tenantRecaptchaConfigs[i.tenantId].siteKey}return new Promise(async(o,a)=>{$R(i,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(c=>{if(c.recaptchaKey===void 0)a(new Error("recaptcha Enterprise site key undefined"));else{const d=new FR(c);return i.tenantId==null?i._agentRecaptchaConfig=d:i._tenantRecaptchaConfigs[i.tenantId]=d,o(d.siteKey)}}).catch(c=>{a(c)})})}function s(i,o,a){const c=window.grecaptcha;Jv(c)?c.enterprise.ready(()=>{c.enterprise.execute(i,{action:e}).then(d=>{o(d)}).catch(()=>{o(F0)})}):a(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new ak().execute("siteKey",{action:"verify"}):new Promise((i,o)=>{r(this.auth).then(a=>{if(!n&&Jv(window.grecaptcha))s(a,i,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let c=sk();c.length!==0&&(c+=a),U0(c).then(()=>{s(a,i,o)}).catch(d=>{o(d)})}}).catch(a=>{o(a)})})}}async function s_(t,e,n,r=!1,s=!1){const i=new ck(t);let o;if(s)o=F0;else try{o=await i.verify(n)}catch{o=await i.verify(n,!0)}const a={...e};if(n==="mfaSmsEnrollment"||n==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in a){const c=a.phoneEnrollmentInfo.phoneNumber,d=a.phoneEnrollmentInfo.recaptchaToken;Object.assign(a,{phoneEnrollmentInfo:{phoneNumber:c,recaptchaToken:d,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in a){const c=a.phoneSignInInfo.recaptchaToken;Object.assign(a,{phoneSignInInfo:{recaptchaToken:c,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return a}return r?Object.assign(a,{captchaResp:o}):Object.assign(a,{captchaResponse:o}),Object.assign(a,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(a,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),a}async function mc(t,e,n,r,s){var i;if((i=t._getRecaptchaConfig())!=null&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const o=await s_(t,e,n,n==="getOobCode");return r(t,o)}else return r(t,e).catch(async o=>{if(o.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const a=await s_(t,e,n,n==="getOobCode");return r(t,a)}else return Promise.reject(o)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dk(t,e){const n=Os(t,"auth");if(n.isInitialized()){const s=n.getImmediate(),i=n.getOptions();if(oi(i,e??{}))return s;xn(s,"already-initialized")}return n.initialize({options:e})}function hk(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(Ir);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function fk(t,e,n){const r=fr(t);de(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!1,i=$0(e),{host:o,port:a}=pk(e),c=a===null?"":`:${a}`,d={url:`${i}//${o}${c}/`},h=Object.freeze({host:o,port:a,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!r._canInitEmulator){de(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),de(oi(d,r.config.emulator)&&oi(h,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=d,r.emulatorConfig=h,r.settings.appVerificationDisabledForTesting=!0,zr(o)?(ed(`${i}//${o}${c}`),td("Auth",!0)):mk()}function $0(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function pk(t){const e=$0(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const i=s[1];return{host:i,port:i_(r.substr(i.length+1))}}else{const[i,o]=r.split(":");return{host:i,port:i_(o)}}}function i_(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function mk(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xm{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return Sr("not implemented")}_getIdTokenResponse(e){return Sr("not implemented")}_linkToIdToken(e,n){return Sr("not implemented")}_getReauthenticationResolver(e){return Sr("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function B0(t,e){return Xn(t,"POST","/v1/accounts:resetPassword",hr(t,e))}async function gk(t,e){return Xn(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function yk(t,e){return fl(t,"POST","/v1/accounts:signInWithPassword",hr(t,e))}async function vk(t,e){return Xn(t,"POST","/v1/accounts:sendOobCode",hr(t,e))}async function _k(t,e){return vk(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function wk(t,e){return fl(t,"POST","/v1/accounts:signInWithEmailLink",hr(t,e))}async function xk(t,e){return fl(t,"POST","/v1/accounts:signInWithEmailLink",hr(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qa extends xm{constructor(e,n,r,s=null){super("password",r),this._email=e,this._password=n,this._tenantId=s}static _fromEmailAndPassword(e,n){return new Qa(e,n,"password")}static _fromEmailAndCode(e,n,r=null){return new Qa(e,n,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n!=null&&n.email&&(n!=null&&n.password)){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return mc(e,n,"signInWithPassword",yk);case"emailLink":return wk(e,{email:this._email,oobCode:this._password});default:xn(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const r={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return mc(e,r,"signUpPassword",gk);case"emailLink":return xk(e,{idToken:n,email:this._email,oobCode:this._password});default:xn(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function eo(t,e){return fl(t,"POST","/v1/accounts:signInWithIdp",hr(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ek="http://localhost";class ai extends xm{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new ai(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):xn("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s,...i}=n;if(!r||!s)return null;const o=new ai(r,s);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return eo(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,eo(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,eo(e,n)}buildRequest(){const e={requestUri:Ek,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=dl(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tk(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function Sk(t){const e=oa(aa(t)).link,n=e?oa(aa(e)).deep_link_id:null,r=oa(aa(t)).deep_link_id;return(r?oa(aa(r)).link:null)||r||n||e||t}class Em{constructor(e){const n=oa(aa(e)),r=n.apiKey??null,s=n.oobCode??null,i=Tk(n.mode??null);de(r&&s&&i,"argument-error"),this.apiKey=r,this.operation=i,this.code=s,this.continueUrl=n.continueUrl??null,this.languageCode=n.lang??null,this.tenantId=n.tenantId??null}static parseLink(e){const n=Sk(e);try{return new Em(n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bo{constructor(){this.providerId=bo.PROVIDER_ID}static credential(e,n){return Qa._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const r=Em.parseLink(n);return de(r,"argument-error"),Qa._fromEmailAndCode(e,r.code,r.tenantId)}}bo.PROVIDER_ID="password";bo.EMAIL_PASSWORD_SIGN_IN_METHOD="password";bo.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tm{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pl extends Tm{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ts extends pl{constructor(){super("facebook.com")}static credential(e){return ai._fromParams({providerId:ts.PROVIDER_ID,signInMethod:ts.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ts.credentialFromTaggedObject(e)}static credentialFromError(e){return ts.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ts.credential(e.oauthAccessToken)}catch{return null}}}ts.FACEBOOK_SIGN_IN_METHOD="facebook.com";ts.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bn extends pl{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return ai._fromParams({providerId:bn.PROVIDER_ID,signInMethod:bn.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return bn.credentialFromTaggedObject(e)}static credentialFromError(e){return bn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return bn.credential(n,r)}catch{return null}}}bn.GOOGLE_SIGN_IN_METHOD="google.com";bn.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ns extends pl{constructor(){super("github.com")}static credential(e){return ai._fromParams({providerId:ns.PROVIDER_ID,signInMethod:ns.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ns.credentialFromTaggedObject(e)}static credentialFromError(e){return ns.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ns.credential(e.oauthAccessToken)}catch{return null}}}ns.GITHUB_SIGN_IN_METHOD="github.com";ns.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rs extends pl{constructor(){super("twitter.com")}static credential(e,n){return ai._fromParams({providerId:rs.PROVIDER_ID,signInMethod:rs.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return rs.credentialFromTaggedObject(e)}static credentialFromError(e){return rs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return rs.credential(n,r)}catch{return null}}}rs.TWITTER_SIGN_IN_METHOD="twitter.com";rs.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ik(t,e){return fl(t,"POST","/v1/accounts:signUp",hr(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class li{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,s=!1){const i=await zn._fromIdTokenResponse(e,r,s),o=o_(r);return new li({user:i,providerId:o,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const s=o_(r);return new li({user:e,providerId:s,_tokenResponse:r,operationType:n})}}function o_(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gc extends Ln{constructor(e,n,r,s){super(n.code,n.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,gc.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,s){return new gc(e,n,r,s)}}function z0(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?gc._fromErrorAndOperation(t,i,e,r):i})}async function bk(t,e,n=!1){const r=await co(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return li._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Nk(t,e,n=!1){const{auth:r}=t;if(Xt(r.app))return Promise.reject(Cr(r));const s="reauthenticate";try{const i=await co(t,z0(r,s,e,t),n);de(i.idToken,r,"internal-error");const o=_m(i.idToken);de(o,r,"internal-error");const{sub:a}=o;return de(t.uid===a,r,"user-mismatch"),li._forOperation(t,s,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&xn(r,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function q0(t,e,n=!1){if(Xt(t.app))return Promise.reject(Cr(t));const r="signIn",s=await z0(t,r,e),i=await li._fromIdTokenResponse(t,r,s);return n||await t._updateCurrentUser(i.user),i}async function Ak(t,e){return q0(fr(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sm{constructor(e,n){this.factorId=e,this.uid=n.mfaEnrollmentId,this.enrollmentTime=new Date(n.enrolledAt).toUTCString(),this.displayName=n.displayName}static _fromServerResponse(e,n){return"phoneInfo"in n?Im._fromServerResponse(e,n):"totpInfo"in n?bm._fromServerResponse(e,n):xn(e,"internal-error")}}class Im extends Sm{constructor(e){super("phone",e),this.phoneNumber=e.phoneInfo}static _fromServerResponse(e,n){return new Im(n)}}class bm extends Sm{constructor(e){super("totp",e)}static _fromServerResponse(e,n){return new bm(n)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Nm(t){const e=fr(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function Ck(t,e,n){const r=fr(t);await mc(r,{requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"},"getOobCode",_k)}async function Rk(t,e,n){await B0(Re(t),{oobCode:e,newPassword:n}).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&Nm(t),r})}async function kk(t,e){const n=Re(t),r=await B0(n,{oobCode:e}),s=r.requestType;switch(de(s,n,"internal-error"),s){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":de(r.newEmail,n,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":de(r.mfaInfo,n,"internal-error");default:de(r.email,n,"internal-error")}let i=null;return r.mfaInfo&&(i=Sm._fromServerResponse(fr(n),r.mfaInfo)),{data:{email:(r.requestType==="VERIFY_AND_CHANGE_EMAIL"?r.newEmail:r.email)||null,previousEmail:(r.requestType==="VERIFY_AND_CHANGE_EMAIL"?r.email:r.newEmail)||null,multiFactorInfo:i},operation:s}}async function Pk(t,e){const{data:n}=await kk(Re(t),e);return n.email}async function jk(t,e,n){if(Xt(t.app))return Promise.reject(Cr(t));const r=fr(t),o=await mc(r,{returnSecureToken:!0,email:e,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",Ik).catch(c=>{throw c.code==="auth/password-does-not-meet-requirements"&&Nm(t),c}),a=await li._fromIdTokenResponse(r,"signIn",o);return await r._updateCurrentUser(a.user),a}function W0(t,e,n){return Xt(t.app)?Promise.reject(Cr(t)):Ak(Re(t),bo.credential(e,n)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&Nm(t),r})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Dk(t,e){return Xn(t,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function H0(t,{displayName:e,photoURL:n}){if(e===void 0&&n===void 0)return;const r=Re(t),i={idToken:await r.getIdToken(),displayName:e,photoUrl:n,returnSecureToken:!0},o=await co(r,Dk(r.auth,i));r.displayName=o.displayName||null,r.photoURL=o.photoUrl||null;const a=r.providerData.find(({providerId:c})=>c==="password");a&&(a.displayName=r.displayName,a.photoURL=r.photoURL),await r._updateTokensIfNecessary(o)}function Ok(t,e,n,r){return Re(t).onIdTokenChanged(e,n,r)}function Lk(t,e,n){return Re(t).beforeAuthStateChanged(e,n)}function Vn(t,e,n,r){return Re(t).onAuthStateChanged(e,n,r)}function G0(t){return Re(t).signOut()}const yc="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K0{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(yc,"1"),this.storage.removeItem(yc),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vk=1e3,Mk=10;class Q0 extends K0{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=V0(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),s=this.localCache[n];r!==s&&e(n,s,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,a,c)=>{this.notifyListeners(o,c)});return}const r=e.key;n?this.detachListener():this.stopPolling();const s=()=>{const o=this.storage.getItem(r);!n&&this.localCache[r]===o||this.notifyListeners(r,o)},i=this.storage.getItem(r);XR()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,Mk):s()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},Vk)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}Q0.type="LOCAL";const Uk=Q0;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y0 extends K0{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}Y0.type="SESSION";const X0=Y0;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fk(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sd{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(s=>s.isListeningto(e));if(n)return n;const r=new sd(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:s,data:i}=n.data,o=this.handlersMap[s];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const a=Array.from(o).map(async d=>d(n.origin,i)),c=await Fk(a);n.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:c})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}sd.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Am(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $k{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,o;return new Promise((a,c)=>{const d=Am("",20);s.port1.start();const h=setTimeout(()=>{c(new Error("unsupported_event"))},r);o={messageChannel:s,onMessage(p){const m=p;if(m.data.eventId===d)switch(m.data.status){case"ack":clearTimeout(h),i=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),a(m.data.response);break;default:clearTimeout(h),clearTimeout(i),c(new Error("invalid_response"));break}}},this.handlers.add(o),s.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:d,data:n},[s.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ar(){return window}function Bk(t){ar().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function J0(){return typeof ar().WorkerGlobalScope<"u"&&typeof ar().importScripts=="function"}async function zk(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function qk(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)==null?void 0:t.controller)||null}function Wk(){return J0()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Z0="firebaseLocalStorageDb",Hk=1,vc="firebaseLocalStorage",eT="fbase_key";class ml{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function id(t,e){return t.transaction([vc],e?"readwrite":"readonly").objectStore(vc)}function Gk(){const t=indexedDB.deleteDatabase(Z0);return new ml(t).toPromise()}function Yf(){const t=indexedDB.open(Z0,Hk);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(vc,{keyPath:eT})}catch(s){n(s)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(vc)?e(r):(r.close(),await Gk(),e(await Yf()))})})}async function a_(t,e,n){const r=id(t,!0).put({[eT]:e,value:n});return new ml(r).toPromise()}async function Kk(t,e){const n=id(t,!1).get(e),r=await new ml(n).toPromise();return r===void 0?null:r.value}function l_(t,e){const n=id(t,!0).delete(e);return new ml(n).toPromise()}const Qk=800,Yk=3;class tT{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Yf(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>Yk)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return J0()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=sd._getInstance(Wk()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var n,r;if(this.activeServiceWorker=await zk(),!this.activeServiceWorker)return;this.sender=new $k(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(n=e[0])!=null&&n.fulfilled&&(r=e[0])!=null&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||qk()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Yf();return await a_(e,yc,"1"),await l_(e,yc),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>a_(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>Kk(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>l_(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=id(s,!1).getAll();return new ml(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),n.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),n.push(s));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),Qk)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}tT.type="LOCAL";const Xk=tT;new hl(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nT(t,e){return e?Ir(e):(de(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cm extends xm{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return eo(e,this._buildIdpRequest())}_linkToIdToken(e,n){return eo(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return eo(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function Jk(t){return q0(t.auth,new Cm(t),t.bypassAuthState)}function Zk(t){const{auth:e,user:n}=t;return de(n,e,"internal-error"),Nk(n,new Cm(t),t.bypassAuthState)}async function eP(t){const{auth:e,user:n}=t;return de(n,e,"internal-error"),bk(n,new Cm(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rT{constructor(e,n,r,s,i=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:s,tenantId:i,error:o,type:a}=e;if(o){this.reject(o);return}const c={auth:this.auth,requestUri:n,sessionId:r,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(c))}catch(d){this.reject(d)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Jk;case"linkViaPopup":case"linkViaRedirect":return eP;case"reauthViaPopup":case"reauthViaRedirect":return Zk;default:xn(this.auth,"internal-error")}}resolve(e){Lr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Lr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tP=new hl(2e3,1e4);async function Rm(t,e,n){if(Xt(t.app))return Promise.reject(Hn(t,"operation-not-supported-in-this-environment"));const r=fr(t);kR(t,e,Tm);const s=nT(r,n);return new Qs(r,"signInViaPopup",e,s).executeNotNull()}class Qs extends rT{constructor(e,n,r,s,i){super(e,n,s,i),this.provider=r,this.authWindow=null,this.pollId=null,Qs.currentPopupAction&&Qs.currentPopupAction.cancel(),Qs.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return de(e,this.auth,"internal-error"),e}async onExecution(){Lr(this.filter.length===1,"Popup operations only handle one event");const e=Am();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(Hn(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(Hn(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Qs.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if((r=(n=this.authWindow)==null?void 0:n.window)!=null&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Hn(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,tP.get())};e()}}Qs.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nP="pendingRedirect",Pu=new Map;class rP extends rT{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=Pu.get(this.auth._key());if(!e){try{const r=await sP(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}Pu.set(this.auth._key(),e)}return this.bypassAuthState||Pu.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function sP(t,e){const n=aP(e),r=oP(t);if(!await r._isAvailable())return!1;const s=await r._get(n)==="true";return await r._remove(n),s}function iP(t,e){Pu.set(t._key(),e)}function oP(t){return Ir(t._redirectPersistence)}function aP(t){return ku(nP,t.config.apiKey,t.name)}async function lP(t,e,n=!1){if(Xt(t.app))return Promise.reject(Cr(t));const r=fr(t),s=nT(r,e),o=await new rP(r,s,n).execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uP=10*60*1e3;class cP{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!dP(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!sT(e)){const s=((r=e.error.code)==null?void 0:r.split("auth/")[1])||"internal-error";n.onError(Hn(this.auth,s))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=uP&&this.cachedEventUids.clear(),this.cachedEventUids.has(u_(e))}saveEventToCache(e){this.cachedEventUids.add(u_(e)),this.lastProcessedEventTime=Date.now()}}function u_(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function sT({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function dP(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return sT(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function hP(t,e={}){return Xn(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fP=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,pP=/^https?/;async function mP(t){if(t.config.emulator)return;const{authorizedDomains:e}=await hP(t);for(const n of e)try{if(gP(n))return}catch{}xn(t,"unauthorized-domain")}function gP(t){const e=Kf(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!pP.test(n))return!1;if(fP.test(t))return r===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yP=new hl(3e4,6e4);function c_(){const t=ar().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function vP(t){return new Promise((e,n)=>{var s,i,o;function r(){c_(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{c_(),n(Hn(t,"network-request-failed"))},timeout:yP.get()})}if((i=(s=ar().gapi)==null?void 0:s.iframes)!=null&&i.Iframe)e(gapi.iframes.getContext());else if((o=ar().gapi)!=null&&o.load)r();else{const a=ok("iframefcb");return ar()[a]=()=>{gapi.load?r():n(Hn(t,"network-request-failed"))},U0(`${ik()}?onload=${a}`).catch(c=>n(c))}}).catch(e=>{throw ju=null,e})}let ju=null;function _P(t){return ju=ju||vP(t),ju}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wP=new hl(5e3,15e3),xP="__/auth/iframe",EP="emulator/auth/iframe",TP={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},SP=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function IP(t){const e=t.config;de(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?vm(e,EP):`https://${t.config.authDomain}/${xP}`,r={apiKey:e.apiKey,appName:t.name,v:vi},s=SP.get(t.config.apiHost);s&&(r.eid=s);const i=t._getFrameworks();return i.length&&(r.fw=i.join(",")),`${n}?${dl(r).slice(1)}`}async function bP(t){const e=await _P(t),n=ar().gapi;return de(n,t,"internal-error"),e.open({where:document.body,url:IP(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:TP,dontclear:!0},r=>new Promise(async(s,i)=>{await r.restyle({setHideOnLeave:!1});const o=Hn(t,"network-request-failed"),a=ar().setTimeout(()=>{i(o)},wP.get());function c(){ar().clearTimeout(a),s(r)}r.ping(c).then(c,()=>{i(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NP={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},AP=500,CP=600,RP="_blank",kP="http://localhost";class d_{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function PP(t,e,n,r=AP,s=CP){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const c={...NP,width:r.toString(),height:s.toString(),top:i,left:o},d=qt().toLowerCase();n&&(a=P0(d)?RP:n),R0(d)&&(e=e||kP,c.scrollbars="yes");const h=Object.entries(c).reduce((m,[y,T])=>`${m}${y}=${T},`,"");if(YR(d)&&a!=="_self")return jP(e||"",a),new d_(null);const p=window.open(e||"",a,h);de(p,t,"popup-blocked");try{p.focus()}catch{}return new d_(p)}function jP(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DP="__/auth/handler",OP="emulator/auth/handler",LP=encodeURIComponent("fac");async function h_(t,e,n,r,s,i){de(t.config.authDomain,t,"auth-domain-config-required"),de(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:vi,eventId:s};if(e instanceof Tm){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",y1(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[h,p]of Object.entries({}))o[h]=p}if(e instanceof pl){const h=e.getScopes().filter(p=>p!=="");h.length>0&&(o.scopes=h.join(","))}t.tenantId&&(o.tid=t.tenantId);const a=o;for(const h of Object.keys(a))a[h]===void 0&&delete a[h];const c=await t._getAppCheckToken(),d=c?`#${LP}=${encodeURIComponent(c)}`:"";return`${VP(t)}?${dl(a).slice(1)}${d}`}function VP({config:t}){return t.emulator?vm(t,OP):`https://${t.authDomain}/${DP}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ch="webStorageSupport";class MP{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=X0,this._completeRedirectFn=lP,this._overrideRedirectResult=iP}async _openPopup(e,n,r,s){var o;Lr((o=this.eventManagers[e._key()])==null?void 0:o.manager,"_initialize() not called before _openPopup()");const i=await h_(e,n,r,Kf(),s);return PP(e,i,Am())}async _openRedirect(e,n,r,s){await this._originValidation(e);const i=await h_(e,n,r,Kf(),s);return Bk(i),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:s,promise:i}=this.eventManagers[n];return s?Promise.resolve(s):(Lr(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await bP(e),r=new cP(e);return n.register("authEvent",s=>(de(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(Ch,{type:Ch},s=>{var o;const i=(o=s==null?void 0:s[0])==null?void 0:o[Ch];i!==void 0&&n(!!i),xn(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=mP(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return V0()||k0()||wm()}}const UP=MP;var f_="@firebase/auth",p_="1.11.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FP{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){de(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $P(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function BP(t){Pn(new wn("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;de(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const c={apiKey:o,authDomain:a,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:M0(t)},d=new nk(r,s,i,c);return hk(d,n),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),Pn(new wn("auth-internal",e=>{const n=fr(e.getProvider("auth").getImmediate());return(r=>new FP(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),$t(f_,p_,$P(t)),$t(f_,p_,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zP=5*60,qP=p0("authIdTokenMaxAge")||zP;let m_=null;const WP=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>qP)return;const s=n==null?void 0:n.token;m_!==s&&(m_=s,await fetch(t,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function Ue(t=Io()){const e=Os(t,"auth");if(e.isInitialized())return e.getImmediate();const n=dk(t,{popupRedirectResolver:UP,persistence:[Xk,Uk,X0]}),r=p0("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(r,location.origin);if(location.origin===i.origin){const o=WP(i.toString());Lk(n,o,()=>o(n.currentUser)),Ok(n,a=>o(a))}}const s=h0("auth");return s&&fk(n,`http://${s}`),n}function HP(){var t;return((t=document.getElementsByTagName("head"))==null?void 0:t[0])??document}rk({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=s=>{const i=Hn("internal-error");i.customData=s,n(i)},r.type="text/javascript",r.charset="UTF-8",HP().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});BP("Browser");var g_=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var ws,iT;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(S,x){function N(){}N.prototype=x.prototype,S.D=x.prototype,S.prototype=new N,S.prototype.constructor=S,S.C=function(k,P,D){for(var C=Array(arguments.length-2),pe=2;pe<arguments.length;pe++)C[pe-2]=arguments[pe];return x.prototype[P].apply(k,C)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,n),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(S,x,N){N||(N=0);var k=Array(16);if(typeof x=="string")for(var P=0;16>P;++P)k[P]=x.charCodeAt(N++)|x.charCodeAt(N++)<<8|x.charCodeAt(N++)<<16|x.charCodeAt(N++)<<24;else for(P=0;16>P;++P)k[P]=x[N++]|x[N++]<<8|x[N++]<<16|x[N++]<<24;x=S.g[0],N=S.g[1],P=S.g[2];var D=S.g[3],C=x+(D^N&(P^D))+k[0]+3614090360&4294967295;x=N+(C<<7&4294967295|C>>>25),C=D+(P^x&(N^P))+k[1]+3905402710&4294967295,D=x+(C<<12&4294967295|C>>>20),C=P+(N^D&(x^N))+k[2]+606105819&4294967295,P=D+(C<<17&4294967295|C>>>15),C=N+(x^P&(D^x))+k[3]+3250441966&4294967295,N=P+(C<<22&4294967295|C>>>10),C=x+(D^N&(P^D))+k[4]+4118548399&4294967295,x=N+(C<<7&4294967295|C>>>25),C=D+(P^x&(N^P))+k[5]+1200080426&4294967295,D=x+(C<<12&4294967295|C>>>20),C=P+(N^D&(x^N))+k[6]+2821735955&4294967295,P=D+(C<<17&4294967295|C>>>15),C=N+(x^P&(D^x))+k[7]+4249261313&4294967295,N=P+(C<<22&4294967295|C>>>10),C=x+(D^N&(P^D))+k[8]+1770035416&4294967295,x=N+(C<<7&4294967295|C>>>25),C=D+(P^x&(N^P))+k[9]+2336552879&4294967295,D=x+(C<<12&4294967295|C>>>20),C=P+(N^D&(x^N))+k[10]+4294925233&4294967295,P=D+(C<<17&4294967295|C>>>15),C=N+(x^P&(D^x))+k[11]+2304563134&4294967295,N=P+(C<<22&4294967295|C>>>10),C=x+(D^N&(P^D))+k[12]+1804603682&4294967295,x=N+(C<<7&4294967295|C>>>25),C=D+(P^x&(N^P))+k[13]+4254626195&4294967295,D=x+(C<<12&4294967295|C>>>20),C=P+(N^D&(x^N))+k[14]+2792965006&4294967295,P=D+(C<<17&4294967295|C>>>15),C=N+(x^P&(D^x))+k[15]+1236535329&4294967295,N=P+(C<<22&4294967295|C>>>10),C=x+(P^D&(N^P))+k[1]+4129170786&4294967295,x=N+(C<<5&4294967295|C>>>27),C=D+(N^P&(x^N))+k[6]+3225465664&4294967295,D=x+(C<<9&4294967295|C>>>23),C=P+(x^N&(D^x))+k[11]+643717713&4294967295,P=D+(C<<14&4294967295|C>>>18),C=N+(D^x&(P^D))+k[0]+3921069994&4294967295,N=P+(C<<20&4294967295|C>>>12),C=x+(P^D&(N^P))+k[5]+3593408605&4294967295,x=N+(C<<5&4294967295|C>>>27),C=D+(N^P&(x^N))+k[10]+38016083&4294967295,D=x+(C<<9&4294967295|C>>>23),C=P+(x^N&(D^x))+k[15]+3634488961&4294967295,P=D+(C<<14&4294967295|C>>>18),C=N+(D^x&(P^D))+k[4]+3889429448&4294967295,N=P+(C<<20&4294967295|C>>>12),C=x+(P^D&(N^P))+k[9]+568446438&4294967295,x=N+(C<<5&4294967295|C>>>27),C=D+(N^P&(x^N))+k[14]+3275163606&4294967295,D=x+(C<<9&4294967295|C>>>23),C=P+(x^N&(D^x))+k[3]+4107603335&4294967295,P=D+(C<<14&4294967295|C>>>18),C=N+(D^x&(P^D))+k[8]+1163531501&4294967295,N=P+(C<<20&4294967295|C>>>12),C=x+(P^D&(N^P))+k[13]+2850285829&4294967295,x=N+(C<<5&4294967295|C>>>27),C=D+(N^P&(x^N))+k[2]+4243563512&4294967295,D=x+(C<<9&4294967295|C>>>23),C=P+(x^N&(D^x))+k[7]+1735328473&4294967295,P=D+(C<<14&4294967295|C>>>18),C=N+(D^x&(P^D))+k[12]+2368359562&4294967295,N=P+(C<<20&4294967295|C>>>12),C=x+(N^P^D)+k[5]+4294588738&4294967295,x=N+(C<<4&4294967295|C>>>28),C=D+(x^N^P)+k[8]+2272392833&4294967295,D=x+(C<<11&4294967295|C>>>21),C=P+(D^x^N)+k[11]+1839030562&4294967295,P=D+(C<<16&4294967295|C>>>16),C=N+(P^D^x)+k[14]+4259657740&4294967295,N=P+(C<<23&4294967295|C>>>9),C=x+(N^P^D)+k[1]+2763975236&4294967295,x=N+(C<<4&4294967295|C>>>28),C=D+(x^N^P)+k[4]+1272893353&4294967295,D=x+(C<<11&4294967295|C>>>21),C=P+(D^x^N)+k[7]+4139469664&4294967295,P=D+(C<<16&4294967295|C>>>16),C=N+(P^D^x)+k[10]+3200236656&4294967295,N=P+(C<<23&4294967295|C>>>9),C=x+(N^P^D)+k[13]+681279174&4294967295,x=N+(C<<4&4294967295|C>>>28),C=D+(x^N^P)+k[0]+3936430074&4294967295,D=x+(C<<11&4294967295|C>>>21),C=P+(D^x^N)+k[3]+3572445317&4294967295,P=D+(C<<16&4294967295|C>>>16),C=N+(P^D^x)+k[6]+76029189&4294967295,N=P+(C<<23&4294967295|C>>>9),C=x+(N^P^D)+k[9]+3654602809&4294967295,x=N+(C<<4&4294967295|C>>>28),C=D+(x^N^P)+k[12]+3873151461&4294967295,D=x+(C<<11&4294967295|C>>>21),C=P+(D^x^N)+k[15]+530742520&4294967295,P=D+(C<<16&4294967295|C>>>16),C=N+(P^D^x)+k[2]+3299628645&4294967295,N=P+(C<<23&4294967295|C>>>9),C=x+(P^(N|~D))+k[0]+4096336452&4294967295,x=N+(C<<6&4294967295|C>>>26),C=D+(N^(x|~P))+k[7]+1126891415&4294967295,D=x+(C<<10&4294967295|C>>>22),C=P+(x^(D|~N))+k[14]+2878612391&4294967295,P=D+(C<<15&4294967295|C>>>17),C=N+(D^(P|~x))+k[5]+4237533241&4294967295,N=P+(C<<21&4294967295|C>>>11),C=x+(P^(N|~D))+k[12]+1700485571&4294967295,x=N+(C<<6&4294967295|C>>>26),C=D+(N^(x|~P))+k[3]+2399980690&4294967295,D=x+(C<<10&4294967295|C>>>22),C=P+(x^(D|~N))+k[10]+4293915773&4294967295,P=D+(C<<15&4294967295|C>>>17),C=N+(D^(P|~x))+k[1]+2240044497&4294967295,N=P+(C<<21&4294967295|C>>>11),C=x+(P^(N|~D))+k[8]+1873313359&4294967295,x=N+(C<<6&4294967295|C>>>26),C=D+(N^(x|~P))+k[15]+4264355552&4294967295,D=x+(C<<10&4294967295|C>>>22),C=P+(x^(D|~N))+k[6]+2734768916&4294967295,P=D+(C<<15&4294967295|C>>>17),C=N+(D^(P|~x))+k[13]+1309151649&4294967295,N=P+(C<<21&4294967295|C>>>11),C=x+(P^(N|~D))+k[4]+4149444226&4294967295,x=N+(C<<6&4294967295|C>>>26),C=D+(N^(x|~P))+k[11]+3174756917&4294967295,D=x+(C<<10&4294967295|C>>>22),C=P+(x^(D|~N))+k[2]+718787259&4294967295,P=D+(C<<15&4294967295|C>>>17),C=N+(D^(P|~x))+k[9]+3951481745&4294967295,S.g[0]=S.g[0]+x&4294967295,S.g[1]=S.g[1]+(P+(C<<21&4294967295|C>>>11))&4294967295,S.g[2]=S.g[2]+P&4294967295,S.g[3]=S.g[3]+D&4294967295}r.prototype.u=function(S,x){x===void 0&&(x=S.length);for(var N=x-this.blockSize,k=this.B,P=this.h,D=0;D<x;){if(P==0)for(;D<=N;)s(this,S,D),D+=this.blockSize;if(typeof S=="string"){for(;D<x;)if(k[P++]=S.charCodeAt(D++),P==this.blockSize){s(this,k),P=0;break}}else for(;D<x;)if(k[P++]=S[D++],P==this.blockSize){s(this,k),P=0;break}}this.h=P,this.o+=x},r.prototype.v=function(){var S=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);S[0]=128;for(var x=1;x<S.length-8;++x)S[x]=0;var N=8*this.o;for(x=S.length-8;x<S.length;++x)S[x]=N&255,N/=256;for(this.u(S),S=Array(16),x=N=0;4>x;++x)for(var k=0;32>k;k+=8)S[N++]=this.g[x]>>>k&255;return S};function i(S,x){var N=a;return Object.prototype.hasOwnProperty.call(N,S)?N[S]:N[S]=x(S)}function o(S,x){this.h=x;for(var N=[],k=!0,P=S.length-1;0<=P;P--){var D=S[P]|0;k&&D==x||(N[P]=D,k=!1)}this.g=N}var a={};function c(S){return-128<=S&&128>S?i(S,function(x){return new o([x|0],0>x?-1:0)}):new o([S|0],0>S?-1:0)}function d(S){if(isNaN(S)||!isFinite(S))return p;if(0>S)return I(d(-S));for(var x=[],N=1,k=0;S>=N;k++)x[k]=S/N|0,N*=4294967296;return new o(x,0)}function h(S,x){if(S.length==0)throw Error("number format error: empty string");if(x=x||10,2>x||36<x)throw Error("radix out of range: "+x);if(S.charAt(0)=="-")return I(h(S.substring(1),x));if(0<=S.indexOf("-"))throw Error('number format error: interior "-" character');for(var N=d(Math.pow(x,8)),k=p,P=0;P<S.length;P+=8){var D=Math.min(8,S.length-P),C=parseInt(S.substring(P,P+D),x);8>D?(D=d(Math.pow(x,D)),k=k.j(D).add(d(C))):(k=k.j(N),k=k.add(d(C)))}return k}var p=c(0),m=c(1),y=c(16777216);t=o.prototype,t.m=function(){if(b(this))return-I(this).m();for(var S=0,x=1,N=0;N<this.g.length;N++){var k=this.i(N);S+=(0<=k?k:4294967296+k)*x,x*=4294967296}return S},t.toString=function(S){if(S=S||10,2>S||36<S)throw Error("radix out of range: "+S);if(T(this))return"0";if(b(this))return"-"+I(this).toString(S);for(var x=d(Math.pow(S,6)),N=this,k="";;){var P=E(N,x).g;N=v(N,P.j(x));var D=((0<N.g.length?N.g[0]:N.h)>>>0).toString(S);if(N=P,T(N))return D+k;for(;6>D.length;)D="0"+D;k=D+k}},t.i=function(S){return 0>S?0:S<this.g.length?this.g[S]:this.h};function T(S){if(S.h!=0)return!1;for(var x=0;x<S.g.length;x++)if(S.g[x]!=0)return!1;return!0}function b(S){return S.h==-1}t.l=function(S){return S=v(this,S),b(S)?-1:T(S)?0:1};function I(S){for(var x=S.g.length,N=[],k=0;k<x;k++)N[k]=~S.g[k];return new o(N,~S.h).add(m)}t.abs=function(){return b(this)?I(this):this},t.add=function(S){for(var x=Math.max(this.g.length,S.g.length),N=[],k=0,P=0;P<=x;P++){var D=k+(this.i(P)&65535)+(S.i(P)&65535),C=(D>>>16)+(this.i(P)>>>16)+(S.i(P)>>>16);k=C>>>16,D&=65535,C&=65535,N[P]=C<<16|D}return new o(N,N[N.length-1]&-2147483648?-1:0)};function v(S,x){return S.add(I(x))}t.j=function(S){if(T(this)||T(S))return p;if(b(this))return b(S)?I(this).j(I(S)):I(I(this).j(S));if(b(S))return I(this.j(I(S)));if(0>this.l(y)&&0>S.l(y))return d(this.m()*S.m());for(var x=this.g.length+S.g.length,N=[],k=0;k<2*x;k++)N[k]=0;for(k=0;k<this.g.length;k++)for(var P=0;P<S.g.length;P++){var D=this.i(k)>>>16,C=this.i(k)&65535,pe=S.i(P)>>>16,Ae=S.i(P)&65535;N[2*k+2*P]+=C*Ae,w(N,2*k+2*P),N[2*k+2*P+1]+=D*Ae,w(N,2*k+2*P+1),N[2*k+2*P+1]+=C*pe,w(N,2*k+2*P+1),N[2*k+2*P+2]+=D*pe,w(N,2*k+2*P+2)}for(k=0;k<x;k++)N[k]=N[2*k+1]<<16|N[2*k];for(k=x;k<2*x;k++)N[k]=0;return new o(N,0)};function w(S,x){for(;(S[x]&65535)!=S[x];)S[x+1]+=S[x]>>>16,S[x]&=65535,x++}function _(S,x){this.g=S,this.h=x}function E(S,x){if(T(x))throw Error("division by zero");if(T(S))return new _(p,p);if(b(S))return x=E(I(S),x),new _(I(x.g),I(x.h));if(b(x))return x=E(S,I(x)),new _(I(x.g),x.h);if(30<S.g.length){if(b(S)||b(x))throw Error("slowDivide_ only works with positive integers.");for(var N=m,k=x;0>=k.l(S);)N=j(N),k=j(k);var P=O(N,1),D=O(k,1);for(k=O(k,2),N=O(N,2);!T(k);){var C=D.add(k);0>=C.l(S)&&(P=P.add(N),D=C),k=O(k,1),N=O(N,1)}return x=v(S,P.j(x)),new _(P,x)}for(P=p;0<=S.l(x);){for(N=Math.max(1,Math.floor(S.m()/x.m())),k=Math.ceil(Math.log(N)/Math.LN2),k=48>=k?1:Math.pow(2,k-48),D=d(N),C=D.j(x);b(C)||0<C.l(S);)N-=k,D=d(N),C=D.j(x);T(D)&&(D=m),P=P.add(D),S=v(S,C)}return new _(P,S)}t.A=function(S){return E(this,S).h},t.and=function(S){for(var x=Math.max(this.g.length,S.g.length),N=[],k=0;k<x;k++)N[k]=this.i(k)&S.i(k);return new o(N,this.h&S.h)},t.or=function(S){for(var x=Math.max(this.g.length,S.g.length),N=[],k=0;k<x;k++)N[k]=this.i(k)|S.i(k);return new o(N,this.h|S.h)},t.xor=function(S){for(var x=Math.max(this.g.length,S.g.length),N=[],k=0;k<x;k++)N[k]=this.i(k)^S.i(k);return new o(N,this.h^S.h)};function j(S){for(var x=S.g.length+1,N=[],k=0;k<x;k++)N[k]=S.i(k)<<1|S.i(k-1)>>>31;return new o(N,S.h)}function O(S,x){var N=x>>5;x%=32;for(var k=S.g.length-N,P=[],D=0;D<k;D++)P[D]=0<x?S.i(D+N)>>>x|S.i(D+N+1)<<32-x:S.i(D+N);return new o(P,S.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,iT=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=d,o.fromString=h,ws=o}).apply(typeof g_<"u"?g_:typeof self<"u"?self:typeof window<"u"?window:{});var cu=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var oT,la,aT,Du,Xf,lT,uT,cT;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(l,f,g){return l==Array.prototype||l==Object.prototype||(l[f]=g.value),l};function n(l){l=[typeof globalThis=="object"&&globalThis,l,typeof window=="object"&&window,typeof self=="object"&&self,typeof cu=="object"&&cu];for(var f=0;f<l.length;++f){var g=l[f];if(g&&g.Math==Math)return g}throw Error("Cannot find global object")}var r=n(this);function s(l,f){if(f)e:{var g=r;l=l.split(".");for(var A=0;A<l.length-1;A++){var L=l[A];if(!(L in g))break e;g=g[L]}l=l[l.length-1],A=g[l],f=f(A),f!=A&&f!=null&&e(g,l,{configurable:!0,writable:!0,value:f})}}function i(l,f){l instanceof String&&(l+="");var g=0,A=!1,L={next:function(){if(!A&&g<l.length){var V=g++;return{value:f(V,l[V]),done:!1}}return A=!0,{done:!0,value:void 0}}};return L[Symbol.iterator]=function(){return L},L}s("Array.prototype.values",function(l){return l||function(){return i(this,function(f,g){return g})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},a=this||self;function c(l){var f=typeof l;return f=f!="object"?f:l?Array.isArray(l)?"array":f:"null",f=="array"||f=="object"&&typeof l.length=="number"}function d(l){var f=typeof l;return f=="object"&&l!=null||f=="function"}function h(l,f,g){return l.call.apply(l.bind,arguments)}function p(l,f,g){if(!l)throw Error();if(2<arguments.length){var A=Array.prototype.slice.call(arguments,2);return function(){var L=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(L,A),l.apply(f,L)}}return function(){return l.apply(f,arguments)}}function m(l,f,g){return m=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?h:p,m.apply(null,arguments)}function y(l,f){var g=Array.prototype.slice.call(arguments,1);return function(){var A=g.slice();return A.push.apply(A,arguments),l.apply(this,A)}}function T(l,f){function g(){}g.prototype=f.prototype,l.aa=f.prototype,l.prototype=new g,l.prototype.constructor=l,l.Qb=function(A,L,V){for(var Q=Array(arguments.length-2),Be=2;Be<arguments.length;Be++)Q[Be-2]=arguments[Be];return f.prototype[L].apply(A,Q)}}function b(l){const f=l.length;if(0<f){const g=Array(f);for(let A=0;A<f;A++)g[A]=l[A];return g}return[]}function I(l,f){for(let g=1;g<arguments.length;g++){const A=arguments[g];if(c(A)){const L=l.length||0,V=A.length||0;l.length=L+V;for(let Q=0;Q<V;Q++)l[L+Q]=A[Q]}else l.push(A)}}class v{constructor(f,g){this.i=f,this.j=g,this.h=0,this.g=null}get(){let f;return 0<this.h?(this.h--,f=this.g,this.g=f.next,f.next=null):f=this.i(),f}}function w(l){return/^[\s\xa0]*$/.test(l)}function _(){var l=a.navigator;return l&&(l=l.userAgent)?l:""}function E(l){return E[" "](l),l}E[" "]=function(){};var j=_().indexOf("Gecko")!=-1&&!(_().toLowerCase().indexOf("webkit")!=-1&&_().indexOf("Edge")==-1)&&!(_().indexOf("Trident")!=-1||_().indexOf("MSIE")!=-1)&&_().indexOf("Edge")==-1;function O(l,f,g){for(const A in l)f.call(g,l[A],A,l)}function S(l,f){for(const g in l)f.call(void 0,l[g],g,l)}function x(l){const f={};for(const g in l)f[g]=l[g];return f}const N="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function k(l,f){let g,A;for(let L=1;L<arguments.length;L++){A=arguments[L];for(g in A)l[g]=A[g];for(let V=0;V<N.length;V++)g=N[V],Object.prototype.hasOwnProperty.call(A,g)&&(l[g]=A[g])}}function P(l){var f=1;l=l.split(":");const g=[];for(;0<f&&l.length;)g.push(l.shift()),f--;return l.length&&g.push(l.join(":")),g}function D(l){a.setTimeout(()=>{throw l},0)}function C(){var l=K;let f=null;return l.g&&(f=l.g,l.g=l.g.next,l.g||(l.h=null),f.next=null),f}class pe{constructor(){this.h=this.g=null}add(f,g){const A=Ae.get();A.set(f,g),this.h?this.h.next=A:this.g=A,this.h=A}}var Ae=new v(()=>new Ee,l=>l.reset());class Ee{constructor(){this.next=this.g=this.h=null}set(f,g){this.h=f,this.g=g,this.next=null}reset(){this.next=this.g=this.h=null}}let J,F=!1,K=new pe,ne=()=>{const l=a.Promise.resolve(void 0);J=()=>{l.then(ge)}};var ge=()=>{for(var l;l=C();){try{l.h.call(l.g)}catch(g){D(g)}var f=Ae;f.j(l),100>f.h&&(f.h++,l.next=f.g,f.g=l)}F=!1};function me(){this.s=this.s,this.C=this.C}me.prototype.s=!1,me.prototype.ma=function(){this.s||(this.s=!0,this.N())},me.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function ue(l,f){this.type=l,this.g=this.target=f,this.defaultPrevented=!1}ue.prototype.h=function(){this.defaultPrevented=!0};var Y=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var l=!1,f=Object.defineProperty({},"passive",{get:function(){l=!0}});try{const g=()=>{};a.addEventListener("test",g,f),a.removeEventListener("test",g,f)}catch{}return l}();function M(l,f){if(ue.call(this,l?l.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,l){var g=this.type=l.type,A=l.changedTouches&&l.changedTouches.length?l.changedTouches[0]:null;if(this.target=l.target||l.srcElement,this.g=f,f=l.relatedTarget){if(j){e:{try{E(f.nodeName);var L=!0;break e}catch{}L=!1}L||(f=null)}}else g=="mouseover"?f=l.fromElement:g=="mouseout"&&(f=l.toElement);this.relatedTarget=f,A?(this.clientX=A.clientX!==void 0?A.clientX:A.pageX,this.clientY=A.clientY!==void 0?A.clientY:A.pageY,this.screenX=A.screenX||0,this.screenY=A.screenY||0):(this.clientX=l.clientX!==void 0?l.clientX:l.pageX,this.clientY=l.clientY!==void 0?l.clientY:l.pageY,this.screenX=l.screenX||0,this.screenY=l.screenY||0),this.button=l.button,this.key=l.key||"",this.ctrlKey=l.ctrlKey,this.altKey=l.altKey,this.shiftKey=l.shiftKey,this.metaKey=l.metaKey,this.pointerId=l.pointerId||0,this.pointerType=typeof l.pointerType=="string"?l.pointerType:z[l.pointerType]||"",this.state=l.state,this.i=l,l.defaultPrevented&&M.aa.h.call(this)}}T(M,ue);var z={2:"touch",3:"pen",4:"mouse"};M.prototype.h=function(){M.aa.h.call(this);var l=this.i;l.preventDefault?l.preventDefault():l.returnValue=!1};var Z="closure_listenable_"+(1e6*Math.random()|0),he=0;function ae(l,f,g,A,L){this.listener=l,this.proxy=null,this.src=f,this.type=g,this.capture=!!A,this.ha=L,this.key=++he,this.da=this.fa=!1}function $(l){l.da=!0,l.listener=null,l.proxy=null,l.src=null,l.ha=null}function G(l){this.src=l,this.g={},this.h=0}G.prototype.add=function(l,f,g,A,L){var V=l.toString();l=this.g[V],l||(l=this.g[V]=[],this.h++);var Q=ce(l,f,A,L);return-1<Q?(f=l[Q],g||(f.fa=!1)):(f=new ae(f,this.src,V,!!A,L),f.fa=g,l.push(f)),f};function se(l,f){var g=f.type;if(g in l.g){var A=l.g[g],L=Array.prototype.indexOf.call(A,f,void 0),V;(V=0<=L)&&Array.prototype.splice.call(A,L,1),V&&($(f),l.g[g].length==0&&(delete l.g[g],l.h--))}}function ce(l,f,g,A){for(var L=0;L<l.length;++L){var V=l[L];if(!V.da&&V.listener==f&&V.capture==!!g&&V.ha==A)return L}return-1}var oe="closure_lm_"+(1e6*Math.random()|0),De={};function ke(l,f,g,A,L){if(Array.isArray(f)){for(var V=0;V<f.length;V++)ke(l,f[V],g,A,L);return null}return g=Ag(g),l&&l[Z]?l.K(f,g,d(A)?!!A.capture:!1,L):Wt(l,f,g,!1,A,L)}function Wt(l,f,g,A,L,V){if(!f)throw Error("Invalid event type");var Q=d(L)?!!L.capture:!!L,Be=Zn(l);if(Be||(l[oe]=Be=new G(l)),g=Be.add(f,g,A,Q,V),g.proxy)return g;if(A=nn(),g.proxy=A,A.src=l,A.listener=g,l.addEventListener)Y||(L=Q),L===void 0&&(L=!1),l.addEventListener(f.toString(),A,L);else if(l.attachEvent)l.attachEvent(jo(f.toString()),A);else if(l.addListener&&l.removeListener)l.addListener(A);else throw Error("addEventListener and attachEvent are unavailable.");return g}function nn(){function l(g){return f.call(l.src,l.listener,g)}const f=kd;return l}function qr(l,f,g,A,L){if(Array.isArray(f))for(var V=0;V<f.length;V++)qr(l,f[V],g,A,L);else A=d(A)?!!A.capture:!!A,g=Ag(g),l&&l[Z]?(l=l.i,f=String(f).toString(),f in l.g&&(V=l.g[f],g=ce(V,g,A,L),-1<g&&($(V[g]),Array.prototype.splice.call(V,g,1),V.length==0&&(delete l.g[f],l.h--)))):l&&(l=Zn(l))&&(f=l.g[f.toString()],l=-1,f&&(l=ce(f,g,A,L)),(g=-1<l?f[l]:null)&&Wr(g))}function Wr(l){if(typeof l!="number"&&l&&!l.da){var f=l.src;if(f&&f[Z])se(f.i,l);else{var g=l.type,A=l.proxy;f.removeEventListener?f.removeEventListener(g,A,l.capture):f.detachEvent?f.detachEvent(jo(g),A):f.addListener&&f.removeListener&&f.removeListener(A),(g=Zn(f))?(se(g,l),g.h==0&&(g.src=null,f[oe]=null)):$(l)}}}function jo(l){return l in De?De[l]:De[l]="on"+l}function kd(l,f){if(l.da)l=!0;else{f=new M(f,this);var g=l.listener,A=l.ha||l.src;l.fa&&Wr(l),l=g.call(A,f)}return l}function Zn(l){return l=l[oe],l instanceof G?l:null}var Pd="__closure_events_fn_"+(1e9*Math.random()>>>0);function Ag(l){return typeof l=="function"?l:(l[Pd]||(l[Pd]=function(f){return l.handleEvent(f)}),l[Pd])}function Pt(){me.call(this),this.i=new G(this),this.M=this,this.F=null}T(Pt,me),Pt.prototype[Z]=!0,Pt.prototype.removeEventListener=function(l,f,g,A){qr(this,l,f,g,A)};function Ht(l,f){var g,A=l.F;if(A)for(g=[];A;A=A.F)g.push(A);if(l=l.M,A=f.type||f,typeof f=="string")f=new ue(f,l);else if(f instanceof ue)f.target=f.target||l;else{var L=f;f=new ue(A,l),k(f,L)}if(L=!0,g)for(var V=g.length-1;0<=V;V--){var Q=f.g=g[V];L=Cl(Q,A,!0,f)&&L}if(Q=f.g=l,L=Cl(Q,A,!0,f)&&L,L=Cl(Q,A,!1,f)&&L,g)for(V=0;V<g.length;V++)Q=f.g=g[V],L=Cl(Q,A,!1,f)&&L}Pt.prototype.N=function(){if(Pt.aa.N.call(this),this.i){var l=this.i,f;for(f in l.g){for(var g=l.g[f],A=0;A<g.length;A++)$(g[A]);delete l.g[f],l.h--}}this.F=null},Pt.prototype.K=function(l,f,g,A){return this.i.add(String(l),f,!1,g,A)},Pt.prototype.L=function(l,f,g,A){return this.i.add(String(l),f,!0,g,A)};function Cl(l,f,g,A){if(f=l.i.g[String(f)],!f)return!0;f=f.concat();for(var L=!0,V=0;V<f.length;++V){var Q=f[V];if(Q&&!Q.da&&Q.capture==g){var Be=Q.listener,Nt=Q.ha||Q.src;Q.fa&&se(l.i,Q),L=Be.call(Nt,A)!==!1&&L}}return L&&!A.defaultPrevented}function Cg(l,f,g){if(typeof l=="function")g&&(l=m(l,g));else if(l&&typeof l.handleEvent=="function")l=m(l.handleEvent,l);else throw Error("Invalid listener argument");return 2147483647<Number(f)?-1:a.setTimeout(l,f||0)}function Rg(l){l.g=Cg(()=>{l.g=null,l.i&&(l.i=!1,Rg(l))},l.l);const f=l.h;l.h=null,l.m.apply(null,f)}class qI extends me{constructor(f,g){super(),this.m=f,this.l=g,this.h=null,this.i=!1,this.g=null}j(f){this.h=arguments,this.g?this.i=!0:Rg(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Do(l){me.call(this),this.h=l,this.g={}}T(Do,me);var kg=[];function Pg(l){O(l.g,function(f,g){this.g.hasOwnProperty(g)&&Wr(f)},l),l.g={}}Do.prototype.N=function(){Do.aa.N.call(this),Pg(this)},Do.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var jd=a.JSON.stringify,WI=a.JSON.parse,HI=class{stringify(l){return a.JSON.stringify(l,void 0)}parse(l){return a.JSON.parse(l,void 0)}};function Dd(){}Dd.prototype.h=null;function jg(l){return l.h||(l.h=l.i())}function Dg(){}var Oo={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Od(){ue.call(this,"d")}T(Od,ue);function Ld(){ue.call(this,"c")}T(Ld,ue);var Ms={},Og=null;function Rl(){return Og=Og||new Pt}Ms.La="serverreachability";function Lg(l){ue.call(this,Ms.La,l)}T(Lg,ue);function Lo(l){const f=Rl();Ht(f,new Lg(f))}Ms.STAT_EVENT="statevent";function Vg(l,f){ue.call(this,Ms.STAT_EVENT,l),this.stat=f}T(Vg,ue);function Gt(l){const f=Rl();Ht(f,new Vg(f,l))}Ms.Ma="timingevent";function Mg(l,f){ue.call(this,Ms.Ma,l),this.size=f}T(Mg,ue);function Vo(l,f){if(typeof l!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){l()},f)}function Mo(){this.g=!0}Mo.prototype.xa=function(){this.g=!1};function GI(l,f,g,A,L,V){l.info(function(){if(l.g)if(V)for(var Q="",Be=V.split("&"),Nt=0;Nt<Be.length;Nt++){var Le=Be[Nt].split("=");if(1<Le.length){var jt=Le[0];Le=Le[1];var Dt=jt.split("_");Q=2<=Dt.length&&Dt[1]=="type"?Q+(jt+"="+Le+"&"):Q+(jt+"=redacted&")}}else Q=null;else Q=V;return"XMLHTTP REQ ("+A+") [attempt "+L+"]: "+f+`
`+g+`
`+Q})}function KI(l,f,g,A,L,V,Q){l.info(function(){return"XMLHTTP RESP ("+A+") [ attempt "+L+"]: "+f+`
`+g+`
`+V+" "+Q})}function Si(l,f,g,A){l.info(function(){return"XMLHTTP TEXT ("+f+"): "+YI(l,g)+(A?" "+A:"")})}function QI(l,f){l.info(function(){return"TIMEOUT: "+f})}Mo.prototype.info=function(){};function YI(l,f){if(!l.g)return f;if(!f)return null;try{var g=JSON.parse(f);if(g){for(l=0;l<g.length;l++)if(Array.isArray(g[l])){var A=g[l];if(!(2>A.length)){var L=A[1];if(Array.isArray(L)&&!(1>L.length)){var V=L[0];if(V!="noop"&&V!="stop"&&V!="close")for(var Q=1;Q<L.length;Q++)L[Q]=""}}}}return jd(g)}catch{return f}}var kl={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Ug={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Vd;function Pl(){}T(Pl,Dd),Pl.prototype.g=function(){return new XMLHttpRequest},Pl.prototype.i=function(){return{}},Vd=new Pl;function Hr(l,f,g,A){this.j=l,this.i=f,this.l=g,this.R=A||1,this.U=new Do(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Fg}function Fg(){this.i=null,this.g="",this.h=!1}var $g={},Md={};function Ud(l,f,g){l.L=1,l.v=Ll(mr(f)),l.m=g,l.P=!0,Bg(l,null)}function Bg(l,f){l.F=Date.now(),jl(l),l.A=mr(l.v);var g=l.A,A=l.R;Array.isArray(A)||(A=[String(A)]),ny(g.i,"t",A),l.C=0,g=l.j.J,l.h=new Fg,l.g=wy(l.j,g?f:null,!l.m),0<l.O&&(l.M=new qI(m(l.Y,l,l.g),l.O)),f=l.U,g=l.g,A=l.ca;var L="readystatechange";Array.isArray(L)||(L&&(kg[0]=L.toString()),L=kg);for(var V=0;V<L.length;V++){var Q=ke(g,L[V],A||f.handleEvent,!1,f.h||f);if(!Q)break;f.g[Q.key]=Q}f=l.H?x(l.H):{},l.m?(l.u||(l.u="POST"),f["Content-Type"]="application/x-www-form-urlencoded",l.g.ea(l.A,l.u,l.m,f)):(l.u="GET",l.g.ea(l.A,l.u,null,f)),Lo(),GI(l.i,l.u,l.A,l.l,l.R,l.m)}Hr.prototype.ca=function(l){l=l.target;const f=this.M;f&&gr(l)==3?f.j():this.Y(l)},Hr.prototype.Y=function(l){try{if(l==this.g)e:{const Dt=gr(this.g);var f=this.g.Ba();const Ni=this.g.Z();if(!(3>Dt)&&(Dt!=3||this.g&&(this.h.h||this.g.oa()||uy(this.g)))){this.J||Dt!=4||f==7||(f==8||0>=Ni?Lo(3):Lo(2)),Fd(this);var g=this.g.Z();this.X=g;t:if(zg(this)){var A=uy(this.g);l="";var L=A.length,V=gr(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Us(this),Uo(this);var Q="";break t}this.h.i=new a.TextDecoder}for(f=0;f<L;f++)this.h.h=!0,l+=this.h.i.decode(A[f],{stream:!(V&&f==L-1)});A.length=0,this.h.g+=l,this.C=0,Q=this.h.g}else Q=this.g.oa();if(this.o=g==200,KI(this.i,this.u,this.A,this.l,this.R,Dt,g),this.o){if(this.T&&!this.K){t:{if(this.g){var Be,Nt=this.g;if((Be=Nt.g?Nt.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!w(Be)){var Le=Be;break t}}Le=null}if(g=Le)Si(this.i,this.l,g,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,$d(this,g);else{this.o=!1,this.s=3,Gt(12),Us(this),Uo(this);break e}}if(this.P){g=!0;let Mn;for(;!this.J&&this.C<Q.length;)if(Mn=XI(this,Q),Mn==Md){Dt==4&&(this.s=4,Gt(14),g=!1),Si(this.i,this.l,null,"[Incomplete Response]");break}else if(Mn==$g){this.s=4,Gt(15),Si(this.i,this.l,Q,"[Invalid Chunk]"),g=!1;break}else Si(this.i,this.l,Mn,null),$d(this,Mn);if(zg(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Dt!=4||Q.length!=0||this.h.h||(this.s=1,Gt(16),g=!1),this.o=this.o&&g,!g)Si(this.i,this.l,Q,"[Invalid Chunked Response]"),Us(this),Uo(this);else if(0<Q.length&&!this.W){this.W=!0;var jt=this.j;jt.g==this&&jt.ba&&!jt.M&&(jt.j.info("Great, no buffering proxy detected. Bytes received: "+Q.length),Gd(jt),jt.M=!0,Gt(11))}}else Si(this.i,this.l,Q,null),$d(this,Q);Dt==4&&Us(this),this.o&&!this.J&&(Dt==4?gy(this.j,this):(this.o=!1,jl(this)))}else pb(this.g),g==400&&0<Q.indexOf("Unknown SID")?(this.s=3,Gt(12)):(this.s=0,Gt(13)),Us(this),Uo(this)}}}catch{}finally{}};function zg(l){return l.g?l.u=="GET"&&l.L!=2&&l.j.Ca:!1}function XI(l,f){var g=l.C,A=f.indexOf(`
`,g);return A==-1?Md:(g=Number(f.substring(g,A)),isNaN(g)?$g:(A+=1,A+g>f.length?Md:(f=f.slice(A,A+g),l.C=A+g,f)))}Hr.prototype.cancel=function(){this.J=!0,Us(this)};function jl(l){l.S=Date.now()+l.I,qg(l,l.I)}function qg(l,f){if(l.B!=null)throw Error("WatchDog timer not null");l.B=Vo(m(l.ba,l),f)}function Fd(l){l.B&&(a.clearTimeout(l.B),l.B=null)}Hr.prototype.ba=function(){this.B=null;const l=Date.now();0<=l-this.S?(QI(this.i,this.A),this.L!=2&&(Lo(),Gt(17)),Us(this),this.s=2,Uo(this)):qg(this,this.S-l)};function Uo(l){l.j.G==0||l.J||gy(l.j,l)}function Us(l){Fd(l);var f=l.M;f&&typeof f.ma=="function"&&f.ma(),l.M=null,Pg(l.U),l.g&&(f=l.g,l.g=null,f.abort(),f.ma())}function $d(l,f){try{var g=l.j;if(g.G!=0&&(g.g==l||Bd(g.h,l))){if(!l.K&&Bd(g.h,l)&&g.G==3){try{var A=g.Da.g.parse(f)}catch{A=null}if(Array.isArray(A)&&A.length==3){var L=A;if(L[0]==0){e:if(!g.u){if(g.g)if(g.g.F+3e3<l.F)Bl(g),Fl(g);else break e;Hd(g),Gt(18)}}else g.za=L[1],0<g.za-g.T&&37500>L[2]&&g.F&&g.v==0&&!g.C&&(g.C=Vo(m(g.Za,g),6e3));if(1>=Gg(g.h)&&g.ca){try{g.ca()}catch{}g.ca=void 0}}else $s(g,11)}else if((l.K||g.g==l)&&Bl(g),!w(f))for(L=g.Da.g.parse(f),f=0;f<L.length;f++){let Le=L[f];if(g.T=Le[0],Le=Le[1],g.G==2)if(Le[0]=="c"){g.K=Le[1],g.ia=Le[2];const jt=Le[3];jt!=null&&(g.la=jt,g.j.info("VER="+g.la));const Dt=Le[4];Dt!=null&&(g.Aa=Dt,g.j.info("SVER="+g.Aa));const Ni=Le[5];Ni!=null&&typeof Ni=="number"&&0<Ni&&(A=1.5*Ni,g.L=A,g.j.info("backChannelRequestTimeoutMs_="+A)),A=g;const Mn=l.g;if(Mn){const ql=Mn.g?Mn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(ql){var V=A.h;V.g||ql.indexOf("spdy")==-1&&ql.indexOf("quic")==-1&&ql.indexOf("h2")==-1||(V.j=V.l,V.g=new Set,V.h&&(zd(V,V.h),V.h=null))}if(A.D){const Kd=Mn.g?Mn.g.getResponseHeader("X-HTTP-Session-Id"):null;Kd&&(A.ya=Kd,Ke(A.I,A.D,Kd))}}g.G=3,g.l&&g.l.ua(),g.ba&&(g.R=Date.now()-l.F,g.j.info("Handshake RTT: "+g.R+"ms")),A=g;var Q=l;if(A.qa=_y(A,A.J?A.ia:null,A.W),Q.K){Kg(A.h,Q);var Be=Q,Nt=A.L;Nt&&(Be.I=Nt),Be.B&&(Fd(Be),jl(Be)),A.g=Q}else py(A);0<g.i.length&&$l(g)}else Le[0]!="stop"&&Le[0]!="close"||$s(g,7);else g.G==3&&(Le[0]=="stop"||Le[0]=="close"?Le[0]=="stop"?$s(g,7):Wd(g):Le[0]!="noop"&&g.l&&g.l.ta(Le),g.v=0)}}Lo(4)}catch{}}var JI=class{constructor(l,f){this.g=l,this.map=f}};function Wg(l){this.l=l||10,a.PerformanceNavigationTiming?(l=a.performance.getEntriesByType("navigation"),l=0<l.length&&(l[0].nextHopProtocol=="hq"||l[0].nextHopProtocol=="h2")):l=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=l?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Hg(l){return l.h?!0:l.g?l.g.size>=l.j:!1}function Gg(l){return l.h?1:l.g?l.g.size:0}function Bd(l,f){return l.h?l.h==f:l.g?l.g.has(f):!1}function zd(l,f){l.g?l.g.add(f):l.h=f}function Kg(l,f){l.h&&l.h==f?l.h=null:l.g&&l.g.has(f)&&l.g.delete(f)}Wg.prototype.cancel=function(){if(this.i=Qg(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const l of this.g.values())l.cancel();this.g.clear()}};function Qg(l){if(l.h!=null)return l.i.concat(l.h.D);if(l.g!=null&&l.g.size!==0){let f=l.i;for(const g of l.g.values())f=f.concat(g.D);return f}return b(l.i)}function ZI(l){if(l.V&&typeof l.V=="function")return l.V();if(typeof Map<"u"&&l instanceof Map||typeof Set<"u"&&l instanceof Set)return Array.from(l.values());if(typeof l=="string")return l.split("");if(c(l)){for(var f=[],g=l.length,A=0;A<g;A++)f.push(l[A]);return f}f=[],g=0;for(A in l)f[g++]=l[A];return f}function eb(l){if(l.na&&typeof l.na=="function")return l.na();if(!l.V||typeof l.V!="function"){if(typeof Map<"u"&&l instanceof Map)return Array.from(l.keys());if(!(typeof Set<"u"&&l instanceof Set)){if(c(l)||typeof l=="string"){var f=[];l=l.length;for(var g=0;g<l;g++)f.push(g);return f}f=[],g=0;for(const A in l)f[g++]=A;return f}}}function Yg(l,f){if(l.forEach&&typeof l.forEach=="function")l.forEach(f,void 0);else if(c(l)||typeof l=="string")Array.prototype.forEach.call(l,f,void 0);else for(var g=eb(l),A=ZI(l),L=A.length,V=0;V<L;V++)f.call(void 0,A[V],g&&g[V],l)}var Xg=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function tb(l,f){if(l){l=l.split("&");for(var g=0;g<l.length;g++){var A=l[g].indexOf("="),L=null;if(0<=A){var V=l[g].substring(0,A);L=l[g].substring(A+1)}else V=l[g];f(V,L?decodeURIComponent(L.replace(/\+/g," ")):"")}}}function Fs(l){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,l instanceof Fs){this.h=l.h,Dl(this,l.j),this.o=l.o,this.g=l.g,Ol(this,l.s),this.l=l.l;var f=l.i,g=new Bo;g.i=f.i,f.g&&(g.g=new Map(f.g),g.h=f.h),Jg(this,g),this.m=l.m}else l&&(f=String(l).match(Xg))?(this.h=!1,Dl(this,f[1]||"",!0),this.o=Fo(f[2]||""),this.g=Fo(f[3]||"",!0),Ol(this,f[4]),this.l=Fo(f[5]||"",!0),Jg(this,f[6]||"",!0),this.m=Fo(f[7]||"")):(this.h=!1,this.i=new Bo(null,this.h))}Fs.prototype.toString=function(){var l=[],f=this.j;f&&l.push($o(f,Zg,!0),":");var g=this.g;return(g||f=="file")&&(l.push("//"),(f=this.o)&&l.push($o(f,Zg,!0),"@"),l.push(encodeURIComponent(String(g)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),g=this.s,g!=null&&l.push(":",String(g))),(g=this.l)&&(this.g&&g.charAt(0)!="/"&&l.push("/"),l.push($o(g,g.charAt(0)=="/"?sb:rb,!0))),(g=this.i.toString())&&l.push("?",g),(g=this.m)&&l.push("#",$o(g,ob)),l.join("")};function mr(l){return new Fs(l)}function Dl(l,f,g){l.j=g?Fo(f,!0):f,l.j&&(l.j=l.j.replace(/:$/,""))}function Ol(l,f){if(f){if(f=Number(f),isNaN(f)||0>f)throw Error("Bad port number "+f);l.s=f}else l.s=null}function Jg(l,f,g){f instanceof Bo?(l.i=f,ab(l.i,l.h)):(g||(f=$o(f,ib)),l.i=new Bo(f,l.h))}function Ke(l,f,g){l.i.set(f,g)}function Ll(l){return Ke(l,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),l}function Fo(l,f){return l?f?decodeURI(l.replace(/%25/g,"%2525")):decodeURIComponent(l):""}function $o(l,f,g){return typeof l=="string"?(l=encodeURI(l).replace(f,nb),g&&(l=l.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),l):null}function nb(l){return l=l.charCodeAt(0),"%"+(l>>4&15).toString(16)+(l&15).toString(16)}var Zg=/[#\/\?@]/g,rb=/[#\?:]/g,sb=/[#\?]/g,ib=/[#\?@]/g,ob=/#/g;function Bo(l,f){this.h=this.g=null,this.i=l||null,this.j=!!f}function Gr(l){l.g||(l.g=new Map,l.h=0,l.i&&tb(l.i,function(f,g){l.add(decodeURIComponent(f.replace(/\+/g," ")),g)}))}t=Bo.prototype,t.add=function(l,f){Gr(this),this.i=null,l=Ii(this,l);var g=this.g.get(l);return g||this.g.set(l,g=[]),g.push(f),this.h+=1,this};function ey(l,f){Gr(l),f=Ii(l,f),l.g.has(f)&&(l.i=null,l.h-=l.g.get(f).length,l.g.delete(f))}function ty(l,f){return Gr(l),f=Ii(l,f),l.g.has(f)}t.forEach=function(l,f){Gr(this),this.g.forEach(function(g,A){g.forEach(function(L){l.call(f,L,A,this)},this)},this)},t.na=function(){Gr(this);const l=Array.from(this.g.values()),f=Array.from(this.g.keys()),g=[];for(let A=0;A<f.length;A++){const L=l[A];for(let V=0;V<L.length;V++)g.push(f[A])}return g},t.V=function(l){Gr(this);let f=[];if(typeof l=="string")ty(this,l)&&(f=f.concat(this.g.get(Ii(this,l))));else{l=Array.from(this.g.values());for(let g=0;g<l.length;g++)f=f.concat(l[g])}return f},t.set=function(l,f){return Gr(this),this.i=null,l=Ii(this,l),ty(this,l)&&(this.h-=this.g.get(l).length),this.g.set(l,[f]),this.h+=1,this},t.get=function(l,f){return l?(l=this.V(l),0<l.length?String(l[0]):f):f};function ny(l,f,g){ey(l,f),0<g.length&&(l.i=null,l.g.set(Ii(l,f),b(g)),l.h+=g.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const l=[],f=Array.from(this.g.keys());for(var g=0;g<f.length;g++){var A=f[g];const V=encodeURIComponent(String(A)),Q=this.V(A);for(A=0;A<Q.length;A++){var L=V;Q[A]!==""&&(L+="="+encodeURIComponent(String(Q[A]))),l.push(L)}}return this.i=l.join("&")};function Ii(l,f){return f=String(f),l.j&&(f=f.toLowerCase()),f}function ab(l,f){f&&!l.j&&(Gr(l),l.i=null,l.g.forEach(function(g,A){var L=A.toLowerCase();A!=L&&(ey(this,A),ny(this,L,g))},l)),l.j=f}function lb(l,f){const g=new Mo;if(a.Image){const A=new Image;A.onload=y(Kr,g,"TestLoadImage: loaded",!0,f,A),A.onerror=y(Kr,g,"TestLoadImage: error",!1,f,A),A.onabort=y(Kr,g,"TestLoadImage: abort",!1,f,A),A.ontimeout=y(Kr,g,"TestLoadImage: timeout",!1,f,A),a.setTimeout(function(){A.ontimeout&&A.ontimeout()},1e4),A.src=l}else f(!1)}function ub(l,f){const g=new Mo,A=new AbortController,L=setTimeout(()=>{A.abort(),Kr(g,"TestPingServer: timeout",!1,f)},1e4);fetch(l,{signal:A.signal}).then(V=>{clearTimeout(L),V.ok?Kr(g,"TestPingServer: ok",!0,f):Kr(g,"TestPingServer: server error",!1,f)}).catch(()=>{clearTimeout(L),Kr(g,"TestPingServer: error",!1,f)})}function Kr(l,f,g,A,L){try{L&&(L.onload=null,L.onerror=null,L.onabort=null,L.ontimeout=null),A(g)}catch{}}function cb(){this.g=new HI}function db(l,f,g){const A=g||"";try{Yg(l,function(L,V){let Q=L;d(L)&&(Q=jd(L)),f.push(A+V+"="+encodeURIComponent(Q))})}catch(L){throw f.push(A+"type="+encodeURIComponent("_badmap")),L}}function Vl(l){this.l=l.Ub||null,this.j=l.eb||!1}T(Vl,Dd),Vl.prototype.g=function(){return new Ml(this.l,this.j)},Vl.prototype.i=function(l){return function(){return l}}({});function Ml(l,f){Pt.call(this),this.D=l,this.o=f,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}T(Ml,Pt),t=Ml.prototype,t.open=function(l,f){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=l,this.A=f,this.readyState=1,qo(this)},t.send=function(l){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const f={headers:this.u,method:this.B,credentials:this.m,cache:void 0};l&&(f.body=l),(this.D||a).fetch(new Request(this.A,f)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,zo(this)),this.readyState=0},t.Sa=function(l){if(this.g&&(this.l=l,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=l.headers,this.readyState=2,qo(this)),this.g&&(this.readyState=3,qo(this),this.g)))if(this.responseType==="arraybuffer")l.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in l){if(this.j=l.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;ry(this)}else l.text().then(this.Ra.bind(this),this.ga.bind(this))};function ry(l){l.j.read().then(l.Pa.bind(l)).catch(l.ga.bind(l))}t.Pa=function(l){if(this.g){if(this.o&&l.value)this.response.push(l.value);else if(!this.o){var f=l.value?l.value:new Uint8Array(0);(f=this.v.decode(f,{stream:!l.done}))&&(this.response=this.responseText+=f)}l.done?zo(this):qo(this),this.readyState==3&&ry(this)}},t.Ra=function(l){this.g&&(this.response=this.responseText=l,zo(this))},t.Qa=function(l){this.g&&(this.response=l,zo(this))},t.ga=function(){this.g&&zo(this)};function zo(l){l.readyState=4,l.l=null,l.j=null,l.v=null,qo(l)}t.setRequestHeader=function(l,f){this.u.append(l,f)},t.getResponseHeader=function(l){return this.h&&this.h.get(l.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const l=[],f=this.h.entries();for(var g=f.next();!g.done;)g=g.value,l.push(g[0]+": "+g[1]),g=f.next();return l.join(`\r
`)};function qo(l){l.onreadystatechange&&l.onreadystatechange.call(l)}Object.defineProperty(Ml.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(l){this.m=l?"include":"same-origin"}});function sy(l){let f="";return O(l,function(g,A){f+=A,f+=":",f+=g,f+=`\r
`}),f}function qd(l,f,g){e:{for(A in g){var A=!1;break e}A=!0}A||(g=sy(g),typeof l=="string"?g!=null&&encodeURIComponent(String(g)):Ke(l,f,g))}function st(l){Pt.call(this),this.headers=new Map,this.o=l||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}T(st,Pt);var hb=/^https?$/i,fb=["POST","PUT"];t=st.prototype,t.Ha=function(l){this.J=l},t.ea=function(l,f,g,A){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+l);f=f?f.toUpperCase():"GET",this.D=l,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Vd.g(),this.v=this.o?jg(this.o):jg(Vd),this.g.onreadystatechange=m(this.Ea,this);try{this.B=!0,this.g.open(f,String(l),!0),this.B=!1}catch(V){iy(this,V);return}if(l=g||"",g=new Map(this.headers),A)if(Object.getPrototypeOf(A)===Object.prototype)for(var L in A)g.set(L,A[L]);else if(typeof A.keys=="function"&&typeof A.get=="function")for(const V of A.keys())g.set(V,A.get(V));else throw Error("Unknown input type for opt_headers: "+String(A));A=Array.from(g.keys()).find(V=>V.toLowerCase()=="content-type"),L=a.FormData&&l instanceof a.FormData,!(0<=Array.prototype.indexOf.call(fb,f,void 0))||A||L||g.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[V,Q]of g)this.g.setRequestHeader(V,Q);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{ly(this),this.u=!0,this.g.send(l),this.u=!1}catch(V){iy(this,V)}};function iy(l,f){l.h=!1,l.g&&(l.j=!0,l.g.abort(),l.j=!1),l.l=f,l.m=5,oy(l),Ul(l)}function oy(l){l.A||(l.A=!0,Ht(l,"complete"),Ht(l,"error"))}t.abort=function(l){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=l||7,Ht(this,"complete"),Ht(this,"abort"),Ul(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Ul(this,!0)),st.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?ay(this):this.bb())},t.bb=function(){ay(this)};function ay(l){if(l.h&&typeof o<"u"&&(!l.v[1]||gr(l)!=4||l.Z()!=2)){if(l.u&&gr(l)==4)Cg(l.Ea,0,l);else if(Ht(l,"readystatechange"),gr(l)==4){l.h=!1;try{const Q=l.Z();e:switch(Q){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var f=!0;break e;default:f=!1}var g;if(!(g=f)){var A;if(A=Q===0){var L=String(l.D).match(Xg)[1]||null;!L&&a.self&&a.self.location&&(L=a.self.location.protocol.slice(0,-1)),A=!hb.test(L?L.toLowerCase():"")}g=A}if(g)Ht(l,"complete"),Ht(l,"success");else{l.m=6;try{var V=2<gr(l)?l.g.statusText:""}catch{V=""}l.l=V+" ["+l.Z()+"]",oy(l)}}finally{Ul(l)}}}}function Ul(l,f){if(l.g){ly(l);const g=l.g,A=l.v[0]?()=>{}:null;l.g=null,l.v=null,f||Ht(l,"ready");try{g.onreadystatechange=A}catch{}}}function ly(l){l.I&&(a.clearTimeout(l.I),l.I=null)}t.isActive=function(){return!!this.g};function gr(l){return l.g?l.g.readyState:0}t.Z=function(){try{return 2<gr(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(l){if(this.g){var f=this.g.responseText;return l&&f.indexOf(l)==0&&(f=f.substring(l.length)),WI(f)}};function uy(l){try{if(!l.g)return null;if("response"in l.g)return l.g.response;switch(l.H){case"":case"text":return l.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in l.g)return l.g.mozResponseArrayBuffer}return null}catch{return null}}function pb(l){const f={};l=(l.g&&2<=gr(l)&&l.g.getAllResponseHeaders()||"").split(`\r
`);for(let A=0;A<l.length;A++){if(w(l[A]))continue;var g=P(l[A]);const L=g[0];if(g=g[1],typeof g!="string")continue;g=g.trim();const V=f[L]||[];f[L]=V,V.push(g)}S(f,function(A){return A.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Wo(l,f,g){return g&&g.internalChannelParams&&g.internalChannelParams[l]||f}function cy(l){this.Aa=0,this.i=[],this.j=new Mo,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Wo("failFast",!1,l),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Wo("baseRetryDelayMs",5e3,l),this.cb=Wo("retryDelaySeedMs",1e4,l),this.Wa=Wo("forwardChannelMaxRetries",2,l),this.wa=Wo("forwardChannelRequestTimeoutMs",2e4,l),this.pa=l&&l.xmlHttpFactory||void 0,this.Xa=l&&l.Tb||void 0,this.Ca=l&&l.useFetchStreams||!1,this.L=void 0,this.J=l&&l.supportsCrossDomainXhr||!1,this.K="",this.h=new Wg(l&&l.concurrentRequestLimit),this.Da=new cb,this.P=l&&l.fastHandshake||!1,this.O=l&&l.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=l&&l.Rb||!1,l&&l.xa&&this.j.xa(),l&&l.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&l&&l.detectBufferingProxy||!1,this.ja=void 0,l&&l.longPollingTimeout&&0<l.longPollingTimeout&&(this.ja=l.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=cy.prototype,t.la=8,t.G=1,t.connect=function(l,f,g,A){Gt(0),this.W=l,this.H=f||{},g&&A!==void 0&&(this.H.OSID=g,this.H.OAID=A),this.F=this.X,this.I=_y(this,null,this.W),$l(this)};function Wd(l){if(dy(l),l.G==3){var f=l.U++,g=mr(l.I);if(Ke(g,"SID",l.K),Ke(g,"RID",f),Ke(g,"TYPE","terminate"),Ho(l,g),f=new Hr(l,l.j,f),f.L=2,f.v=Ll(mr(g)),g=!1,a.navigator&&a.navigator.sendBeacon)try{g=a.navigator.sendBeacon(f.v.toString(),"")}catch{}!g&&a.Image&&(new Image().src=f.v,g=!0),g||(f.g=wy(f.j,null),f.g.ea(f.v)),f.F=Date.now(),jl(f)}vy(l)}function Fl(l){l.g&&(Gd(l),l.g.cancel(),l.g=null)}function dy(l){Fl(l),l.u&&(a.clearTimeout(l.u),l.u=null),Bl(l),l.h.cancel(),l.s&&(typeof l.s=="number"&&a.clearTimeout(l.s),l.s=null)}function $l(l){if(!Hg(l.h)&&!l.s){l.s=!0;var f=l.Ga;J||ne(),F||(J(),F=!0),K.add(f,l),l.B=0}}function mb(l,f){return Gg(l.h)>=l.h.j-(l.s?1:0)?!1:l.s?(l.i=f.D.concat(l.i),!0):l.G==1||l.G==2||l.B>=(l.Va?0:l.Wa)?!1:(l.s=Vo(m(l.Ga,l,f),yy(l,l.B)),l.B++,!0)}t.Ga=function(l){if(this.s)if(this.s=null,this.G==1){if(!l){this.U=Math.floor(1e5*Math.random()),l=this.U++;const L=new Hr(this,this.j,l);let V=this.o;if(this.S&&(V?(V=x(V),k(V,this.S)):V=this.S),this.m!==null||this.O||(L.H=V,V=null),this.P)e:{for(var f=0,g=0;g<this.i.length;g++){t:{var A=this.i[g];if("__data__"in A.map&&(A=A.map.__data__,typeof A=="string")){A=A.length;break t}A=void 0}if(A===void 0)break;if(f+=A,4096<f){f=g;break e}if(f===4096||g===this.i.length-1){f=g+1;break e}}f=1e3}else f=1e3;f=fy(this,L,f),g=mr(this.I),Ke(g,"RID",l),Ke(g,"CVER",22),this.D&&Ke(g,"X-HTTP-Session-Id",this.D),Ho(this,g),V&&(this.O?f="headers="+encodeURIComponent(String(sy(V)))+"&"+f:this.m&&qd(g,this.m,V)),zd(this.h,L),this.Ua&&Ke(g,"TYPE","init"),this.P?(Ke(g,"$req",f),Ke(g,"SID","null"),L.T=!0,Ud(L,g,null)):Ud(L,g,f),this.G=2}}else this.G==3&&(l?hy(this,l):this.i.length==0||Hg(this.h)||hy(this))};function hy(l,f){var g;f?g=f.l:g=l.U++;const A=mr(l.I);Ke(A,"SID",l.K),Ke(A,"RID",g),Ke(A,"AID",l.T),Ho(l,A),l.m&&l.o&&qd(A,l.m,l.o),g=new Hr(l,l.j,g,l.B+1),l.m===null&&(g.H=l.o),f&&(l.i=f.D.concat(l.i)),f=fy(l,g,1e3),g.I=Math.round(.5*l.wa)+Math.round(.5*l.wa*Math.random()),zd(l.h,g),Ud(g,A,f)}function Ho(l,f){l.H&&O(l.H,function(g,A){Ke(f,A,g)}),l.l&&Yg({},function(g,A){Ke(f,A,g)})}function fy(l,f,g){g=Math.min(l.i.length,g);var A=l.l?m(l.l.Na,l.l,l):null;e:{var L=l.i;let V=-1;for(;;){const Q=["count="+g];V==-1?0<g?(V=L[0].g,Q.push("ofs="+V)):V=0:Q.push("ofs="+V);let Be=!0;for(let Nt=0;Nt<g;Nt++){let Le=L[Nt].g;const jt=L[Nt].map;if(Le-=V,0>Le)V=Math.max(0,L[Nt].g-100),Be=!1;else try{db(jt,Q,"req"+Le+"_")}catch{A&&A(jt)}}if(Be){A=Q.join("&");break e}}}return l=l.i.splice(0,g),f.D=l,A}function py(l){if(!l.g&&!l.u){l.Y=1;var f=l.Fa;J||ne(),F||(J(),F=!0),K.add(f,l),l.v=0}}function Hd(l){return l.g||l.u||3<=l.v?!1:(l.Y++,l.u=Vo(m(l.Fa,l),yy(l,l.v)),l.v++,!0)}t.Fa=function(){if(this.u=null,my(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var l=2*this.R;this.j.info("BP detection timer enabled: "+l),this.A=Vo(m(this.ab,this),l)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Gt(10),Fl(this),my(this))};function Gd(l){l.A!=null&&(a.clearTimeout(l.A),l.A=null)}function my(l){l.g=new Hr(l,l.j,"rpc",l.Y),l.m===null&&(l.g.H=l.o),l.g.O=0;var f=mr(l.qa);Ke(f,"RID","rpc"),Ke(f,"SID",l.K),Ke(f,"AID",l.T),Ke(f,"CI",l.F?"0":"1"),!l.F&&l.ja&&Ke(f,"TO",l.ja),Ke(f,"TYPE","xmlhttp"),Ho(l,f),l.m&&l.o&&qd(f,l.m,l.o),l.L&&(l.g.I=l.L);var g=l.g;l=l.ia,g.L=1,g.v=Ll(mr(f)),g.m=null,g.P=!0,Bg(g,l)}t.Za=function(){this.C!=null&&(this.C=null,Fl(this),Hd(this),Gt(19))};function Bl(l){l.C!=null&&(a.clearTimeout(l.C),l.C=null)}function gy(l,f){var g=null;if(l.g==f){Bl(l),Gd(l),l.g=null;var A=2}else if(Bd(l.h,f))g=f.D,Kg(l.h,f),A=1;else return;if(l.G!=0){if(f.o)if(A==1){g=f.m?f.m.length:0,f=Date.now()-f.F;var L=l.B;A=Rl(),Ht(A,new Mg(A,g)),$l(l)}else py(l);else if(L=f.s,L==3||L==0&&0<f.X||!(A==1&&mb(l,f)||A==2&&Hd(l)))switch(g&&0<g.length&&(f=l.h,f.i=f.i.concat(g)),L){case 1:$s(l,5);break;case 4:$s(l,10);break;case 3:$s(l,6);break;default:$s(l,2)}}}function yy(l,f){let g=l.Ta+Math.floor(Math.random()*l.cb);return l.isActive()||(g*=2),g*f}function $s(l,f){if(l.j.info("Error code "+f),f==2){var g=m(l.fb,l),A=l.Xa;const L=!A;A=new Fs(A||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||Dl(A,"https"),Ll(A),L?lb(A.toString(),g):ub(A.toString(),g)}else Gt(2);l.G=0,l.l&&l.l.sa(f),vy(l),dy(l)}t.fb=function(l){l?(this.j.info("Successfully pinged google.com"),Gt(2)):(this.j.info("Failed to ping google.com"),Gt(1))};function vy(l){if(l.G=0,l.ka=[],l.l){const f=Qg(l.h);(f.length!=0||l.i.length!=0)&&(I(l.ka,f),I(l.ka,l.i),l.h.i.length=0,b(l.i),l.i.length=0),l.l.ra()}}function _y(l,f,g){var A=g instanceof Fs?mr(g):new Fs(g);if(A.g!="")f&&(A.g=f+"."+A.g),Ol(A,A.s);else{var L=a.location;A=L.protocol,f=f?f+"."+L.hostname:L.hostname,L=+L.port;var V=new Fs(null);A&&Dl(V,A),f&&(V.g=f),L&&Ol(V,L),g&&(V.l=g),A=V}return g=l.D,f=l.ya,g&&f&&Ke(A,g,f),Ke(A,"VER",l.la),Ho(l,A),A}function wy(l,f,g){if(f&&!l.J)throw Error("Can't create secondary domain capable XhrIo object.");return f=l.Ca&&!l.pa?new st(new Vl({eb:g})):new st(l.pa),f.Ha(l.J),f}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function xy(){}t=xy.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function zl(){}zl.prototype.g=function(l,f){return new hn(l,f)};function hn(l,f){Pt.call(this),this.g=new cy(f),this.l=l,this.h=f&&f.messageUrlParams||null,l=f&&f.messageHeaders||null,f&&f.clientProtocolHeaderRequired&&(l?l["X-Client-Protocol"]="webchannel":l={"X-Client-Protocol":"webchannel"}),this.g.o=l,l=f&&f.initMessageHeaders||null,f&&f.messageContentType&&(l?l["X-WebChannel-Content-Type"]=f.messageContentType:l={"X-WebChannel-Content-Type":f.messageContentType}),f&&f.va&&(l?l["X-WebChannel-Client-Profile"]=f.va:l={"X-WebChannel-Client-Profile":f.va}),this.g.S=l,(l=f&&f.Sb)&&!w(l)&&(this.g.m=l),this.v=f&&f.supportsCrossDomainXhr||!1,this.u=f&&f.sendRawJson||!1,(f=f&&f.httpSessionIdParam)&&!w(f)&&(this.g.D=f,l=this.h,l!==null&&f in l&&(l=this.h,f in l&&delete l[f])),this.j=new bi(this)}T(hn,Pt),hn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},hn.prototype.close=function(){Wd(this.g)},hn.prototype.o=function(l){var f=this.g;if(typeof l=="string"){var g={};g.__data__=l,l=g}else this.u&&(g={},g.__data__=jd(l),l=g);f.i.push(new JI(f.Ya++,l)),f.G==3&&$l(f)},hn.prototype.N=function(){this.g.l=null,delete this.j,Wd(this.g),delete this.g,hn.aa.N.call(this)};function Ey(l){Od.call(this),l.__headers__&&(this.headers=l.__headers__,this.statusCode=l.__status__,delete l.__headers__,delete l.__status__);var f=l.__sm__;if(f){e:{for(const g in f){l=g;break e}l=void 0}(this.i=l)&&(l=this.i,f=f!==null&&l in f?f[l]:void 0),this.data=f}else this.data=l}T(Ey,Od);function Ty(){Ld.call(this),this.status=1}T(Ty,Ld);function bi(l){this.g=l}T(bi,xy),bi.prototype.ua=function(){Ht(this.g,"a")},bi.prototype.ta=function(l){Ht(this.g,new Ey(l))},bi.prototype.sa=function(l){Ht(this.g,new Ty)},bi.prototype.ra=function(){Ht(this.g,"b")},zl.prototype.createWebChannel=zl.prototype.g,hn.prototype.send=hn.prototype.o,hn.prototype.open=hn.prototype.m,hn.prototype.close=hn.prototype.close,cT=function(){return new zl},uT=function(){return Rl()},lT=Ms,Xf={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},kl.NO_ERROR=0,kl.TIMEOUT=8,kl.HTTP_ERROR=6,Du=kl,Ug.COMPLETE="complete",aT=Ug,Dg.EventType=Oo,Oo.OPEN="a",Oo.CLOSE="b",Oo.ERROR="c",Oo.MESSAGE="d",Pt.prototype.listen=Pt.prototype.K,la=Dg,st.prototype.listenOnce=st.prototype.L,st.prototype.getLastError=st.prototype.Ka,st.prototype.getLastErrorCode=st.prototype.Ba,st.prototype.getStatus=st.prototype.Z,st.prototype.getResponseJson=st.prototype.Oa,st.prototype.getResponseText=st.prototype.oa,st.prototype.send=st.prototype.ea,st.prototype.setWithCredentials=st.prototype.Ha,oT=st}).apply(typeof cu<"u"?cu:typeof self<"u"?self:typeof window<"u"?window:{});const y_="@firebase/firestore",v_="4.9.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mt{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Mt.UNAUTHENTICATED=new Mt(null),Mt.GOOGLE_CREDENTIALS=new Mt("google-credentials-uid"),Mt.FIRST_PARTY=new Mt("first-party-uid"),Mt.MOCK_USER=new Mt("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let No="12.0.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ui=new pm("@firebase/firestore");function Ci(){return ui.logLevel}function ee(t,...e){if(ui.logLevel<=Ie.DEBUG){const n=e.map(km);ui.debug(`Firestore (${No}): ${t}`,...n)}}function Vr(t,...e){if(ui.logLevel<=Ie.ERROR){const n=e.map(km);ui.error(`Firestore (${No}): ${t}`,...n)}}function ci(t,...e){if(ui.logLevel<=Ie.WARN){const n=e.map(km);ui.warn(`Firestore (${No}): ${t}`,...n)}}function km(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fe(t,e,n){let r="Unexpected state";typeof e=="string"?r=e:n=e,dT(t,r,n)}function dT(t,e,n){let r=`FIRESTORE (${No}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(n!==void 0)try{r+=" CONTEXT: "+JSON.stringify(n)}catch{r+=" CONTEXT: "+n}throw Vr(r),new Error(r)}function Ve(t,e,n,r){let s="Unexpected state";typeof n=="string"?s=n:r=n,t||dT(e,s,r)}function ye(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const U={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class X extends Ln{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lr{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hT{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class fT{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(Mt.UNAUTHENTICATED))}shutdown(){}}class GP{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class KP{constructor(e){this.t=e,this.currentUser=Mt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){Ve(this.o===void 0,42304);let r=this.i;const s=c=>this.i!==r?(r=this.i,n(c)):Promise.resolve();let i=new lr;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new lr,e.enqueueRetryable(()=>s(this.currentUser))};const o=()=>{const c=i;e.enqueueRetryable(async()=>{await c.promise,await s(this.currentUser)})},a=c=>{ee("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(c=>a(c)),setTimeout(()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?a(c):(ee("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new lr)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(ee("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Ve(typeof r.accessToken=="string",31837,{l:r}),new hT(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Ve(e===null||typeof e=="string",2055,{h:e}),new Mt(e)}}class QP{constructor(e,n,r){this.P=e,this.T=n,this.I=r,this.type="FirstParty",this.user=Mt.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class YP{constructor(e,n,r){this.P=e,this.T=n,this.I=r}getToken(){return Promise.resolve(new QP(this.P,this.T,this.I))}start(e,n){e.enqueueRetryable(()=>n(Mt.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class __{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class XP{constructor(e,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Xt(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,n){Ve(this.o===void 0,3512);const r=i=>{i.error!=null&&ee("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.m;return this.m=i.token,ee("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>r(i))};const s=i=>{ee("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.V.getImmediate({optional:!0});i?s(i):ee("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new __(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(Ve(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new __(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JP(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class od{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const s=JP(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<n&&(r+=e.charAt(s[i]%62))}return r}}function be(t,e){return t<e?-1:t>e?1:0}function Jf(t,e){const n=Math.min(t.length,e.length);for(let r=0;r<n;r++){const s=t.charAt(r),i=e.charAt(r);if(s!==i)return Rh(s)===Rh(i)?be(s,i):Rh(s)?1:-1}return be(t.length,e.length)}const ZP=55296,e2=57343;function Rh(t){const e=t.charCodeAt(0);return e>=ZP&&e<=e2}function ho(t,e,n){return t.length===e.length&&t.every((r,s)=>n(r,e[s]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const w_="__name__";class nr{constructor(e,n,r){n===void 0?n=0:n>e.length&&fe(637,{offset:n,range:e.length}),r===void 0?r=e.length-n:r>e.length-n&&fe(1746,{length:r,range:e.length-n}),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return nr.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof nr?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let s=0;s<r;s++){const i=nr.compareSegments(e.get(s),n.get(s));if(i!==0)return i}return be(e.length,n.length)}static compareSegments(e,n){const r=nr.isNumericId(e),s=nr.isNumericId(n);return r&&!s?-1:!r&&s?1:r&&s?nr.extractNumericId(e).compare(nr.extractNumericId(n)):Jf(e,n)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return ws.fromString(e.substring(4,e.length-2))}}class qe extends nr{construct(e,n,r){return new qe(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new X(U.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(s=>s.length>0))}return new qe(n)}static emptyPath(){return new qe([])}}const t2=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Et extends nr{construct(e,n,r){return new Et(e,n,r)}static isValidIdentifier(e){return t2.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Et.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===w_}static keyField(){return new Et([w_])}static fromServerFormat(e){const n=[];let r="",s=0;const i=()=>{if(r.length===0)throw new X(U.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;s<e.length;){const a=e[s];if(a==="\\"){if(s+1===e.length)throw new X(U.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[s+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new X(U.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=c,s+=2}else a==="`"?(o=!o,s++):a!=="."||o?(r+=a,s++):(i(),s++)}if(i(),o)throw new X(U.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Et(n)}static emptyPath(){return new Et([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class le{constructor(e){this.path=e}static fromPath(e){return new le(qe.fromString(e))}static fromName(e){return new le(qe.fromString(e).popFirst(5))}static empty(){return new le(qe.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&qe.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return qe.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new le(new qe(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pm(t,e,n){if(!n)throw new X(U.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function pT(t,e,n,r){if(e===!0&&r===!0)throw new X(U.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function x_(t){if(!le.isDocumentKey(t))throw new X(U.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function E_(t){if(le.isDocumentKey(t))throw new X(U.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function mT(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function ad(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":fe(12329,{type:typeof t})}function St(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new X(U.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=ad(t);throw new X(U.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pt(t,e){const n={typeString:t};return e&&(n.value=e),n}function gl(t,e){if(!mT(t))throw new X(U.INVALID_ARGUMENT,"JSON must be an object");let n;for(const r in e)if(e[r]){const s=e[r].typeString,i="value"in e[r]?{value:e[r].value}:void 0;if(!(r in t)){n=`JSON missing required field: '${r}'`;break}const o=t[r];if(s&&typeof o!==s){n=`JSON field '${r}' must be a ${s}.`;break}if(i!==void 0&&o!==i.value){n=`Expected '${r}' field to equal '${i.value}'`;break}}if(n)throw new X(U.INVALID_ARGUMENT,n);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const T_=-62135596800,S_=1e6;class We{static now(){return We.fromMillis(Date.now())}static fromDate(e){return We.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor((e-1e3*n)*S_);return new We(n,r)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new X(U.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new X(U.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<T_)throw new X(U.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new X(U.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/S_}_compareTo(e){return this.seconds===e.seconds?be(this.nanoseconds,e.nanoseconds):be(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:We._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(gl(e,We._jsonSchema))return new We(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-T_;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}We._jsonSchemaVersion="firestore/timestamp/1.0",We._jsonSchema={type:pt("string",We._jsonSchemaVersion),seconds:pt("number"),nanoseconds:pt("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ve{static fromTimestamp(e){return new ve(e)}static min(){return new ve(new We(0,0))}static max(){return new ve(new We(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ya=-1;function n2(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,s=ve.fromTimestamp(r===1e9?new We(n+1,0):new We(n,r));return new Is(s,le.empty(),e)}function r2(t){return new Is(t.readTime,t.key,Ya)}class Is{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new Is(ve.min(),le.empty(),Ya)}static max(){return new Is(ve.max(),le.empty(),Ya)}}function s2(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=le.comparator(t.documentKey,e.documentKey),n!==0?n:be(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i2="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class o2{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ao(t){if(t.code!==U.FAILED_PRECONDITION||t.message!==i2)throw t;ee("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&fe(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new B((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(n,i).next(r,s)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof B?n:B.resolve(n)}catch(n){return B.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):B.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):B.reject(n)}static resolve(e){return new B((n,r)=>{n(e)})}static reject(e){return new B((n,r)=>{r(e)})}static waitFor(e){return new B((n,r)=>{let s=0,i=0,o=!1;e.forEach(a=>{++s,a.next(()=>{++i,o&&i===s&&n()},c=>r(c))}),o=!0,i===s&&n()})}static or(e){let n=B.resolve(!1);for(const r of e)n=n.next(s=>s?B.resolve(s):r());return n}static forEach(e,n){const r=[];return e.forEach((s,i)=>{r.push(n.call(this,s,i))}),this.waitFor(r)}static mapArray(e,n){return new B((r,s)=>{const i=e.length,o=new Array(i);let a=0;for(let c=0;c<i;c++){const d=c;n(e[d]).next(h=>{o[d]=h,++a,a===i&&r(o)},h=>s(h))}})}static doWhile(e,n){return new B((r,s)=>{const i=()=>{e()===!0?n().next(()=>{i()},s):r()};i()})}}function a2(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function Co(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ld{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>n.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}ld.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jm=-1;function ud(t){return t==null}function _c(t){return t===0&&1/t==-1/0}function l2(t){return typeof t=="number"&&Number.isInteger(t)&&!_c(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gT="";function u2(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=I_(e)),e=c2(t.get(n),e);return I_(e)}function c2(t,e){let n=e;const r=t.length;for(let s=0;s<r;s++){const i=t.charAt(s);switch(i){case"\0":n+="";break;case gT:n+="";break;default:n+=i}}return n}function I_(t){return t+gT+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function b_(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Ls(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function d2(t,e){const n=[];for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&n.push(e(t[r],r,t));return n}function yT(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rt{constructor(e,n){this.comparator=e,this.root=n||Ct.EMPTY}insert(e,n){return new rt(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Ct.BLACK,null,null))}remove(e){return new rt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Ct.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return n+r.left.size;s<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new du(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new du(this.root,e,this.comparator,!1)}getReverseIterator(){return new du(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new du(this.root,e,this.comparator,!0)}}class du{constructor(e,n,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=n?r(e.key,n):1,n&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Ct{constructor(e,n,r,s,i){this.key=e,this.value=n,this.color=r??Ct.RED,this.left=s??Ct.EMPTY,this.right=i??Ct.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,s,i){return new Ct(e??this.key,n??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,n,r),null):i===0?s.copy(null,n,null,null,null):s.copy(null,null,null,null,s.right.insert(e,n,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return Ct.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,s=this;if(n(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),n(e,s.key)===0){if(s.right.isEmpty())return Ct.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Ct.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Ct.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw fe(43730,{key:this.key,value:this.value});if(this.right.isRed())throw fe(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw fe(27949);return e+(this.isRed()?0:1)}}Ct.EMPTY=null,Ct.RED=!0,Ct.BLACK=!1;Ct.EMPTY=new class{constructor(){this.size=0}get key(){throw fe(57766)}get value(){throw fe(16141)}get color(){throw fe(16727)}get left(){throw fe(29726)}get right(){throw fe(36894)}copy(e,n,r,s,i){return this}insert(e,n,r){return new Ct(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _t{constructor(e){this.comparator=e,this.data=new rt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;n(s.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new N_(this.data.getIterator())}getIteratorFrom(e){return new N_(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof _t)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new _t(this.comparator);return n.data=e,n}}class N_{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gn{constructor(e){this.fields=e,e.sort(Et.comparator)}static empty(){return new gn([])}unionWith(e){let n=new _t(Et.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new gn(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return ho(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vT extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bt{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new vT("Invalid base64 string: "+i):i}}(e);return new bt(n)}static fromUint8Array(e){const n=function(s){let i="";for(let o=0;o<s.length;++o)i+=String.fromCharCode(s[o]);return i}(e);return new bt(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return be(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}bt.EMPTY_BYTE_STRING=new bt("");const h2=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function bs(t){if(Ve(!!t,39018),typeof t=="string"){let e=0;const n=h2.exec(t);if(Ve(!!n,46558,{timestamp:t}),n[1]){let s=n[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:lt(t.seconds),nanos:lt(t.nanos)}}function lt(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Ns(t){return typeof t=="string"?bt.fromBase64String(t):bt.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _T="server_timestamp",wT="__type__",xT="__previous_value__",ET="__local_write_time__";function Dm(t){var n,r;return((r=(((n=t==null?void 0:t.mapValue)==null?void 0:n.fields)||{})[wT])==null?void 0:r.stringValue)===_T}function cd(t){const e=t.mapValue.fields[xT];return Dm(e)?cd(e):e}function Xa(t){const e=bs(t.mapValue.fields[ET].timestampValue);return new We(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f2{constructor(e,n,r,s,i,o,a,c,d,h){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=c,this.useFetchStreams=d,this.isUsingEmulator=h}}const wc="(default)";class fo{constructor(e,n){this.projectId=e,this.database=n||wc}static empty(){return new fo("","")}get isDefaultDatabase(){return this.database===wc}isEqual(e){return e instanceof fo&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TT="__type__",p2="__max__",hu={mapValue:{}},ST="__vector__",xc="value";function As(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Dm(t)?4:g2(t)?9007199254740991:m2(t)?10:11:fe(28295,{value:t})}function dr(t,e){if(t===e)return!0;const n=As(t);if(n!==As(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Xa(t).isEqual(Xa(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const o=bs(s.timestampValue),a=bs(i.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,i){return Ns(s.bytesValue).isEqual(Ns(i.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,i){return lt(s.geoPointValue.latitude)===lt(i.geoPointValue.latitude)&&lt(s.geoPointValue.longitude)===lt(i.geoPointValue.longitude)}(t,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return lt(s.integerValue)===lt(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const o=lt(s.doubleValue),a=lt(i.doubleValue);return o===a?_c(o)===_c(a):isNaN(o)&&isNaN(a)}return!1}(t,e);case 9:return ho(t.arrayValue.values||[],e.arrayValue.values||[],dr);case 10:case 11:return function(s,i){const o=s.mapValue.fields||{},a=i.mapValue.fields||{};if(b_(o)!==b_(a))return!1;for(const c in o)if(o.hasOwnProperty(c)&&(a[c]===void 0||!dr(o[c],a[c])))return!1;return!0}(t,e);default:return fe(52216,{left:t})}}function Ja(t,e){return(t.values||[]).find(n=>dr(n,e))!==void 0}function po(t,e){if(t===e)return 0;const n=As(t),r=As(e);if(n!==r)return be(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return be(t.booleanValue,e.booleanValue);case 2:return function(i,o){const a=lt(i.integerValue||i.doubleValue),c=lt(o.integerValue||o.doubleValue);return a<c?-1:a>c?1:a===c?0:isNaN(a)?isNaN(c)?0:-1:1}(t,e);case 3:return A_(t.timestampValue,e.timestampValue);case 4:return A_(Xa(t),Xa(e));case 5:return Jf(t.stringValue,e.stringValue);case 6:return function(i,o){const a=Ns(i),c=Ns(o);return a.compareTo(c)}(t.bytesValue,e.bytesValue);case 7:return function(i,o){const a=i.split("/"),c=o.split("/");for(let d=0;d<a.length&&d<c.length;d++){const h=be(a[d],c[d]);if(h!==0)return h}return be(a.length,c.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,o){const a=be(lt(i.latitude),lt(o.latitude));return a!==0?a:be(lt(i.longitude),lt(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return C_(t.arrayValue,e.arrayValue);case 10:return function(i,o){var m,y,T,b;const a=i.fields||{},c=o.fields||{},d=(m=a[xc])==null?void 0:m.arrayValue,h=(y=c[xc])==null?void 0:y.arrayValue,p=be(((T=d==null?void 0:d.values)==null?void 0:T.length)||0,((b=h==null?void 0:h.values)==null?void 0:b.length)||0);return p!==0?p:C_(d,h)}(t.mapValue,e.mapValue);case 11:return function(i,o){if(i===hu.mapValue&&o===hu.mapValue)return 0;if(i===hu.mapValue)return 1;if(o===hu.mapValue)return-1;const a=i.fields||{},c=Object.keys(a),d=o.fields||{},h=Object.keys(d);c.sort(),h.sort();for(let p=0;p<c.length&&p<h.length;++p){const m=Jf(c[p],h[p]);if(m!==0)return m;const y=po(a[c[p]],d[h[p]]);if(y!==0)return y}return be(c.length,h.length)}(t.mapValue,e.mapValue);default:throw fe(23264,{he:n})}}function A_(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return be(t,e);const n=bs(t),r=bs(e),s=be(n.seconds,r.seconds);return s!==0?s:be(n.nanos,r.nanos)}function C_(t,e){const n=t.values||[],r=e.values||[];for(let s=0;s<n.length&&s<r.length;++s){const i=po(n[s],r[s]);if(i)return i}return be(n.length,r.length)}function mo(t){return Zf(t)}function Zf(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=bs(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return Ns(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return le.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",s=!0;for(const i of n.values||[])s?s=!1:r+=",",r+=Zf(i);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let s="{",i=!0;for(const o of r)i?i=!1:s+=",",s+=`${o}:${Zf(n.fields[o])}`;return s+"}"}(t.mapValue):fe(61005,{value:t})}function Ou(t){switch(As(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=cd(t);return e?16+Ou(e):16;case 5:return 2*t.stringValue.length;case 6:return Ns(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((s,i)=>s+Ou(i),0)}(t.arrayValue);case 10:case 11:return function(r){let s=0;return Ls(r.fields,(i,o)=>{s+=i.length+Ou(o)}),s}(t.mapValue);default:throw fe(13486,{value:t})}}function R_(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function ep(t){return!!t&&"integerValue"in t}function Om(t){return!!t&&"arrayValue"in t}function k_(t){return!!t&&"nullValue"in t}function P_(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Lu(t){return!!t&&"mapValue"in t}function m2(t){var n,r;return((r=(((n=t==null?void 0:t.mapValue)==null?void 0:n.fields)||{})[TT])==null?void 0:r.stringValue)===ST}function Ea(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return Ls(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=Ea(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Ea(t.arrayValue.values[n]);return e}return{...t}}function g2(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===p2}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class on{constructor(e){this.value=e}static empty(){return new on({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!Lu(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=Ea(n)}setAll(e){let n=Et.emptyPath(),r={},s=[];e.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){const c=this.getFieldsMap(n);this.applyChanges(c,r,s),r={},s=[],n=a.popLast()}o?r[a.lastSegment()]=Ea(o):s.push(a.lastSegment())});const i=this.getFieldsMap(n);this.applyChanges(i,r,s)}delete(e){const n=this.field(e.popLast());Lu(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return dr(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=n.mapValue.fields[e.get(r)];Lu(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=s),n=s}return n.mapValue.fields}applyChanges(e,n,r){Ls(n,(s,i)=>e[s]=i);for(const s of r)delete e[s]}clone(){return new on(Ea(this.value))}}function IT(t){const e=[];return Ls(t.fields,(n,r)=>{const s=new Et([n]);if(Lu(r)){const i=IT(r.mapValue).fields;if(i.length===0)e.push(s);else for(const o of i)e.push(s.child(o))}else e.push(s)}),new gn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ft{constructor(e,n,r,s,i,o,a){this.key=e,this.documentType=n,this.version=r,this.readTime=s,this.createTime=i,this.data=o,this.documentState=a}static newInvalidDocument(e){return new Ft(e,0,ve.min(),ve.min(),ve.min(),on.empty(),0)}static newFoundDocument(e,n,r,s){return new Ft(e,1,n,ve.min(),r,s,0)}static newNoDocument(e,n){return new Ft(e,2,n,ve.min(),ve.min(),on.empty(),0)}static newUnknownDocument(e,n){return new Ft(e,3,n,ve.min(),ve.min(),on.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(ve.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=on.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=on.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ve.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Ft&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Ft(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ec{constructor(e,n){this.position=e,this.inclusive=n}}function j_(t,e,n){let r=0;for(let s=0;s<t.position.length;s++){const i=e[s],o=t.position[s];if(i.field.isKeyField()?r=le.comparator(le.fromName(o.referenceValue),n.key):r=po(o,n.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function D_(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!dr(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Za{constructor(e,n="asc"){this.field=e,this.dir=n}}function y2(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bT{}class ft extends bT{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new _2(e,n,r):n==="array-contains"?new E2(e,r):n==="in"?new T2(e,r):n==="not-in"?new S2(e,r):n==="array-contains-any"?new I2(e,r):new ft(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new w2(e,r):new x2(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(po(n,this.value)):n!==null&&As(this.value)===As(n)&&this.matchesComparison(po(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return fe(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Yn extends bT{constructor(e,n){super(),this.filters=e,this.op=n,this.Pe=null}static create(e,n){return new Yn(e,n)}matches(e){return NT(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function NT(t){return t.op==="and"}function AT(t){return v2(t)&&NT(t)}function v2(t){for(const e of t.filters)if(e instanceof Yn)return!1;return!0}function tp(t){if(t instanceof ft)return t.field.canonicalString()+t.op.toString()+mo(t.value);if(AT(t))return t.filters.map(e=>tp(e)).join(",");{const e=t.filters.map(n=>tp(n)).join(",");return`${t.op}(${e})`}}function CT(t,e){return t instanceof ft?function(r,s){return s instanceof ft&&r.op===s.op&&r.field.isEqual(s.field)&&dr(r.value,s.value)}(t,e):t instanceof Yn?function(r,s){return s instanceof Yn&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce((i,o,a)=>i&&CT(o,s.filters[a]),!0):!1}(t,e):void fe(19439)}function RT(t){return t instanceof ft?function(n){return`${n.field.canonicalString()} ${n.op} ${mo(n.value)}`}(t):t instanceof Yn?function(n){return n.op.toString()+" {"+n.getFilters().map(RT).join(" ,")+"}"}(t):"Filter"}class _2 extends ft{constructor(e,n,r){super(e,n,r),this.key=le.fromName(r.referenceValue)}matches(e){const n=le.comparator(e.key,this.key);return this.matchesComparison(n)}}class w2 extends ft{constructor(e,n){super(e,"in",n),this.keys=kT("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class x2 extends ft{constructor(e,n){super(e,"not-in",n),this.keys=kT("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function kT(t,e){var n;return(((n=e.arrayValue)==null?void 0:n.values)||[]).map(r=>le.fromName(r.referenceValue))}class E2 extends ft{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return Om(n)&&Ja(n.arrayValue,this.value)}}class T2 extends ft{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&Ja(this.value.arrayValue,n)}}class S2 extends ft{constructor(e,n){super(e,"not-in",n)}matches(e){if(Ja(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&n.nullValue===void 0&&!Ja(this.value.arrayValue,n)}}class I2 extends ft{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!Om(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>Ja(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b2{constructor(e,n=null,r=[],s=[],i=null,o=null,a=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=o,this.endAt=a,this.Te=null}}function O_(t,e=null,n=[],r=[],s=null,i=null,o=null){return new b2(t,e,n,r,s,i,o)}function Lm(t){const e=ye(t);if(e.Te===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>tp(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(i){return i.field.canonicalString()+i.dir}(r)).join(","),ud(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>mo(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>mo(r)).join(",")),e.Te=n}return e.Te}function Vm(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!y2(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!CT(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!D_(t.startAt,e.startAt)&&D_(t.endAt,e.endAt)}function np(t){return le.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _i{constructor(e,n=null,r=[],s=[],i=null,o="F",a=null,c=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=o,this.startAt=a,this.endAt=c,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function N2(t,e,n,r,s,i,o,a){return new _i(t,e,n,r,s,i,o,a)}function dd(t){return new _i(t)}function L_(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function PT(t){return t.collectionGroup!==null}function Ta(t){const e=ye(t);if(e.Ie===null){e.Ie=[];const n=new Set;for(const i of e.explicitOrderBy)e.Ie.push(i),n.add(i.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new _t(Et.comparator);return o.filters.forEach(c=>{c.getFlattenedFilters().forEach(d=>{d.isInequality()&&(a=a.add(d.field))})}),a})(e).forEach(i=>{n.has(i.canonicalString())||i.isKeyField()||e.Ie.push(new Za(i,r))}),n.has(Et.keyField().canonicalString())||e.Ie.push(new Za(Et.keyField(),r))}return e.Ie}function ur(t){const e=ye(t);return e.Ee||(e.Ee=jT(e,Ta(t))),e.Ee}function A2(t){const e=ye(t);return e.de||(e.de=jT(e,t.explicitOrderBy)),e.de}function jT(t,e){if(t.limitType==="F")return O_(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new Za(s.field,i)});const n=t.endAt?new Ec(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new Ec(t.startAt.position,t.startAt.inclusive):null;return O_(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function rp(t,e){const n=t.filters.concat([e]);return new _i(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function Tc(t,e,n){return new _i(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function hd(t,e){return Vm(ur(t),ur(e))&&t.limitType===e.limitType}function DT(t){return`${Lm(ur(t))}|lt:${t.limitType}`}function Ri(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(s=>RT(s)).join(", ")}]`),ud(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(s=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(s)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(s=>mo(s)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(s=>mo(s)).join(",")),`Target(${r})`}(ur(t))}; limitType=${t.limitType})`}function fd(t,e){return e.isFoundDocument()&&function(r,s){const i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):le.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)}(t,e)&&function(r,s){for(const i of Ta(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(t,e)&&function(r,s){for(const i of r.filters)if(!i.matches(s))return!1;return!0}(t,e)&&function(r,s){return!(r.startAt&&!function(o,a,c){const d=j_(o,a,c);return o.inclusive?d<=0:d<0}(r.startAt,Ta(r),s)||r.endAt&&!function(o,a,c){const d=j_(o,a,c);return o.inclusive?d>=0:d>0}(r.endAt,Ta(r),s))}(t,e)}function C2(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function OT(t){return(e,n)=>{let r=!1;for(const s of Ta(t)){const i=R2(s,e,n);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function R2(t,e,n){const r=t.field.isKeyField()?le.comparator(e.key,n.key):function(i,o,a){const c=o.data.field(i),d=a.data.field(i);return c!==null&&d!==null?po(c,d):fe(42886)}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return fe(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wi{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,n]);s.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[n]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){Ls(this.inner,(n,r)=>{for(const[s,i]of r)e(s,i)})}isEmpty(){return yT(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const k2=new rt(le.comparator);function Mr(){return k2}const LT=new rt(le.comparator);function ua(...t){let e=LT;for(const n of t)e=e.insert(n.key,n);return e}function VT(t){let e=LT;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function Ys(){return Sa()}function MT(){return Sa()}function Sa(){return new wi(t=>t.toString(),(t,e)=>t.isEqual(e))}const P2=new rt(le.comparator),j2=new _t(le.comparator);function Ne(...t){let e=j2;for(const n of t)e=e.add(n);return e}const D2=new _t(be);function O2(){return D2}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mm(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:_c(e)?"-0":e}}function UT(t){return{integerValue:""+t}}function L2(t,e){return l2(e)?UT(e):Mm(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pd{constructor(){this._=void 0}}function V2(t,e,n){return t instanceof el?function(s,i){const o={fields:{[wT]:{stringValue:_T},[ET]:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&Dm(i)&&(i=cd(i)),i&&(o.fields[xT]=i),{mapValue:o}}(n,e):t instanceof tl?$T(t,e):t instanceof nl?BT(t,e):function(s,i){const o=FT(s,i),a=V_(o)+V_(s.Ae);return ep(o)&&ep(s.Ae)?UT(a):Mm(s.serializer,a)}(t,e)}function M2(t,e,n){return t instanceof tl?$T(t,e):t instanceof nl?BT(t,e):n}function FT(t,e){return t instanceof Sc?function(r){return ep(r)||function(i){return!!i&&"doubleValue"in i}(r)}(e)?e:{integerValue:0}:null}class el extends pd{}class tl extends pd{constructor(e){super(),this.elements=e}}function $T(t,e){const n=zT(e);for(const r of t.elements)n.some(s=>dr(s,r))||n.push(r);return{arrayValue:{values:n}}}class nl extends pd{constructor(e){super(),this.elements=e}}function BT(t,e){let n=zT(e);for(const r of t.elements)n=n.filter(s=>!dr(s,r));return{arrayValue:{values:n}}}class Sc extends pd{constructor(e,n){super(),this.serializer=e,this.Ae=n}}function V_(t){return lt(t.integerValue||t.doubleValue)}function zT(t){return Om(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U2{constructor(e,n){this.field=e,this.transform=n}}function F2(t,e){return t.field.isEqual(e.field)&&function(r,s){return r instanceof tl&&s instanceof tl||r instanceof nl&&s instanceof nl?ho(r.elements,s.elements,dr):r instanceof Sc&&s instanceof Sc?dr(r.Ae,s.Ae):r instanceof el&&s instanceof el}(t.transform,e.transform)}class $2{constructor(e,n){this.version=e,this.transformResults=n}}class Zt{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new Zt}static exists(e){return new Zt(void 0,e)}static updateTime(e){return new Zt(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Vu(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class md{}function qT(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new gd(t.key,Zt.none()):new yl(t.key,t.data,Zt.none());{const n=t.data,r=on.empty();let s=new _t(Et.comparator);for(let i of e.fields)if(!s.has(i)){let o=n.field(i);o===null&&i.length>1&&(i=i.popLast(),o=n.field(i)),o===null?r.delete(i):r.set(i,o),s=s.add(i)}return new Vs(t.key,r,new gn(s.toArray()),Zt.none())}}function B2(t,e,n){t instanceof yl?function(s,i,o){const a=s.value.clone(),c=U_(s.fieldTransforms,i,o.transformResults);a.setAll(c),i.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(t,e,n):t instanceof Vs?function(s,i,o){if(!Vu(s.precondition,i))return void i.convertToUnknownDocument(o.version);const a=U_(s.fieldTransforms,i,o.transformResults),c=i.data;c.setAll(WT(s)),c.setAll(a),i.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(t,e,n):function(s,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function Ia(t,e,n,r){return t instanceof yl?function(i,o,a,c){if(!Vu(i.precondition,o))return a;const d=i.value.clone(),h=F_(i.fieldTransforms,c,o);return d.setAll(h),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),null}(t,e,n,r):t instanceof Vs?function(i,o,a,c){if(!Vu(i.precondition,o))return a;const d=F_(i.fieldTransforms,c,o),h=o.data;return h.setAll(WT(i)),h.setAll(d),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),a===null?null:a.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(p=>p.field))}(t,e,n,r):function(i,o,a){return Vu(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(t,e,n)}function z2(t,e){let n=null;for(const r of t.fieldTransforms){const s=e.data.field(r.field),i=FT(r.transform,s||null);i!=null&&(n===null&&(n=on.empty()),n.set(r.field,i))}return n||null}function M_(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&ho(r,s,(i,o)=>F2(i,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class yl extends md{constructor(e,n,r,s=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class Vs extends md{constructor(e,n,r,s,i=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function WT(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function U_(t,e,n){const r=new Map;Ve(t.length===n.length,32656,{Re:n.length,Ve:t.length});for(let s=0;s<n.length;s++){const i=t[s],o=i.transform,a=e.data.field(i.field);r.set(i.field,M2(o,a,n[s]))}return r}function F_(t,e,n){const r=new Map;for(const s of t){const i=s.transform,o=n.data.field(s.field);r.set(s.field,V2(i,o,e))}return r}class gd extends md{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class q2 extends md{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W2{constructor(e,n,r,s){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&B2(i,e,r[s])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=Ia(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=Ia(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=MT();return this.mutations.forEach(s=>{const i=e.get(s.key),o=i.overlayedDocument;let a=this.applyToLocalView(o,i.mutatedFields);a=n.has(s.key)?null:a;const c=qT(o,a);c!==null&&r.set(s.key,c),o.isValidDocument()||o.convertToNoDocument(ve.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),Ne())}isEqual(e){return this.batchId===e.batchId&&ho(this.mutations,e.mutations,(n,r)=>M_(n,r))&&ho(this.baseMutations,e.baseMutations,(n,r)=>M_(n,r))}}class Um{constructor(e,n,r,s){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=s}static from(e,n,r){Ve(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let s=function(){return P2}();const i=e.mutations;for(let o=0;o<i.length;o++)s=s.insert(i[o].key,r[o].version);return new Um(e,n,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H2{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G2{constructor(e,n,r){this.alias=e,this.aggregateType=n,this.fieldPath=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K2{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ct,Pe;function Q2(t){switch(t){case U.OK:return fe(64938);case U.CANCELLED:case U.UNKNOWN:case U.DEADLINE_EXCEEDED:case U.RESOURCE_EXHAUSTED:case U.INTERNAL:case U.UNAVAILABLE:case U.UNAUTHENTICATED:return!1;case U.INVALID_ARGUMENT:case U.NOT_FOUND:case U.ALREADY_EXISTS:case U.PERMISSION_DENIED:case U.FAILED_PRECONDITION:case U.ABORTED:case U.OUT_OF_RANGE:case U.UNIMPLEMENTED:case U.DATA_LOSS:return!0;default:return fe(15467,{code:t})}}function HT(t){if(t===void 0)return Vr("GRPC error has no .code"),U.UNKNOWN;switch(t){case ct.OK:return U.OK;case ct.CANCELLED:return U.CANCELLED;case ct.UNKNOWN:return U.UNKNOWN;case ct.DEADLINE_EXCEEDED:return U.DEADLINE_EXCEEDED;case ct.RESOURCE_EXHAUSTED:return U.RESOURCE_EXHAUSTED;case ct.INTERNAL:return U.INTERNAL;case ct.UNAVAILABLE:return U.UNAVAILABLE;case ct.UNAUTHENTICATED:return U.UNAUTHENTICATED;case ct.INVALID_ARGUMENT:return U.INVALID_ARGUMENT;case ct.NOT_FOUND:return U.NOT_FOUND;case ct.ALREADY_EXISTS:return U.ALREADY_EXISTS;case ct.PERMISSION_DENIED:return U.PERMISSION_DENIED;case ct.FAILED_PRECONDITION:return U.FAILED_PRECONDITION;case ct.ABORTED:return U.ABORTED;case ct.OUT_OF_RANGE:return U.OUT_OF_RANGE;case ct.UNIMPLEMENTED:return U.UNIMPLEMENTED;case ct.DATA_LOSS:return U.DATA_LOSS;default:return fe(39323,{code:t})}}(Pe=ct||(ct={}))[Pe.OK=0]="OK",Pe[Pe.CANCELLED=1]="CANCELLED",Pe[Pe.UNKNOWN=2]="UNKNOWN",Pe[Pe.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Pe[Pe.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Pe[Pe.NOT_FOUND=5]="NOT_FOUND",Pe[Pe.ALREADY_EXISTS=6]="ALREADY_EXISTS",Pe[Pe.PERMISSION_DENIED=7]="PERMISSION_DENIED",Pe[Pe.UNAUTHENTICATED=16]="UNAUTHENTICATED",Pe[Pe.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Pe[Pe.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Pe[Pe.ABORTED=10]="ABORTED",Pe[Pe.OUT_OF_RANGE=11]="OUT_OF_RANGE",Pe[Pe.UNIMPLEMENTED=12]="UNIMPLEMENTED",Pe[Pe.INTERNAL=13]="INTERNAL",Pe[Pe.UNAVAILABLE=14]="UNAVAILABLE",Pe[Pe.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Y2(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const X2=new ws([4294967295,4294967295],0);function $_(t){const e=Y2().encode(t),n=new iT;return n.update(e),new Uint8Array(n.digest())}function B_(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new ws([n,r],0),new ws([s,i],0)]}class Fm{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new ca(`Invalid padding: ${n}`);if(r<0)throw new ca(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new ca(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new ca(`Invalid padding when bitmap length is 0: ${n}`);this.ge=8*e.length-n,this.pe=ws.fromNumber(this.ge)}ye(e,n,r){let s=e.add(n.multiply(ws.fromNumber(r)));return s.compare(X2)===1&&(s=new ws([s.getBits(0),s.getBits(1)],0)),s.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const n=$_(e),[r,s]=B_(n);for(let i=0;i<this.hashCount;i++){const o=this.ye(r,s,i);if(!this.we(o))return!1}return!0}static create(e,n,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new Fm(i,s,n);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.ge===0)return;const n=$_(e),[r,s]=B_(n);for(let i=0;i<this.hashCount;i++){const o=this.ye(r,s,i);this.Se(o)}}Se(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class ca extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yd{constructor(e,n,r,s,i){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const s=new Map;return s.set(e,vl.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new yd(ve.min(),s,new rt(be),Mr(),Ne())}}class vl{constructor(e,n,r,s,i){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new vl(r,n,Ne(),Ne(),Ne())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mu{constructor(e,n,r,s){this.be=e,this.removedTargetIds=n,this.key=r,this.De=s}}class GT{constructor(e,n){this.targetId=e,this.Ce=n}}class KT{constructor(e,n,r=bt.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=s}}class z_{constructor(){this.ve=0,this.Fe=q_(),this.Me=bt.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Ne(),n=Ne(),r=Ne();return this.Fe.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:n=n.add(s);break;case 1:r=r.add(s);break;default:fe(38017,{changeType:i})}}),new vl(this.Me,this.xe,e,n,r)}qe(){this.Oe=!1,this.Fe=q_()}Qe(e,n){this.Oe=!0,this.Fe=this.Fe.insert(e,n)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,Ve(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class J2{constructor(e){this.Ge=e,this.ze=new Map,this.je=Mr(),this.Je=fu(),this.He=fu(),this.Ye=new rt(be)}Ze(e){for(const n of e.be)e.De&&e.De.isFoundDocument()?this.Xe(n,e.De):this.et(n,e.key,e.De);for(const n of e.removedTargetIds)this.et(n,e.key,e.De)}tt(e){this.forEachTarget(e,n=>{const r=this.nt(n);switch(e.state){case 0:this.rt(n)&&r.Le(e.resumeToken);break;case 1:r.Ke(),r.Ne||r.qe(),r.Le(e.resumeToken);break;case 2:r.Ke(),r.Ne||this.removeTarget(n);break;case 3:this.rt(n)&&(r.We(),r.Le(e.resumeToken));break;case 4:this.rt(n)&&(this.it(n),r.Le(e.resumeToken));break;default:fe(56790,{state:e.state})}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.ze.forEach((r,s)=>{this.rt(s)&&n(s)})}st(e){const n=e.targetId,r=e.Ce.count,s=this.ot(n);if(s){const i=s.target;if(np(i))if(r===0){const o=new le(i.path);this.et(n,o,Ft.newNoDocument(o,ve.min()))}else Ve(r===1,20013,{expectedCount:r});else{const o=this._t(n);if(o!==r){const a=this.ut(e),c=a?this.ct(a,e,o):1;if(c!==0){this.it(n);const d=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(n,d)}}}}}ut(e){const n=e.Ce.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:i=0}=n;let o,a;try{o=Ns(r).toUint8Array()}catch(c){if(c instanceof vT)return ci("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{a=new Fm(o,s,i)}catch(c){return ci(c instanceof ca?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return a.ge===0?null:a}ct(e,n,r){return n.Ce.count===r-this.Pt(e,n.targetId)?0:2}Pt(e,n){const r=this.Ge.getRemoteKeysForTarget(n);let s=0;return r.forEach(i=>{const o=this.Ge.ht(),a=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;e.mightContain(a)||(this.et(n,i,null),s++)}),s}Tt(e){const n=new Map;this.ze.forEach((i,o)=>{const a=this.ot(o);if(a){if(i.current&&np(a.target)){const c=new le(a.target.path);this.It(c).has(o)||this.Et(o,c)||this.et(o,c,Ft.newNoDocument(c,e))}i.Be&&(n.set(o,i.ke()),i.qe())}});let r=Ne();this.He.forEach((i,o)=>{let a=!0;o.forEachWhile(c=>{const d=this.ot(c);return!d||d.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(i))}),this.je.forEach((i,o)=>o.setReadTime(e));const s=new yd(e,n,this.Ye,this.je,r);return this.je=Mr(),this.Je=fu(),this.He=fu(),this.Ye=new rt(be),s}Xe(e,n){if(!this.rt(e))return;const r=this.Et(e,n.key)?2:0;this.nt(e).Qe(n.key,r),this.je=this.je.insert(n.key,n),this.Je=this.Je.insert(n.key,this.It(n.key).add(e)),this.He=this.He.insert(n.key,this.dt(n.key).add(e))}et(e,n,r){if(!this.rt(e))return;const s=this.nt(e);this.Et(e,n)?s.Qe(n,1):s.$e(n),this.He=this.He.insert(n,this.dt(n).delete(e)),this.He=this.He.insert(n,this.dt(n).add(e)),r&&(this.je=this.je.insert(n,r))}removeTarget(e){this.ze.delete(e)}_t(e){const n=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let n=this.ze.get(e);return n||(n=new z_,this.ze.set(e,n)),n}dt(e){let n=this.He.get(e);return n||(n=new _t(be),this.He=this.He.insert(e,n)),n}It(e){let n=this.Je.get(e);return n||(n=new _t(be),this.Je=this.Je.insert(e,n)),n}rt(e){const n=this.ot(e)!==null;return n||ee("WatchChangeAggregator","Detected inactive target",e),n}ot(e){const n=this.ze.get(e);return n&&n.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new z_),this.Ge.getRemoteKeysForTarget(e).forEach(n=>{this.et(e,n,null)})}Et(e,n){return this.Ge.getRemoteKeysForTarget(e).has(n)}}function fu(){return new rt(le.comparator)}function q_(){return new rt(le.comparator)}const Z2={asc:"ASCENDING",desc:"DESCENDING"},ej={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},tj={and:"AND",or:"OR"};class nj{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function sp(t,e){return t.useProto3Json||ud(e)?e:{value:e}}function Ic(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function QT(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function rj(t,e){return Ic(t,e.toTimestamp())}function cr(t){return Ve(!!t,49232),ve.fromTimestamp(function(n){const r=bs(n);return new We(r.seconds,r.nanos)}(t))}function $m(t,e){return ip(t,e).canonicalString()}function ip(t,e){const n=function(s){return new qe(["projects",s.projectId,"databases",s.database])}(t).child("documents");return e===void 0?n:n.child(e)}function YT(t){const e=qe.fromString(t);return Ve(nS(e),10190,{key:e.toString()}),e}function op(t,e){return $m(t.databaseId,e.path)}function kh(t,e){const n=YT(e);if(n.get(1)!==t.databaseId.projectId)throw new X(U.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new X(U.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new le(JT(n))}function XT(t,e){return $m(t.databaseId,e)}function sj(t){const e=YT(t);return e.length===4?qe.emptyPath():JT(e)}function ap(t){return new qe(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function JT(t){return Ve(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function W_(t,e,n){return{name:op(t,e),fields:n.value.mapValue.fields}}function ij(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:fe(39313,{state:d})}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(d,h){return d.useProto3Json?(Ve(h===void 0||typeof h=="string",58123),bt.fromBase64String(h||"")):(Ve(h===void 0||h instanceof Buffer||h instanceof Uint8Array,16193),bt.fromUint8Array(h||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(d){const h=d.code===void 0?U.UNKNOWN:HT(d.code);return new X(h,d.message||"")}(o);n=new KT(r,s,i,a||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=kh(t,r.document.name),i=cr(r.document.updateTime),o=r.document.createTime?cr(r.document.createTime):ve.min(),a=new on({mapValue:{fields:r.document.fields}}),c=Ft.newFoundDocument(s,i,o,a),d=r.targetIds||[],h=r.removedTargetIds||[];n=new Mu(d,h,c.key,c)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=kh(t,r.document),i=r.readTime?cr(r.readTime):ve.min(),o=Ft.newNoDocument(s,i),a=r.removedTargetIds||[];n=new Mu([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=kh(t,r.document),i=r.removedTargetIds||[];n=new Mu([],i,s,null)}else{if(!("filter"in e))return fe(11601,{Rt:e});{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,o=new K2(s,i),a=r.targetId;n=new GT(a,o)}}return n}function oj(t,e){let n;if(e instanceof yl)n={update:W_(t,e.key,e.value)};else if(e instanceof gd)n={delete:op(t,e.key)};else if(e instanceof Vs)n={update:W_(t,e.key,e.data),updateMask:mj(e.fieldMask)};else{if(!(e instanceof q2))return fe(16599,{Vt:e.type});n={verify:op(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(i,o){const a=o.transform;if(a instanceof el)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof tl)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof nl)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof Sc)return{fieldPath:o.field.canonicalString(),increment:a.Ae};throw fe(20930,{transform:o.transform})}(0,r))),e.precondition.isNone||(n.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:rj(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:fe(27497)}(t,e.precondition)),n}function aj(t,e){return t&&t.length>0?(Ve(e!==void 0,14353),t.map(n=>function(s,i){let o=s.updateTime?cr(s.updateTime):cr(i);return o.isEqual(ve.min())&&(o=cr(i)),new $2(o,s.transformResults||[])}(n,e))):[]}function lj(t,e){return{documents:[XT(t,e.path)]}}function ZT(t,e){const n={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=XT(t,s);const i=function(d){if(d.length!==0)return tS(Yn.create(d,"and"))}(e.filters);i&&(n.structuredQuery.where=i);const o=function(d){if(d.length!==0)return d.map(h=>function(m){return{field:ss(m.field),direction:hj(m.dir)}}(h))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const a=sp(t,e.limit);return a!==null&&(n.structuredQuery.limit=a),e.startAt&&(n.structuredQuery.startAt=function(d){return{before:d.inclusive,values:d.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(d){return{before:!d.inclusive,values:d.position}}(e.endAt)),{ft:n,parent:s}}function uj(t,e,n,r){const{ft:s,parent:i}=ZT(t,e),o={},a=[];let c=0;return n.forEach(d=>{const h="aggregate_"+c++;o[h]=d.alias,d.aggregateType==="count"?a.push({alias:h,count:{}}):d.aggregateType==="avg"?a.push({alias:h,avg:{field:ss(d.fieldPath)}}):d.aggregateType==="sum"&&a.push({alias:h,sum:{field:ss(d.fieldPath)}})}),{request:{structuredAggregationQuery:{aggregations:a,structuredQuery:s.structuredQuery},parent:s.parent},gt:o,parent:i}}function cj(t){let e=sj(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let s=null;if(r>0){Ve(r===1,65062);const h=n.from[0];h.allDescendants?s=h.collectionId:e=e.child(h.collectionId)}let i=[];n.where&&(i=function(p){const m=eS(p);return m instanceof Yn&&AT(m)?m.getFilters():[m]}(n.where));let o=[];n.orderBy&&(o=function(p){return p.map(m=>function(T){return new Za(ki(T.field),function(I){switch(I){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(T.direction))}(m))}(n.orderBy));let a=null;n.limit&&(a=function(p){let m;return m=typeof p=="object"?p.value:p,ud(m)?null:m}(n.limit));let c=null;n.startAt&&(c=function(p){const m=!!p.before,y=p.values||[];return new Ec(y,m)}(n.startAt));let d=null;return n.endAt&&(d=function(p){const m=!p.before,y=p.values||[];return new Ec(y,m)}(n.endAt)),N2(e,s,o,i,a,"F",c,d)}function dj(t,e){const n=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return fe(28987,{purpose:s})}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function eS(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=ki(n.unaryFilter.field);return ft.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=ki(n.unaryFilter.field);return ft.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=ki(n.unaryFilter.field);return ft.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=ki(n.unaryFilter.field);return ft.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return fe(61313);default:return fe(60726)}}(t):t.fieldFilter!==void 0?function(n){return ft.create(ki(n.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return fe(58110);default:return fe(50506)}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return Yn.create(n.compositeFilter.filters.map(r=>eS(r)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return fe(1026)}}(n.compositeFilter.op))}(t):fe(30097,{filter:t})}function hj(t){return Z2[t]}function fj(t){return ej[t]}function pj(t){return tj[t]}function ss(t){return{fieldPath:t.canonicalString()}}function ki(t){return Et.fromServerFormat(t.fieldPath)}function tS(t){return t instanceof ft?function(n){if(n.op==="=="){if(P_(n.value))return{unaryFilter:{field:ss(n.field),op:"IS_NAN"}};if(k_(n.value))return{unaryFilter:{field:ss(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(P_(n.value))return{unaryFilter:{field:ss(n.field),op:"IS_NOT_NAN"}};if(k_(n.value))return{unaryFilter:{field:ss(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ss(n.field),op:fj(n.op),value:n.value}}}(t):t instanceof Yn?function(n){const r=n.getFilters().map(s=>tS(s));return r.length===1?r[0]:{compositeFilter:{op:pj(n.op),filters:r}}}(t):fe(54877,{filter:t})}function mj(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function nS(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class us{constructor(e,n,r,s,i=ve.min(),o=ve.min(),a=bt.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=c}withSequenceNumber(e){return new us(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new us(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new us(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new us(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gj{constructor(e){this.yt=e}}function yj(t){const e=cj({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Tc(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vj{constructor(){this.Cn=new _j}addToCollectionParentIndex(e,n){return this.Cn.add(n),B.resolve()}getCollectionParents(e,n){return B.resolve(this.Cn.getEntries(n))}addFieldIndex(e,n){return B.resolve()}deleteFieldIndex(e,n){return B.resolve()}deleteAllFieldIndexes(e){return B.resolve()}createTargetIndexes(e,n){return B.resolve()}getDocumentsMatchingTarget(e,n){return B.resolve(null)}getIndexType(e,n){return B.resolve(0)}getFieldIndexes(e,n){return B.resolve([])}getNextCollectionGroupToUpdate(e){return B.resolve(null)}getMinOffset(e,n){return B.resolve(Is.min())}getMinOffsetFromCollectionGroup(e,n){return B.resolve(Is.min())}updateCollectionGroup(e,n,r){return B.resolve()}updateIndexEntries(e,n){return B.resolve()}}class _j{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n]||new _t(qe.comparator),i=!s.has(r);return this.index[n]=s.add(r),i}has(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n];return s&&s.has(r)}getEntries(e){return(this.index[e]||new _t(qe.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const H_={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},rS=41943040;class rn{static withCacheSize(e){return new rn(e,rn.DEFAULT_COLLECTION_PERCENTILE,rn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */rn.DEFAULT_COLLECTION_PERCENTILE=10,rn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,rn.DEFAULT=new rn(rS,rn.DEFAULT_COLLECTION_PERCENTILE,rn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),rn.DISABLED=new rn(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class go{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new go(0)}static cr(){return new go(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const G_="LruGarbageCollector",wj=1048576;function K_([t,e],[n,r]){const s=be(t,n);return s===0?be(e,r):s}class xj{constructor(e){this.Ir=e,this.buffer=new _t(K_),this.Er=0}dr(){return++this.Er}Ar(e){const n=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();K_(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class Ej{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){ee(G_,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){Co(n)?ee(G_,"Ignoring IndexedDB error during garbage collection: ",n):await Ao(n)}await this.Vr(3e5)})}}class Tj{constructor(e,n){this.mr=e,this.params=n}calculateTargetCount(e,n){return this.mr.gr(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return B.resolve(ld.ce);const r=new xj(n);return this.mr.forEachTarget(e,s=>r.Ar(s.sequenceNumber)).next(()=>this.mr.pr(e,s=>r.Ar(s))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.mr.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.mr.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(ee("LruGarbageCollector","Garbage collection skipped; disabled"),B.resolve(H_)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(ee("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),H_):this.yr(e,n))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,n){let r,s,i,o,a,c,d;const h=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(p=>(p>this.params.maximumSequenceNumbersToCollect?(ee("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${p}`),s=this.params.maximumSequenceNumbersToCollect):s=p,o=Date.now(),this.nthSequenceNumber(e,s))).next(p=>(r=p,a=Date.now(),this.removeTargets(e,r,n))).next(p=>(i=p,c=Date.now(),this.removeOrphanedDocuments(e,r))).next(p=>(d=Date.now(),Ci()<=Ie.DEBUG&&ee("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-h}ms
	Determined least recently used ${s} in `+(a-o)+`ms
	Removed ${i} targets in `+(c-a)+`ms
	Removed ${p} documents in `+(d-c)+`ms
Total Duration: ${d-h}ms`),B.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:i,documentsRemoved:p})))}}function Sj(t,e){return new Tj(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ij{constructor(){this.changes=new wi(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,Ft.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?B.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bj{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nj{constructor(e,n,r,s){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,n))).next(s=>(r!==null&&Ia(r.mutation,s,gn.empty(),We.now()),s))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,Ne()).next(()=>r))}getLocalViewOfDocuments(e,n,r=Ne()){const s=Ys();return this.populateOverlays(e,s,n).next(()=>this.computeViews(e,n,s,r).next(i=>{let o=ua();return i.forEach((a,c)=>{o=o.insert(a,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=Ys();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,Ne()))}populateOverlays(e,n,r){const s=[];return r.forEach(i=>{n.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((o,a)=>{n.set(o,a)})})}computeViews(e,n,r,s){let i=Mr();const o=Sa(),a=function(){return Sa()}();return n.forEach((c,d)=>{const h=r.get(d.key);s.has(d.key)&&(h===void 0||h.mutation instanceof Vs)?i=i.insert(d.key,d):h!==void 0?(o.set(d.key,h.mutation.getFieldMask()),Ia(h.mutation,d,h.mutation.getFieldMask(),We.now())):o.set(d.key,gn.empty())}),this.recalculateAndSaveOverlays(e,i).next(c=>(c.forEach((d,h)=>o.set(d,h)),n.forEach((d,h)=>a.set(d,new bj(h,o.get(d)??null))),a))}recalculateAndSaveOverlays(e,n){const r=Sa();let s=new rt((o,a)=>o-a),i=Ne();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const a of o)a.keys().forEach(c=>{const d=n.get(c);if(d===null)return;let h=r.get(c)||gn.empty();h=a.applyToLocalView(d,h),r.set(c,h);const p=(s.get(a.batchId)||Ne()).add(c);s=s.insert(a.batchId,p)})}).next(()=>{const o=[],a=s.getReverseIterator();for(;a.hasNext();){const c=a.getNext(),d=c.key,h=c.value,p=MT();h.forEach(m=>{if(!i.has(m)){const y=qT(n.get(m),r.get(m));y!==null&&p.set(m,y),i=i.add(m)}}),o.push(this.documentOverlayCache.saveOverlays(e,d,p))}return B.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,s){return function(o){return le.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):PT(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,s):this.getDocumentsMatchingCollectionQuery(e,n,r,s)}getNextDocuments(e,n,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,s).next(i=>{const o=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,s-i.size):B.resolve(Ys());let a=Ya,c=i;return o.next(d=>B.forEach(d,(h,p)=>(a<p.largestBatchId&&(a=p.largestBatchId),i.get(h)?B.resolve():this.remoteDocumentCache.getEntry(e,h).next(m=>{c=c.insert(h,m)}))).next(()=>this.populateOverlays(e,d,i)).next(()=>this.computeViews(e,c,d,Ne())).next(h=>({batchId:a,changes:VT(h)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new le(n)).next(r=>{let s=ua();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,n,r,s){const i=n.collectionGroup;let o=ua();return this.indexManager.getCollectionParents(e,i).next(a=>B.forEach(a,c=>{const d=function(p,m){return new _i(m,null,p.explicitOrderBy.slice(),p.filters.slice(),p.limit,p.limitType,p.startAt,p.endAt)}(n,c.child(i));return this.getDocumentsMatchingCollectionQuery(e,d,r,s).next(h=>{h.forEach((p,m)=>{o=o.insert(p,m)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,i,s))).next(o=>{i.forEach((c,d)=>{const h=d.getKey();o.get(h)===null&&(o=o.insert(h,Ft.newInvalidDocument(h)))});let a=ua();return o.forEach((c,d)=>{const h=i.get(c);h!==void 0&&Ia(h.mutation,d,gn.empty(),We.now()),fd(n,d)&&(a=a.insert(c,d))}),a})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Aj{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,n){return B.resolve(this.Lr.get(n))}saveBundleMetadata(e,n){return this.Lr.set(n.id,function(s){return{id:s.id,version:s.version,createTime:cr(s.createTime)}}(n)),B.resolve()}getNamedQuery(e,n){return B.resolve(this.kr.get(n))}saveNamedQuery(e,n){return this.kr.set(n.name,function(s){return{name:s.name,query:yj(s.bundledQuery),readTime:cr(s.readTime)}}(n)),B.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cj{constructor(){this.overlays=new rt(le.comparator),this.qr=new Map}getOverlay(e,n){return B.resolve(this.overlays.get(n))}getOverlays(e,n){const r=Ys();return B.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((s,i)=>{this.St(e,n,i)}),B.resolve()}removeOverlaysForBatchId(e,n,r){const s=this.qr.get(r);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.qr.delete(r)),B.resolve()}getOverlaysForCollection(e,n,r){const s=Ys(),i=n.length+1,o=new le(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const c=a.getNext().value,d=c.getKey();if(!n.isPrefixOf(d.path))break;d.path.length===i&&c.largestBatchId>r&&s.set(c.getKey(),c)}return B.resolve(s)}getOverlaysForCollectionGroup(e,n,r,s){let i=new rt((d,h)=>d-h);const o=this.overlays.getIterator();for(;o.hasNext();){const d=o.getNext().value;if(d.getKey().getCollectionGroup()===n&&d.largestBatchId>r){let h=i.get(d.largestBatchId);h===null&&(h=Ys(),i=i.insert(d.largestBatchId,h)),h.set(d.getKey(),d)}}const a=Ys(),c=i.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((d,h)=>a.set(d,h)),!(a.size()>=s)););return B.resolve(a)}St(e,n,r){const s=this.overlays.get(r.key);if(s!==null){const o=this.qr.get(s.largestBatchId).delete(r.key);this.qr.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new H2(n,r));let i=this.qr.get(n);i===void 0&&(i=Ne(),this.qr.set(n,i)),this.qr.set(n,i.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rj{constructor(){this.sessionToken=bt.EMPTY_BYTE_STRING}getSessionToken(e){return B.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,B.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bm{constructor(){this.Qr=new _t(wt.$r),this.Ur=new _t(wt.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,n){const r=new wt(e,n);this.Qr=this.Qr.add(r),this.Ur=this.Ur.add(r)}Wr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Gr(new wt(e,n))}zr(e,n){e.forEach(r=>this.removeReference(r,n))}jr(e){const n=new le(new qe([])),r=new wt(n,e),s=new wt(n,e+1),i=[];return this.Ur.forEachInRange([r,s],o=>{this.Gr(o),i.push(o.key)}),i}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const n=new le(new qe([])),r=new wt(n,e),s=new wt(n,e+1);let i=Ne();return this.Ur.forEachInRange([r,s],o=>{i=i.add(o.key)}),i}containsKey(e){const n=new wt(e,0),r=this.Qr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class wt{constructor(e,n){this.key=e,this.Yr=n}static $r(e,n){return le.comparator(e.key,n.key)||be(e.Yr,n.Yr)}static Kr(e,n){return be(e.Yr,n.Yr)||le.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kj{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.tr=1,this.Zr=new _t(wt.$r)}checkEmpty(e){return B.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,s){const i=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new W2(i,n,r,s);this.mutationQueue.push(o);for(const a of s)this.Zr=this.Zr.add(new wt(a.key,i)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return B.resolve(o)}lookupMutationBatch(e,n){return B.resolve(this.Xr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=this.ei(r),i=s<0?0:s;return B.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return B.resolve(this.mutationQueue.length===0?jm:this.tr-1)}getAllMutationBatches(e){return B.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new wt(n,0),s=new wt(n,Number.POSITIVE_INFINITY),i=[];return this.Zr.forEachInRange([r,s],o=>{const a=this.Xr(o.Yr);i.push(a)}),B.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new _t(be);return n.forEach(s=>{const i=new wt(s,0),o=new wt(s,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([i,o],a=>{r=r.add(a.Yr)})}),B.resolve(this.ti(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1;let i=r;le.isDocumentKey(i)||(i=i.child(""));const o=new wt(new le(i),0);let a=new _t(be);return this.Zr.forEachWhile(c=>{const d=c.key.path;return!!r.isPrefixOf(d)&&(d.length===s&&(a=a.add(c.Yr)),!0)},o),B.resolve(this.ti(a))}ti(e){const n=[];return e.forEach(r=>{const s=this.Xr(r);s!==null&&n.push(s)}),n}removeMutationBatch(e,n){Ve(this.ni(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Zr;return B.forEach(n.mutations,s=>{const i=new wt(s.key,n.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.Zr=r})}ir(e){}containsKey(e,n){const r=new wt(n,0),s=this.Zr.firstAfterOrEqual(r);return B.resolve(n.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,B.resolve()}ni(e,n){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const n=this.ei(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pj{constructor(e){this.ri=e,this.docs=function(){return new rt(le.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,s=this.docs.get(r),i=s?s.size:0,o=this.ri(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return B.resolve(r?r.document.mutableCopy():Ft.newInvalidDocument(n))}getEntries(e,n){let r=Mr();return n.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():Ft.newInvalidDocument(s))}),B.resolve(r)}getDocumentsMatchingQuery(e,n,r,s){let i=Mr();const o=n.path,a=new le(o.child("__id-9223372036854775808__")),c=this.docs.getIteratorFrom(a);for(;c.hasNext();){const{key:d,value:{document:h}}=c.getNext();if(!o.isPrefixOf(d.path))break;d.path.length>o.length+1||s2(r2(h),r)<=0||(s.has(h.key)||fd(n,h))&&(i=i.insert(h.key,h.mutableCopy()))}return B.resolve(i)}getAllFromCollectionGroup(e,n,r,s){fe(9500)}ii(e,n){return B.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new jj(this)}getSize(e){return B.resolve(this.size)}}class jj extends Ij{constructor(e){super(),this.Nr=e}applyChanges(e){const n=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?n.push(this.Nr.addEntry(e,s)):this.Nr.removeEntry(r)}),B.waitFor(n)}getFromCache(e,n){return this.Nr.getEntry(e,n)}getAllFromCache(e,n){return this.Nr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dj{constructor(e){this.persistence=e,this.si=new wi(n=>Lm(n),Vm),this.lastRemoteSnapshotVersion=ve.min(),this.highestTargetId=0,this.oi=0,this._i=new Bm,this.targetCount=0,this.ai=go.ur()}forEachTarget(e,n){return this.si.forEach((r,s)=>n(s)),B.resolve()}getLastRemoteSnapshotVersion(e){return B.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return B.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),B.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.oi&&(this.oi=n),B.resolve()}Pr(e){this.si.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.ai=new go(n),this.highestTargetId=n),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,n){return this.Pr(n),this.targetCount+=1,B.resolve()}updateTargetData(e,n){return this.Pr(n),B.resolve()}removeTargetData(e,n){return this.si.delete(n.target),this._i.jr(n.targetId),this.targetCount-=1,B.resolve()}removeTargets(e,n,r){let s=0;const i=[];return this.si.forEach((o,a)=>{a.sequenceNumber<=n&&r.get(a.targetId)===null&&(this.si.delete(o),i.push(this.removeMatchingKeysForTargetId(e,a.targetId)),s++)}),B.waitFor(i).next(()=>s)}getTargetCount(e){return B.resolve(this.targetCount)}getTargetData(e,n){const r=this.si.get(n)||null;return B.resolve(r)}addMatchingKeys(e,n,r){return this._i.Wr(n,r),B.resolve()}removeMatchingKeys(e,n,r){this._i.zr(n,r);const s=this.persistence.referenceDelegate,i=[];return s&&n.forEach(o=>{i.push(s.markPotentiallyOrphaned(e,o))}),B.waitFor(i)}removeMatchingKeysForTargetId(e,n){return this._i.jr(n),B.resolve()}getMatchingKeysForTargetId(e,n){const r=this._i.Hr(n);return B.resolve(r)}containsKey(e,n){return B.resolve(this._i.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sS{constructor(e,n){this.ui={},this.overlays={},this.ci=new ld(0),this.li=!1,this.li=!0,this.hi=new Rj,this.referenceDelegate=e(this),this.Pi=new Dj(this),this.indexManager=new vj,this.remoteDocumentCache=function(s){return new Pj(s)}(r=>this.referenceDelegate.Ti(r)),this.serializer=new gj(n),this.Ii=new Aj(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new Cj,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.ui[e.toKey()];return r||(r=new kj(n,this.referenceDelegate),this.ui[e.toKey()]=r),r}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,n,r){ee("MemoryPersistence","Starting transaction:",e);const s=new Oj(this.ci.next());return this.referenceDelegate.Ei(),r(s).next(i=>this.referenceDelegate.di(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Ai(e,n){return B.or(Object.values(this.ui).map(r=>()=>r.containsKey(e,n)))}}class Oj extends o2{constructor(e){super(),this.currentSequenceNumber=e}}class zm{constructor(e){this.persistence=e,this.Ri=new Bm,this.Vi=null}static mi(e){return new zm(e)}get fi(){if(this.Vi)return this.Vi;throw fe(60996)}addReference(e,n,r){return this.Ri.addReference(r,n),this.fi.delete(r.toString()),B.resolve()}removeReference(e,n,r){return this.Ri.removeReference(r,n),this.fi.add(r.toString()),B.resolve()}markPotentiallyOrphaned(e,n){return this.fi.add(n.toString()),B.resolve()}removeTarget(e,n){this.Ri.jr(n.targetId).forEach(s=>this.fi.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(s=>{s.forEach(i=>this.fi.add(i.toString()))}).next(()=>r.removeTargetData(e,n))}Ei(){this.Vi=new Set}di(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return B.forEach(this.fi,r=>{const s=le.fromPath(r);return this.gi(e,s).next(i=>{i||n.removeEntry(s,ve.min())})}).next(()=>(this.Vi=null,n.apply(e)))}updateLimboDocument(e,n){return this.gi(e,n).next(r=>{r?this.fi.delete(n.toString()):this.fi.add(n.toString())})}Ti(e){return 0}gi(e,n){return B.or([()=>B.resolve(this.Ri.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ai(e,n)])}}class bc{constructor(e,n){this.persistence=e,this.pi=new wi(r=>u2(r.path),(r,s)=>r.isEqual(s)),this.garbageCollector=Sj(this,n)}static mi(e,n){return new bc(e,n)}Ei(){}di(e){return B.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}gr(e){const n=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>n.next(s=>r+s))}wr(e){let n=0;return this.pr(e,r=>{n++}).next(()=>n)}pr(e,n){return B.forEach(this.pi,(r,s)=>this.br(e,r,s).next(i=>i?B.resolve():n(s)))}removeTargets(e,n,r){return this.persistence.getTargetCache().removeTargets(e,n,r)}removeOrphanedDocuments(e,n){let r=0;const s=this.persistence.getRemoteDocumentCache(),i=s.newChangeBuffer();return s.ii(e,o=>this.br(e,o,n).next(a=>{a||(r++,i.removeEntry(o,ve.min()))})).next(()=>i.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,n){return this.pi.set(n,e.currentSequenceNumber),B.resolve()}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,n,r){return this.pi.set(r,e.currentSequenceNumber),B.resolve()}removeReference(e,n,r){return this.pi.set(r,e.currentSequenceNumber),B.resolve()}updateLimboDocument(e,n){return this.pi.set(n,e.currentSequenceNumber),B.resolve()}Ti(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=Ou(e.data.value)),n}br(e,n,r){return B.or([()=>this.persistence.Ai(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const s=this.pi.get(n);return B.resolve(s!==void 0&&s>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qm{constructor(e,n,r,s){this.targetId=e,this.fromCache=n,this.Es=r,this.ds=s}static As(e,n){let r=Ne(),s=Ne();for(const i of n.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new qm(e,n.fromCache,r,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lj{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vj{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=function(){return h1()?8:a2(qt())>0?6:4}()}initialize(e,n){this.ps=e,this.indexManager=n,this.Rs=!0}getDocumentsMatchingQuery(e,n,r,s){const i={result:null};return this.ys(e,n).next(o=>{i.result=o}).next(()=>{if(!i.result)return this.ws(e,n,s,r).next(o=>{i.result=o})}).next(()=>{if(i.result)return;const o=new Lj;return this.Ss(e,n,o).next(a=>{if(i.result=a,this.Vs)return this.bs(e,n,o,a.size)})}).next(()=>i.result)}bs(e,n,r,s){return r.documentReadCount<this.fs?(Ci()<=Ie.DEBUG&&ee("QueryEngine","SDK will not create cache indexes for query:",Ri(n),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),B.resolve()):(Ci()<=Ie.DEBUG&&ee("QueryEngine","Query:",Ri(n),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.gs*s?(Ci()<=Ie.DEBUG&&ee("QueryEngine","The SDK decides to create cache indexes for query:",Ri(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,ur(n))):B.resolve())}ys(e,n){if(L_(n))return B.resolve(null);let r=ur(n);return this.indexManager.getIndexType(e,r).next(s=>s===0?null:(n.limit!==null&&s===1&&(n=Tc(n,null,"F"),r=ur(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(i=>{const o=Ne(...i);return this.ps.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(c=>{const d=this.Ds(n,a);return this.Cs(n,d,o,c.readTime)?this.ys(e,Tc(n,null,"F")):this.vs(e,d,n,c)}))})))}ws(e,n,r,s){return L_(n)||s.isEqual(ve.min())?B.resolve(null):this.ps.getDocuments(e,r).next(i=>{const o=this.Ds(n,i);return this.Cs(n,o,r,s)?B.resolve(null):(Ci()<=Ie.DEBUG&&ee("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),Ri(n)),this.vs(e,o,n,n2(s,Ya)).next(a=>a))})}Ds(e,n){let r=new _t(OT(e));return n.forEach((s,i)=>{fd(e,i)&&(r=r.add(i))}),r}Cs(e,n,r,s){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const i=e.limitType==="F"?n.last():n.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Ss(e,n,r){return Ci()<=Ie.DEBUG&&ee("QueryEngine","Using full collection scan to execute query:",Ri(n)),this.ps.getDocumentsMatchingQuery(e,n,Is.min(),r)}vs(e,n,r,s){return this.ps.getDocumentsMatchingQuery(e,r,s).next(i=>(n.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wm="LocalStore",Mj=3e8;class Uj{constructor(e,n,r,s){this.persistence=e,this.Fs=n,this.serializer=s,this.Ms=new rt(be),this.xs=new wi(i=>Lm(i),Vm),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(r)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Nj(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.Ms))}}function Fj(t,e,n,r){return new Uj(t,e,n,r)}async function iS(t,e){const n=ye(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let s;return n.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,n.Bs(e),n.mutationQueue.getAllMutationBatches(r))).next(i=>{const o=[],a=[];let c=Ne();for(const d of s){o.push(d.batchId);for(const h of d.mutations)c=c.add(h.key)}for(const d of i){a.push(d.batchId);for(const h of d.mutations)c=c.add(h.key)}return n.localDocuments.getDocuments(r,c).next(d=>({Ls:d,removedBatchIds:o,addedBatchIds:a}))})})}function $j(t,e){const n=ye(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),i=n.Ns.newChangeBuffer({trackRemovals:!0});return function(a,c,d,h){const p=d.batch,m=p.keys();let y=B.resolve();return m.forEach(T=>{y=y.next(()=>h.getEntry(c,T)).next(b=>{const I=d.docVersions.get(T);Ve(I!==null,48541),b.version.compareTo(I)<0&&(p.applyToRemoteDocument(b,d),b.isValidDocument()&&(b.setReadTime(d.commitVersion),h.addEntry(b)))})}),y.next(()=>a.mutationQueue.removeMutationBatch(c,p))}(n,r,e,i).next(()=>i.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let c=Ne();for(let d=0;d<a.mutationResults.length;++d)a.mutationResults[d].transformResults.length>0&&(c=c.add(a.batch.mutations[d].key));return c}(e))).next(()=>n.localDocuments.getDocuments(r,s))})}function oS(t){const e=ye(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Pi.getLastRemoteSnapshotVersion(n))}function Bj(t,e){const n=ye(t),r=e.snapshotVersion;let s=n.Ms;return n.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=n.Ns.newChangeBuffer({trackRemovals:!0});s=n.Ms;const a=[];e.targetChanges.forEach((h,p)=>{const m=s.get(p);if(!m)return;a.push(n.Pi.removeMatchingKeys(i,h.removedDocuments,p).next(()=>n.Pi.addMatchingKeys(i,h.addedDocuments,p)));let y=m.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(p)!==null?y=y.withResumeToken(bt.EMPTY_BYTE_STRING,ve.min()).withLastLimboFreeSnapshotVersion(ve.min()):h.resumeToken.approximateByteSize()>0&&(y=y.withResumeToken(h.resumeToken,r)),s=s.insert(p,y),function(b,I,v){return b.resumeToken.approximateByteSize()===0||I.snapshotVersion.toMicroseconds()-b.snapshotVersion.toMicroseconds()>=Mj?!0:v.addedDocuments.size+v.modifiedDocuments.size+v.removedDocuments.size>0}(m,y,h)&&a.push(n.Pi.updateTargetData(i,y))});let c=Mr(),d=Ne();if(e.documentUpdates.forEach(h=>{e.resolvedLimboDocuments.has(h)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(i,h))}),a.push(zj(i,o,e.documentUpdates).next(h=>{c=h.ks,d=h.qs})),!r.isEqual(ve.min())){const h=n.Pi.getLastRemoteSnapshotVersion(i).next(p=>n.Pi.setTargetsMetadata(i,i.currentSequenceNumber,r));a.push(h)}return B.waitFor(a).next(()=>o.apply(i)).next(()=>n.localDocuments.getLocalViewOfDocuments(i,c,d)).next(()=>c)}).then(i=>(n.Ms=s,i))}function zj(t,e,n){let r=Ne(),s=Ne();return n.forEach(i=>r=r.add(i)),e.getEntries(t,r).next(i=>{let o=Mr();return n.forEach((a,c)=>{const d=i.get(a);c.isFoundDocument()!==d.isFoundDocument()&&(s=s.add(a)),c.isNoDocument()&&c.version.isEqual(ve.min())?(e.removeEntry(a,c.readTime),o=o.insert(a,c)):!d.isValidDocument()||c.version.compareTo(d.version)>0||c.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(c),o=o.insert(a,c)):ee(Wm,"Ignoring outdated watch update for ",a,". Current version:",d.version," Watch version:",c.version)}),{ks:o,qs:s}})}function qj(t,e){const n=ye(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=jm),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function Wj(t,e){const n=ye(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return n.Pi.getTargetData(r,e).next(i=>i?(s=i,B.resolve(s)):n.Pi.allocateTargetId(r).next(o=>(s=new us(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.Pi.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=n.Ms.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(n.Ms=n.Ms.insert(r.targetId,r),n.xs.set(e,r.targetId)),r})}async function lp(t,e,n){const r=ye(t),s=r.Ms.get(e),i=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",i,o=>r.persistence.referenceDelegate.removeTarget(o,s))}catch(o){if(!Co(o))throw o;ee(Wm,`Failed to update sequence numbers for target ${e}: ${o}`)}r.Ms=r.Ms.remove(e),r.xs.delete(s.target)}function Q_(t,e,n){const r=ye(t);let s=ve.min(),i=Ne();return r.persistence.runTransaction("Execute query","readwrite",o=>function(c,d,h){const p=ye(c),m=p.xs.get(h);return m!==void 0?B.resolve(p.Ms.get(m)):p.Pi.getTargetData(d,h)}(r,o,ur(e)).next(a=>{if(a)return s=a.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(o,a.targetId).next(c=>{i=c})}).next(()=>r.Fs.getDocumentsMatchingQuery(o,e,n?s:ve.min(),n?i:Ne())).next(a=>(Hj(r,C2(e),a),{documents:a,Qs:i})))}function Hj(t,e,n){let r=t.Os.get(e)||ve.min();n.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),t.Os.set(e,r)}class Y_{constructor(){this.activeTargetIds=O2()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Gj{constructor(){this.Mo=new Y_,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,n,r){this.xo[e]=n}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new Y_,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kj{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const X_="ConnectivityMonitor";class J_{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){ee(X_,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){ee(X_,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let pu=null;function up(){return pu===null?pu=function(){return 268435456+Math.round(2147483648*Math.random())}():pu++,"0x"+pu.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ph="RestConnection",Qj={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class Yj{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Uo=n+"://"+e.host,this.Ko=`projects/${r}/databases/${s}`,this.Wo=this.databaseId.database===wc?`project_id=${r}`:`project_id=${r}&database_id=${s}`}Go(e,n,r,s,i){const o=up(),a=this.zo(e,n.toUriEncodedString());ee(Ph,`Sending RPC '${e}' ${o}:`,a,r);const c={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(c,s,i);const{host:d}=new URL(a),h=zr(d);return this.Jo(e,a,c,r,h).then(p=>(ee(Ph,`Received RPC '${e}' ${o}: `,p),p),p=>{throw ci(Ph,`RPC '${e}' ${o} failed with error: `,p,"url: ",a,"request:",r),p})}Ho(e,n,r,s,i,o){return this.Go(e,n,r,s,i)}jo(e,n,r){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+No}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((s,i)=>e[i]=s),r&&r.headers.forEach((s,i)=>e[i]=s)}zo(e,n){const r=Qj[e];return`${this.Uo}/v1/${n}:${r}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xj{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vt="WebChannelConnection";class Jj extends Yj{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,n,r,s,i){const o=up();return new Promise((a,c)=>{const d=new oT;d.setWithCredentials(!0),d.listenOnce(aT.COMPLETE,()=>{try{switch(d.getLastErrorCode()){case Du.NO_ERROR:const p=d.getResponseJson();ee(Vt,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(p)),a(p);break;case Du.TIMEOUT:ee(Vt,`RPC '${e}' ${o} timed out`),c(new X(U.DEADLINE_EXCEEDED,"Request time out"));break;case Du.HTTP_ERROR:const m=d.getStatus();if(ee(Vt,`RPC '${e}' ${o} failed with status:`,m,"response text:",d.getResponseText()),m>0){let y=d.getResponseJson();Array.isArray(y)&&(y=y[0]);const T=y==null?void 0:y.error;if(T&&T.status&&T.message){const b=function(v){const w=v.toLowerCase().replace(/_/g,"-");return Object.values(U).indexOf(w)>=0?w:U.UNKNOWN}(T.status);c(new X(b,T.message))}else c(new X(U.UNKNOWN,"Server responded with status "+d.getStatus()))}else c(new X(U.UNAVAILABLE,"Connection failed."));break;default:fe(9055,{l_:e,streamId:o,h_:d.getLastErrorCode(),P_:d.getLastError()})}}finally{ee(Vt,`RPC '${e}' ${o} completed.`)}});const h=JSON.stringify(s);ee(Vt,`RPC '${e}' ${o} sending request:`,s),d.send(n,"POST",h,r,15)})}T_(e,n,r){const s=up(),i=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=cT(),a=uT(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(c.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(c.useFetchStreams=!0),this.jo(c.initMessageHeaders,n,r),c.encodeInitMessageHeaders=!0;const h=i.join("");ee(Vt,`Creating RPC '${e}' stream ${s}: ${h}`,c);const p=o.createWebChannel(h,c);this.I_(p);let m=!1,y=!1;const T=new Xj({Yo:I=>{y?ee(Vt,`Not sending because RPC '${e}' stream ${s} is closed:`,I):(m||(ee(Vt,`Opening RPC '${e}' stream ${s} transport.`),p.open(),m=!0),ee(Vt,`RPC '${e}' stream ${s} sending:`,I),p.send(I))},Zo:()=>p.close()}),b=(I,v,w)=>{I.listen(v,_=>{try{w(_)}catch(E){setTimeout(()=>{throw E},0)}})};return b(p,la.EventType.OPEN,()=>{y||(ee(Vt,`RPC '${e}' stream ${s} transport opened.`),T.o_())}),b(p,la.EventType.CLOSE,()=>{y||(y=!0,ee(Vt,`RPC '${e}' stream ${s} transport closed`),T.a_(),this.E_(p))}),b(p,la.EventType.ERROR,I=>{y||(y=!0,ci(Vt,`RPC '${e}' stream ${s} transport errored. Name:`,I.name,"Message:",I.message),T.a_(new X(U.UNAVAILABLE,"The operation could not be completed")))}),b(p,la.EventType.MESSAGE,I=>{var v;if(!y){const w=I.data[0];Ve(!!w,16349);const _=w,E=(_==null?void 0:_.error)||((v=_[0])==null?void 0:v.error);if(E){ee(Vt,`RPC '${e}' stream ${s} received error:`,E);const j=E.status;let O=function(N){const k=ct[N];if(k!==void 0)return HT(k)}(j),S=E.message;O===void 0&&(O=U.INTERNAL,S="Unknown error status: "+j+" with message "+E.message),y=!0,T.a_(new X(O,S)),p.close()}else ee(Vt,`RPC '${e}' stream ${s} received:`,w),T.u_(w)}}),b(a,lT.STAT_EVENT,I=>{I.stat===Xf.PROXY?ee(Vt,`RPC '${e}' stream ${s} detected buffering proxy`):I.stat===Xf.NOPROXY&&ee(Vt,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{T.__()},0),T}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(n=>n===e)}}function jh(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vd(t){return new nj(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aS{constructor(e,n,r=1e3,s=1.5,i=6e4){this.Mi=e,this.timerId=n,this.d_=r,this.A_=s,this.R_=i,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const n=Math.floor(this.V_+this.y_()),r=Math.max(0,Date.now()-this.f_),s=Math.max(0,n-r);s>0&&ee("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.V_} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,s,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Z_="PersistentStream";class lS{constructor(e,n,r,s,i,o,a,c){this.Mi=e,this.S_=r,this.b_=s,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=c,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new aS(e,n)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,n){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():n&&n.code===U.RESOURCE_EXHAUSTED?(Vr(n.toString()),Vr("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):n&&n.code===U.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(n)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),n=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.D_===n&&this.G_(r,s)},r=>{e(()=>{const s=new X(U.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(s)})})}G_(e,n){const r=this.W_(this.D_);this.stream=this.j_(e,n),this.stream.Xo(()=>{r(()=>this.listener.Xo())}),this.stream.t_(()=>{r(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(s=>{r(()=>this.z_(s))}),this.stream.onMessage(s=>{r(()=>++this.F_==1?this.J_(s):this.onNext(s))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return ee(Z_,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return n=>{this.Mi.enqueueAndForget(()=>this.D_===e?n():(ee(Z_,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class Zj extends lS{constructor(e,n,r,s,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}j_(e,n){return this.connection.T_("Listen",e,n)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const n=ij(this.serializer,e),r=function(i){if(!("targetChange"in i))return ve.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?ve.min():o.readTime?cr(o.readTime):ve.min()}(e);return this.listener.H_(n,r)}Y_(e){const n={};n.database=ap(this.serializer),n.addTarget=function(i,o){let a;const c=o.target;if(a=np(c)?{documents:lj(i,c)}:{query:ZT(i,c).ft},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=QT(i,o.resumeToken);const d=sp(i,o.expectedCount);d!==null&&(a.expectedCount=d)}else if(o.snapshotVersion.compareTo(ve.min())>0){a.readTime=Ic(i,o.snapshotVersion.toTimestamp());const d=sp(i,o.expectedCount);d!==null&&(a.expectedCount=d)}return a}(this.serializer,e);const r=dj(this.serializer,e);r&&(n.labels=r),this.q_(n)}Z_(e){const n={};n.database=ap(this.serializer),n.removeTarget=e,this.q_(n)}}class eD extends lS{constructor(e,n,r,s,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,n){return this.connection.T_("Write",e,n)}J_(e){return Ve(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Ve(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Ve(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const n=aj(e.writeResults,e.commitTime),r=cr(e.commitTime);return this.listener.na(r,n)}ra(){const e={};e.database=ap(this.serializer),this.q_(e)}ea(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>oj(this.serializer,r))};this.q_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tD{}class nD extends tD{constructor(e,n,r,s){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=s,this.ia=!1}sa(){if(this.ia)throw new X(U.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,n,r,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.Go(e,ip(n,r),s,i,o)).catch(i=>{throw i.name==="FirebaseError"?(i.code===U.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new X(U.UNKNOWN,i.toString())})}Ho(e,n,r,s,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Ho(e,ip(n,r),s,o,a,i)).catch(o=>{throw o.name==="FirebaseError"?(o.code===U.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new X(U.UNKNOWN,o.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class rD{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Vr(n),this.aa=!1):ee("OnlineStateTracker",n)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const di="RemoteStore";class sD{constructor(e,n,r,s,i){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=i,this.Aa.Oo(o=>{r.enqueueAndForget(async()=>{xi(this)&&(ee(di,"Restarting streams for network reachability change."),await async function(c){const d=ye(c);d.Ea.add(4),await _l(d),d.Ra.set("Unknown"),d.Ea.delete(4),await _d(d)}(this))})}),this.Ra=new rD(r,s)}}async function _d(t){if(xi(t))for(const e of t.da)await e(!0)}async function _l(t){for(const e of t.da)await e(!1)}function uS(t,e){const n=ye(t);n.Ia.has(e.targetId)||(n.Ia.set(e.targetId,e),Qm(n)?Km(n):Ro(n).O_()&&Gm(n,e))}function Hm(t,e){const n=ye(t),r=Ro(n);n.Ia.delete(e),r.O_()&&cS(n,e),n.Ia.size===0&&(r.O_()?r.L_():xi(n)&&n.Ra.set("Unknown"))}function Gm(t,e){if(t.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(ve.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}Ro(t).Y_(e)}function cS(t,e){t.Va.Ue(e),Ro(t).Z_(e)}function Km(t){t.Va=new J2({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),Ro(t).start(),t.Ra.ua()}function Qm(t){return xi(t)&&!Ro(t).x_()&&t.Ia.size>0}function xi(t){return ye(t).Ea.size===0}function dS(t){t.Va=void 0}async function iD(t){t.Ra.set("Online")}async function oD(t){t.Ia.forEach((e,n)=>{Gm(t,e)})}async function aD(t,e){dS(t),Qm(t)?(t.Ra.ha(e),Km(t)):t.Ra.set("Unknown")}async function lD(t,e,n){if(t.Ra.set("Online"),e instanceof KT&&e.state===2&&e.cause)try{await async function(s,i){const o=i.cause;for(const a of i.targetIds)s.Ia.has(a)&&(await s.remoteSyncer.rejectListen(a,o),s.Ia.delete(a),s.Va.removeTarget(a))}(t,e)}catch(r){ee(di,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Nc(t,r)}else if(e instanceof Mu?t.Va.Ze(e):e instanceof GT?t.Va.st(e):t.Va.tt(e),!n.isEqual(ve.min()))try{const r=await oS(t.localStore);n.compareTo(r)>=0&&await function(i,o){const a=i.Va.Tt(o);return a.targetChanges.forEach((c,d)=>{if(c.resumeToken.approximateByteSize()>0){const h=i.Ia.get(d);h&&i.Ia.set(d,h.withResumeToken(c.resumeToken,o))}}),a.targetMismatches.forEach((c,d)=>{const h=i.Ia.get(c);if(!h)return;i.Ia.set(c,h.withResumeToken(bt.EMPTY_BYTE_STRING,h.snapshotVersion)),cS(i,c);const p=new us(h.target,c,d,h.sequenceNumber);Gm(i,p)}),i.remoteSyncer.applyRemoteEvent(a)}(t,n)}catch(r){ee(di,"Failed to raise snapshot:",r),await Nc(t,r)}}async function Nc(t,e,n){if(!Co(e))throw e;t.Ea.add(1),await _l(t),t.Ra.set("Offline"),n||(n=()=>oS(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{ee(di,"Retrying IndexedDB access"),await n(),t.Ea.delete(1),await _d(t)})}function hS(t,e){return e().catch(n=>Nc(t,n,e))}async function wd(t){const e=ye(t),n=Cs(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:jm;for(;uD(e);)try{const s=await qj(e.localStore,r);if(s===null){e.Ta.length===0&&n.L_();break}r=s.batchId,cD(e,s)}catch(s){await Nc(e,s)}fS(e)&&pS(e)}function uD(t){return xi(t)&&t.Ta.length<10}function cD(t,e){t.Ta.push(e);const n=Cs(t);n.O_()&&n.X_&&n.ea(e.mutations)}function fS(t){return xi(t)&&!Cs(t).x_()&&t.Ta.length>0}function pS(t){Cs(t).start()}async function dD(t){Cs(t).ra()}async function hD(t){const e=Cs(t);for(const n of t.Ta)e.ea(n.mutations)}async function fD(t,e,n){const r=t.Ta.shift(),s=Um.from(r,e,n);await hS(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await wd(t)}async function pD(t,e){e&&Cs(t).X_&&await async function(r,s){if(function(o){return Q2(o)&&o!==U.ABORTED}(s.code)){const i=r.Ta.shift();Cs(r).B_(),await hS(r,()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s)),await wd(r)}}(t,e),fS(t)&&pS(t)}async function ew(t,e){const n=ye(t);n.asyncQueue.verifyOperationInProgress(),ee(di,"RemoteStore received new credentials");const r=xi(n);n.Ea.add(3),await _l(n),r&&n.Ra.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.Ea.delete(3),await _d(n)}async function mD(t,e){const n=ye(t);e?(n.Ea.delete(2),await _d(n)):e||(n.Ea.add(2),await _l(n),n.Ra.set("Unknown"))}function Ro(t){return t.ma||(t.ma=function(n,r,s){const i=ye(n);return i.sa(),new Zj(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Xo:iD.bind(null,t),t_:oD.bind(null,t),r_:aD.bind(null,t),H_:lD.bind(null,t)}),t.da.push(async e=>{e?(t.ma.B_(),Qm(t)?Km(t):t.Ra.set("Unknown")):(await t.ma.stop(),dS(t))})),t.ma}function Cs(t){return t.fa||(t.fa=function(n,r,s){const i=ye(n);return i.sa(),new eD(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Xo:()=>Promise.resolve(),t_:dD.bind(null,t),r_:pD.bind(null,t),ta:hD.bind(null,t),na:fD.bind(null,t)}),t.da.push(async e=>{e?(t.fa.B_(),await wd(t)):(await t.fa.stop(),t.Ta.length>0&&(ee(di,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))})),t.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ym{constructor(e,n,r,s,i){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new lr,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,s,i){const o=Date.now()+r,a=new Ym(e,n,o,s,i);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new X(U.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Xm(t,e){if(Vr("AsyncQueue",`${e}: ${t}`),Co(t))return new X(U.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class to{static emptySet(e){return new to(e.comparator)}constructor(e){this.comparator=e?(n,r)=>e(n,r)||le.comparator(n.key,r.key):(n,r)=>le.comparator(n.key,r.key),this.keyedMap=ua(),this.sortedSet=new rt(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof to)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new to;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tw{constructor(){this.ga=new rt(le.comparator)}track(e){const n=e.doc.key,r=this.ga.get(n);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(n,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(n):e.type===1&&r.type===2?this.ga=this.ga.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):fe(63341,{Rt:e,pa:r}):this.ga=this.ga.insert(n,e)}ya(){const e=[];return this.ga.inorderTraversal((n,r)=>{e.push(r)}),e}}class yo{constructor(e,n,r,s,i,o,a,c,d){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=c,this.hasCachedResults=d}static fromInitialDocuments(e,n,r,s,i){const o=[];return n.forEach(a=>{o.push({type:0,doc:a})}),new yo(e,n,to.emptySet(n),o,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&hd(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let s=0;s<n.length;s++)if(n[s].type!==r[s].type||!n[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gD{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class yD{constructor(){this.queries=nw(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(n,r){const s=ye(n),i=s.queries;s.queries=nw(),i.forEach((o,a)=>{for(const c of a.Sa)c.onError(r)})})(this,new X(U.ABORTED,"Firestore shutting down"))}}function nw(){return new wi(t=>DT(t),hd)}async function Jm(t,e){const n=ye(t);let r=3;const s=e.query;let i=n.queries.get(s);i?!i.ba()&&e.Da()&&(r=2):(i=new gD,r=e.Da()?0:1);try{switch(r){case 0:i.wa=await n.onListen(s,!0);break;case 1:i.wa=await n.onListen(s,!1);break;case 2:await n.onFirstRemoteStoreListen(s)}}catch(o){const a=Xm(o,`Initialization of query '${Ri(e.query)}' failed`);return void e.onError(a)}n.queries.set(s,i),i.Sa.push(e),e.va(n.onlineState),i.wa&&e.Fa(i.wa)&&eg(n)}async function Zm(t,e){const n=ye(t),r=e.query;let s=3;const i=n.queries.get(r);if(i){const o=i.Sa.indexOf(e);o>=0&&(i.Sa.splice(o,1),i.Sa.length===0?s=e.Da()?0:1:!i.ba()&&e.Da()&&(s=2))}switch(s){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function vD(t,e){const n=ye(t);let r=!1;for(const s of e){const i=s.query,o=n.queries.get(i);if(o){for(const a of o.Sa)a.Fa(s)&&(r=!0);o.wa=s}}r&&eg(n)}function _D(t,e,n){const r=ye(t),s=r.queries.get(e);if(s)for(const i of s.Sa)i.onError(n);r.queries.delete(e)}function eg(t){t.Ca.forEach(e=>{e.next()})}var cp,rw;(rw=cp||(cp={})).Ma="default",rw.Cache="cache";class tg{constructor(e,n,r){this.query=e,this.xa=n,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new yo(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),n=!0):this.La(e,this.onlineState)&&(this.ka(e),n=!0),this.Na=e,n}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let n=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),n=!0),n}La(e,n){if(!e.fromCache||!this.Da())return!0;const r=n!=="Offline";return(!this.options.qa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const n=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}ka(e){e=yo.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==cp.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mS{constructor(e){this.key=e}}class gS{constructor(e){this.key=e}}class wD{constructor(e,n){this.query=e,this.Ya=n,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=Ne(),this.mutatedKeys=Ne(),this.eu=OT(e),this.tu=new to(this.eu)}get nu(){return this.Ya}ru(e,n){const r=n?n.iu:new tw,s=n?n.tu:this.tu;let i=n?n.mutatedKeys:this.mutatedKeys,o=s,a=!1;const c=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,d=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((h,p)=>{const m=s.get(h),y=fd(this.query,p)?p:null,T=!!m&&this.mutatedKeys.has(m.key),b=!!y&&(y.hasLocalMutations||this.mutatedKeys.has(y.key)&&y.hasCommittedMutations);let I=!1;m&&y?m.data.isEqual(y.data)?T!==b&&(r.track({type:3,doc:y}),I=!0):this.su(m,y)||(r.track({type:2,doc:y}),I=!0,(c&&this.eu(y,c)>0||d&&this.eu(y,d)<0)&&(a=!0)):!m&&y?(r.track({type:0,doc:y}),I=!0):m&&!y&&(r.track({type:1,doc:m}),I=!0,(c||d)&&(a=!0)),I&&(y?(o=o.add(y),i=b?i.add(h):i.delete(h)):(o=o.delete(h),i=i.delete(h)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const h=this.query.limitType==="F"?o.last():o.first();o=o.delete(h.key),i=i.delete(h.key),r.track({type:1,doc:h})}return{tu:o,iu:r,Cs:a,mutatedKeys:i}}su(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,s){const i=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const o=e.iu.ya();o.sort((h,p)=>function(y,T){const b=I=>{switch(I){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return fe(20277,{Rt:I})}};return b(y)-b(T)}(h.type,p.type)||this.eu(h.doc,p.doc)),this.ou(r),s=s??!1;const a=n&&!s?this._u():[],c=this.Xa.size===0&&this.current&&!s?1:0,d=c!==this.Za;return this.Za=c,o.length!==0||d?{snapshot:new yo(this.query,e.tu,i,o,e.mutatedKeys,c===0,d,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:a}:{au:a}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new tw,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(n=>this.Ya=this.Ya.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ya=this.Ya.delete(n)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=Ne(),this.tu.forEach(r=>{this.uu(r.key)&&(this.Xa=this.Xa.add(r.key))});const n=[];return e.forEach(r=>{this.Xa.has(r)||n.push(new gS(r))}),this.Xa.forEach(r=>{e.has(r)||n.push(new mS(r))}),n}cu(e){this.Ya=e.Qs,this.Xa=Ne();const n=this.ru(e.documents);return this.applyChanges(n,!0)}lu(){return yo.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const ng="SyncEngine";class xD{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class ED{constructor(e){this.key=e,this.hu=!1}}class TD{constructor(e,n,r,s,i,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new wi(a=>DT(a),hd),this.Iu=new Map,this.Eu=new Set,this.du=new rt(le.comparator),this.Au=new Map,this.Ru=new Bm,this.Vu={},this.mu=new Map,this.fu=go.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function SD(t,e,n=!0){const r=ES(t);let s;const i=r.Tu.get(e);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.lu()):s=await yS(r,e,n,!0),s}async function ID(t,e){const n=ES(t);await yS(n,e,!0,!1)}async function yS(t,e,n,r){const s=await Wj(t.localStore,ur(e)),i=s.targetId,o=t.sharedClientState.addLocalQueryTarget(i,n);let a;return r&&(a=await bD(t,e,i,o==="current",s.resumeToken)),t.isPrimaryClient&&n&&uS(t.remoteStore,s),a}async function bD(t,e,n,r,s){t.pu=(p,m,y)=>async function(b,I,v,w){let _=I.view.ru(v);_.Cs&&(_=await Q_(b.localStore,I.query,!1).then(({documents:S})=>I.view.ru(S,_)));const E=w&&w.targetChanges.get(I.targetId),j=w&&w.targetMismatches.get(I.targetId)!=null,O=I.view.applyChanges(_,b.isPrimaryClient,E,j);return iw(b,I.targetId,O.au),O.snapshot}(t,p,m,y);const i=await Q_(t.localStore,e,!0),o=new wD(e,i.Qs),a=o.ru(i.documents),c=vl.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",s),d=o.applyChanges(a,t.isPrimaryClient,c);iw(t,n,d.au);const h=new xD(e,n,o);return t.Tu.set(e,h),t.Iu.has(n)?t.Iu.get(n).push(e):t.Iu.set(n,[e]),d.snapshot}async function ND(t,e,n){const r=ye(t),s=r.Tu.get(e),i=r.Iu.get(s.targetId);if(i.length>1)return r.Iu.set(s.targetId,i.filter(o=>!hd(o,e))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await lp(r.localStore,s.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(s.targetId),n&&Hm(r.remoteStore,s.targetId),dp(r,s.targetId)}).catch(Ao)):(dp(r,s.targetId),await lp(r.localStore,s.targetId,!0))}async function AD(t,e){const n=ye(t),r=n.Tu.get(e),s=n.Iu.get(r.targetId);n.isPrimaryClient&&s.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),Hm(n.remoteStore,r.targetId))}async function CD(t,e,n){const r=LD(t);try{const s=await function(o,a){const c=ye(o),d=We.now(),h=a.reduce((y,T)=>y.add(T.key),Ne());let p,m;return c.persistence.runTransaction("Locally write mutations","readwrite",y=>{let T=Mr(),b=Ne();return c.Ns.getEntries(y,h).next(I=>{T=I,T.forEach((v,w)=>{w.isValidDocument()||(b=b.add(v))})}).next(()=>c.localDocuments.getOverlayedDocuments(y,T)).next(I=>{p=I;const v=[];for(const w of a){const _=z2(w,p.get(w.key).overlayedDocument);_!=null&&v.push(new Vs(w.key,_,IT(_.value.mapValue),Zt.exists(!0)))}return c.mutationQueue.addMutationBatch(y,d,v,a)}).next(I=>{m=I;const v=I.applyToLocalDocumentSet(p,b);return c.documentOverlayCache.saveOverlays(y,I.batchId,v)})}).then(()=>({batchId:m.batchId,changes:VT(p)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(o,a,c){let d=o.Vu[o.currentUser.toKey()];d||(d=new rt(be)),d=d.insert(a,c),o.Vu[o.currentUser.toKey()]=d}(r,s.batchId,n),await wl(r,s.changes),await wd(r.remoteStore)}catch(s){const i=Xm(s,"Failed to persist write");n.reject(i)}}async function vS(t,e){const n=ye(t);try{const r=await Bj(n.localStore,e);e.targetChanges.forEach((s,i)=>{const o=n.Au.get(i);o&&(Ve(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1,22616),s.addedDocuments.size>0?o.hu=!0:s.modifiedDocuments.size>0?Ve(o.hu,14607):s.removedDocuments.size>0&&(Ve(o.hu,42227),o.hu=!1))}),await wl(n,r,e)}catch(r){await Ao(r)}}function sw(t,e,n){const r=ye(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const s=[];r.Tu.forEach((i,o)=>{const a=o.view.va(e);a.snapshot&&s.push(a.snapshot)}),function(o,a){const c=ye(o);c.onlineState=a;let d=!1;c.queries.forEach((h,p)=>{for(const m of p.Sa)m.va(a)&&(d=!0)}),d&&eg(c)}(r.eventManager,e),s.length&&r.Pu.H_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function RD(t,e,n){const r=ye(t);r.sharedClientState.updateQueryState(e,"rejected",n);const s=r.Au.get(e),i=s&&s.key;if(i){let o=new rt(le.comparator);o=o.insert(i,Ft.newNoDocument(i,ve.min()));const a=Ne().add(i),c=new yd(ve.min(),new Map,new rt(be),o,a);await vS(r,c),r.du=r.du.remove(i),r.Au.delete(e),rg(r)}else await lp(r.localStore,e,!1).then(()=>dp(r,e,n)).catch(Ao)}async function kD(t,e){const n=ye(t),r=e.batch.batchId;try{const s=await $j(n.localStore,e);wS(n,r,null),_S(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await wl(n,s)}catch(s){await Ao(s)}}async function PD(t,e,n){const r=ye(t);try{const s=await function(o,a){const c=ye(o);return c.persistence.runTransaction("Reject batch","readwrite-primary",d=>{let h;return c.mutationQueue.lookupMutationBatch(d,a).next(p=>(Ve(p!==null,37113),h=p.keys(),c.mutationQueue.removeMutationBatch(d,p))).next(()=>c.mutationQueue.performConsistencyCheck(d)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(d,h,a)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,h)).next(()=>c.localDocuments.getDocuments(d,h))})}(r.localStore,e);wS(r,e,n),_S(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await wl(r,s)}catch(s){await Ao(s)}}function _S(t,e){(t.mu.get(e)||[]).forEach(n=>{n.resolve()}),t.mu.delete(e)}function wS(t,e,n){const r=ye(t);let s=r.Vu[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(n?i.reject(n):i.resolve(),s=s.remove(e)),r.Vu[r.currentUser.toKey()]=s}}function dp(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Iu.get(e))t.Tu.delete(r),n&&t.Pu.yu(r,n);t.Iu.delete(e),t.isPrimaryClient&&t.Ru.jr(e).forEach(r=>{t.Ru.containsKey(r)||xS(t,r)})}function xS(t,e){t.Eu.delete(e.path.canonicalString());const n=t.du.get(e);n!==null&&(Hm(t.remoteStore,n),t.du=t.du.remove(e),t.Au.delete(n),rg(t))}function iw(t,e,n){for(const r of n)r instanceof mS?(t.Ru.addReference(r.key,e),jD(t,r)):r instanceof gS?(ee(ng,"Document no longer in limbo: "+r.key),t.Ru.removeReference(r.key,e),t.Ru.containsKey(r.key)||xS(t,r.key)):fe(19791,{wu:r})}function jD(t,e){const n=e.key,r=n.path.canonicalString();t.du.get(n)||t.Eu.has(r)||(ee(ng,"New document in limbo: "+n),t.Eu.add(r),rg(t))}function rg(t){for(;t.Eu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const n=new le(qe.fromString(e)),r=t.fu.next();t.Au.set(r,new ED(n)),t.du=t.du.insert(n,r),uS(t.remoteStore,new us(ur(dd(n.path)),r,"TargetPurposeLimboResolution",ld.ce))}}async function wl(t,e,n){const r=ye(t),s=[],i=[],o=[];r.Tu.isEmpty()||(r.Tu.forEach((a,c)=>{o.push(r.pu(c,e,n).then(d=>{var h;if((d||n)&&r.isPrimaryClient){const p=d?!d.fromCache:(h=n==null?void 0:n.targetChanges.get(c.targetId))==null?void 0:h.current;r.sharedClientState.updateQueryState(c.targetId,p?"current":"not-current")}if(d){s.push(d);const p=qm.As(c.targetId,d);i.push(p)}}))}),await Promise.all(o),r.Pu.H_(s),await async function(c,d){const h=ye(c);try{await h.persistence.runTransaction("notifyLocalViewChanges","readwrite",p=>B.forEach(d,m=>B.forEach(m.Es,y=>h.persistence.referenceDelegate.addReference(p,m.targetId,y)).next(()=>B.forEach(m.ds,y=>h.persistence.referenceDelegate.removeReference(p,m.targetId,y)))))}catch(p){if(!Co(p))throw p;ee(Wm,"Failed to update sequence numbers: "+p)}for(const p of d){const m=p.targetId;if(!p.fromCache){const y=h.Ms.get(m),T=y.snapshotVersion,b=y.withLastLimboFreeSnapshotVersion(T);h.Ms=h.Ms.insert(m,b)}}}(r.localStore,i))}async function DD(t,e){const n=ye(t);if(!n.currentUser.isEqual(e)){ee(ng,"User change. New user:",e.toKey());const r=await iS(n.localStore,e);n.currentUser=e,function(i,o){i.mu.forEach(a=>{a.forEach(c=>{c.reject(new X(U.CANCELLED,o))})}),i.mu.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await wl(n,r.Ls)}}function OD(t,e){const n=ye(t),r=n.Au.get(e);if(r&&r.hu)return Ne().add(r.key);{let s=Ne();const i=n.Iu.get(e);if(!i)return s;for(const o of i){const a=n.Tu.get(o);s=s.unionWith(a.view.nu)}return s}}function ES(t){const e=ye(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=vS.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=OD.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=RD.bind(null,e),e.Pu.H_=vD.bind(null,e.eventManager),e.Pu.yu=_D.bind(null,e.eventManager),e}function LD(t){const e=ye(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=kD.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=PD.bind(null,e),e}class Ac{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=vd(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,n){return null}Mu(e,n){return null}vu(e){return Fj(this.persistence,new Vj,e.initialUser,this.serializer)}Cu(e){return new sS(zm.mi,this.serializer)}Du(e){return new Gj}async terminate(){var e,n;(e=this.gcScheduler)==null||e.stop(),(n=this.indexBackfillerScheduler)==null||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Ac.provider={build:()=>new Ac};class VD extends Ac{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,n){Ve(this.persistence.referenceDelegate instanceof bc,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new Ej(r,e.asyncQueue,n)}Cu(e){const n=this.cacheSizeBytes!==void 0?rn.withCacheSize(this.cacheSizeBytes):rn.DEFAULT;return new sS(r=>bc.mi(r,n),this.serializer)}}class hp{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>sw(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=DD.bind(null,this.syncEngine),await mD(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new yD}()}createDatastore(e){const n=vd(e.databaseInfo.databaseId),r=function(i){return new Jj(i)}(e.databaseInfo);return function(i,o,a,c){return new nD(i,o,a,c)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,s,i,o,a){return new sD(r,s,i,o,a)}(this.localStore,this.datastore,e.asyncQueue,n=>sw(this.syncEngine,n,0),function(){return J_.v()?new J_:new Kj}())}createSyncEngine(e,n){return function(s,i,o,a,c,d,h){const p=new TD(s,i,o,a,c,d);return h&&(p.gu=!0),p}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(s){const i=ye(s);ee(di,"RemoteStore shutting down."),i.Ea.add(5),await _l(i),i.Aa.shutdown(),i.Ra.set("Unknown")}(this.remoteStore),(e=this.datastore)==null||e.terminate(),(n=this.eventManager)==null||n.terminate()}}hp.provider={build:()=>new hp};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sg{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Vr("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rs="FirestoreClient";class MD{constructor(e,n,r,s,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=s,this.user=Mt.UNAUTHENTICATED,this.clientId=od.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,async o=>{ee(Rs,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(ee(Rs,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new lr;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=Xm(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function Dh(t,e){t.asyncQueue.verifyOperationInProgress(),ee(Rs,"Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async s=>{r.isEqual(s)||(await iS(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function ow(t,e){t.asyncQueue.verifyOperationInProgress();const n=await UD(t);ee(Rs,"Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>ew(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,s)=>ew(e.remoteStore,s)),t._onlineComponents=e}async function UD(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){ee(Rs,"Using user provided OfflineComponentProvider");try{await Dh(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(s){return s.name==="FirebaseError"?s.code===U.FAILED_PRECONDITION||s.code===U.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(n))throw n;ci("Error using user provided cache. Falling back to memory cache: "+n),await Dh(t,new Ac)}}else ee(Rs,"Using default OfflineComponentProvider"),await Dh(t,new VD(void 0));return t._offlineComponents}async function ig(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(ee(Rs,"Using user provided OnlineComponentProvider"),await ow(t,t._uninitializedComponentsProvider._online)):(ee(Rs,"Using default OnlineComponentProvider"),await ow(t,new hp))),t._onlineComponents}function FD(t){return ig(t).then(e=>e.syncEngine)}function $D(t){return ig(t).then(e=>e.datastore)}async function Cc(t){const e=await ig(t),n=e.eventManager;return n.onListen=SD.bind(null,e.syncEngine),n.onUnlisten=ND.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=ID.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=AD.bind(null,e.syncEngine),n}function BD(t,e,n={}){const r=new lr;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,a,c,d){const h=new sg({next:m=>{h.Nu(),o.enqueueAndForget(()=>Zm(i,p));const y=m.docs.has(a);!y&&m.fromCache?d.reject(new X(U.UNAVAILABLE,"Failed to get document because the client is offline.")):y&&m.fromCache&&c&&c.source==="server"?d.reject(new X(U.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):d.resolve(m)},error:m=>d.reject(m)}),p=new tg(dd(a.path),h,{includeMetadataChanges:!0,qa:!0});return Jm(i,p)}(await Cc(t),t.asyncQueue,e,n,r)),r.promise}function zD(t,e,n={}){const r=new lr;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,a,c,d){const h=new sg({next:m=>{h.Nu(),o.enqueueAndForget(()=>Zm(i,p)),m.fromCache&&c.source==="server"?d.reject(new X(U.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):d.resolve(m)},error:m=>d.reject(m)}),p=new tg(a,h,{includeMetadataChanges:!0,qa:!0});return Jm(i,p)}(await Cc(t),t.asyncQueue,e,n,r)),r.promise}function qD(t,e,n){const r=new lr;return t.asyncQueue.enqueueAndForget(async()=>{try{const s=await $D(t);r.resolve(async function(o,a,c){var b;const d=ye(o),{request:h,gt:p,parent:m}=uj(d.serializer,A2(a),c);d.connection.$o||delete h.parent;const y=(await d.Ho("RunAggregationQuery",d.serializer.databaseId,m,h,1)).filter(I=>!!I.result);Ve(y.length===1,64727);const T=(b=y[0].result)==null?void 0:b.aggregateFields;return Object.keys(T).reduce((I,v)=>(I[p[v]]=T[v],I),{})}(s,e,n))}catch(s){r.reject(s)}}),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TS(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aw=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SS="firestore.googleapis.com",lw=!0;class uw{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new X(U.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=SS,this.ssl=lw}else this.host=e.host,this.ssl=e.ssl??lw;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=rS;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<wj)throw new X(U.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}pT("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=TS(e.experimentalLongPollingOptions??{}),function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new X(U.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new X(U.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new X(U.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,s){return r.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class xl{constructor(e,n,r,s){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new uw({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new X(U.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new X(U.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new uw(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new fT;switch(r.type){case"firstParty":return new YP(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new X(U.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=aw.get(n);r&&(ee("ComponentProvider","Removing Datastore"),aw.delete(n),r.terminate())}(this),Promise.resolve()}}function IS(t,e,n,r={}){var d;t=St(t,xl);const s=zr(e),i=t._getSettings(),o={...i,emulatorOptions:t._getEmulatorOptions()},a=`${e}:${n}`;s&&(ed(`https://${a}`),td("Firestore",!0)),i.host!==SS&&i.host!==a&&ci("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const c={...i,host:a,ssl:s,emulatorOptions:r};if(!oi(c,o)&&(t._setSettings(c),r.mockUserToken)){let h,p;if(typeof r.mockUserToken=="string")h=r.mockUserToken,p=Mt.MOCK_USER;else{h=m0(r.mockUserToken,(d=t._app)==null?void 0:d.options.projectId);const m=r.mockUserToken.sub||r.mockUserToken.user_id;if(!m)throw new X(U.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");p=new Mt(m)}t._authCredentials=new GP(new hT(h,p))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jn{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new Jn(this.firestore,e,this._query)}}class Ze{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Rr(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Ze(this.firestore,e,this._key)}toJSON(){return{type:Ze._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,n,r){if(gl(n,Ze._jsonSchema))return new Ze(e,r||null,new le(qe.fromString(n.referencePath)))}}Ze._jsonSchemaVersion="firestore/documentReference/1.0",Ze._jsonSchema={type:pt("string",Ze._jsonSchemaVersion),referencePath:pt("string")};class Rr extends Jn{constructor(e,n,r){super(e,n,dd(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Ze(this.firestore,null,new le(e))}withConverter(e){return new Rr(this.firestore,e,this._path)}}function ie(t,e,...n){if(t=Re(t),Pm("collection","path",e),t instanceof xl){const r=qe.fromString(e,...n);return E_(r),new Rr(t,null,r)}{if(!(t instanceof Ze||t instanceof Rr))throw new X(U.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(qe.fromString(e,...n));return E_(r),new Rr(t.firestore,null,r)}}function jn(t,e){if(t=St(t,xl),Pm("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new X(U.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new Jn(t,null,function(r){return new _i(qe.emptyPath(),r)}(e))}function q(t,e,...n){if(t=Re(t),arguments.length===1&&(e=od.newId()),Pm("doc","path",e),t instanceof xl){const r=qe.fromString(e,...n);return x_(r),new Ze(t,null,new le(r))}{if(!(t instanceof Ze||t instanceof Rr))throw new X(U.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(qe.fromString(e,...n));return x_(r),new Ze(t.firestore,t instanceof Rr?t.converter:null,new le(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cw="AsyncQueue";class dw{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new aS(this,"async_queue_retry"),this._c=()=>{const r=jh();r&&ee(cw,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const n=jh();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const n=jh();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const n=new lr;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!Co(e))throw e;ee(cw,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const n=this.ac.then(()=>(this.rc=!0,e().catch(r=>{throw this.nc=r,this.rc=!1,Vr("INTERNAL UNHANDLED ERROR: ",hw(r)),r}).then(r=>(this.rc=!1,r))));return this.ac=n,n}enqueueAfterDelay(e,n,r){this.uc(),this.oc.indexOf(e)>-1&&(n=0);const s=Ym.createAndSchedule(this,e,n,r,i=>this.hc(i));return this.tc.push(s),s}uc(){this.nc&&fe(47125,{Pc:hw(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const n of this.tc)if(n.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.tc)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const n=this.tc.indexOf(e);this.tc.splice(n,1)}}function hw(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fw(t){return function(n,r){if(typeof n!="object"||n===null)return!1;const s=n;for(const i of r)if(i in s&&typeof s[i]=="function")return!0;return!1}(t,["next","error","complete"])}class Dn extends xl{constructor(e,n,r,s){super(e,n,r,s),this.type="firestore",this._queue=new dw,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new dw(e),this._firestoreClient=void 0,await e}}}function Me(t,e){const n=typeof t=="object"?t:Io(),r=typeof t=="string"?t:wc,s=Os(n,"firestore").getImmediate({identifier:r});if(!s._initialized){const i=fm("firestore");i&&IS(s,...i)}return s}function Ei(t){if(t._terminated)throw new X(U.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||WD(t),t._firestoreClient}function WD(t){var r,s,i;const e=t._freezeSettings(),n=function(a,c,d,h){return new f2(a,c,d,h.host,h.ssl,h.experimentalForceLongPolling,h.experimentalAutoDetectLongPolling,TS(h.experimentalLongPollingOptions),h.useFetchStreams,h.isUsingEmulator)}(t._databaseId,((r=t._app)==null?void 0:r.options.appId)||"",t._persistenceKey,e);t._componentsProvider||(s=e.localCache)!=null&&s._offlineComponentProvider&&((i=e.localCache)!=null&&i._onlineComponentProvider)&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new MD(t._authCredentials,t._appCheckCredentials,t._queue,n,t._componentsProvider&&function(a){const c=a==null?void 0:a._online.build();return{_offline:a==null?void 0:a._offline.build(c),_online:c}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bS{constructor(e="count",n){this._internalFieldPath=n,this.type="AggregateField",this.aggregateType=e}}class NS{constructor(e,n,r){this._userDataWriter=n,this._data=r,this.type="AggregateQuerySnapshot",this.query=e}data(){return this._userDataWriter.convertObjectMap(this._data)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pn{constructor(e){this._byteString=e}static fromBase64String(e){try{return new pn(bt.fromBase64String(e))}catch(n){throw new X(U.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new pn(bt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:pn._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(gl(e,pn._jsonSchema))return pn.fromBase64String(e.bytes)}}pn._jsonSchemaVersion="firestore/bytes/1.0",pn._jsonSchema={type:pt("string",pn._jsonSchemaVersion),bytes:pt("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ko{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new X(U.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Et(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class El{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gn{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new X(U.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new X(U.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return be(this._lat,e._lat)||be(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Gn._jsonSchemaVersion}}static fromJSON(e){if(gl(e,Gn._jsonSchema))return new Gn(e.latitude,e.longitude)}}Gn._jsonSchemaVersion="firestore/geoPoint/1.0",Gn._jsonSchema={type:pt("string",Gn._jsonSchemaVersion),latitude:pt("number"),longitude:pt("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kn{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,s){if(r.length!==s.length)return!1;for(let i=0;i<r.length;++i)if(r[i]!==s[i])return!1;return!0}(this._values,e._values)}toJSON(){return{type:Kn._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(gl(e,Kn._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(n=>typeof n=="number"))return new Kn(e.vectorValues);throw new X(U.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Kn._jsonSchemaVersion="firestore/vectorValue/1.0",Kn._jsonSchema={type:pt("string",Kn._jsonSchemaVersion),vectorValues:pt("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HD=/^__.*__$/;class GD{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new Vs(e,this.data,this.fieldMask,n,this.fieldTransforms):new yl(e,this.data,n,this.fieldTransforms)}}class AS{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new Vs(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function CS(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw fe(40011,{Ac:t})}}class og{constructor(e,n,r,s,i,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.Rc(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new og({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var s;const n=(s=this.path)==null?void 0:s.child(e),r=this.Vc({path:n,fc:!1});return r.gc(e),r}yc(e){var s;const n=(s=this.path)==null?void 0:s.child(e),r=this.Vc({path:n,fc:!1});return r.Rc(),r}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Rc(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(CS(this.Ac)&&HD.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class KD{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||vd(e)}Cc(e,n,r,s=!1){return new og({Ac:e,methodName:n,Dc:r,path:Et.emptyPath(),fc:!1,bc:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Tl(t){const e=t._freezeSettings(),n=vd(t._databaseId);return new KD(t._databaseId,!!e.ignoreUndefinedProperties,n)}function ag(t,e,n,r,s,i={}){const o=t.Cc(i.merge||i.mergeFields?2:0,e,n,s);ug("Data must be an object, but it was:",o,r);const a=PS(r,o);let c,d;if(i.merge)c=new gn(o.fieldMask),d=o.fieldTransforms;else if(i.mergeFields){const h=[];for(const p of i.mergeFields){const m=fp(e,p,n);if(!o.contains(m))throw new X(U.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);DS(h,m)||h.push(m)}c=new gn(h),d=o.fieldTransforms.filter(p=>c.covers(p.field))}else c=null,d=o.fieldTransforms;return new GD(new on(a),c,d)}class Sl extends El{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Sl}}class lg extends El{_toFieldTransform(e){return new U2(e.path,new el)}isEqual(e){return e instanceof lg}}function RS(t,e,n,r){const s=t.Cc(1,e,n);ug("Data must be an object, but it was:",s,r);const i=[],o=on.empty();Ls(r,(c,d)=>{const h=cg(e,c,n);d=Re(d);const p=s.yc(h);if(d instanceof Sl)i.push(h);else{const m=Il(d,p);m!=null&&(i.push(h),o.set(h,m))}});const a=new gn(i);return new AS(o,a,s.fieldTransforms)}function kS(t,e,n,r,s,i){const o=t.Cc(1,e,n),a=[fp(e,r,n)],c=[s];if(i.length%2!=0)throw new X(U.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let m=0;m<i.length;m+=2)a.push(fp(e,i[m])),c.push(i[m+1]);const d=[],h=on.empty();for(let m=a.length-1;m>=0;--m)if(!DS(d,a[m])){const y=a[m];let T=c[m];T=Re(T);const b=o.yc(y);if(T instanceof Sl)d.push(y);else{const I=Il(T,b);I!=null&&(d.push(y),h.set(y,I))}}const p=new gn(d);return new AS(h,p,o.fieldTransforms)}function QD(t,e,n,r=!1){return Il(n,t.Cc(r?4:3,e))}function Il(t,e){if(jS(t=Re(t)))return ug("Unsupported field value:",e,t),PS(t,e);if(t instanceof El)return function(r,s){if(!CS(s.Ac))throw s.Sc(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Sc(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return function(r,s){const i=[];let o=0;for(const a of r){let c=Il(a,s.wc(o));c==null&&(c={nullValue:"NULL_VALUE"}),i.push(c),o++}return{arrayValue:{values:i}}}(t,e)}return function(r,s){if((r=Re(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return L2(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=We.fromDate(r);return{timestampValue:Ic(s.serializer,i)}}if(r instanceof We){const i=new We(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Ic(s.serializer,i)}}if(r instanceof Gn)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof pn)return{bytesValue:QT(s.serializer,r._byteString)};if(r instanceof Ze){const i=s.databaseId,o=r.firestore._databaseId;if(!o.isEqual(i))throw s.Sc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:$m(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof Kn)return function(o,a){return{mapValue:{fields:{[TT]:{stringValue:ST},[xc]:{arrayValue:{values:o.toArray().map(d=>{if(typeof d!="number")throw a.Sc("VectorValues must only contain numeric values.");return Mm(a.serializer,d)})}}}}}}(r,s);throw s.Sc(`Unsupported field value: ${ad(r)}`)}(t,e)}function PS(t,e){const n={};return yT(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Ls(t,(r,s)=>{const i=Il(s,e.mc(r));i!=null&&(n[r]=i)}),{mapValue:{fields:n}}}function jS(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof We||t instanceof Gn||t instanceof pn||t instanceof Ze||t instanceof El||t instanceof Kn)}function ug(t,e,n){if(!jS(n)||!mT(n)){const r=ad(n);throw r==="an object"?e.Sc(t+" a custom object"):e.Sc(t+" "+r)}}function fp(t,e,n){if((e=Re(e))instanceof ko)return e._internalPath;if(typeof e=="string")return cg(t,e);throw Rc("Field path arguments must be of type string or ",t,!1,void 0,n)}const YD=new RegExp("[~\\*/\\[\\]]");function cg(t,e,n){if(e.search(YD)>=0)throw Rc(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new ko(...e.split("."))._internalPath}catch{throw Rc(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Rc(t,e,n,r,s){const i=r&&!r.isEmpty(),o=s!==void 0;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(i||o)&&(c+=" (found",i&&(c+=` in field ${r}`),o&&(c+=` in document ${s}`),c+=")"),new X(U.INVALID_ARGUMENT,a+t+c)}function DS(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OS{constructor(e,n,r,s,i){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Ze(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new XD(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(xd("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class XD extends OS{data(){return super.data()}}function xd(t,e){return typeof e=="string"?cg(t,e):e instanceof ko?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LS(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new X(U.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class dg{}class Ed extends dg{}function we(t,e,...n){let r=[];e instanceof dg&&r.push(e),r=r.concat(n),function(i){const o=i.filter(c=>c instanceof Td).length,a=i.filter(c=>c instanceof bl).length;if(o>1||o>0&&a>0)throw new X(U.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const s of r)t=s._apply(t);return t}class bl extends Ed{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new bl(e,n,r)}_apply(e){const n=this._parse(e);return VS(e._query,n),new Jn(e.firestore,e.converter,rp(e._query,n))}_parse(e){const n=Tl(e.firestore);return function(i,o,a,c,d,h,p){let m;if(d.isKeyField()){if(h==="array-contains"||h==="array-contains-any")throw new X(U.INVALID_ARGUMENT,`Invalid Query. You can't perform '${h}' queries on documentId().`);if(h==="in"||h==="not-in"){mw(p,h);const T=[];for(const b of p)T.push(pw(c,i,b));m={arrayValue:{values:T}}}else m=pw(c,i,p)}else h!=="in"&&h!=="not-in"&&h!=="array-contains-any"||mw(p,h),m=QD(a,o,p,h==="in"||h==="not-in");return ft.create(d,h,m)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function Fe(t,e,n){const r=e,s=xd("where",t);return bl._create(s,r,n)}class Td extends dg{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new Td(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:Yn.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(s,i){let o=s;const a=i.getFlattenedFilters();for(const c of a)VS(o,c),o=rp(o,c)}(e._query,n),new Jn(e.firestore,e.converter,rp(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Sd extends Ed{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new Sd(e,n)}_apply(e){const n=function(s,i,o){if(s.startAt!==null)throw new X(U.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new X(U.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Za(i,o)}(e._query,this._field,this._direction);return new Jn(e.firestore,e.converter,function(s,i){const o=s.explicitOrderBy.concat([i]);return new _i(s.path,s.collectionGroup,o,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)}(e._query,n))}}function It(t,e="asc"){const n=e,r=xd("orderBy",t);return Sd._create(r,n)}class Id extends Ed{constructor(e,n,r){super(),this.type=e,this._limit=n,this._limitType=r}static _create(e,n,r){return new Id(e,n,r)}_apply(e){return new Jn(e.firestore,e.converter,Tc(e._query,this._limit,this._limitType))}}function hg(t){return Id._create("limit",t,"F")}function pw(t,e,n){if(typeof(n=Re(n))=="string"){if(n==="")throw new X(U.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!PT(e)&&n.indexOf("/")!==-1)throw new X(U.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(qe.fromString(n));if(!le.isDocumentKey(r))throw new X(U.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return R_(t,new le(r))}if(n instanceof Ze)return R_(t,n._key);throw new X(U.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${ad(n)}.`)}function mw(t,e){if(!Array.isArray(t)||t.length===0)throw new X(U.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function VS(t,e){const n=function(s,i){for(const o of s)for(const a of o.getFlattenedFilters())if(i.indexOf(a.op)>=0)return a.op;return null}(t.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new X(U.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new X(U.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class MS{convertValue(e,n="none"){switch(As(e)){case 0:return null;case 1:return e.booleanValue;case 2:return lt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(Ns(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw fe(62114,{value:e})}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return Ls(e,(s,i)=>{r[s]=this.convertValue(i,n)}),r}convertVectorValue(e){var r,s,i;const n=(i=(s=(r=e.fields)==null?void 0:r[xc].arrayValue)==null?void 0:s.values)==null?void 0:i.map(o=>lt(o.doubleValue));return new Kn(n)}convertGeoPoint(e){return new Gn(lt(e.latitude),lt(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=cd(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(Xa(e));default:return null}}convertTimestamp(e){const n=bs(e);return new We(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=qe.fromString(e);Ve(nS(r),9688,{name:e});const s=new fo(r.get(1),r.get(3)),i=new le(r.popFirst(5));return s.isEqual(n)||Vr(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fg(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}function US(){return new bS("count")}class qi{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class xs extends OS{constructor(e,n,r,s,i,o){super(e,n,r,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new ba(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(xd("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new X(U.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,n={};return n.type=xs._jsonSchemaVersion,n.bundle="",n.bundleSource="DocumentSnapshot",n.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?n:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),n.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),n)}}xs._jsonSchemaVersion="firestore/documentSnapshot/1.0",xs._jsonSchema={type:pt("string",xs._jsonSchemaVersion),bundleSource:pt("string","DocumentSnapshot"),bundleName:pt("string"),bundle:pt("string")};class ba extends xs{data(e={}){return super.data(e)}}class Es{constructor(e,n,r,s){this._firestore=e,this._userDataWriter=n,this._snapshot=s,this.metadata=new qi(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new ba(this._firestore,this._userDataWriter,r.key,r,new qi(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new X(U.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let o=0;return s._snapshot.docChanges.map(a=>{const c=new ba(s._firestore,s._userDataWriter,a.doc.key,a.doc,new qi(s._snapshot.mutatedKeys.has(a.doc.key),s._snapshot.fromCache),s.query.converter);return a.doc,{type:"added",doc:c,oldIndex:-1,newIndex:o++}})}{let o=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(a=>i||a.type!==3).map(a=>{const c=new ba(s._firestore,s._userDataWriter,a.doc.key,a.doc,new qi(s._snapshot.mutatedKeys.has(a.doc.key),s._snapshot.fromCache),s.query.converter);let d=-1,h=-1;return a.type!==0&&(d=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),h=o.indexOf(a.doc.key)),{type:JD(a.type),doc:c,oldIndex:d,newIndex:h}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new X(U.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Es._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=od.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const n=[],r=[],s=[];return this.docs.forEach(i=>{i._document!==null&&(n.push(i._document),r.push(this._userDataWriter.convertObjectMap(i._document.data.value.mapValue.fields,"previous")),s.push(i.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function JD(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return fe(61501,{type:t})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xe(t){t=St(t,Ze);const e=St(t.firestore,Dn);return BD(Ei(e),t._key).then(n=>FS(e,t,n))}Es._jsonSchemaVersion="firestore/querySnapshot/1.0",Es._jsonSchema={type:pt("string",Es._jsonSchemaVersion),bundleSource:pt("string","QuerySnapshot"),bundleName:pt("string"),bundle:pt("string")};class bd extends MS{constructor(e){super(),this.firestore=e}convertBytes(e){return new pn(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Ze(this.firestore,null,n)}}function Ge(t){t=St(t,Jn);const e=St(t.firestore,Dn),n=Ei(e),r=new bd(e);return LS(t._query),zD(n,t._query).then(s=>new Es(e,r,t,s))}function ze(t,e,n){t=St(t,Ze);const r=St(t.firestore,Dn),s=fg(t.converter,e,n);return Po(r,[ag(Tl(r),"setDoc",t._key,s,t.converter!==null,n).toMutation(t._key,Zt.none())])}function Nl(t,e,n,...r){t=St(t,Ze);const s=St(t.firestore,Dn),i=Tl(s);let o;return o=typeof(e=Re(e))=="string"||e instanceof ko?kS(i,"updateDoc",t._key,e,n,r):RS(i,"updateDoc",t._key,e),Po(s,[o.toMutation(t._key,Zt.exists(!0))])}function mt(t){return Po(St(t.firestore,Dn),[new gd(t._key,Zt.none())])}function An(t,e){const n=St(t.firestore,Dn),r=q(t),s=fg(t.converter,e);return Po(n,[ag(Tl(t.firestore),"addDoc",r._key,s,t.converter!==null,{}).toMutation(r._key,Zt.exists(!1))]).then(()=>r)}function Te(t,...e){var c,d,h;t=Re(t);let n={includeMetadataChanges:!1,source:"default"},r=0;typeof e[r]!="object"||fw(e[r])||(n=e[r++]);const s={includeMetadataChanges:n.includeMetadataChanges,source:n.source};if(fw(e[r])){const p=e[r];e[r]=(c=p.next)==null?void 0:c.bind(p),e[r+1]=(d=p.error)==null?void 0:d.bind(p),e[r+2]=(h=p.complete)==null?void 0:h.bind(p)}let i,o,a;if(t instanceof Ze)o=St(t.firestore,Dn),a=dd(t._key.path),i={next:p=>{e[r]&&e[r](FS(o,t,p))},error:e[r+1],complete:e[r+2]};else{const p=St(t,Jn);o=St(p.firestore,Dn),a=p._query;const m=new bd(o);i={next:y=>{e[r]&&e[r](new Es(o,m,p,y))},error:e[r+1],complete:e[r+2]},LS(t._query)}return function(m,y,T,b){const I=new sg(b),v=new tg(y,I,T);return m.asyncQueue.enqueueAndForget(async()=>Jm(await Cc(m),v)),()=>{I.Nu(),m.asyncQueue.enqueueAndForget(async()=>Zm(await Cc(m),v))}}(Ei(o),a,s,i)}function Po(t,e){return function(r,s){const i=new lr;return r.asyncQueue.enqueueAndForget(async()=>CD(await FD(r),s,i)),i.promise}(Ei(t),e)}function FS(t,e,n){const r=n.docs.get(e._key),s=new bd(t);return new xs(t,s,e._key,r,new qi(n.hasPendingWrites,n.fromCache),e.converter)}function $S(t){return BS(t,{count:US()})}function BS(t,e){const n=St(t.firestore,Dn),r=Ei(n),s=d2(e,(i,o)=>new G2(o,i.aggregateType,i._internalFieldPath));return qD(r,t._query,s).then(i=>function(a,c,d){const h=new bd(a);return new NS(c,h,d)}(n,t,i))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zS{constructor(e,n){this._firestore=e,this._commitHandler=n,this._mutations=[],this._committed=!1,this._dataReader=Tl(e)}set(e,n,r){this._verifyNotCommitted();const s=Oh(e,this._firestore),i=fg(s.converter,n,r),o=ag(this._dataReader,"WriteBatch.set",s._key,i,s.converter!==null,r);return this._mutations.push(o.toMutation(s._key,Zt.none())),this}update(e,n,r,...s){this._verifyNotCommitted();const i=Oh(e,this._firestore);let o;return o=typeof(n=Re(n))=="string"||n instanceof ko?kS(this._dataReader,"WriteBatch.update",i._key,n,r,s):RS(this._dataReader,"WriteBatch.update",i._key,n),this._mutations.push(o.toMutation(i._key,Zt.exists(!0))),this}delete(e){this._verifyNotCommitted();const n=Oh(e,this._firestore);return this._mutations=this._mutations.concat(new gd(n._key,Zt.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new X(U.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function Oh(t,e){if((t=Re(t)).firestore!==e)throw new X(U.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rl(){return new Sl("deleteField")}function Ce(){return new lg("serverTimestamp")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qS(t){return Ei(t=St(t,Dn)),new zS(t,e=>Po(t,e))}(function(e,n=!0){(function(s){No=s})(vi),Pn(new wn("firestore",(r,{instanceIdentifier:s,options:i})=>{const o=r.getProvider("app").getImmediate(),a=new Dn(new KP(r.getProvider("auth-internal")),new XP(o,r.getProvider("app-check-internal")),function(d,h){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new X(U.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new fo(d.options.projectId,h)}(o,s),o);return i={useFetchStreams:n,...i},a._setSettings(i),a},"PUBLIC").setMultipleInstances(!0)),$t(y_,v_,e),$t(y_,v_,"esm2020")})();const ZD=Object.freeze(Object.defineProperty({__proto__:null,AbstractUserDataWriter:MS,AggregateField:bS,AggregateQuerySnapshot:NS,Bytes:pn,CollectionReference:Rr,DocumentReference:Ze,DocumentSnapshot:xs,FieldPath:ko,FieldValue:El,Firestore:Dn,FirestoreError:X,GeoPoint:Gn,Query:Jn,QueryCompositeFilterConstraint:Td,QueryConstraint:Ed,QueryDocumentSnapshot:ba,QueryFieldFilterConstraint:bl,QueryLimitConstraint:Id,QueryOrderByConstraint:Sd,QuerySnapshot:Es,SnapshotMetadata:qi,Timestamp:We,VectorValue:Kn,WriteBatch:zS,_AutoId:od,_ByteString:bt,_DatabaseId:fo,_DocumentKey:le,_EmptyAuthCredentialsProvider:fT,_FieldPath:Et,_cast:St,_logWarn:ci,_validateIsNotUsedTogether:pT,addDoc:An,collection:ie,collectionGroup:jn,connectFirestoreEmulator:IS,count:US,deleteDoc:mt,deleteField:rl,doc:q,ensureFirestoreConfigured:Ei,executeWrite:Po,getAggregateFromServer:BS,getCountFromServer:$S,getDoc:xe,getDocs:Ge,getFirestore:Me,limit:hg,onSnapshot:Te,orderBy:It,query:we,serverTimestamp:Ce,setDoc:ze,updateDoc:Nl,where:Fe,writeBatch:qS},Symbol.toStringTag,{value:"Module"}));var eO="firebase",tO="12.1.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */$t(eO,tO,"app");const WS="@firebase/installations",pg="0.6.19";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HS=1e4,GS=`w:${pg}`,KS="FIS_v2",nO="https://firebaseinstallations.googleapis.com/v1",rO=60*60*1e3,sO="installations",iO="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oO={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},hi=new yi(sO,iO,oO);function QS(t){return t instanceof Ln&&t.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YS({projectId:t}){return`${nO}/projects/${t}/installations`}function XS(t){return{token:t.token,requestStatus:2,expiresIn:lO(t.expiresIn),creationTime:Date.now()}}async function JS(t,e){const r=(await e.json()).error;return hi.create("request-failed",{requestName:t,serverCode:r.code,serverMessage:r.message,serverStatus:r.status})}function ZS({apiKey:t}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}function aO(t,{refreshToken:e}){const n=ZS(t);return n.append("Authorization",uO(e)),n}async function eI(t){const e=await t();return e.status>=500&&e.status<600?t():e}function lO(t){return Number(t.replace("s","000"))}function uO(t){return`${KS} ${t}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function cO({appConfig:t,heartbeatServiceProvider:e},{fid:n}){const r=YS(t),s=ZS(t),i=e.getImmediate({optional:!0});if(i){const d=await i.getHeartbeatsHeader();d&&s.append("x-firebase-client",d)}const o={fid:n,authVersion:KS,appId:t.appId,sdkVersion:GS},a={method:"POST",headers:s,body:JSON.stringify(o)},c=await eI(()=>fetch(r,a));if(c.ok){const d=await c.json();return{fid:d.fid||n,registrationStatus:2,refreshToken:d.refreshToken,authToken:XS(d.authToken)}}else throw await JS("Create Installation",c)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tI(t){return new Promise(e=>{setTimeout(e,t)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dO(t){return btoa(String.fromCharCode(...t)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hO=/^[cdef][\w-]{21}$/,pp="";function fO(){try{const t=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(t),t[0]=112+t[0]%16;const n=pO(t);return hO.test(n)?n:pp}catch{return pp}}function pO(t){return dO(t).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nd(t){return`${t.appName}!${t.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nI=new Map;function rI(t,e){const n=Nd(t);sI(n,e),mO(n,e)}function sI(t,e){const n=nI.get(t);if(n)for(const r of n)r(e)}function mO(t,e){const n=gO();n&&n.postMessage({key:t,fid:e}),yO()}let Xs=null;function gO(){return!Xs&&"BroadcastChannel"in self&&(Xs=new BroadcastChannel("[Firebase] FID Change"),Xs.onmessage=t=>{sI(t.data.key,t.data.fid)}),Xs}function yO(){nI.size===0&&Xs&&(Xs.close(),Xs=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vO="firebase-installations-database",_O=1,fi="firebase-installations-store";let Lh=null;function mg(){return Lh||(Lh=nd(vO,_O,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(fi)}}})),Lh}async function kc(t,e){const n=Nd(t),s=(await mg()).transaction(fi,"readwrite"),i=s.objectStore(fi),o=await i.get(n);return await i.put(e,n),await s.done,(!o||o.fid!==e.fid)&&rI(t,e.fid),e}async function iI(t){const e=Nd(t),r=(await mg()).transaction(fi,"readwrite");await r.objectStore(fi).delete(e),await r.done}async function Ad(t,e){const n=Nd(t),s=(await mg()).transaction(fi,"readwrite"),i=s.objectStore(fi),o=await i.get(n),a=e(o);return a===void 0?await i.delete(n):await i.put(a,n),await s.done,a&&(!o||o.fid!==a.fid)&&rI(t,a.fid),a}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function gg(t){let e;const n=await Ad(t.appConfig,r=>{const s=wO(r),i=xO(t,s);return e=i.registrationPromise,i.installationEntry});return n.fid===pp?{installationEntry:await e}:{installationEntry:n,registrationPromise:e}}function wO(t){const e=t||{fid:fO(),registrationStatus:0};return oI(e)}function xO(t,e){if(e.registrationStatus===0){if(!navigator.onLine){const s=Promise.reject(hi.create("app-offline"));return{installationEntry:e,registrationPromise:s}}const n={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},r=EO(t,n);return{installationEntry:n,registrationPromise:r}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:TO(t)}:{installationEntry:e}}async function EO(t,e){try{const n=await cO(t,e);return kc(t.appConfig,n)}catch(n){throw QS(n)&&n.customData.serverCode===409?await iI(t.appConfig):await kc(t.appConfig,{fid:e.fid,registrationStatus:0}),n}}async function TO(t){let e=await gw(t.appConfig);for(;e.registrationStatus===1;)await tI(100),e=await gw(t.appConfig);if(e.registrationStatus===0){const{installationEntry:n,registrationPromise:r}=await gg(t);return r||n}return e}function gw(t){return Ad(t,e=>{if(!e)throw hi.create("installation-not-found");return oI(e)})}function oI(t){return SO(t)?{fid:t.fid,registrationStatus:0}:t}function SO(t){return t.registrationStatus===1&&t.registrationTime+HS<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function IO({appConfig:t,heartbeatServiceProvider:e},n){const r=bO(t,n),s=aO(t,n),i=e.getImmediate({optional:!0});if(i){const d=await i.getHeartbeatsHeader();d&&s.append("x-firebase-client",d)}const o={installation:{sdkVersion:GS,appId:t.appId}},a={method:"POST",headers:s,body:JSON.stringify(o)},c=await eI(()=>fetch(r,a));if(c.ok){const d=await c.json();return XS(d)}else throw await JS("Generate Auth Token",c)}function bO(t,{fid:e}){return`${YS(t)}/${e}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function yg(t,e=!1){let n;const r=await Ad(t.appConfig,i=>{if(!aI(i))throw hi.create("not-registered");const o=i.authToken;if(!e&&CO(o))return i;if(o.requestStatus===1)return n=NO(t,e),i;{if(!navigator.onLine)throw hi.create("app-offline");const a=kO(i);return n=AO(t,a),a}});return n?await n:r.authToken}async function NO(t,e){let n=await yw(t.appConfig);for(;n.authToken.requestStatus===1;)await tI(100),n=await yw(t.appConfig);const r=n.authToken;return r.requestStatus===0?yg(t,e):r}function yw(t){return Ad(t,e=>{if(!aI(e))throw hi.create("not-registered");const n=e.authToken;return PO(n)?{...e,authToken:{requestStatus:0}}:e})}async function AO(t,e){try{const n=await IO(t,e),r={...e,authToken:n};return await kc(t.appConfig,r),n}catch(n){if(QS(n)&&(n.customData.serverCode===401||n.customData.serverCode===404))await iI(t.appConfig);else{const r={...e,authToken:{requestStatus:0}};await kc(t.appConfig,r)}throw n}}function aI(t){return t!==void 0&&t.registrationStatus===2}function CO(t){return t.requestStatus===2&&!RO(t)}function RO(t){const e=Date.now();return e<t.creationTime||t.creationTime+t.expiresIn<e+rO}function kO(t){const e={requestStatus:1,requestTime:Date.now()};return{...t,authToken:e}}function PO(t){return t.requestStatus===1&&t.requestTime+HS<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function jO(t){const e=t,{installationEntry:n,registrationPromise:r}=await gg(e);return r?r.catch(console.error):yg(e).catch(console.error),n.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function DO(t,e=!1){const n=t;return await OO(n),(await yg(n,e)).token}async function OO(t){const{registrationPromise:e}=await gg(t);e&&await e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LO(t){if(!t||!t.options)throw Vh("App Configuration");if(!t.name)throw Vh("App Name");const e=["projectId","apiKey","appId"];for(const n of e)if(!t.options[n])throw Vh(n);return{appName:t.name,projectId:t.options.projectId,apiKey:t.options.apiKey,appId:t.options.appId}}function Vh(t){return hi.create("missing-app-config-values",{valueName:t})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lI="installations",VO="installations-internal",MO=t=>{const e=t.getProvider("app").getImmediate(),n=LO(e),r=Os(e,"heartbeat");return{app:e,appConfig:n,heartbeatServiceProvider:r,_delete:()=>Promise.resolve()}},UO=t=>{const e=t.getProvider("app").getImmediate(),n=Os(e,lI).getImmediate();return{getId:()=>jO(n),getToken:s=>DO(n,s)}};function FO(){Pn(new wn(lI,MO,"PUBLIC")),Pn(new wn(VO,UO,"PRIVATE"))}FO();$t(WS,pg);$t(WS,pg,"esm2020");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $O="/firebase-messaging-sw.js",BO="/firebase-cloud-messaging-push-scope",uI="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",zO="https://fcmregistrations.googleapis.com/v1",cI="google.c.a.c_id",qO="google.c.a.c_l",WO="google.c.a.ts",HO="google.c.a.e",vw=1e4;var _w;(function(t){t[t.DATA_MESSAGE=1]="DATA_MESSAGE",t[t.DISPLAY_NOTIFICATION=3]="DISPLAY_NOTIFICATION"})(_w||(_w={}));/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file except
 * in compliance with the License. You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software distributed under the License
 * is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express
 * or implied. See the License for the specific language governing permissions and limitations under
 * the License.
 */var sl;(function(t){t.PUSH_RECEIVED="push-received",t.NOTIFICATION_CLICKED="notification-clicked"})(sl||(sl={}));/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wr(t){const e=new Uint8Array(t);return btoa(String.fromCharCode(...e)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function GO(t){const e="=".repeat((4-t.length%4)%4),n=(t+e).replace(/\-/g,"+").replace(/_/g,"/"),r=atob(n),s=new Uint8Array(r.length);for(let i=0;i<r.length;++i)s[i]=r.charCodeAt(i);return s}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mh="fcm_token_details_db",KO=5,ww="fcm_token_object_Store";async function QO(t){if("databases"in indexedDB&&!(await indexedDB.databases()).map(i=>i.name).includes(Mh))return null;let e=null;return(await nd(Mh,KO,{upgrade:async(r,s,i,o)=>{if(s<2||!r.objectStoreNames.contains(ww))return;const a=o.objectStore(ww),c=await a.index("fcmSenderId").get(t);if(await a.clear(),!!c){if(s===2){const d=c;if(!d.auth||!d.p256dh||!d.endpoint)return;e={token:d.fcmToken,createTime:d.createTime??Date.now(),subscriptionOptions:{auth:d.auth,p256dh:d.p256dh,endpoint:d.endpoint,swScope:d.swScope,vapidKey:typeof d.vapidKey=="string"?d.vapidKey:wr(d.vapidKey)}}}else if(s===3){const d=c;e={token:d.fcmToken,createTime:d.createTime,subscriptionOptions:{auth:wr(d.auth),p256dh:wr(d.p256dh),endpoint:d.endpoint,swScope:d.swScope,vapidKey:wr(d.vapidKey)}}}else if(s===4){const d=c;e={token:d.fcmToken,createTime:d.createTime,subscriptionOptions:{auth:wr(d.auth),p256dh:wr(d.p256dh),endpoint:d.endpoint,swScope:d.swScope,vapidKey:wr(d.vapidKey)}}}}}})).close(),await Ih(Mh),await Ih("fcm_vapid_details_db"),await Ih("undefined"),YO(e)?e:null}function YO(t){if(!t||!t.subscriptionOptions)return!1;const{subscriptionOptions:e}=t;return typeof t.createTime=="number"&&t.createTime>0&&typeof t.token=="string"&&t.token.length>0&&typeof e.auth=="string"&&e.auth.length>0&&typeof e.p256dh=="string"&&e.p256dh.length>0&&typeof e.endpoint=="string"&&e.endpoint.length>0&&typeof e.swScope=="string"&&e.swScope.length>0&&typeof e.vapidKey=="string"&&e.vapidKey.length>0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XO="firebase-messaging-database",JO=1,il="firebase-messaging-store";let Uh=null;function dI(){return Uh||(Uh=nd(XO,JO,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(il)}}})),Uh}async function ZO(t){const e=hI(t),r=await(await dI()).transaction(il).objectStore(il).get(e);if(r)return r;{const s=await QO(t.appConfig.senderId);if(s)return await vg(t,s),s}}async function vg(t,e){const n=hI(t),s=(await dI()).transaction(il,"readwrite");return await s.objectStore(il).put(e,n),await s.done,e}function hI({appConfig:t}){return t.appId}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eL={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."},Bt=new yi("messaging","Messaging",eL);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function tL(t,e){const n=await wg(t),r=fI(e),s={method:"POST",headers:n,body:JSON.stringify(r)};let i;try{i=await(await fetch(_g(t.appConfig),s)).json()}catch(o){throw Bt.create("token-subscribe-failed",{errorInfo:o==null?void 0:o.toString()})}if(i.error){const o=i.error.message;throw Bt.create("token-subscribe-failed",{errorInfo:o})}if(!i.token)throw Bt.create("token-subscribe-no-token");return i.token}async function nL(t,e){const n=await wg(t),r=fI(e.subscriptionOptions),s={method:"PATCH",headers:n,body:JSON.stringify(r)};let i;try{i=await(await fetch(`${_g(t.appConfig)}/${e.token}`,s)).json()}catch(o){throw Bt.create("token-update-failed",{errorInfo:o==null?void 0:o.toString()})}if(i.error){const o=i.error.message;throw Bt.create("token-update-failed",{errorInfo:o})}if(!i.token)throw Bt.create("token-update-no-token");return i.token}async function rL(t,e){const r={method:"DELETE",headers:await wg(t)};try{const i=await(await fetch(`${_g(t.appConfig)}/${e}`,r)).json();if(i.error){const o=i.error.message;throw Bt.create("token-unsubscribe-failed",{errorInfo:o})}}catch(s){throw Bt.create("token-unsubscribe-failed",{errorInfo:s==null?void 0:s.toString()})}}function _g({projectId:t}){return`${zO}/projects/${t}/registrations`}async function wg({appConfig:t,installations:e}){const n=await e.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t.apiKey,"x-goog-firebase-installations-auth":`FIS ${n}`})}function fI({p256dh:t,auth:e,endpoint:n,vapidKey:r}){const s={web:{endpoint:n,auth:e,p256dh:t}};return r!==uI&&(s.web.applicationPubKey=r),s}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sL=7*24*60*60*1e3;async function iL(t){const e=await aL(t.swRegistration,t.vapidKey),n={vapidKey:t.vapidKey,swScope:t.swRegistration.scope,endpoint:e.endpoint,auth:wr(e.getKey("auth")),p256dh:wr(e.getKey("p256dh"))},r=await ZO(t.firebaseDependencies);if(r){if(lL(r.subscriptionOptions,n))return Date.now()>=r.createTime+sL?oL(t,{token:r.token,createTime:Date.now(),subscriptionOptions:n}):r.token;try{await rL(t.firebaseDependencies,r.token)}catch(s){console.warn(s)}return xw(t.firebaseDependencies,n)}else return xw(t.firebaseDependencies,n)}async function oL(t,e){try{const n=await nL(t.firebaseDependencies,e),r={...e,token:n,createTime:Date.now()};return await vg(t.firebaseDependencies,r),n}catch(n){throw n}}async function xw(t,e){const r={token:await tL(t,e),createTime:Date.now(),subscriptionOptions:e};return await vg(t,r),r.token}async function aL(t,e){const n=await t.pushManager.getSubscription();return n||t.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:GO(e)})}function lL(t,e){const n=e.vapidKey===t.vapidKey,r=e.endpoint===t.endpoint,s=e.auth===t.auth,i=e.p256dh===t.p256dh;return n&&r&&s&&i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ew(t){const e={from:t.from,collapseKey:t.collapse_key,messageId:t.fcmMessageId};return uL(e,t),cL(e,t),dL(e,t),e}function uL(t,e){if(!e.notification)return;t.notification={};const n=e.notification.title;n&&(t.notification.title=n);const r=e.notification.body;r&&(t.notification.body=r);const s=e.notification.image;s&&(t.notification.image=s);const i=e.notification.icon;i&&(t.notification.icon=i)}function cL(t,e){e.data&&(t.data=e.data)}function dL(t,e){var s,i,o,a;if(!e.fcmOptions&&!((s=e.notification)!=null&&s.click_action))return;t.fcmOptions={};const n=((i=e.fcmOptions)==null?void 0:i.link)??((o=e.notification)==null?void 0:o.click_action);n&&(t.fcmOptions.link=n);const r=(a=e.fcmOptions)==null?void 0:a.analytics_label;r&&(t.fcmOptions.analyticsLabel=r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hL(t){return typeof t=="object"&&!!t&&cI in t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fL(t){if(!t||!t.options)throw Fh("App Configuration Object");if(!t.name)throw Fh("App Name");const e=["projectId","apiKey","appId","messagingSenderId"],{options:n}=t;for(const r of e)if(!n[r])throw Fh(r);return{appName:t.name,projectId:n.projectId,apiKey:n.apiKey,appId:n.appId,senderId:n.messagingSenderId}}function Fh(t){return Bt.create("missing-app-config-values",{valueName:t})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pL{constructor(e,n,r){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;const s=fL(e);this.firebaseDependencies={app:e,appConfig:s,installations:n,analyticsProvider:r}}_delete(){return Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function mL(t){try{t.swRegistration=await navigator.serviceWorker.register($O,{scope:BO}),t.swRegistration.update().catch(()=>{}),await gL(t.swRegistration)}catch(e){throw Bt.create("failed-service-worker-registration",{browserErrorMessage:e==null?void 0:e.message})}}async function gL(t){return new Promise((e,n)=>{const r=setTimeout(()=>n(new Error(`Service worker not registered after ${vw} ms`)),vw),s=t.installing||t.waiting;t.active?(clearTimeout(r),e()):s?s.onstatechange=i=>{var o;((o=i.target)==null?void 0:o.state)==="activated"&&(s.onstatechange=null,clearTimeout(r),e())}:(clearTimeout(r),n(new Error("No incoming service worker found.")))})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function yL(t,e){if(!e&&!t.swRegistration&&await mL(t),!(!e&&t.swRegistration)){if(!(e instanceof ServiceWorkerRegistration))throw Bt.create("invalid-sw-registration");t.swRegistration=e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vL(t,e){e?t.vapidKey=e:t.vapidKey||(t.vapidKey=uI)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function pI(t,e){if(!navigator)throw Bt.create("only-available-in-window");if(Notification.permission==="default"&&await Notification.requestPermission(),Notification.permission!=="granted")throw Bt.create("permission-blocked");return await vL(t,e==null?void 0:e.vapidKey),await yL(t,e==null?void 0:e.serviceWorkerRegistration),iL(t)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _L(t,e,n){const r=wL(e);(await t.firebaseDependencies.analyticsProvider.get()).logEvent(r,{message_id:n[cI],message_name:n[qO],message_time:n[WO],message_device_time:Math.floor(Date.now()/1e3)})}function wL(t){switch(t){case sl.NOTIFICATION_CLICKED:return"notification_open";case sl.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function xL(t,e){const n=e.data;if(!n.isFirebaseMessaging)return;t.onMessageHandler&&n.messageType===sl.PUSH_RECEIVED&&(typeof t.onMessageHandler=="function"?t.onMessageHandler(Ew(n)):t.onMessageHandler.next(Ew(n)));const r=n.data;hL(r)&&r[HO]==="1"&&await _L(t,n.messageType,r)}const Tw="@firebase/messaging",Sw="0.12.23";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EL=t=>{const e=new pL(t.getProvider("app").getImmediate(),t.getProvider("installations-internal").getImmediate(),t.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",n=>xL(e,n)),e},TL=t=>{const e=t.getProvider("messaging").getImmediate();return{getToken:r=>pI(e,r)}};function SL(){Pn(new wn("messaging",EL,"PUBLIC")),Pn(new wn("messaging-internal",TL,"PRIVATE")),$t(Tw,Sw),$t(Tw,Sw,"esm2020")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function mI(){try{await y0()}catch{return!1}return typeof window<"u"&&g0()&&f1()&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IL(t,e){if(!navigator)throw Bt.create("only-available-in-window");return t.onMessageHandler=e,()=>{t.onMessageHandler=null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bL(t=Io()){return mI().then(e=>{if(!e)throw Bt.create("unsupported-browser")},e=>{throw Bt.create("indexed-db-unsupported")}),Os(Re(t),"messaging").getImmediate()}async function NL(t,e){return t=Re(t),pI(t,e)}function AL(t,e){return t=Re(t),IL(t,e)}SL();const xg={apiKey:"AIzaSyAvTkBdah-m0JBKF2hPh2ra95ZrFfFXPZs",authDomain:"immanuel-app.firebaseapp.com",projectId:"immanuel-app",storageBucket:"immanuel-app.firebasestorage.app",messagingSenderId:"815824103273",appId:"1:815824103273:web:3817385bebff5f704a3ff8",measurementId:"G-P6WR1NQRB8"};function CL(t){const e=Object.entries(t).filter(([,n])=>!n||String(n).trim()==="").map(([n])=>n);if(e.length){const n=Object.fromEntries(Object.entries(t).map(([r,s])=>[r,s&&(typeof s=="string"?s.slice(0,6)+"":s)]));throw console.error("[firebase] Missing config keys:",e,`
Loaded values:`,n),new Error("Firebase configuration is incomplete. Missing: "+e.join(", "))}}CL(xg);const te=vR().length?Io():w0(xg),vo=Ue(te),dt=Me(te),RL=new bn;RL.setCustomParameters({prompt:"select_account"});typeof window<"u"&&(window.__FIREBASE_CONFIG__=xg);async function Cd(){try{return await mI()?bL(te):null}catch{return null}}const gI=R.createContext(void 0);function kL({children:t}){const e=R.useMemo(()=>Ue(te),[]),n=R.useMemo(()=>Me(te),[]),[r,s]=R.useState(e.currentUser),[i,o]=R.useState(!0),[a,c]=R.useState(!1);async function d(b){var I;if(!b){c(!1);return}try{const v=b.uid,_=((I=(await xe(q(n,"users",v))).data())==null?void 0:I.isSuperAdmin)===!0;let E=!1;try{const j=we(jn(n,"groupAdmins"),Fe("uid","==",v));E=!(await Ge(j)).empty}catch{E=!1}c(_||E)}catch{c(!1)}}R.useEffect(()=>{const b=Vn(e,async I=>{s(I),await d(I),o(!1)});return()=>b()},[e]),R.useEffect(()=>{if(!r)return;const b=r.uid,I=Te(q(n,"users",b),()=>d(r)),v=we(jn(n,"groupAdmins"),Fe("uid","==",b)),w=Te(v,()=>d(r));return()=>{I(),w()}},[r,n]);const h=async(b,I)=>{await W0(e,b,I),await d(e.currentUser)},p=async()=>{const b=new bn;await Rm(e,b),await d(e.currentUser)},m=async()=>{await G0(e),c(!1)},y=async()=>{await d(e.currentUser)},T=R.useMemo(()=>({user:r,loading:i,isAdmin:a,login:h,signInWithGoogle:p,logout:m,refresh:y}),[r,i,a]);return u.jsx(gI.Provider,{value:T,children:t})}function Ti(){const t=R.useContext(gI);if(!t)throw new Error("useAuth must be used within AuthProvider");return t}function pr({label:t="Loading..."}){return u.jsxs("div",{className:"flex items-center gap-3 text-slate-500 py-6",children:[u.jsxs("svg",{className:"animate-spin h-5 w-5",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[u.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),u.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"})]}),u.jsx("span",{children:t})]})}function Kt({children:t}){const e=Ue(te),[n,r]=H.useState(!1),[s,i]=H.useState(e.currentUser);return H.useEffect(()=>{const o=Vn(e,a=>{i(a),r(!0)});return()=>o()},[e]),n?s?u.jsx(u.Fragment,{children:t}):u.jsx(Nr,{to:"/login",replace:!0}):u.jsx("div",{className:"max-w-xl mx-auto p-6",children:u.jsx(pr,{label:"Checking authentication"})})}function PL(){var a;const t=Ue(te),e=Me(te),[n,r]=R.useState(!0),[s,i]=R.useState(null),o=(a=t.currentUser)==null?void 0:a.uid;return R.useEffect(()=>{let c=!0;async function d(){if(!o){i(null),r(!1);return}r(!0);try{const h=q(e,"users",o),p=await xe(h);if(p.exists()){if(!c)return;i(p.data()||{})}else{await ze(h,{createdAt:Ce()},{merge:!0});const m=await xe(h);if(!c)return;i(m.data()||{})}}finally{r(!1)}}return d(),()=>{c=!1}},[e,o]),{loading:n,profile:s,uid:o}}function jL(t){return t?!!(t.displayName&&String(t.displayName).trim().length>1):!1}function gt({children:t}){const e=Ue(te),{loading:n,profile:r}=PL(),[s,i]=H.useState(!1),o=e.currentUser,a=On();if(R.useEffect(()=>{const h=Vn(e,()=>i(!0));return()=>h()},[e]),!s||n)return u.jsx("div",{className:"max-w-xl mx-auto p-6",children:u.jsx(pr,{label:"Loading your profile"})});if(!o)return u.jsx(Nr,{to:"/login",replace:!0});const c=jL(r),d=a.pathname==="/welcome";return!c&&!d?u.jsx(Nr,{to:"/welcome",replace:!0}):c&&d?u.jsx(Nr,{to:"/dashboard",replace:!0}):u.jsx(u.Fragment,{children:t})}function DL({label:t="Checking admin access"}){return u.jsx("div",{className:"max-w-xl mx-auto p-6 text-slate-700",children:t})}function Bs({children:t}){const e=Ue(te),n=Me(te),[r,s]=H.useState(!1),[i,o]=H.useState(null),[a,c]=H.useState(null);return H.useEffect(()=>{const d=Vn(e,async h=>{var p;if(s(!0),!h){o(!1);return}try{if(((p=(await xe(q(n,"users",h.uid))).data())==null?void 0:p.isSuperAdmin)===!0)o(!0);else{const T=await Ge(we(ie(n,"users"),Fe("isSuperAdmin","==",!0),hg(1)));o(T.empty)}}catch(m){c((m==null?void 0:m.message)||String(m)),o(!1)}});return()=>d()},[e,n]),!r||i===null?u.jsx(DL,{}):e.currentUser?i?u.jsx(u.Fragment,{children:t}):u.jsx(Nr,{to:"/dashboard",replace:!0}):u.jsx(Nr,{to:"/login",replace:!0})}function OL({label:t="Checking access"}){return u.jsx("div",{className:"max-w-xl mx-auto p-6 text-slate-700",children:t})}function $h({children:t}){const{slug:e}=Ds(),n=e,r=Ue(te),s=Me(te),[i,o]=H.useState(!1),[a,c]=H.useState(null);return H.useEffect(()=>{const d=Vn(r,async h=>{var p;if(o(!0),!h||!n){c(!1);return}try{if(((p=(await xe(q(s,"users",h.uid))).data())==null?void 0:p.isSuperAdmin)===!0){c(!0);return}const y=await xe(q(s,`groups/${n}/groupAdmins/${h.uid}`));c(y.exists())}catch{c(!1)}});return()=>d()},[r,s,n]),!i||a===null?u.jsx(OL,{}):a?u.jsx(u.Fragment,{children:t}):u.jsx(Nr,{to:"/dashboard",replace:!0})}function yI({group:t,isMember:e,footer:n}){const r=t.name||t.title||Iw(t.id),s=t.description||"",i=t.parent?`Parent: ${Iw(t.parent)}`:null;return u.jsxs("div",{className:"rounded-xl border border-border bg-card p-4 flex flex-col justify-between shadow-sm",children:[u.jsxs("div",{children:[u.jsxs("div",{className:"flex items-start justify-between gap-2",children:[u.jsx("h3",{className:"text-lg font-semibold text-accent",children:r}),e?u.jsx(_e,{to:`/groups/${t.id}`,className:"inline-flex items-center rounded-lg bg-slate-900 text-white px-3 py-1.5 text-sm hover:bg-slate-800",children:"View"}):u.jsx("button",{type:"button",disabled:!0,className:"inline-flex items-center rounded-lg bg-slate-200 text-slate-500 px-3 py-1.5 text-sm cursor-not-allowed",title:"Join this group to view",children:"View"})]}),i&&u.jsx("p",{className:"text-xs text-text2 mt-1",children:i}),s&&u.jsx("p",{className:"text-sm text-text2 mt-3",children:s})]}),n&&u.jsx("div",{className:"mt-4 flex items-center gap-2",children:n})]})}function Iw(t){return t.replace(/[-_]/g," ").replace(/\b\w/g,e=>e.toUpperCase())}function LL({groupId:t,className:e=""}){var m;const n=R.useMemo(()=>Ue(te),[]),r=R.useMemo(()=>Me(te),[]),[s,i]=R.useState("checking"),[o,a]=R.useState(((m=n.currentUser)==null?void 0:m.uid)??null),[c,d]=R.useState(!1);R.useEffect(()=>{const y=Vn(n,T=>{a((T==null?void 0:T.uid)??null)});return()=>y()},[n]),R.useEffect(()=>{let y=!0;async function T(){if(!o){i("none");return}try{const b=await xe(q(r,`users/${o}/memberships/${t}`));if(!y)return;if(b.exists()){i("member");return}const I=ie(r,`users/${o}/memberships`),v=we(I,Fe("groupId","==",t)),w=await Ge(v);if(!y)return;if(!w.empty){i("member");return}const _=await xe(q(r,`users/${o}/membershipRequests/${t}`));if(!y)return;i(_.exists()?"pending":"none")}catch(b){console.warn("Unable to determine membership status; defaulting to 'none'.",b),y&&i("none")}}return T(),()=>{y=!1}},[r,o,t]);async function h(){var y,T;if(o){d(!0);try{let b=((y=n.currentUser)==null?void 0:y.displayName)||"";try{const I=await xe(q(r,`users/${o}`));I.exists()&&(b=((T=I.data())==null?void 0:T.displayName)||b)}catch{}await ze(q(r,`users/${o}/membershipRequests/${t}`),{groupId:t,requestedAt:Ce(),displayName:b},{merge:!0}),i("pending");try{await ze(q(r,`groups/${t}/membershipRequests/${o}`),{uid:o,requestedAt:Ce(),displayName:b},{merge:!0})}catch(I){console.warn("Could not mirror to group joinRequests; ensure rules allow create.",I)}}finally{d(!1)}}}async function p(){if(o){d(!0);try{await mt(q(r,`users/${o}/membershipRequests/${t}`));try{await mt(q(r,`groups/${t}/membershipRequests/${o}`))}catch{}i("none")}finally{d(!1)}}}return s==="checking"?u.jsx("button",{className:`text-xs px-3 py-1.5 rounded-lg border border-border bg-muted text-text2 ${e}`,disabled:!0,children:"Checking"}):s==="member"?u.jsx("button",{className:`text-xs px-3 py-1.5 rounded-lg border border-border bg-muted text-text2 ${e}`,disabled:!0,children:"Member"}):s==="pending"?u.jsx("button",{onClick:p,className:`text-xs px-3 py-1.5 rounded-lg bg-slate-100 text-slate-900 hover:bg-slate-200 disabled:opacity-60 ${e}`,disabled:c,title:"Click to cancel your join request",children:"Pending  Cancel"}):u.jsx("button",{onClick:h,className:`text-xs px-3 py-1.5 rounded-lg bg-slate-100 text-slate-900 hover:bg-slate-200 disabled:opacity-60 ${e}`,disabled:c||!o,title:o?void 0:"Sign in to request",children:"Request to Join"})}function VL(){const t=R.useMemo(()=>Me(te),[]),e=Ue(te),[n,r]=R.useState([]),[s,i]=R.useState(new Set),[o,a]=R.useState(!0);R.useEffect(()=>{let d=!1;async function h(){try{const m=(await Ge(we(ie(t,"groups"),It("name")))).docs.map(y=>({id:y.id,...y.data()}));if(d||r(m),e.currentUser){const y=e.currentUser.uid,T=await Ge(ie(t,`users/${y}/memberships`));d||i(new Set(T.docs.map(b=>b.id)))}}finally{d||a(!1)}}return h(),()=>{d=!0}},[t,e.currentUser]);const c=R.useMemo(()=>n.filter(d=>!s.has(d.id)),[n,s]);return o?u.jsx("div",{className:"container py-8",children:u.jsx("div",{className:"max-w-5xl mx-auto p-6",children:u.jsx(pr,{label:"Loading groups"})})}):u.jsx("div",{className:"container py-8 md:py-12",children:u.jsxs("div",{className:"max-w-5xl mx-auto",children:[u.jsx("h1",{className:"text-2xl font-semibold text-accent mb-4",children:"Explore Groups"}),c.length>0?u.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:c.map(d=>u.jsx(yI,{group:d,isMember:!1,footer:u.jsx(LL,{groupId:d.id})},d.id))}):u.jsx("div",{className:"rounded-xl border border-border bg-card p-6",children:u.jsx("p",{className:"text-text2",children:"Youve already joined all available groups."})})]})})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vI="firebasestorage.googleapis.com",_I="storageBucket",ML=2*60*1e3,UL=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class at extends Ln{constructor(e,n,r=0){super(Bh(e),`Firebase Storage: ${n} (${Bh(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,at.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Bh(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var ot;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(ot||(ot={}));function Bh(t){return"storage/"+t}function Eg(){const t="An unknown error occurred, please check the error payload for server response.";return new at(ot.UNKNOWN,t)}function FL(t){return new at(ot.OBJECT_NOT_FOUND,"Object '"+t+"' does not exist.")}function $L(t){return new at(ot.QUOTA_EXCEEDED,"Quota for bucket '"+t+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function BL(){const t="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new at(ot.UNAUTHENTICATED,t)}function zL(){return new at(ot.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function qL(t){return new at(ot.UNAUTHORIZED,"User does not have permission to access '"+t+"'.")}function WL(){return new at(ot.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function HL(){return new at(ot.CANCELED,"User canceled the upload/download.")}function GL(t){return new at(ot.INVALID_URL,"Invalid URL '"+t+"'.")}function KL(t){return new at(ot.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function QL(){return new at(ot.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+_I+"' property when initializing the app?")}function YL(){return new at(ot.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function XL(){return new at(ot.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function JL(t){return new at(ot.UNSUPPORTED_ENVIRONMENT,`${t} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function mp(t){return new at(ot.INVALID_ARGUMENT,t)}function wI(){return new at(ot.APP_DELETED,"The Firebase app was deleted.")}function ZL(t){return new at(ot.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function Na(t,e){return new at(ot.INVALID_FORMAT,"String does not match format '"+t+"': "+e)}function ta(t){throw new at(ot.INTERNAL_ERROR,"Internal error: "+t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yn{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let r;try{r=yn.makeFromUrl(e,n)}catch{return new yn(e,"")}if(r.path==="")return r;throw KL(e)}static makeFromUrl(e,n){let r=null;const s="([A-Za-z0-9.\\-_]+)";function i(E){E.path.charAt(E.path.length-1)==="/"&&(E.path_=E.path_.slice(0,-1))}const o="(/(.*))?$",a=new RegExp("^gs://"+s+o,"i"),c={bucket:1,path:3};function d(E){E.path_=decodeURIComponent(E.path)}const h="v[A-Za-z0-9_]+",p=n.replace(/[.]/g,"\\."),m="(/([^?#]*).*)?$",y=new RegExp(`^https?://${p}/${h}/b/${s}/o${m}`,"i"),T={bucket:1,path:3},b=n===vI?"(?:storage.googleapis.com|storage.cloud.google.com)":n,I="([^?#]*)",v=new RegExp(`^https?://${b}/${s}/${I}`,"i"),_=[{regex:a,indices:c,postModify:i},{regex:y,indices:T,postModify:d},{regex:v,indices:{bucket:1,path:2},postModify:d}];for(let E=0;E<_.length;E++){const j=_[E],O=j.regex.exec(e);if(O){const S=O[j.indices.bucket];let x=O[j.indices.path];x||(x=""),r=new yn(S,x),j.postModify(r);break}}if(r==null)throw GL(e);return r}}class eV{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tV(t,e,n){let r=1,s=null,i=null,o=!1,a=0;function c(){return a===2}let d=!1;function h(...I){d||(d=!0,e.apply(null,I))}function p(I){s=setTimeout(()=>{s=null,t(y,c())},I)}function m(){i&&clearTimeout(i)}function y(I,...v){if(d){m();return}if(I){m(),h.call(null,I,...v);return}if(c()||o){m(),h.call(null,I,...v);return}r<64&&(r*=2);let _;a===1?(a=2,_=0):_=(r+Math.random())*1e3,p(_)}let T=!1;function b(I){T||(T=!0,m(),!d&&(s!==null?(I||(a=2),clearTimeout(s),p(0)):I||(a=1)))}return p(0),i=setTimeout(()=>{o=!0,b(!0)},n),b}function nV(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rV(t){return t!==void 0}function sV(t){return typeof t=="object"&&!Array.isArray(t)}function Tg(t){return typeof t=="string"||t instanceof String}function bw(t){return Sg()&&t instanceof Blob}function Sg(){return typeof Blob<"u"}function Nw(t,e,n,r){if(r<e)throw mp(`Invalid value for '${t}'. Expected ${e} or greater.`);if(r>n)throw mp(`Invalid value for '${t}'. Expected ${n} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ig(t,e,n){let r=e;return n==null&&(r=`https://${e}`),`${n}://${r}/v0${t}`}function xI(t){const e=encodeURIComponent;let n="?";for(const r in t)if(t.hasOwnProperty(r)){const s=e(r)+"="+e(t[r]);n=n+s+"&"}return n=n.slice(0,-1),n}var ei;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(ei||(ei={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iV(t,e){const n=t>=500&&t<600,s=[408,429].indexOf(t)!==-1,i=e.indexOf(t)!==-1;return n||s||i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oV{constructor(e,n,r,s,i,o,a,c,d,h,p,m=!0,y=!1){this.url_=e,this.method_=n,this.headers_=r,this.body_=s,this.successCodes_=i,this.additionalRetryCodes_=o,this.callback_=a,this.errorCallback_=c,this.timeout_=d,this.progressCallback_=h,this.connectionFactory_=p,this.retry=m,this.isUsingEmulator=y,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((T,b)=>{this.resolve_=T,this.reject_=b,this.start_()})}start_(){const e=(r,s)=>{if(s){r(!1,new mu(!1,null,!0));return}const i=this.connectionFactory_();this.pendingConnection_=i;const o=a=>{const c=a.loaded,d=a.lengthComputable?a.total:-1;this.progressCallback_!==null&&this.progressCallback_(c,d)};this.progressCallback_!==null&&i.addUploadProgressListener(o),i.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&i.removeUploadProgressListener(o),this.pendingConnection_=null;const a=i.getErrorCode()===ei.NO_ERROR,c=i.getStatus();if(!a||iV(c,this.additionalRetryCodes_)&&this.retry){const h=i.getErrorCode()===ei.ABORT;r(!1,new mu(!1,null,h));return}const d=this.successCodes_.indexOf(c)!==-1;r(!0,new mu(d,i))})},n=(r,s)=>{const i=this.resolve_,o=this.reject_,a=s.connection;if(s.wasSuccessCode)try{const c=this.callback_(a,a.getResponse());rV(c)?i(c):i()}catch(c){o(c)}else if(a!==null){const c=Eg();c.serverResponse=a.getErrorText(),this.errorCallback_?o(this.errorCallback_(a,c)):o(c)}else if(s.canceled){const c=this.appDelete_?wI():HL();o(c)}else{const c=WL();o(c)}};this.canceled_?n(!1,new mu(!1,null,!0)):this.backoffId_=tV(e,n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&nV(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class mu{constructor(e,n,r){this.wasSuccessCode=e,this.connection=n,this.canceled=!!r}}function aV(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function lV(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function uV(t,e){e&&(t["X-Firebase-GMPID"]=e)}function cV(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function dV(t,e,n,r,s,i,o=!0,a=!1){const c=xI(t.urlParams),d=t.url+c,h=Object.assign({},t.headers);return uV(h,e),aV(h,n),lV(h,i),cV(h,r),new oV(d,t.method,h,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,s,o,a)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hV(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function fV(...t){const e=hV();if(e!==void 0){const n=new e;for(let r=0;r<t.length;r++)n.append(t[r]);return n.getBlob()}else{if(Sg())return new Blob(t);throw new at(ot.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function pV(t,e,n){return t.webkitSlice?t.webkitSlice(e,n):t.mozSlice?t.mozSlice(e,n):t.slice?t.slice(e,n):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mV(t){if(typeof atob>"u")throw JL("base-64");return atob(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sr={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class zh{constructor(e,n){this.data=e,this.contentType=n||null}}function gV(t,e){switch(t){case sr.RAW:return new zh(EI(e));case sr.BASE64:case sr.BASE64URL:return new zh(TI(t,e));case sr.DATA_URL:return new zh(vV(e),_V(e))}throw Eg()}function EI(t){const e=[];for(let n=0;n<t.length;n++){let r=t.charCodeAt(n);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|r&63);else if((r&64512)===55296)if(!(n<t.length-1&&(t.charCodeAt(n+1)&64512)===56320))e.push(239,191,189);else{const i=r,o=t.charCodeAt(++n);r=65536|(i&1023)<<10|o&1023,e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|r&63)}else(r&64512)===56320?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|r&63)}return new Uint8Array(e)}function yV(t){let e;try{e=decodeURIComponent(t)}catch{throw Na(sr.DATA_URL,"Malformed data URL.")}return EI(e)}function TI(t,e){switch(t){case sr.BASE64:{const s=e.indexOf("-")!==-1,i=e.indexOf("_")!==-1;if(s||i)throw Na(t,"Invalid character '"+(s?"-":"_")+"' found: is it base64url encoded?");break}case sr.BASE64URL:{const s=e.indexOf("+")!==-1,i=e.indexOf("/")!==-1;if(s||i)throw Na(t,"Invalid character '"+(s?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=mV(e)}catch(s){throw s.message.includes("polyfill")?s:Na(t,"Invalid character found")}const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}class SI{constructor(e){this.base64=!1,this.contentType=null;const n=e.match(/^data:([^,]+)?,/);if(n===null)throw Na(sr.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const r=n[1]||null;r!=null&&(this.base64=wV(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}}function vV(t){const e=new SI(t);return e.base64?TI(sr.BASE64,e.rest):yV(e.rest)}function _V(t){return new SI(t).contentType}function wV(t,e){return t.length>=e.length?t.substring(t.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class is{constructor(e,n){let r=0,s="";bw(e)?(this.data_=e,r=e.size,s=e.type):e instanceof ArrayBuffer?(n?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(n?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=s}size(){return this.size_}type(){return this.type_}slice(e,n){if(bw(this.data_)){const r=this.data_,s=pV(r,e,n);return s===null?null:new is(s)}else{const r=new Uint8Array(this.data_.buffer,e,n-e);return new is(r,!0)}}static getBlob(...e){if(Sg()){const n=e.map(r=>r instanceof is?r.data_:r);return new is(fV.apply(null,n))}else{const n=e.map(o=>Tg(o)?gV(sr.RAW,o).data:o.data_);let r=0;n.forEach(o=>{r+=o.byteLength});const s=new Uint8Array(r);let i=0;return n.forEach(o=>{for(let a=0;a<o.length;a++)s[i++]=o[a]}),new is(s,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function II(t){let e;try{e=JSON.parse(t)}catch{return null}return sV(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xV(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function EV(t,e){const n=e.split("/").filter(r=>r.length>0).join("/");return t.length===0?n:t+"/"+n}function bI(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TV(t,e){return e}class Qt{constructor(e,n,r,s){this.server=e,this.local=n||e,this.writable=!!r,this.xform=s||TV}}let gu=null;function SV(t){return!Tg(t)||t.length<2?t:bI(t)}function NI(){if(gu)return gu;const t=[];t.push(new Qt("bucket")),t.push(new Qt("generation")),t.push(new Qt("metageneration")),t.push(new Qt("name","fullPath",!0));function e(i,o){return SV(o)}const n=new Qt("name");n.xform=e,t.push(n);function r(i,o){return o!==void 0?Number(o):o}const s=new Qt("size");return s.xform=r,t.push(s),t.push(new Qt("timeCreated")),t.push(new Qt("updated")),t.push(new Qt("md5Hash",null,!0)),t.push(new Qt("cacheControl",null,!0)),t.push(new Qt("contentDisposition",null,!0)),t.push(new Qt("contentEncoding",null,!0)),t.push(new Qt("contentLanguage",null,!0)),t.push(new Qt("contentType",null,!0)),t.push(new Qt("metadata","customMetadata",!0)),gu=t,gu}function IV(t,e){function n(){const r=t.bucket,s=t.fullPath,i=new yn(r,s);return e._makeStorageReference(i)}Object.defineProperty(t,"ref",{get:n})}function bV(t,e,n){const r={};r.type="file";const s=n.length;for(let i=0;i<s;i++){const o=n[i];r[o.local]=o.xform(r,e[o.server])}return IV(r,t),r}function AI(t,e,n){const r=II(e);return r===null?null:bV(t,r,n)}function NV(t,e,n,r){const s=II(e);if(s===null||!Tg(s.downloadTokens))return null;const i=s.downloadTokens;if(i.length===0)return null;const o=encodeURIComponent;return i.split(",").map(d=>{const h=t.bucket,p=t.fullPath,m="/b/"+o(h)+"/o/"+o(p),y=Ig(m,n,r),T=xI({alt:"media",token:d});return y+T})[0]}function AV(t,e){const n={},r=e.length;for(let s=0;s<r;s++){const i=e[s];i.writable&&(n[i.server]=t[i.local])}return JSON.stringify(n)}class CI{constructor(e,n,r,s){this.url=e,this.method=n,this.handler=r,this.timeout=s,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RI(t){if(!t)throw Eg()}function CV(t,e){function n(r,s){const i=AI(t,s,e);return RI(i!==null),i}return n}function RV(t,e){function n(r,s){const i=AI(t,s,e);return RI(i!==null),NV(i,s,t.host,t._protocol)}return n}function kI(t){function e(n,r){let s;return n.getStatus()===401?n.getErrorText().includes("Firebase App Check token is invalid")?s=zL():s=BL():n.getStatus()===402?s=$L(t.bucket):n.getStatus()===403?s=qL(t.path):s=r,s.status=n.getStatus(),s.serverResponse=r.serverResponse,s}return e}function kV(t){const e=kI(t);function n(r,s){let i=e(r,s);return r.getStatus()===404&&(i=FL(t.path)),i.serverResponse=s.serverResponse,i}return n}function PV(t,e,n){const r=e.fullServerUrl(),s=Ig(r,t.host,t._protocol),i="GET",o=t.maxOperationRetryTime,a=new CI(s,i,RV(t,n),o);return a.errorHandler=kV(e),a}function jV(t,e){return t&&t.contentType||e&&e.type()||"application/octet-stream"}function DV(t,e,n){const r=Object.assign({},n);return r.fullPath=t.path,r.size=e.size(),r.contentType||(r.contentType=jV(null,e)),r}function OV(t,e,n,r,s){const i=e.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};function a(){let _="";for(let E=0;E<2;E++)_=_+Math.random().toString().slice(2);return _}const c=a();o["Content-Type"]="multipart/related; boundary="+c;const d=DV(e,r,s),h=AV(d,n),p="--"+c+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+h+`\r
--`+c+`\r
Content-Type: `+d.contentType+`\r
\r
`,m=`\r
--`+c+"--",y=is.getBlob(p,r,m);if(y===null)throw YL();const T={name:d.fullPath},b=Ig(i,t.host,t._protocol),I="POST",v=t.maxUploadRetryTime,w=new CI(b,I,CV(t,n),v);return w.urlParams=T,w.headers=o,w.body=y.uploadData(),w.errorHandler=kI(e),w}class LV{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=ei.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=ei.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=ei.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,n,r,s,i){if(this.sent_)throw ta("cannot .send() more than once");if(zr(e)&&r&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(n,e,!0),i!==void 0)for(const o in i)i.hasOwnProperty(o)&&this.xhr_.setRequestHeader(o,i[o].toString());return s!==void 0?this.xhr_.send(s):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw ta("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw ta("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw ta("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw ta("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class VV extends LV{initXhr(){this.xhr_.responseType="text"}}function PI(){return new VV}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pi{constructor(e,n){this._service=e,n instanceof yn?this._location=n:this._location=yn.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new pi(e,n)}get root(){const e=new yn(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return bI(this._location.path)}get storage(){return this._service}get parent(){const e=xV(this._location.path);if(e===null)return null;const n=new yn(this._location.bucket,e);return new pi(this._service,n)}_throwIfRoot(e){if(this._location.path==="")throw ZL(e)}}function MV(t,e,n){t._throwIfRoot("uploadBytes");const r=OV(t.storage,t._location,NI(),new is(e,!0),n);return t.storage.makeRequestWithTokens(r,PI).then(s=>({metadata:s,ref:t}))}function UV(t){t._throwIfRoot("getDownloadURL");const e=PV(t.storage,t._location,NI());return t.storage.makeRequestWithTokens(e,PI).then(n=>{if(n===null)throw XL();return n})}function FV(t,e){const n=EV(t._location.path,e),r=new yn(t._location.bucket,n);return new pi(t.storage,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $V(t){return/^[A-Za-z]+:\/\//.test(t)}function BV(t,e){return new pi(t,e)}function jI(t,e){if(t instanceof bg){const n=t;if(n._bucket==null)throw QL();const r=new pi(n,n._bucket);return e!=null?jI(r,e):r}else return e!==void 0?FV(t,e):t}function zV(t,e){if(e&&$V(e)){if(t instanceof bg)return BV(t,e);throw mp("To use ref(service, url), the first argument must be a Storage instance.")}else return jI(t,e)}function Aw(t,e){const n=e==null?void 0:e[_I];return n==null?null:yn.makeFromBucketSpec(n,t)}function qV(t,e,n,r={}){t.host=`${e}:${n}`;const s=zr(e);s&&(ed(`https://${t.host}/b`),td("Storage",!0)),t._isUsingEmulator=!0,t._protocol=s?"https":"http";const{mockUserToken:i}=r;i&&(t._overrideAuthToken=typeof i=="string"?i:m0(i,t.app.options.projectId))}class bg{constructor(e,n,r,s,i,o=!1){this.app=e,this._authProvider=n,this._appCheckProvider=r,this._url=s,this._firebaseVersion=i,this._isUsingEmulator=o,this._bucket=null,this._host=vI,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=ML,this._maxUploadRetryTime=UL,this._requests=new Set,s!=null?this._bucket=yn.makeFromBucketSpec(s,this._host):this._bucket=Aw(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=yn.makeFromBucketSpec(this._url,e):this._bucket=Aw(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){Nw("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){Nw("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const n=await e.getToken();if(n!==null)return n.accessToken}return null}async _getAppCheckToken(){if(Xt(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new pi(this,e)}_makeRequest(e,n,r,s,i=!0){if(this._deleted)return new eV(wI());{const o=dV(e,this._appId,r,s,n,this._firebaseVersion,i,this._isUsingEmulator);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,n){const[r,s]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,n,r,s).getPromise()}}const Cw="@firebase/storage",Rw="0.14.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DI="storage";function OI(t,e,n){return t=Re(t),MV(t,e,n)}function LI(t){return t=Re(t),UV(t)}function VI(t,e){return t=Re(t),zV(t,e)}function MI(t=Io(),e){t=Re(t);const r=Os(t,DI).getImmediate({identifier:e}),s=fm("storage");return s&&WV(r,...s),r}function WV(t,e,n,r={}){qV(t,e,n,r)}function HV(t,{instanceIdentifier:e}){const n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal"),s=t.getProvider("app-check-internal");return new bg(n,r,s,e,vi)}function GV(){Pn(new wn(DI,HV,"PUBLIC").setMultipleInstances(!0)),$t(Cw,Rw,""),$t(Cw,Rw,"esm2020")}GV();function KV({groupId:t,msg:e,lastSeen:n,currentUid:r,canDelete:s}){const i=Me(te),o=Ue(te),a=MI(te),[c,d]=R.useState(!1),[h,p]=R.useState([]),[m,y]=R.useState(""),[T,b]=R.useState(null);R.useEffect(()=>{if(!c||!e.id)return;const _=we(ie(i,`groups/${t}/messages/${e.id}/replies`),It("createdAt","asc"));return Te(_,j=>{p(j.docs.map(O=>({id:O.id,...O.data()})))})},[i,t,e.id,c]);async function I(_){var S,x;_.preventDefault();const E=(S=o.currentUser)==null?void 0:S.uid;if(!E||!m.trim()&&!T||!e.id)return;const j=q(ie(i,`groups/${t}/messages/${e.id}/replies`));let O=null;if(T){const N=`groupChatAttachments/${t}/${e.id}/${j.id}/${T.name}`,k=VI(a,N);await OI(k,T),O={fileUrl:await LI(k),fileName:T.name}}await ze(j,{uid:E,text:m.trim(),displayName:((x=o.currentUser)==null?void 0:x.displayName)||null,createdAt:Ce(),...O||{}}),y(""),b(null),_.currentTarget.reset()}async function v(){if(e.id&&r&&(e.uid===r||s))try{await mt(q(i,`groups/${t}/messages/${e.id}`))}catch{alert("Failed to delete message (check rules).")}}async function w(_,E){if(e.id&&r&&(E===r||s))try{await mt(q(i,`groups/${t}/messages/${e.id}/replies/${_}`))}catch{alert("Failed to delete reply (check rules).")}}return u.jsxs("div",{className:"relative p-2 text-sm border-b border-border",children:[u.jsxs("div",{children:[u.jsx("span",{className:"font-medium",children:e.displayName||e.uid.slice(0,6)}),": ",e.text,e.fileUrl&&u.jsx("div",{children:u.jsx("a",{href:e.fileUrl,target:"_blank",rel:"noopener",className:"text-accent underline",children:e.fileName||"Attachment"})})]}),(r===e.uid||s)&&u.jsx("button",{type:"button",onClick:()=>void v(),className:"absolute -top-2 -right-2 text-[10px] rounded-full border border-border bg-background px-1.5 py-0.5 hover:bg-surface",title:"Delete message",children:""}),u.jsx("button",{onClick:()=>d(_=>!_),className:"mt-1 text-xs text-accent",children:c?"Hide replies":"Reply"}),e.latestReplyAt&&!c&&u.jsx("button",{type:"button",onClick:()=>d(!0),className:e.latestReplyAt>n?"ml-2 rounded bg-yellow-200 px-1 py-0.5 text-xs text-yellow-800 cursor-pointer hover:underline":"ml-2 text-xs text-accent",children:e.latestReplyAt>n?"New Replies":"Open Replies"}),c&&u.jsxs("div",{className:"mt-2 ml-4",children:[h.length===0&&u.jsx("div",{className:"p-1 text-xs text-text2",children:"No replies yet."}),h.map(_=>u.jsxs("div",{className:"relative p-1 text-xs border-b border-border",children:[u.jsx("span",{className:"font-medium",children:_.displayName||_.uid.slice(0,6)}),": ",_.text,_.fileUrl&&u.jsx("div",{children:u.jsx("a",{href:_.fileUrl,target:"_blank",rel:"noopener",className:"text-accent underline",children:_.fileName||"Attachment"})}),(r===_.uid||s)&&u.jsx("button",{type:"button",onClick:()=>void w(_.id,_.uid),className:"absolute -top-1 -right-1 text-[8px] rounded-full border border-border bg-background px-1 py-0 hover:bg-surface",title:"Delete reply",children:""})]},_.id)),u.jsxs("form",{onSubmit:I,className:"mt-2 flex gap-2",children:[u.jsx("input",{value:m,onChange:_=>y(_.target.value),placeholder:"Write a reply",className:"flex-1 rounded-lg border border-border bg-background px-2 py-1 text-xs outline-none"}),u.jsx("input",{type:"file",onChange:_=>{var E;return b(((E=_.target.files)==null?void 0:E[0])||null)},className:"text-xs"}),u.jsx("button",{className:"rounded-lg bg-[#919FAA] hover:opacity-90 px-3 py-1 text-white text-xs",children:"Send"})]})]})]})}function QV({groupId:t}){var b;const e=Me(te),n=Ue(te),[r,s]=R.useState([]),[i,o]=R.useState(""),[a,c]=R.useState(null),d=MI(te),h=R.useRef(null),[p]=R.useState(()=>{const I=localStorage.getItem(`groupChatLastSeen_${t}`);return I?parseInt(I,10):0}),[m,y]=R.useState(!1);R.useEffect(()=>{async function I(){var w,_;const v=(w=n.currentUser)==null?void 0:w.uid;if(!v){y(!1);return}try{if(((_=(await xe(q(e,"users",v))).data())==null?void 0:_.isSuperAdmin)===!0){y(!0);return}const O=await xe(q(e,`groups/${t}/groupAdmins/${v}`));y(O.exists())}catch{y(!1)}}I()},[(b=n.currentUser)==null?void 0:b.uid,e,t]),R.useEffect(()=>()=>{localStorage.setItem(`groupChatLastSeen_${t}`,Date.now().toString())},[t]),R.useEffect(()=>{const I=we(ie(e,`groups/${t}/messages`),It("createdAt","asc"));return Te(I,async w=>{const _=await Promise.all(w.docs.map(async E=>{var x,N;const j=E.data(),O=await Ge(we(ie(e,`groups/${t}/messages/${E.id}/replies`),It("createdAt","desc"),hg(1))),S=O.empty?null:(N=(x=O.docs[0].data().createdAt)==null?void 0:x.toMillis)==null?void 0:N.call(x);return{id:E.id,...j,latestReplyAt:S}}));s(_),setTimeout(()=>{var E;return(E=h.current)==null?void 0:E.scrollIntoView({behavior:"smooth"})},0)})},[e,t]);async function T(I){var E,j;I.preventDefault();const v=(E=n.currentUser)==null?void 0:E.uid;if(!v||!i.trim()&&!a)return;const w=q(ie(e,`groups/${t}/messages`));let _=null;if(a){const O=`groupChatAttachments/${t}/${w.id}/${a.name}`,S=VI(d,O);await OI(S,a),_={fileUrl:await LI(S),fileName:a.name}}await ze(w,{uid:v,text:i.trim(),displayName:((j=n.currentUser)==null?void 0:j.displayName)||null,createdAt:Ce(),..._||{}}),o(""),c(null),I.currentTarget.reset()}return u.jsxs("div",{className:"rounded-xl border border-border bg-card p-5",children:[u.jsx("h2",{className:"text-lg font-semibold text-accent",children:"Team Chat"}),u.jsxs("div",{className:"mt-3 max-h-72 overflow-y-auto rounded-lg border border-border bg-background",children:[r.length===0&&u.jsx("div",{className:"p-3 text-sm text-text2",children:"No messages yet."}),r.map(I=>{var v;return u.jsx(KV,{groupId:t,msg:I,lastSeen:p,currentUid:((v=n.currentUser)==null?void 0:v.uid)||null,canDelete:m},I.id)}),u.jsx("div",{ref:h})]}),u.jsxs("form",{onSubmit:T,className:"mt-2 flex gap-2",children:[u.jsx("input",{value:i,onChange:I=>o(I.target.value),placeholder:"Write a message",className:"flex-1 rounded-lg border border-border bg-background px-3 py-2 text-sm outline-none"}),u.jsx("input",{type:"file",onChange:I=>{var v;return c(((v=I.target.files)==null?void 0:v[0])||null)},className:"text-sm"}),u.jsx("button",{className:"rounded-lg bg-[#919FAA] hover:opacity-90 px-4 py-2 text-white text-sm",children:"Send"})]})]})}const YV="America/New_York";function XV(){var ae;const{slug:t=""}=Ds(),e=H.useMemo(()=>Me(te),[]),n=Ue(te),[r,s]=H.useState(null),[i,o]=H.useState(!1),[a,c]=H.useState(!1),[d,h]=H.useState(!0),[p,m]=H.useState([]),[y,T]=H.useState([]),[b,I]=H.useState([]);H.useEffect(()=>{xe(q(e,"appSettings","general")).then($=>{const G=$.data();G!=null&&G.calendarIds&&G.calendarIds.length?I(G.calendarIds):G!=null&&G.calendarId?I([G.calendarId]):I([])}).catch(()=>I([]))},[e]);const v=H.useMemo(()=>{const $=r!=null&&r.calendarIds&&r.calendarIds.length?r.calendarIds:b;return $.length?`https://calendar.google.com/calendar/embed?${$.map(se=>`src=${encodeURIComponent(se)}`).join("&")}&ctz=${encodeURIComponent(YV)}`:null},[r==null?void 0:r.calendarIds,b]),[w,_]=H.useState(""),[E,j]=H.useState(""),[O,S]=H.useState(""),[x,N]=H.useState(null),[k,P]=H.useState(""),[D,C]=H.useState(""),[pe,Ae]=H.useState(""),[Ee,J]=H.useState(!1),[F,K]=H.useState(null),ne=((ae=n.currentUser)==null?void 0:ae.uid)||null,ge=H.useMemo(()=>y.find($=>$.uid===ne)||null,[y,ne]),[me,ue]=H.useState(!1);H.useEffect(()=>{ue(!!(ge!=null&&ge.muted))},[ge==null?void 0:ge.muted]);async function Y($){try{return(await xe($)).exists()}catch{return!1}}H.useEffect(()=>{let $=!1;async function G(){var se;try{if(!t)return;try{const ke=await xe(q(e,"groups",t));ke.exists()&&!$&&s({id:ke.id,...ke.data()})}catch(ke){console.error("Failed to load group doc",ke)}let ce=!1,oe=!1;const De=n.currentUser;if(De){const ke=De.uid;if(((se=(await xe(q(e,"users",ke))).data())==null?void 0:se.isSuperAdmin)===!0)ce=!0,oe=!0;else if(await Y(q(e,`groups/${t}/groupAdmins/${ke}`)))ce=!0,oe=!0;else if(await Y(q(e,`users/${ke}/memberships/${t}`)))ce=!0;else try{ce=(await Ge(ie(e,`users/${ke}/memberships`))).docs.some(kd=>{const Zn=kd.data();return(Zn==null?void 0:Zn.groupId)===t||(Zn==null?void 0:Zn.groupSlug)===t})}catch(jo){console.warn("Membership scan failed",jo)}}$||(c(oe),o(ce))}finally{$||h(!1)}}return G(),()=>{$=!0}},[e,n.currentUser,t]),H.useEffect(()=>{if(!i||!t)return;const $=Te(ie(e,`groups/${t}/resources`),se=>{const ce=se.docs.map(oe=>{var De,ke,Wt;return{id:oe.id,title:((De=oe.data())==null?void 0:De.title)||oe.id,url:((ke=oe.data())==null?void 0:ke.url)||"#",note:((Wt=oe.data())==null?void 0:Wt.note)||""}});m(ce)}),G=Te(ie(e,`groups/${t}/members`),se=>{const ce=se.docs.map(oe=>({uid:oe.id,...oe.data()}));T(ce)});return()=>{$(),G()}},[e,t,i]);async function M($){var ce;$.preventDefault(),K(null);const G=w.trim(),se=E.trim();if(!G||!se){K("Please enter a title and URL.");return}J(!0);try{await An(ie(e,`groups/${t}/resources`),{title:G,url:se,note:O.trim()||"",createdAt:Ce(),createdBy:((ce=n.currentUser)==null?void 0:ce.uid)||null}),_(""),j(""),S("")}catch(oe){const De=(oe==null?void 0:oe.message)||"Could not add resource.";K(De)}finally{J(!1)}}async function z(){var se;if(!x)return;K(null);const $=k.trim(),G=D.trim();if(!$||!G){K("Please enter a title and URL.");return}J(!0);try{await Nl(q(e,`groups/${t}/resources/${x}`),{title:$,url:G,note:pe.trim()||"",updatedAt:Ce(),updatedBy:((se=n.currentUser)==null?void 0:se.uid)||null}),N(null),P(""),C(""),Ae("")}catch(ce){const oe=(ce==null?void 0:ce.message)||"Could not save changes.";K(oe)}finally{J(!1)}}function Z($){N($.id),P($.title),C($.url),Ae($.note||""),K(null)}async function he($){if(K(null),!!window.confirm("Delete this resource?"))try{await mt(q(e,`groups/${t}/resources/${$}`))}catch(G){const se=(G==null?void 0:G.message)||"Could not delete resource.";K(se)}}return d?u.jsx("div",{className:"container py-8",children:u.jsx("div",{className:"max-w-5xl mx-auto p-6",children:u.jsx(pr,{label:"Loading group"})})}):r?i?u.jsx("div",{className:"container py-8 md:py-12",children:u.jsxs("div",{className:"max-w-5xl mx-auto",children:[u.jsxs("div",{className:"flex items-start justify-between gap-3",children:[u.jsxs("div",{children:[u.jsx("h1",{className:"text-2xl font-semibold text-accent",children:r.name||t}),a&&u.jsx(_e,{to:`/admin/groups/${t}/edit`,className:"inline-flex items-center gap-1 rounded-lg border border-border px-3 py-1.5 text-sm hover:bg-muted",children:"Edit settings"}),r.description&&u.jsx("p",{className:"text-sm text-text2 mt-2",children:r.description}),u.jsx("div",{className:"mt-2",children:u.jsx(_e,{to:`/groups/${t}/polls`,className:"inline-flex rounded-lg border border-border px-3 py-1.5 text-sm hover:bg-muted",children:"View polls"})})]}),ne&&u.jsx("div",{className:"mt-1",children:u.jsxs("label",{className:"inline-flex items-center gap-2 text-sm",children:[u.jsx("input",{type:"checkbox",checked:me,onChange:async $=>{const G=$.target.checked;ue(G);try{await ze(q(e,`groups/${t}/members/${ne}`),{muted:G},{merge:!0})}catch{ue(!G),alert("Could not update notification setting.")}}}),u.jsx("span",{children:"Mute notifications for this group"})]})})]}),u.jsx("div",{className:"mt-6",children:u.jsx(QV,{groupId:t})}),u.jsxs("section",{className:"mt-6 rounded-xl border border-border bg-card p-5",children:[u.jsx("div",{className:"flex items-center justify-between",children:u.jsx("h2",{className:"text-lg font-semibold text-accent",children:"Resources"})}),a&&u.jsxs("form",{onSubmit:M,className:"mt-3 grid gap-2 sm:grid-cols-6",children:[u.jsx("input",{className:"sm:col-span-2 rounded-lg border border-border bg-background px-3 py-2 text-sm outline-none",placeholder:"Title",value:w,onChange:$=>_($.target.value)}),u.jsx("input",{className:"sm:col-span-3 rounded-lg border border-border bg-background px-3 py-2 text-sm outline-none",placeholder:"https://...",value:E,onChange:$=>j($.target.value)}),u.jsx("div",{className:"sm:col-span-6",children:u.jsx("textarea",{className:"w-full rounded-lg border border-border bg-background px-3 py-2 text-sm outline-none",placeholder:"Optional note (description)",value:O,onChange:$=>S($.target.value)})}),u.jsxs("div",{className:"sm:col-span-6",children:[u.jsx("button",{className:"rounded-lg bg-[#919FAA] hover:opacity-90 px-4 py-2 text-white text-sm",disabled:Ee,children:Ee?"Saving":"Add resource"}),F&&u.jsx("span",{className:"ml-3 text-sm text-rose-700",children:F})]})]}),u.jsxs("ul",{className:"mt-3 divide-y divide-border",children:[p.map($=>u.jsxs("li",{className:"py-2 flex items-center justify-between gap-3",children:[u.jsxs("div",{children:[u.jsx("a",{href:$.url,target:"_blank",rel:"noreferrer",className:"text-sm text-accent underline underline-offset-2 break-all",children:$.title}),$.note&&u.jsx("p",{className:"text-xs text-text2 mt-1",children:$.note})]}),a&&u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("button",{type:"button",onClick:()=>Z($),className:"text-xs rounded-lg border border-border px-2 py-1 hover:bg-muted",children:"Edit"}),u.jsx("button",{type:"button",onClick:()=>he($.id),className:"text-xs rounded-lg border border-rose-300 text-rose-700 px-2 py-1 hover:bg-rose-50",children:"Remove"})]})]},$.id)),p.length===0&&u.jsx("li",{className:"py-2 text-sm text-text2",children:"No resources yet."})]}),x&&u.jsxs("form",{onSubmit:$=>{$.preventDefault(),z()},className:"mt-3 grid gap-2 sm:grid-cols-6",children:[u.jsx("input",{className:"sm:col-span-2 rounded-lg border border-border bg-background px-3 py-2 text-sm outline-none",placeholder:"Title",value:k,onChange:$=>P($.target.value)}),u.jsx("input",{className:"sm:col-span-3 rounded-lg border border-border bg-background px-3 py-2 text-sm outline-none",placeholder:"https://...",value:D,onChange:$=>C($.target.value)}),u.jsx("div",{className:"sm:col-span-6",children:u.jsx("textarea",{className:"w-full rounded-lg border border-border bg-background px-3 py-2 text-sm outline-none",placeholder:"Optional note (description)",value:pe,onChange:$=>Ae($.target.value)})}),u.jsxs("div",{className:"sm:col-span-6 flex items-center gap-2",children:[u.jsx("button",{className:"rounded-lg bg-[#919FAA] hover:opacity-90 px-4 py-2 text-white text-sm",disabled:Ee,children:Ee?"Saving":"Save changes"}),u.jsx("button",{type:"button",onClick:()=>{N(null),P(""),C(""),Ae("")},className:"text-sm rounded-lg border border-border px-3 py-2 hover:bg-muted",children:"Cancel"}),F&&u.jsx("span",{className:"text-sm text-rose-700",children:F})]})]})]}),u.jsxs("section",{className:"mt-6 rounded-xl border border-border bg-card p-5",children:[u.jsx("h2",{className:"text-lg font-semibold text-accent",children:"Team"}),y.length>0?u.jsx("ul",{className:"mt-3 grid grid-cols-1 sm:grid-cols-2 gap-2",children:y.map($=>u.jsxs("li",{className:"rounded-lg border border-border px-3 py-2",children:[u.jsx("p",{className:"text-sm",children:$.displayName||$.uid}),$.role&&u.jsx("p",{className:"text-xs text-text2",children:$.role}),$.email&&u.jsx("p",{className:"text-xs text-text2",children:$.email}),"muted"in $&&u.jsx("p",{className:"text-[11px] text-text2 mt-1",children:$.muted?"Muted":"Notifications on"})]},$.uid))}):u.jsx("p",{className:"text-sm text-text2 mt-2",children:"No members are listed for this group yet."})]}),u.jsxs("section",{className:"mt-6 rounded-xl border border-border bg-card p-5",children:[u.jsx("h2",{className:"text-lg font-semibold text-accent",children:"Calendar"}),u.jsx("p",{className:"text-text2 text-sm mt-1",children:"Synced from Google Calendar."}),u.jsx("div",{className:"mt-3 w-full",children:v?u.jsx("iframe",{className:"w-full h-[440px] sm:h-[520px] md:h-[720px] rounded border-0",src:v,title:"Group Calendar",loading:"lazy",referrerPolicy:"no-referrer-when-downgrade"}):u.jsx("div",{className:"w-full h-[440px] sm:h-[520px] md:h-[720px] flex items-center justify-center text-center p-6 text-sm text-text2 rounded bg-surface/50",children:u.jsxs("div",{children:[u.jsx("div",{className:"font-medium text-text mb-1",children:"Calendar not configured"}),u.jsxs("div",{children:["Ask an admin to set a ",u.jsx("code",{className:"px-1 py-0.5 rounded bg-surface/50",children:"Calendar ID"})," in Settings."]})]})})})]})]})}):u.jsx("div",{className:"container py-8",children:u.jsxs("div",{className:"max-w-3xl mx-auto rounded-xl border border-border bg-card p-6",children:[u.jsx("h1",{className:"text-xl font-semibold text-accent mb-2",children:r.name||t}),u.jsx("p",{className:"text-sm text-text2 mb-4",children:"Membership is required to view this group."}),u.jsx("p",{className:"text-sm text-text2",children:"Request to join from the Explore page."})]})}):u.jsx("div",{className:"container py-8",children:u.jsx("div",{className:"max-w-5xl mx-auto p-6",children:u.jsx("p",{className:"text-text2",children:"Group not found."})})})}function JV(){var b;const{slug:t=""}=Ds(),e=R.useMemo(()=>Me(te),[]),r=((b=Ue(te).currentUser)==null?void 0:b.uid)||"",[s,i]=R.useState([]),[o,a]=R.useState(""),[c,d]=R.useState(""),[h,p]=R.useState(!1);R.useEffect(()=>{if(!t)return;const I=Te(ie(e,`groups/${t}/polls`),v=>{const w=v.docs.map(_=>({id:_.id,..._.data()}));i(w)});return()=>I()},[e,t]),R.useEffect(()=>{let I=!1;async function v(){var w;if(!(!t||!r))try{const[_,E]=await Promise.all([xe(q(e,"users",r)),xe(q(e,`groups/${t}/groupAdmins/${r}`))]);I||p(((w=_.data())==null?void 0:w.isSuperAdmin)===!0||E.exists())}catch{I||p(!1)}}return v(),()=>{I=!0}},[e,t,r]);async function m(){if(!h||!o.trim())return;const I=c.split(`
`).map(v=>v.trim()).filter(Boolean).map(v=>({id:crypto.randomUUID(),label:v,voters:[]}));await An(ie(e,`groups/${t}/polls`),{question:o.trim(),options:I,createdBy:r}),a(""),d("")}async function y(I,v){const w=s.find(E=>E.id===I);if(!w||!r)return;const _=w.options.map(E=>{let j=E.voters||[];return E.id===v&&(j=j.includes(r)?j.filter(O=>O!==r):[...j,r]),{...E,voters:j}});await Nl(q(e,`groups/${t}/polls/${I}`),{options:_})}async function T(I){h&&window.confirm("Delete this poll?")&&await mt(q(e,`groups/${t}/polls/${I}`))}return u.jsx("div",{className:"container py-8 md:py-12",children:u.jsxs("div",{className:"max-w-3xl mx-auto",children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsx("h1",{className:"text-2xl font-semibold text-accent",children:"Polls"}),u.jsx(_e,{to:`/groups/${t}`,className:"text-sm text-accent underline underline-offset-2",children:"Back to group"})]}),h&&u.jsxs("form",{onSubmit:I=>{I.preventDefault(),m()},className:"mt-6 grid gap-2 sm:grid-cols-6",children:[u.jsx("input",{className:"sm:col-span-6 rounded-lg border border-border bg-background px-3 py-2 text-sm outline-none",placeholder:"Poll question",value:o,onChange:I=>a(I.target.value)}),u.jsx("textarea",{className:"sm:col-span-6 rounded-lg border border-border bg-background px-3 py-2 text-sm outline-none",placeholder:"Options, one per line",value:c,onChange:I=>d(I.target.value)}),u.jsx("div",{className:"sm:col-span-6",children:u.jsx("button",{className:"rounded-lg bg-[#919FAA] hover:opacity-90 px-4 py-2 text-white text-sm",children:"Create poll"})})]}),u.jsxs("div",{className:"mt-8 space-y-6",children:[s.map(I=>u.jsxs("div",{className:"rounded-lg border border-border bg-card p-4",children:[u.jsxs("div",{className:"flex items-start justify-between",children:[u.jsx("h2",{className:"font-medium text-accent",children:I.question}),h&&u.jsx("button",{onClick:()=>void T(I.id),className:"text-xs text-red-500 hover:underline",children:"Delete"})]}),u.jsx("ul",{className:"mt-3 space-y-2",children:I.options.map(v=>{var w,_;return u.jsx("li",{children:u.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[u.jsx("input",{type:"checkbox",checked:(w=v.voters)==null?void 0:w.includes(r),onChange:()=>void y(I.id,v.id)}),u.jsx("span",{children:v.label}),u.jsxs("span",{className:"text-xs text-text2",children:["(",((_=v.voters)==null?void 0:_.length)||0,")"]})]})},v.id)})})]},I.id)),s.length===0&&u.jsx("p",{className:"text-sm text-text2",children:"No polls yet."})]})]})})}const UI="/assets/Header_Logo-CWkkS3_r.png";function ZV(){const[t,e]=R.useState(!1);return R.useEffect(()=>{const n=window.matchMedia&&window.matchMedia("(display-mode: standalone)"),r=navigator.standalone===!0,s=()=>e(!!(n&&n.matches||r));return s(),n&&n.addEventListener&&n.addEventListener("change",s),()=>{n&&n.removeEventListener&&n.removeEventListener("change",s)}},[]),t}function eM(){const t=ZV();return u.jsxs(u.Fragment,{children:[t&&u.jsx("style",{children:`
          [data-app-header]{
            padding-top: env(safe-area-inset-top);
            padding-top: constant(safe-area-inset-top);
          }
        `}),u.jsx("header",{"data-app-header":!0,className:"w-full border-b border-border bg-[var(--bg)]",children:u.jsx("div",{className:"container py-2 md:py-3 flex items-center",children:u.jsx(_e,{to:"/login","aria-label":"Immanuel Members Home",className:"shrink-0",children:u.jsx("img",{src:UI,alt:"Immanuel Downtown",className:"h-14 sm:h-12 md:h-14 lg:h-16 w-auto object-contain"})})})})]})}function tM(){const[t,e]=R.useState(!1);return R.useEffect(()=>{const n=window.matchMedia&&window.matchMedia("(display-mode: standalone)"),r=navigator.standalone===!0,s=()=>e(!!(n&&n.matches||r));return s(),n&&n.addEventListener&&n.addEventListener("change",s),()=>{n&&n.removeEventListener&&n.removeEventListener("change",s)}},[]),t}function nM(){const{user:t,isAdmin:e}=Ti(),n=On(),s=(t==null?void 0:t.uid)==="N86oGmSc8oVnHHeHm2Nlxi2L8Wb2",[i,o]=R.useState(!1),a=tM(),c="inline-flex items-center justify-center min-h-[2.25rem] px-3 py-2 rounded-lg text-sm leading-tight text-center whitespace-normal md:whitespace-nowrap",d=h=>`${c} ${h?"bg-muted text-accent":"text-text hover:text-accent"}`;return R.useEffect(()=>{o(!1)},[n.pathname]),u.jsxs(u.Fragment,{children:[a&&u.jsx("style",{children:`
          [data-app-header] {
            padding-top: env(safe-area-inset-top);
            /* Safari < 11.2 fallback (rare now) */
            padding-top: constant(safe-area-inset-top);
          }
        `}),u.jsxs("header",{"data-app-header":!0,className:"w-full border-b border-border bg-[var(--bg)]",children:[u.jsxs("div",{className:"container py-2 md:py-3 grid grid-cols-2 md:grid-cols-3 grid-rows-2 md:grid-rows-1 items-center gap-x-3 gap-y-2",children:[u.jsx("div",{className:"col-start-1 row-start-1 md:col-span-1 flex items-center min-w-0",children:u.jsx(_e,{to:"/dashboard","aria-label":"Immanuel Members Home",className:"shrink-0",children:u.jsx("img",{src:UI,alt:"Immanuel Downtown",className:"h-14 sm:h-12 md:h-14 lg:h-16 w-auto object-contain"})})}),u.jsx("div",{className:"col-start-2 md:col-start-3 row-start-1 flex justify-end",children:u.jsx("button",{"aria-label":"Open menu","aria-expanded":i,className:"p-2 rounded-md border border-border/70 bg-surface/40 hover:bg-surface/60 active:scale-[0.98] transition",onClick:()=>o(h=>!h),children:u.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none","aria-hidden":"true",children:u.jsx("path",{d:"M4 6h16M4 12h16M4 18h16",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})})})}),u.jsxs("nav",{className:"col-span-2 row-start-2 md:row-start-1 md:col-span-1 flex justify-center gap-4 text-sm",children:[u.jsx(lu,{to:"/dashboard",className:({isActive:h})=>d(h),children:"Dashboard"}),u.jsx(lu,{to:"/forum",className:({isActive:h})=>d(h),children:"The Forum"}),u.jsx(lu,{to:"/groups",className:({isActive:h})=>d(h),children:"Groups"}),u.jsx(lu,{to:"/activity",className:({isActive:h})=>d(h),children:"Activity"})]})]}),i&&u.jsxs("div",{className:"fixed inset-0 z-50",children:[u.jsx("button",{"aria-label":"Close menu",className:"absolute inset-0 bg-black/40",onClick:()=>o(!1)}),u.jsxs("div",{className:"absolute right-2 w-64 rounded-xl border border-border bg-[var(--bg)] shadow-xl p-3",style:{top:"calc(env(safe-area-inset-top, 0px) + 0.5rem)"},children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsx("div",{className:"text-sm text-text2",children:"Menu"}),u.jsx("button",{className:"p-2 rounded-md hover:bg-surface/60",onClick:()=>o(!1),"aria-label":"Close",children:u.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",children:u.jsx("path",{d:"M6 6l12 12M18 6l-12 12",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})})})]}),u.jsx("div",{className:"mt-2 border-t border-border/60 pt-2 grid gap-2",children:t?u.jsxs(u.Fragment,{children:[u.jsx(_e,{to:"/profile",className:"btn btn-outline btn-sm",onClick:()=>o(!1),children:"Profile"}),u.jsx(_e,{to:"/activity",className:"btn btn-outline btn-sm",onClick:()=>o(!1),children:"Activity"}),s&&u.jsx(_e,{to:"/pastor/questions",className:"btn btn-outline btn-sm",onClick:()=>o(!1),children:"Questions"}),e&&u.jsx(_e,{to:"/admin",className:"btn btn-outline btn-sm",onClick:()=>o(!1),children:"Admin"}),u.jsx("button",{className:"btn btn-outline btn-sm",onClick:()=>{o(!1),G0(vo)},children:"Sign out"})]}):n.pathname!=="/login"&&u.jsx(_e,{to:"/login",className:"btn btn-outline btn-sm",onClick:()=>o(!1),children:"Sign in"})})]})]})]})]})}function rM(){const t=Ue(te),e=Br(),[n,r]=R.useState(""),[s,i]=R.useState(""),[o,a]=R.useState(!1),[c,d]=R.useState(!1),[h,p]=R.useState(!1),[m,y]=R.useState(null);R.useEffect(()=>Vn(t,v=>{v&&e("/dashboard",{replace:!0})}),[t,e]);async function T(){y(null),d(!0);try{const I=new bn;await Rm(t,I),e("/dashboard",{replace:!0})}catch{y("Google sign-in was cancelled or failed.")}finally{d(!1)}}async function b(I){if(I.preventDefault(),y(null),!n||!s){y("Please enter your email and password.");return}p(!0);try{await W0(t,n,s),e("/dashboard",{replace:!0})}catch(v){const w=String((v==null?void 0:v.code)||"");let _="Could not sign in with email and password.";w==="auth/invalid-email"?_="Please enter a valid email address.":(w==="auth/user-not-found"||w==="auth/wrong-password")&&(_="Email or password is incorrect."),y(_)}finally{p(!1)}}return u.jsx("div",{className:"container py-8 md:py-12",children:u.jsxs("div",{className:"mx-auto max-w-md rounded-xl border border-border bg-card p-6 shadow",children:[u.jsx("h1",{className:"text-2xl font-semibold text-accent mb-1",children:"Welcome back"}),u.jsx("p",{className:"text-sm text-text2 mb-6",children:"Sign in to continue."}),m&&u.jsx("div",{className:"mb-4 rounded-lg border border-red-300 bg-red-50 px-3 py-2 text-sm text-red-700",children:m}),u.jsxs("form",{onSubmit:b,className:"grid gap-3 mb-4",children:[u.jsxs("label",{className:"grid gap-1",children:[u.jsx("span",{className:"text-sm",children:"Email"}),u.jsx("input",{type:"email",value:n,onChange:I=>r(I.target.value),placeholder:"you@example.com",autoComplete:"email",className:"rounded-lg border border-border bg-background px-3 py-2 outline-none",required:!0})]}),u.jsxs("label",{className:"grid gap-1",children:[u.jsx("span",{className:"text-sm",children:"Password"}),u.jsxs("div",{className:"flex gap-2",children:[u.jsx("input",{type:o?"text":"password",value:s,onChange:I=>i(I.target.value),placeholder:"",autoComplete:"current-password",className:"flex-1 rounded-lg border border-border bg-background px-3 py-2 outline-none",required:!0}),u.jsx("button",{type:"button",onClick:()=>a(I=>!I),className:"rounded-lg border border-border px-3 py-2 text-sm",children:o?"Hide":"Show"})]})]}),u.jsx("button",{type:"submit",disabled:h,className:"rounded-lg bg-[#919FAA] hover:opacity-90 px-4 py-2 text-white disabled:opacity-60",children:h?"Signing in":"Sign in"})]}),u.jsx("button",{type:"button",onClick:T,disabled:c,className:"btn btn-outline w-full",children:c?"Please wait":"Sign in with Google"}),u.jsx("div",{className:"mt-2",children:u.jsx(_e,{to:"/signup",className:"btn btn-outline w-full",children:"Create account"})}),u.jsx("div",{className:"mt-6 text-center",children:u.jsx(_e,{to:"/forgot",className:"text-sm text-accent underline underline-offset-2",children:"Forgot password?"})})]})})}function sM(t){const e=t.trim().split(/\s+/).filter(Boolean);return e.length===0?{firstName:"",lastName:""}:e.length===1?{firstName:e[0],lastName:""}:{firstName:e[0],lastName:e.slice(1).join(" ")}}function iM(){const t=Ue(te),e=Br(),[n,r]=R.useState(""),[s,i]=R.useState(""),[o,a]=R.useState(""),[c,d]=R.useState(""),[h,p]=R.useState(""),[m,y]=R.useState(!1),[T,b]=R.useState(null),[I,v]=R.useState(!1);R.useEffect(()=>Vn(t,j=>{j&&e("/dashboard",{replace:!0})}),[t,e]);async function w(E){E.preventDefault(),b(null);const j=n.trim(),O=s.trim();if(!j){b("Please enter your first name.");return}if(!o||!c){b("Please enter an email and password.");return}if(c!==h){b("Passwords do not match.");return}const S=(j+" "+O).trim();v(!0);try{const x=await jk(t,o,c);x.user&&await H0(x.user,{displayName:S});try{localStorage.setItem("signupName",S),localStorage.setItem("signupFirstName",j),localStorage.setItem("signupLastName",O)}catch{}e("/welcome",{replace:!0,state:{name:S,firstName:j,lastName:O}})}catch(x){const N=String((x==null?void 0:x.code)||"");let k="Could not create account.";N==="auth/email-already-in-use"?k="That email is already in use.":N==="auth/invalid-email"?k="Please enter a valid email address.":N==="auth/weak-password"&&(k="Password should be at least 6 characters."),b(k)}finally{v(!1)}}async function _(){var E;b(null),v(!0);try{const j=new bn,S=((E=(await Rm(t,j)).user)==null?void 0:E.displayName)||"",{firstName:x,lastName:N}=sM(S);try{S&&(localStorage.setItem("signupName",S),localStorage.setItem("signupFirstName",x),localStorage.setItem("signupLastName",N))}catch{}e("/welcome",{replace:!0,state:{name:S,firstName:x,lastName:N}})}catch{b("Google sign-in was cancelled or failed.")}finally{v(!1)}}return u.jsx("div",{className:"container py-8 md:py-12",children:u.jsxs("div",{className:"mx-auto max-w-md rounded-xl border border-border bg-card p-6 shadow",children:[u.jsx("h1",{className:"text-2xl font-semibold text-accent mb-1",children:"Create your account"}),u.jsx("p",{className:"text-sm text-text2 mb-6",children:"Join Immanuel Downtown to access your dashboard and groups."}),T&&u.jsx("div",{className:"mb-4 rounded-lg border border-red-300 bg-red-50 px-3 py-2 text-sm text-red-700",children:T}),u.jsxs("form",{onSubmit:w,className:"grid gap-3",children:[u.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[u.jsxs("label",{className:"grid gap-1",children:[u.jsx("span",{className:"text-sm",children:"First name"}),u.jsx("input",{type:"text",value:n,onChange:E=>r(E.target.value),placeholder:"Jordan",autoComplete:"given-name",required:!0,className:"rounded-lg border border-border bg-background px-3 py-2 outline-none"})]}),u.jsxs("label",{className:"grid gap-1",children:[u.jsx("span",{className:"text-sm",children:"Last name"}),u.jsx("input",{type:"text",value:s,onChange:E=>i(E.target.value),placeholder:"Smith",autoComplete:"family-name",className:"rounded-lg border border-border bg-background px-3 py-2 outline-none"})]})]}),u.jsxs("label",{className:"grid gap-1",children:[u.jsx("span",{className:"text-sm",children:"Email"}),u.jsx("input",{type:"email",value:o,onChange:E=>a(E.target.value),placeholder:"you@example.com",autoComplete:"email",required:!0,className:"rounded-lg border border-border bg-background px-3 py-2 outline-none"})]}),u.jsxs("label",{className:"grid gap-1",children:[u.jsx("span",{className:"text-sm",children:"Password"}),u.jsxs("div",{className:"flex gap-2",children:[u.jsx("input",{type:m?"text":"password",value:c,onChange:E=>d(E.target.value),placeholder:"",autoComplete:"new-password",required:!0,className:"flex-1 rounded-lg border border-border bg-background px-3 py-2 outline-none"}),u.jsx("button",{type:"button",onClick:()=>y(E=>!E),className:"rounded-lg border border-border px-3 py-2 text-sm",children:m?"Hide":"Show"})]})]}),u.jsxs("label",{className:"grid gap-1",children:[u.jsx("span",{className:"text-sm",children:"Confirm password"}),u.jsx("input",{type:m?"text":"password",value:h,onChange:E=>p(E.target.value),placeholder:"",autoComplete:"new-password",required:!0,className:"rounded-lg border border-border bg-background px-3 py-2 outline-none"})]}),u.jsx("button",{type:"submit",disabled:I,className:"mt-2 rounded-lg bg-accent px-4 py-2 text-white hover:opacity-90 disabled:opacity-60",children:I?"Creating":"Create account"})]}),u.jsx("div",{className:"mt-4",children:u.jsx("button",{type:"button",onClick:_,disabled:I,className:"w-full rounded-lg border border-border px-4 py-2 text-sm hover:bg-muted disabled:opacity-60",children:"Continue with Google"})}),u.jsxs("div",{className:"mt-4 text-sm text-text2",children:["Already have an account?"," ",u.jsx(_e,{to:"/login",className:"text-accent underline underline-offset-2",children:"Sign in"})]})]})})}function oM(){const t=R.useMemo(()=>Me(te),[]),{user:e,loading:n}=Ti(),r=(e==null?void 0:e.uid)??null,[s,i]=R.useState(null);if(R.useEffect(()=>{if(!r){i([]);return}const a=we(ie(t,`users/${r}/notifications`),It("createdAt","desc")),c=Te(a,d=>{const h=d.docs.map(p=>({id:p.id,...p.data()}));i(h.filter(p=>!p.read))},d=>{console.error("Notifications listener error:",(d==null?void 0:d.message)||d),i([])});return()=>c()},[t,r]),s===null||n)return u.jsxs("div",{className:"p-1",children:[u.jsx("h2",{className:"text-xl font-semibold text-accent",children:"Notifications"}),u.jsx("div",{className:"mt-2",children:u.jsx(pr,{label:"Loading notifications"})})]});async function o(a){if(r)try{await Nl(q(t,`users/${r}/notifications/${a}`),{read:!0,readAt:Ce()})}catch{}}return u.jsxs("div",{children:[u.jsx("h2",{className:"text-xl font-semibold text-accent",children:"Notifications"}),s.length===0?u.jsx("p",{className:"text-text2 mt-2",children:"You have no new notifications."}):u.jsx("ul",{className:"mt-3 space-y-2",children:s.map(a=>{const c=u.jsxs("div",{className:"flex items-center justify-between gap-2",children:[u.jsxs("div",{children:[u.jsx("p",{className:"text-sm",children:a.text}),a.groupName&&u.jsxs("p",{className:"text-xs text-text2",children:["Group: ",a.groupName]})]}),u.jsx("span",{className:"text-[10px] px-1.5 py-0.5 rounded-full bg-emerald-100 text-emerald-700 border border-emerald-200",children:"new"})]});return u.jsx("li",{className:"rounded-lg border border-border bg-card px-3 py-2 ring-1 ring-emerald-300/40",children:a.href?u.jsx(_e,{to:a.href,onClick:()=>o(a.id),className:"block hover:opacity-90",children:c}):u.jsx("button",{onClick:()=>o(a.id),className:"block w-full text-left hover:opacity-90",children:c})},a.id)})})]})}const aM="https://calendar.google.com/calendar/embed?src=immanueldowntown@gmail.com",lM="America/New_York";function uM(){const{isAdmin:t}=Ti(),e=R.useMemo(()=>Ue(te),[]),n=R.useMemo(()=>Me(te),[]),[r,s]=R.useState(!1),[i,o]=R.useState(null),a=R.useRef(!1),c=R.useRef(!1),d=R.useRef(new Map),h=R.useRef(new Map),p=R.useRef(new Map);R.useEffect(()=>{let y=!1;const T=[],b=()=>{y||s(a.current||c.current)},I=()=>{let _=!1;for(const E of d.current.values())if((E??0)>0){_=!0;break}c.current=_,b()},v=()=>{h.current.forEach(_=>{try{_()}catch{}}),h.current.clear(),p.current.clear(),a.current=!1,b()};async function w(){var O;const _=e.currentUser;if(!_)return;const E=_.uid;a.current=!1,d.current.clear(),c.current=!1,b();let j=!1;try{j=((O=(await xe(q(n,"users",E))).data())==null?void 0:O.isSuperAdmin)===!0}catch{j=!1}if(j)try{const S=we(jn(n,"membershipRequests"),Fe("status","==","pending"));T.push(Te(S,x=>{a.current=x.size>0,b()},()=>{a.current=!1,b()}))}catch{a.current=!1,b()}else try{const S=we(jn(n,"groupAdmins"),Fe("uid","==",E));T.push(Te(S,x=>{const N=new Set;x.forEach(P=>{var C;const D=(C=P.ref.parent.parent)==null?void 0:C.id;D&&N.add(D)});for(const[P,D]of h.current.entries())if(!N.has(P)){try{D()}catch{}h.current.delete(P),p.current.delete(P)}N.forEach(P=>{if(h.current.has(P))return;const D=we(ie(n,`groups/${P}/membershipRequests`),Fe("status","==","pending")),C=Te(D,pe=>{p.current.set(P,pe.size);let Ae=!1;for(const Ee of p.current.values())if((Ee??0)>0){Ae=!0;break}a.current=Ae,b()},()=>{p.current.set(P,0);let pe=!1;for(const Ae of p.current.values())if((Ae??0)>0){pe=!0;break}a.current=pe,b()});h.current.set(P,C)});let k=!1;for(const P of p.current.values())if((P??0)>0){k=!0;break}a.current=k,b()},()=>{v()}))}catch{v()}if(j){const S=(x,N)=>{try{const k=Te(N,P=>{d.current.set(x,P.size),I()},()=>{d.current.set(x,0),I()});T.push(k)}catch{d.current.set(x,0),I()}};S("reviewed",we(ie(n,"users"),Fe("reviewed","==",!1))),S("status",we(ie(n,"users"),Fe("status","==","pending"))),S("needsReview",we(ie(n,"users"),Fe("needsReview","==",!0)))}}return w(),()=>{y=!0,T.forEach(_=>{try{_()}catch{}}),v(),d.current.clear(),c.current=!1}},[e,n]),R.useEffect(()=>{let y=!1;async function T(){try{const I=(await xe(q(n,"appSettings","general"))).data();let v;I!=null&&I.calendarIds&&I.calendarIds.length?v=`https://calendar.google.com/calendar/embed?${I.calendarIds.map(_=>`src=${encodeURIComponent(_)}`).join("&")}`:I!=null&&I.calendarId?v=`https://calendar.google.com/calendar/embed?src=${encodeURIComponent(I.calendarId)}`:v=aM,y||o(v?`${v}${v.includes("?")?"&":"?"}ctz=${encodeURIComponent(lM)}`:null)}catch{y||o(null)}}return T(),()=>{y=!0}},[n]);const m=r?"text-sm px-3 py-1.5 rounded-lg bg-amber-100 text-amber-900 border border-amber-300 hover:bg-amber-200":"text-sm px-3 py-1.5 rounded-lg bg-slate-100 text-slate-900 hover:bg-slate-200";return u.jsxs("div",{className:"container py-8 md:py-10",children:[u.jsx("div",{className:"text-center mb-6",children:u.jsx("h1",{className:"text-2xl md:text-3xl font-semibold",children:"Welcome!"})}),t&&u.jsxs("section",{className:"mb-6 border border-border p-5 rounded-xl flex items-center justify-between",children:[u.jsxs("div",{children:[u.jsx("h2",{className:"text-xl font-semibold text-accent",children:"Admin Tools"}),u.jsx("p",{className:"text-sm text-text2",children:r?"Attention needed: pending requests or new users.":"You have admin privileges."})]}),u.jsx(_e,{to:"/admin",className:m,title:r?"Pending requests or new users need review":"Open Admin Console",children:"Admin Console"})]}),u.jsxs("section",{className:"border border-border p-5 rounded-xl",children:[u.jsx("h2",{className:"text-xl font-semibold text-accent",children:"General Announcements"}),u.jsxs("ul",{className:"mt-3 space-y-2 text-text",children:[u.jsx("li",{children:" Welcome to the Community Portal. Check your groups for updates. "}),u.jsx("li",{children:' Notifications are now working. Open your profile and click on "Enable notification" to be kept up to speed on announcements and new resources and communications in your groups.'}),u.jsx("li",{children:" Direct Messaging are now working so everyone can communicate easily in one place."}),u.jsx("li",{children:" We are still in development. If you find bugs, or have features you'd like to see added, send Sam a DM."})]}),u.jsx("div",{className:"mt-6 pt-5 border-t border-border",children:u.jsx("div",{className:"mt-2",children:u.jsx(oM,{})})})]}),u.jsxs("section",{className:"mt-8 border border-border p-5 rounded-xl",children:[u.jsx("h2",{className:"text-xl font-semibold text-accent",children:"Calendar"}),u.jsx("p",{className:"text-text2 text-sm mt-1",children:"Synced from church Google Calendar."}),u.jsx("div",{className:"mt-4 w-full",children:i?u.jsx("iframe",{className:"w-full h-[440px] sm:h-[520px] md:h-[720px] rounded border-0",src:i,title:"Church Calendar",loading:"lazy",referrerPolicy:"no-referrer-when-downgrade"}):u.jsx("div",{className:"w-full h-[440px] sm:h-[520px] md:h-[720px] flex items-center justify-center text-center p-6 text-sm text-text2 rounded bg-surface/50",children:u.jsxs("div",{children:[u.jsx("div",{className:"font-medium text-text mb-1",children:"Calendar not configured"}),u.jsxs("div",{children:["Set a ",u.jsx("code",{className:"px-1 py-0.5 rounded bg-surface/50",children:"Calendar ID"})," in Settings. In Google Calendar  ",u.jsx("em",{children:"Settings  Integrate calendar"}),", copy the ",u.jsx("strong",{children:"Calendar ID"})," and paste it there."]})]})})})]})]})}function cM(){const t=Ue(te),e=R.useMemo(()=>Me(te),[]),[n,r]=R.useState(null),[s,i]=R.useState(!0);return R.useEffect(()=>{if(!t.currentUser)return;const o=t.currentUser.uid,a=Te(ie(e,`users/${o}/memberships`),async c=>{const d=c.docs.map(p=>p.id);if(d.length===0){r([]),i(!1);return}const h=await Promise.all(d.map(async p=>{const m=await xe(q(e,"groups",p));if(m.exists()){const y=m.data();return{id:m.id,...y}}return null}));r(h.filter(Boolean)),i(!1)});return()=>a()},[t.currentUser,e]),s?u.jsx("div",{className:"container py-8",children:u.jsx("div",{className:"max-w-5xl mx-auto p-6",children:u.jsx(pr,{label:"Loading your groups"})})}):u.jsx("div",{className:"container py-8 md:py-12",children:u.jsxs("div",{className:"max-w-5xl mx-auto",children:[u.jsx("h1",{className:"text-2xl font-semibold text-accent mb-4",children:"Your Groups"}),n&&n.length>0?u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:n.map(o=>u.jsx(yI,{group:o,isMember:!0},o.id))}),u.jsx("div",{className:"mt-6",children:u.jsx(_e,{to:"/groups/explore",className:"inline-flex rounded-lg border border-border px-3 py-1.5 text-sm hover:bg-muted",children:"Other Available Groups"})})]}):u.jsxs("div",{className:"rounded-xl border border-border bg-card p-6",children:[u.jsx("p",{className:"text-text2",children:"You havent joined any groups yet."}),u.jsx(_e,{to:"/groups/explore",className:"inline-flex mt-3 rounded-lg bg-slate-900 text-white px-3 py-1.5 text-sm hover:bg-slate-800",children:"View More Groups"})]})]})})}async function dM(t,e){var n;try{const r=(n=vo.currentUser)==null?void 0:n.uid;if(!r||!t)return;await An(ie(dt,`users/${r}/activity`),{type:"resource_access",resourcePath:t,title:e||null,createdAt:Ce()})}catch(r){console.error("Failed to log activity",r)}}function hM(){const t=Me(te),[e,n]=R.useState([]),[r,s]=R.useState(""),[i,o]=R.useState([]);R.useEffect(()=>{const p=we(jn(t,"resources"),It("createdAt","desc"));return Te(p,y=>{n(y.docs.map(T=>({id:T.id,...T.data(),__path:T.ref.path})))})},[t]);const a=R.useMemo(()=>{const p=new Set;return e.forEach(m=>(m.tags||[]).forEach(y=>p.add(y))),Array.from(p).sort()},[e]),c=p=>{o(m=>m.includes(p)?m.filter(y=>y!==p):[...m,p])},d=p=>{try{const m=p!=null&&p.toDate?p.toDate():p instanceof Date?p:null;if(!m)return!1;const y=7*24*60*60*1e3;return Date.now()-m.getTime()<y}catch{return!1}},h=R.useMemo(()=>{const p=r.trim().toLowerCase();return e.filter(m=>{const y=p.length===0||(m.title||"").toLowerCase().includes(p)||(m.description||"").toLowerCase().includes(p)||(m.url||"").toLowerCase().includes(p),T=i.length===0||i.every(b=>(m.tags||[]).includes(b));return y&&T})},[e,r,i]);return u.jsxs("div",{className:"container py-10",children:[u.jsx("h1",{className:"text-2xl font-semibold text-accent",children:"Resources"}),u.jsx("p",{className:"text-text2 mt-2",children:"Documents, links, and media you have access to."}),u.jsxs("div",{className:"mt-6 flex flex-col gap-3",children:[u.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[u.jsx("input",{className:"rounded-lg border border-slate-300 bg-white px-3 py-2 text-sm outline-none",placeholder:"Search by title, description, or URL",value:r,onChange:p=>s(p.target.value)}),i.length>0&&u.jsx("button",{type:"button",className:"rounded-lg border border-slate-300 px-3 py-2 text-sm hover:bg-slate-100",onClick:()=>o([]),children:"Clear tags"})]}),a.length>0&&u.jsx("div",{className:"flex flex-wrap gap-2",children:a.map(p=>u.jsxs("button",{type:"button",onClick:()=>c(p),className:`text-xs rounded-full px-3 py-1 border ${i.includes(p)?"border-slate-700 bg-slate-800 text-white":"border-slate-300 bg-white text-slate-700 hover:bg-slate-50"}`,"aria-pressed":i.includes(p),children:["#",p]},p))}),u.jsxs("ul",{className:"divide-y divide-slate-200 rounded-2xl border border-slate-200 bg-white/70",children:[h.map(p=>u.jsx("li",{className:"p-4 flex items-start justify-between gap-3",children:u.jsxs("div",{className:"min-w-0",children:[u.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[u.jsx("a",{href:p.url,target:"_blank",rel:"noreferrer",className:"text-sm text-accent underline underline-offset-2 break-all",onClick:()=>dM(p.__path||"",p.title||p.url),children:p.title||p.url}),d(p.createdAt)&&u.jsx("span",{className:"text-[10px] uppercase tracking-wide rounded-full bg-green-100 text-green-800 px-2 py-0.5",children:"New"})]}),p.description&&u.jsx("p",{className:"mt-1 text-sm text-slate-600 whitespace-pre-wrap break-words",children:p.description}),p.tags&&p.tags.length>0&&u.jsx("div",{className:"mt-2 flex flex-wrap gap-1.5",children:p.tags.map(m=>u.jsxs("button",{type:"button",onClick:()=>c(m),className:`text-[11px] rounded-full px-2.5 py-1 border ${i.includes(m)?"border-slate-700 bg-slate-800 text-white":"border-slate-300 bg-white text-slate-700 hover:bg-slate-50"}`,"aria-pressed":i.includes(m),title:`Filter by #${m}`,children:["#",m]},m))})]})},p.__path||p.id)),h.length===0&&u.jsx("li",{className:"p-4 text-sm text-slate-600",children:"No resources match your filters."})]})]})]})}function fM(){return u.jsxs("div",{className:"container py-10",children:[u.jsx("h1",{className:"text-2xl font-semibold text-accent",children:"Events"}),u.jsx("p",{className:"text-text2 mt-2",children:"Calendar and upcoming gatherings."})]})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pM="type.googleapis.com/google.protobuf.Int64Value",mM="type.googleapis.com/google.protobuf.UInt64Value";function FI(t,e){const n={};for(const r in t)t.hasOwnProperty(r)&&(n[r]=e(t[r]));return n}function Pc(t){if(t==null)return null;if(t instanceof Number&&(t=t.valueOf()),typeof t=="number"&&isFinite(t)||t===!0||t===!1||Object.prototype.toString.call(t)==="[object String]")return t;if(t instanceof Date)return t.toISOString();if(Array.isArray(t))return t.map(e=>Pc(e));if(typeof t=="function"||typeof t=="object")return FI(t,e=>Pc(e));throw new Error("Data cannot be encoded in JSON: "+t)}function _o(t){if(t==null)return t;if(t["@type"])switch(t["@type"]){case pM:case mM:{const e=Number(t.value);if(isNaN(e))throw new Error("Data cannot be decoded from JSON: "+t);return e}default:throw new Error("Data cannot be decoded from JSON: "+t)}return Array.isArray(t)?t.map(e=>_o(e)):typeof t=="function"||typeof t=="object"?FI(t,e=>_o(e)):t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ng="functions";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kw={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class ln extends Ln{constructor(e,n,r){super(`${Ng}/${e}`,n||""),this.details=r,Object.setPrototypeOf(this,ln.prototype)}}function gM(t){if(t>=200&&t<300)return"ok";switch(t){case 0:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 500:return"internal";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}function jc(t,e){let n=gM(t),r=n,s;try{const i=e&&e.error;if(i){const o=i.status;if(typeof o=="string"){if(!kw[o])return new ln("internal","internal");n=kw[o],r=o}const a=i.message;typeof a=="string"&&(r=a),s=i.details,s!==void 0&&(s=_o(s))}}catch{}return n==="ok"?null:new ln(n,r,s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yM{constructor(e,n,r,s){this.app=e,this.auth=null,this.messaging=null,this.appCheck=null,this.serverAppAppCheckToken=null,Xt(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.auth=n.getImmediate({optional:!0}),this.messaging=r.getImmediate({optional:!0}),this.auth||n.get().then(i=>this.auth=i,()=>{}),this.messaging||r.get().then(i=>this.messaging=i,()=>{}),this.appCheck||s==null||s.get().then(i=>this.appCheck=i,()=>{})}async getAuthToken(){if(this.auth)try{const e=await this.auth.getToken();return e==null?void 0:e.accessToken}catch{return}}async getMessagingToken(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return await this.messaging.getToken()}catch{return}}async getAppCheckToken(e){if(this.serverAppAppCheckToken)return this.serverAppAppCheckToken;if(this.appCheck){const n=e?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return n.error?null:n.token}return null}async getContext(e){const n=await this.getAuthToken(),r=await this.getMessagingToken(),s=await this.getAppCheckToken(e);return{authToken:n,messagingToken:r,appCheckToken:s}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gp="us-central1",vM=/^data: (.*?)(?:\n|$)/;function _M(t){let e=null;return{promise:new Promise((n,r)=>{e=setTimeout(()=>{r(new ln("deadline-exceeded","deadline-exceeded"))},t)}),cancel:()=>{e&&clearTimeout(e)}}}class wM{constructor(e,n,r,s,i=gp,o=(...a)=>fetch(...a)){this.app=e,this.fetchImpl=o,this.emulatorOrigin=null,this.contextProvider=new yM(e,n,r,s),this.cancelAllRequests=new Promise(a=>{this.deleteService=()=>Promise.resolve(a())});try{const a=new URL(i);this.customDomain=a.origin+(a.pathname==="/"?"":a.pathname),this.region=gp}catch{this.customDomain=null,this.region=i}}_delete(){return this.deleteService()}_url(e){const n=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${n}/${this.region}/${e}`:this.customDomain!==null?`${this.customDomain}/${e}`:`https://${this.region}-${n}.cloudfunctions.net/${e}`}}function xM(t,e,n){const r=zr(e);t.emulatorOrigin=`http${r?"s":""}://${e}:${n}`,r&&(ed(t.emulatorOrigin),td("Functions",!0))}function EM(t,e,n){const r=s=>SM(t,e,s,{});return r.stream=(s,i)=>bM(t,e,s,i),r}async function TM(t,e,n,r){n["Content-Type"]="application/json";let s;try{s=await r(t,{method:"POST",body:JSON.stringify(e),headers:n})}catch{return{status:0,json:null}}let i=null;try{i=await s.json()}catch{}return{status:s.status,json:i}}async function $I(t,e){const n={},r=await t.contextProvider.getContext(e.limitedUseAppCheckTokens);return r.authToken&&(n.Authorization="Bearer "+r.authToken),r.messagingToken&&(n["Firebase-Instance-ID-Token"]=r.messagingToken),r.appCheckToken!==null&&(n["X-Firebase-AppCheck"]=r.appCheckToken),n}function SM(t,e,n,r){const s=t._url(e);return IM(t,s,n,r)}async function IM(t,e,n,r){n=Pc(n);const s={data:n},i=await $I(t,r),o=r.timeout||7e4,a=_M(o),c=await Promise.race([TM(e,s,i,t.fetchImpl),a.promise,t.cancelAllRequests]);if(a.cancel(),!c)throw new ln("cancelled","Firebase Functions instance was deleted.");const d=jc(c.status,c.json);if(d)throw d;if(!c.json)throw new ln("internal","Response is not valid JSON object.");let h=c.json.data;if(typeof h>"u"&&(h=c.json.result),typeof h>"u")throw new ln("internal","Response is missing data field.");return{data:_o(h)}}function bM(t,e,n,r){const s=t._url(e);return NM(t,s,n,r||{})}async function NM(t,e,n,r){var m;n=Pc(n);const s={data:n},i=await $I(t,r);i["Content-Type"]="application/json",i.Accept="text/event-stream";let o;try{o=await t.fetchImpl(e,{method:"POST",body:JSON.stringify(s),headers:i,signal:r==null?void 0:r.signal})}catch(y){if(y instanceof Error&&y.name==="AbortError"){const b=new ln("cancelled","Request was cancelled.");return{data:Promise.reject(b),stream:{[Symbol.asyncIterator](){return{next(){return Promise.reject(b)}}}}}}const T=jc(0,null);return{data:Promise.reject(T),stream:{[Symbol.asyncIterator](){return{next(){return Promise.reject(T)}}}}}}let a,c;const d=new Promise((y,T)=>{a=y,c=T});(m=r==null?void 0:r.signal)==null||m.addEventListener("abort",()=>{const y=new ln("cancelled","Request was cancelled.");c(y)});const h=o.body.getReader(),p=AM(h,a,c,r==null?void 0:r.signal);return{stream:{[Symbol.asyncIterator](){const y=p.getReader();return{async next(){const{value:T,done:b}=await y.read();return{value:T,done:b}},async return(){return await y.cancel(),{done:!0,value:void 0}}}}},data:d}}function AM(t,e,n,r){const s=(o,a)=>{const c=o.match(vM);if(!c)return;const d=c[1];try{const h=JSON.parse(d);if("result"in h){e(_o(h.result));return}if("message"in h){a.enqueue(_o(h.message));return}if("error"in h){const p=jc(0,h);a.error(p),n(p);return}}catch(h){if(h instanceof ln){a.error(h),n(h);return}}},i=new TextDecoder;return new ReadableStream({start(o){let a="";return c();async function c(){if(r!=null&&r.aborted){const d=new ln("cancelled","Request was cancelled");return o.error(d),n(d),Promise.resolve()}try{const{value:d,done:h}=await t.read();if(h){a.trim()&&s(a.trim(),o),o.close();return}if(r!=null&&r.aborted){const m=new ln("cancelled","Request was cancelled");o.error(m),n(m),await t.cancel();return}a+=i.decode(d,{stream:!0});const p=a.split(`
`);a=p.pop()||"";for(const m of p)m.trim()&&s(m.trim(),o);return c()}catch(d){const h=d instanceof ln?d:jc(0,null);o.error(h),n(h)}}},cancel(){return t.cancel()}})}const Pw="@firebase/functions",jw="0.13.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CM="auth-internal",RM="app-check-internal",kM="messaging-internal";function PM(t){const e=(n,{instanceIdentifier:r})=>{const s=n.getProvider("app").getImmediate(),i=n.getProvider(CM),o=n.getProvider(kM),a=n.getProvider(RM);return new wM(s,i,o,a,r)};Pn(new wn(Ng,e,"PUBLIC").setMultipleInstances(!0)),$t(Pw,jw,t),$t(Pw,jw,"esm2020")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rd(t=Io(),e=gp){const r=Os(Re(t),Ng).getImmediate({identifier:e}),s=fm("functions");return s&&jM(r,...s),r}function jM(t,e,n){xM(Re(t),e,n)}function Al(t,e,n){return EM(Re(t),e)}PM();function DM(t){return t?"present":"missing"}async function OM(){const t=await(async()=>{try{return!!await Promise.resolve(Cd())}catch{return!1}})(),e=await navigator.serviceWorker.getRegistration("/sw.js"),s={permission:typeof Notification<"u"?Notification.permission:"unavailable",swRegistered:!!e,swScope:(e==null?void 0:e.scope)||null,messagingSupported:t,vapidKey:DM("BOhz8CwPpf6kstE2HWU-Pyb4bkPGM6OpdVzU3PYrhyMSGZKyds6UzoSlQN1lRYxrmtf-HGQwSw5DivQ0SjkdxCI")};return console.table(s),s}async function BI(){try{return!!await Promise.resolve(Cd())}catch(t){return console.warn("[push] getMessagingIfSupported threw:",t),!1}}async function LM(t){console.groupCollapsed("[push] enroll start");try{if(await OM(),!await BI())return console.warn("[push] messaging not supported in this environment"),null;let e=Notification.permission;if(e!=="granted"&&(e=await Notification.requestPermission()),console.log("[push] permission after request:",e),e!=="granted")return console.warn("[push] user did not grant permission"),null;let n=await navigator.serviceWorker.getRegistration("/sw.js");if(n)console.log("[push] using existing SW at",n.scope);else{console.log("[push] registering /sw.js");try{n=await navigator.serviceWorker.register("/sw.js"),console.log("[push] /sw.js registered at",n.scope)}catch(o){return console.warn("[push] failed to register /sw.js:",o),null}}const r=await Promise.resolve(Cd());if(!r)return console.warn("[push] getMessagingIfSupported returned null"),null;const s="BOhz8CwPpf6kstE2HWU-Pyb4bkPGM6OpdVzU3PYrhyMSGZKyds6UzoSlQN1lRYxrmtf-HGQwSw5DivQ0SjkdxCI";let i=null;try{i=await NL(r,{vapidKey:s,serviceWorkerRegistration:n})}catch(o){return console.warn("[push] getToken() threw:",o),null}if(!i)return console.warn("[push] getToken() returned null/empty"),null;console.log("[push] obtained token (truncated):",i.slice(0,10)+"...");try{const o=q(dt,`users/${t}/pushTokens/${i}`);await ze(o,{token:i,createdAt:Ce(),userAgent:navigator.userAgent||""},{merge:!0}),console.log("[push] token saved to Firestore (client)")}catch(o){console.warn("[push] failed to write token to Firestore (client):",o)}try{await Al(Rd(te,"us-central1"),"registerPushToken")({token:i}),console.log("[push] token saved via callable (server)")}catch(o){console.warn("[push] registerPushToken callable failed (non-fatal):",o)}return i}finally{console.groupEnd()}}async function VM(t){if(!await BI())return()=>{};const e=await Promise.resolve(Cd());return e?AL(e,r=>{try{t(r)}catch(s){console.warn("[push] handler error:",s)}}):()=>{}}function MM(){const t=Ue(),e=t.currentUser,[n,r]=R.useState(null),[s,i]=R.useState(null);R.useEffect(()=>{if(!e)return;const a=q(dt,"users",e.uid),c=Te(a,d=>r(d.data()),d=>console.warn("Profile onSnapshot error:",d));return()=>c()},[e]),R.useEffect(()=>{if(!e)return;let a=null,c=!1;return(async()=>{try{const d=await VM(h=>{console.log("[push] Foreground message:",h);const p=(h==null?void 0:h.data)||{};i({title:p.title||"Notification",body:p.body||""}),setTimeout(()=>i(null),6e3)});c?typeof d=="function"&&d():a=typeof d=="function"?d:null}catch(d){console.warn("listenForegroundMessages failed:",d)}})(),()=>{if(c=!0,typeof a=="function")try{a()}catch{}}},[e]);const o=async()=>{try{const a=t.currentUser;if(!a)return;const c=await LM(a.uid);alert(c?"Notifications enabled on this device.":"Notifications not enabled (permission denied or unsupported).")}catch(a){console.error("Notification setup failed",a),alert("Could not enable notifications.")}};return u.jsx("div",{className:"container py-8",children:u.jsxs("div",{className:"max-w-3xl mx-auto rounded-xl border border-border bg-card p-6",children:[u.jsx("h1",{className:"text-xl font-semibold text-accent mb-4",children:"Profile"}),e&&u.jsxs("div",{className:"mb-4 text-sm text-text",children:[u.jsxs("p",{children:[u.jsx("span",{className:"font-medium",children:"Email:"})," ",e.email]}),u.jsxs("p",{children:[u.jsx("span",{className:"font-medium",children:"UID:"})," ",e.uid]})]}),n&&u.jsx("div",{className:"mb-6 text-sm text-text2",children:n.displayName&&u.jsxs("p",{children:[u.jsx("span",{className:"font-medium text-text",children:"Display Name:"})," ",n.displayName]})}),s&&u.jsxs("div",{className:"mb-4 rounded-lg border border-border bg-card p-3",children:[u.jsx("div",{className:"text-sm font-semibold text-accent",children:s.title}),u.jsx("div",{className:"text-sm text-text2",children:s.body})]}),u.jsxs("section",{className:"mt-2 rounded-xl border border-border bg-card p-5",children:[u.jsx("h2",{className:"text-lg font-semibold text-accent",children:"Notifications"}),u.jsx("p",{className:"text-sm text-text2 mt-1",children:"Enable push notifications on this device to get updates."}),u.jsx("div",{className:"mt-3 flex gap-3",children:u.jsx("button",{type:"button",onClick:o,className:"rounded-lg px-4 py-2 text-white text-sm",style:{backgroundColor:"#919FAA"},children:"Enable notifications on this device"})})]})]})})}function UM(){const t=H.useMemo(()=>Ue(te),[]),e=H.useMemo(()=>Me(te),[]),[n,r]=H.useState(""),[s,i]=H.useState(!1),[o,a]=H.useState(!1);H.useEffect(()=>{var h;const d=(h=t.currentUser)==null?void 0:h.uid;d&&xe(q(e,"users",d)).then(p=>{var m;return i(((m=p.data())==null?void 0:m.isSuperAdmin)===!0)}).catch(()=>i(!1))},[t,e]),H.useEffect(()=>{xe(q(e,"appSettings","general")).then(d=>{if(d.exists()){const h=d.data();h!=null&&h.calendarIds&&h.calendarIds.length?r(h.calendarIds.join(", ")):h!=null&&h.calendarId&&r(h.calendarId)}}).catch(()=>{})},[e]);const c=async()=>{a(!0);try{await ze(q(e,"appSettings","general"),(()=>{const d=n.split(",").map(h=>h.trim()).filter(Boolean);return{calendarIds:d,calendarId:d[0]||""}})(),{merge:!0})}catch{alert("Failed to save settings")}finally{a(!1)}};return u.jsxs("div",{className:"container py-10",children:[u.jsx("h1",{className:"text-2xl font-semibold text-accent",children:"Settings"}),u.jsx("p",{className:"text-text2 mt-2",children:"Preferences and app settings."}),s&&u.jsxs("div",{className:"mt-8 max-w-lg",children:[u.jsxs("label",{className:"block text-sm font-medium text-text",children:["Calendar IDs (comma-separated)",u.jsx("input",{type:"text",value:n,onChange:d=>r(d.target.value),placeholder:"id1@group.calendar.google.com, id2@group.calendar.google.com",className:"mt-1 w-full rounded border border-border p-2"})]}),u.jsx("button",{onClick:c,disabled:o,className:"mt-2 px-3 py-1.5 rounded-lg bg-accent text-white hover:bg-accent/90 disabled:opacity-50",children:"Save"})]})]})}function FM(){const[t,e]=R.useState(""),[n,r]=R.useState(!1),[s,i]=R.useState(null),[o,a]=R.useState(!1);async function c(d){d.preventDefault(),i(null),r(!0);try{await Ck(vo,t),a(!0)}catch(h){i((h==null?void 0:h.message)||"Failed to send reset email")}finally{r(!1)}}return u.jsx("div",{className:"flex flex-col items-center min-h-screen bg-[var(--bg)] text-white pt-[15vh]",children:u.jsxs("div",{className:"w-full max-w-sm",children:[u.jsx("h1",{className:"text-2xl font-bold mb-2 text-center",children:"Forgot password"}),u.jsx("p",{className:"mb-6 text-center text-text2",children:"Enter your account email and well send you a reset link."}),o?u.jsxs("div",{className:"border border-border p-4 text-center",children:[u.jsx("p",{className:"text-accent",children:"Check your email"}),u.jsxs("p",{className:"text-text2 text-sm mt-1",children:["If an account exists for ",u.jsx("span",{className:"text-text",children:t}),", youll receive a password reset link shortly."]}),u.jsx(_e,{to:"/login",className:"btn btn-outline mt-4 w-full",children:"Back to sign in"})]}):u.jsxs("form",{onSubmit:c,className:"space-y-3",children:[u.jsx("input",{type:"email",className:"input w-full",placeholder:"Email",value:t,onChange:d=>e(d.target.value),required:!0,autoComplete:"email"}),s&&u.jsx("div",{className:"text-red-400 text-sm",children:s}),u.jsx("button",{className:"btn btn-primary w-full",disabled:n,children:n?"Sending":"Send reset link"}),u.jsx("div",{className:"text-center",children:u.jsx(_e,{to:"/login",className:"text-sm underline text-text2",children:"Back to sign in"})})]})]})})}function $M(){const[t]=GC(),e=Br(),n=t.get("oobCode")||"",[r,s]=R.useState(null),[i,o]=R.useState(""),[a,c]=R.useState(""),[d,h]=R.useState(!0),[p,m]=R.useState(null),[y,T]=R.useState(!1);R.useEffect(()=>{async function I(){try{const v=await Pk(vo,n);s(v)}catch(v){m((v==null?void 0:v.message)||"Invalid or expired reset link.")}finally{h(!1)}}n?I():(m("Missing reset code."),h(!1))},[n]);async function b(I){if(I.preventDefault(),m(null),i.length<6){m("Password must be at least 6 characters.");return}if(i!==a){m("Passwords do not match.");return}try{await Rk(vo,n,i),T(!0),setTimeout(()=>e("/login",{replace:!0}),1200)}catch(v){m((v==null?void 0:v.message)||"Failed to reset password.")}}return d?u.jsx("div",{className:"container py-20",children:"Checking reset link"}):u.jsx("div",{className:"flex flex-col items-center min-h-screen bg-[var(--bg)] text-white pt-[15vh]",children:u.jsxs("div",{className:"w-full max-w-sm",children:[u.jsx("h1",{className:"text-2xl font-bold mb-2 text-center",children:"Reset password"}),p&&u.jsxs("div",{className:"border border-border p-4 text-center",children:[u.jsx("p",{className:"text-red-400 text-sm",children:p}),u.jsx(_e,{to:"/forgot",className:"btn btn-outline mt-4 w-full",children:"Request a new link"})]}),!p&&!y&&u.jsxs(u.Fragment,{children:[u.jsxs("p",{className:"mb-6 text-center text-text2",children:["Resetting password for ",r]}),u.jsxs("form",{onSubmit:b,className:"space-y-3",children:[u.jsx("input",{type:"password",className:"input w-full",placeholder:"New password",value:i,onChange:I=>o(I.target.value),required:!0,autoComplete:"new-password"}),u.jsx("input",{type:"password",className:"input w-full",placeholder:"Confirm new password",value:a,onChange:I=>c(I.target.value),required:!0,autoComplete:"new-password"}),u.jsx("button",{className:"btn btn-primary w-full",children:"Set new password"})]})]}),y&&u.jsxs("div",{className:"border border-border p-4 text-center",children:[u.jsx("p",{className:"text-accent",children:"Password updated!"}),u.jsx("p",{className:"text-text2 text-sm mt-1",children:"Taking you back to sign in"})]})]})})}const Wi=[{id:"downtown",name:"Downtown"}];function BM(t){const e=t.trim().split(/\s+/).filter(Boolean);return e.length===0?{firstName:"",lastName:""}:e.length===1?{firstName:e[0],lastName:""}:{firstName:e[0],lastName:e.slice(1).join(" ")}}function zM(t){if(!t)return"";const e=String(t).trim();return Wi.some(n=>n.id.toLowerCase()===e.toLowerCase())?Wi.find(n=>n.id.toLowerCase()===e.toLowerCase()).id:Wi.some(n=>n.name.toLowerCase()===e.toLowerCase())?Wi.find(n=>n.name.toLowerCase()===e.toLowerCase()).id:""}function qM(){const t=Br(),e=On(),n=Ue(te),r=Me(te),[s,i]=H.useState(!1),[o,a]=H.useState(n.currentUser),[c,d]=H.useState(""),[h,p]=H.useState(!1),[m,y]=H.useState(""),[T,b]=H.useState(""),[I,v]=H.useState(!1),[w,_]=H.useState(null);H.useEffect(()=>{const j=Vn(n,async O=>{var x;if(a(O),!O){i(!0);return}let S=O.displayName||((x=e.state)==null?void 0:x.name)||"";if(!S)try{const N=localStorage.getItem("signupName");N&&(S=N)}catch{}try{const N=await xe(q(r,"users",O.uid)),k=N.exists()?N.data():null;!S&&(k!=null&&k.displayName)&&(S=String(k.displayName)),k!=null&&k.phone&&y(String(k.phone)),k!=null&&k.campus&&b(zM(String(k.campus)))}catch{}d(S||""),p(!!S),i(!0)});return()=>j()},[n,r,e.state]);async function E(){var N;if(_(null),!o){_("You are not signed in.");return}const j=c.trim();if(!h&&!j){_("Please enter your name.");return}const O=h?(o==null?void 0:o.displayName)||c:j,{firstName:S,lastName:x}=BM(O);v(!0);try{if(!h){if(!n.currentUser)throw new Error("No current user.");await H0(n.currentUser,{displayName:O})}await ze(q(r,"users",o.uid),{displayName:O,firstName:S,lastName:x,phone:m.trim()||null,campus:T||null,campusName:((N=Wi.find(k=>k.id===T))==null?void 0:N.name)||null,updatedAt:Ce(),onboardedAt:Ce(),reviewed:!1,needsReview:!0},{merge:!0});try{localStorage.removeItem("signupName"),localStorage.removeItem("signupFirstName"),localStorage.removeItem("signupLastName")}catch{}t("/dashboard",{replace:!0})}catch(k){_((k==null?void 0:k.message)||"Could not save your profile.")}finally{v(!1)}}return s?o?u.jsx("div",{className:"container py-8 md:py-12",children:u.jsxs("div",{className:"mx-auto max-w-md rounded-xl border border-border bg-card p-6 shadow",children:[u.jsx("h1",{className:"text-2xl font-semibold text-accent mb-2",children:"Welcome!"}),u.jsx("p",{className:"text-sm text-text2 mb-4",children:"Lets finish setting up your profile."}),h?u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"text-sm block text-text2",children:"Name"}),u.jsx("div",{className:"mt-1 rounded-lg border border-border bg-muted px-3 py-2 text-sm",children:c}),u.jsx("p",{className:"mt-1 text-xs text-text2",children:"Pulled from your sign-up. You can edit this later in Profile."})]}):u.jsxs("label",{className:"mb-4 block",children:[u.jsx("span",{className:"text-sm",children:"Name"}),u.jsx("input",{type:"text",value:c,onChange:j=>d(j.target.value),placeholder:"First Last",className:"mt-1 w-full rounded-lg border border-border bg-background px-3 py-2 text-sm outline-none"})]}),u.jsxs("label",{className:"mb-4 block",children:[u.jsx("span",{className:"text-sm",children:"Phone (optional)"}),u.jsx("input",{type:"tel",value:m,onChange:j=>y(j.target.value),placeholder:"(555) 555-5555",className:"mt-1 w-full rounded-lg border border-border bg-background px-3 py-2 text-sm outline-none"})]}),u.jsxs("label",{className:"mb-4 block",children:[u.jsx("span",{className:"text-sm",children:"Campus (optional)"}),u.jsxs("select",{value:T,onChange:j=>b(j.target.value),className:"mt-1 w-full rounded-lg border border-border bg-background px-3 py-2 text-sm outline-none",children:[u.jsx("option",{value:"",children:"Select a campus (optional)"}),Wi.map(j=>u.jsx("option",{value:j.id,children:j.name},j.id))]})]}),w&&u.jsx("p",{className:"text-sm text-rose-700 mb-2",children:w}),u.jsx("button",{onClick:E,disabled:I,className:"px-4 py-2 rounded-lg bg-slate-900 text-white hover:bg-slate-800 disabled:opacity-60",children:I?"Saving":"Save and continue"})]})}):u.jsx("div",{className:"container py-8",children:u.jsx("div",{className:"mx-auto max-w-md rounded-xl border border-border bg-card p-6",children:u.jsx("p",{className:"text-sm text-text2",children:"You are not signed in."})})}):u.jsx("div",{className:"container py-8",children:u.jsx("div",{className:"mx-auto max-w-md",children:u.jsx(pr,{label:"Loading your account"})})})}const WM="modulepreload",HM=function(t){return"/"+t},Dw={},GM=function(e,n,r){let s=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),a=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));s=Promise.allSettled(n.map(c=>{if(c=HM(c),c in Dw)return;Dw[c]=!0;const d=c.endsWith(".css"),h=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${h}`))return;const p=document.createElement("link");if(p.rel=d?"stylesheet":WM,d||(p.as="script"),p.crossOrigin="",p.href=c,a&&p.setAttribute("nonce",a),document.head.appendChild(p),d)return new Promise((m,y)=>{p.addEventListener("load",m),p.addEventListener("error",()=>y(new Error(`Unable to preload CSS for ${c}`)))})}))}function i(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return s.then(o=>{for(const a of o||[])a.status==="rejected"&&i(a.reason);return e().catch(i)})};function KM(){const t=H.useMemo(()=>Me(te),[]),{user:e}=Ti(),[n,r]=H.useState(null),[s,i]=H.useState(null),[o,a]=H.useState(""),[c,d]=H.useState(""),[h,p]=H.useState(""),[m,y]=H.useState(null),[T,b]=H.useState(!1);H.useEffect(()=>{let _;if(e!=null&&e.uid){const E=q(t,"users",e.uid);GM(async()=>{const{onSnapshot:j}=await Promise.resolve().then(()=>ZD);return{onSnapshot:j}},void 0).then(({onSnapshot:j})=>{_=j(E,O=>{var S;return r(((S=O.data())==null?void 0:S.isSuperAdmin)===!0)})})}else r(!1);return()=>{_&&_()}},[t,e==null?void 0:e.uid]),H.useEffect(()=>{const _=we(ie(t,"sundayResources"),It("createdAt","desc")),E=Te(_,j=>{const O=j.docs.map(S=>({id:S.id,...S.data()}));i(O)});return()=>E()},[t]);async function I(_){if(_.preventDefault(),!!n){if(y(null),!o.trim()||!c.trim()){y("Title and URL are required.");return}try{b(!0),await An(ie(t,"sundayResources"),{title:o.trim(),url:c.trim(),note:h.trim()||null,createdAt:Ce(),createdBy:(e==null?void 0:e.uid)??null,createdByName:(e==null?void 0:e.displayName)??null}),a(""),d(""),p("")}catch(E){y((E==null?void 0:E.message)||"Failed to add resource.")}finally{b(!1)}}}async function v(_){if(n)try{await mt(q(t,"sundayResources",_))}catch{}}const w=n===!0;return s===null||n===null?u.jsx("div",{className:"container py-8 md:py-12",children:u.jsxs("div",{className:"max-w-4xl mx-auto",children:[u.jsx("h1",{className:"text-2xl font-semibold text-accent",children:"Sunday White Papers"}),u.jsx("div",{className:"mt-4",children:u.jsx(pr,{label:"Loading"})})]})}):u.jsx("div",{className:"container py-8 md:py-12",children:u.jsxs("div",{className:"max-w-4xl mx-auto",children:[u.jsx("h1",{className:"text-2xl font-semibold text-accent",children:"Sunday White Papers"}),u.jsx("p",{className:"text-text2 mt-2",children:"A curated library of Sunday white papers and study resources."}),w&&u.jsxs("section",{className:"mt-6 rounded-xl border border-border bg-card p-5",children:[u.jsx("h2",{className:"text-lg font-semibold text-accent",children:"Add a resource"}),m&&u.jsx("p",{className:"text-red-500 text-sm mt-2",children:m}),u.jsxs("form",{onSubmit:I,className:"mt-3 grid grid-cols-1 md:grid-cols-12 gap-3",children:[u.jsx("input",{type:"text",value:o,onChange:_=>a(_.target.value),placeholder:"Title",className:"md:col-span-3 rounded-lg border border-border bg-muted px-3 py-2 text-sm text-text focus:outline-none focus:ring-2 focus:ring-accent/30"}),u.jsx("input",{type:"url",value:c,onChange:_=>d(_.target.value),placeholder:"URL (Google Drive, video, article)",className:"md:col-span-6 rounded-lg border border-border bg-muted px-3 py-2 text-sm text-text focus:outline-none focus:ring-2 focus:ring-accent/30"}),u.jsx("input",{type:"text",value:h,onChange:_=>p(_.target.value),placeholder:"Note (optional)",className:"md:col-span-3 rounded-lg border border-border bg-muted px-3 py-2 text-sm text-text focus:outline-none focus:ring-2 focus:ring-accent/30"}),u.jsx("div",{className:"md:col-span-12 flex justify-end",children:u.jsx("button",{type:"submit",disabled:T,className:"text-sm px-3 py-1.5 rounded-lg bg-slate-900 text-white hover:bg-slate-800 disabled:opacity-60",children:T?"Adding":"Add resource"})})]})]}),u.jsxs("section",{className:"mt-6 rounded-xl border border-border bg-card p-5",children:[u.jsx("h2",{className:"text-lg font-semibold text-accent",children:"Resources"}),s.length===0?u.jsx("p",{className:"text-text2 text-sm mt-2",children:"No resources yet."}):u.jsx("ul",{className:"mt-3 space-y-2",children:s.map(_=>u.jsx("li",{className:"rounded-lg border border-border bg-muted px-3 py-2",children:u.jsxs("div",{className:"flex items-center justify-between gap-3",children:[u.jsxs("div",{className:"min-w-0",children:[u.jsx("p",{className:"text-sm font-medium truncate",children:u.jsx("a",{href:_.url,target:"_blank",rel:"noopener noreferrer",className:"hover:underline",children:_.title})}),_.note&&u.jsx("p",{className:"text-xs text-text2 mt-0.5",children:_.note})]}),u.jsxs("div",{className:"flex items-center gap-2 shrink-0",children:[u.jsx(_e,{to:_.url,target:"_blank",className:"text-xs px-2 py-1 rounded-md border border-border hover:bg-muted/70",children:"Open"}),w&&u.jsx("button",{onClick:()=>v(_.id),className:"text-xs px-2 py-1 rounded-md border border-border hover:bg-muted/70",title:"Delete",children:"Delete"})]})]})},_.id))})]})]})})}const QM=Al(Rd(te,"us-central1"),"askPastorQuestion");async function YM(t){await QM({text:t})}function XM(){const{user:t}=Ti(),[e,n]=R.useState(null),[r,s]=R.useState(null),[i,o]=R.useState(null),[a,c]=R.useState(""),[d,h]=R.useState(""),[p,m]=R.useState(null),[y,T]=R.useState(""),[b,I]=R.useState(""),[v,w]=R.useState(""),[_,E]=R.useState(""),[j,O]=R.useState(""),[S,x]=R.useState(""),[N,k]=R.useState(!1),[P,D]=R.useState(""),[C,pe]=R.useState(""),[Ae,Ee]=R.useState(!1);R.useEffect(()=>{const Y=we(ie(dt,"sundayResources"),It("createdAt","desc")),M=Te(Y,z=>{const Z=z.docs.map(he=>({id:he.id,...he.data()}));n(Z)});return()=>M()},[]),R.useEffect(()=>{const Y=we(ie(dt,"forumThreads"),It("createdAt","desc")),M=Te(Y,z=>{const Z=z.docs.map(he=>({id:he.id,...he.data()}));o(Z)});return()=>M()},[]),R.useEffect(()=>{const Y=we(ie(dt,"forumResources"),It("createdAt","desc")),M=Te(Y,z=>{const Z=z.docs.map(he=>({id:he.id,...he.data()}));s(Z)});return()=>M()},[]),R.useEffect(()=>{let Y;if(t!=null&&t.uid){const M=q(dt,"users",t.uid);Y=Te(M,z=>{var Z;return m(((Z=z.data())==null?void 0:Z.isSuperAdmin)===!0)})}else m(!1);return()=>{Y&&Y()}},[t==null?void 0:t.uid]);const J=async Y=>{Y.preventDefault();const M=a.trim(),z=d.trim();if(!M||!z||!t)return;const Z=await An(ie(dt,"forumThreads"),{title:M,createdAt:Ce(),creator:t.uid});await An(ie(dt,"forumThreads",Z.id,"posts"),{author:t.displayName||t.email||"Anonymous",content:z,uid:t.uid,createdAt:Ce()}),c(""),h("")},F=async Y=>{if(Y.preventDefault(),!p)return;const M=y.trim(),z=b.trim(),Z=v.trim();!M||!z||(await An(ie(dt,"sundayResources"),{title:M,url:z,note:Z||null,createdAt:Ce(),createdBy:(t==null?void 0:t.uid)??null}),T(""),I(""),w(""))},K=async Y=>{p&&await mt(q(dt,"sundayResources",Y))},ne=async Y=>{if(Y.preventDefault(),!p)return;const M=_.trim(),z=j.trim(),Z=S.trim();!M||!z||(await An(ie(dt,"forumResources"),{title:M,url:z,note:Z||null,createdAt:Ce(),createdBy:(t==null?void 0:t.uid)??null}),E(""),O(""),x(""))},ge=async Y=>{p&&await mt(q(dt,"forumResources",Y))},me=()=>{k(!0),D(""),pe(""),Ee(!1)},ue=async Y=>{Y.preventDefault();const M=P.trim();if(!M){pe("Question cannot be empty"),Ee(!0);return}if(!t){pe("Sign in required"),Ee(!0);return}try{await YM(M),pe("Question sent."),Ee(!1),D("")}catch(z){let Z="Could not send question.";(z==null?void 0:z.code)==="unauthenticated"?Z="Sign in required":(z==null?void 0:z.code)==="invalid-argument"&&(Z="Question cannot be empty"),pe(Z),Ee(!0)}};return u.jsxs(u.Fragment,{children:[N&&u.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",children:u.jsxs("div",{className:"w-full max-w-md rounded-md bg-background p-4",children:[u.jsx("h2",{className:"mb-2 text-lg font-semibold",children:"Ask a Question"}),u.jsxs("form",{onSubmit:ue,className:"space-y-3",children:[u.jsx("textarea",{value:P,onChange:Y=>D(Y.target.value),placeholder:"Type your question",className:"w-full rounded-md border border-border bg-background p-2",rows:4}),C&&u.jsx("p",{className:`text-sm ${Ae?"text-red-500":"text-green-600"}`,children:C}),u.jsxs("div",{className:"flex justify-end space-x-2",children:[u.jsx("button",{type:"button",onClick:()=>k(!1),className:"rounded-md border border-border bg-background px-4 py-2",children:"Close"}),u.jsx("button",{type:"submit",className:"rounded-md bg-accent px-4 py-2 text-slate-900",children:"Send"})]})]})]})}),u.jsx("div",{className:"container py-8 md:py-12",children:u.jsxs("div",{className:"max-w-4xl mx-auto space-y-10",children:[u.jsxs("section",{className:"text-center mb-6",children:[u.jsx("h1",{className:"text-2xl md:text-3xl font-semibold",children:"The Forum"}),u.jsx("p",{className:"text-text2 mt-2",children:"Connect with others and explore resources."})]}),u.jsx("div",{className:"text-right",children:u.jsx("button",{onClick:me,className:"mb-4 rounded-md bg-accent px-4 py-2 text-slate-900",children:"Ask a Question"})}),u.jsxs("section",{className:"border border-border p-5 rounded-xl",children:[u.jsx("h2",{className:"text-xl font-semibold text-accent",children:"Discussion Board"}),i===null?u.jsx("p",{className:"text-text2 mt-2",children:"Loading"}):i.length===0?u.jsx("p",{className:"text-text2 mt-2",children:"No threads yet."}):u.jsx("ul",{className:"mt-4 space-y-2",children:i.map(Y=>u.jsx("li",{className:"rounded-lg border border-border bg-muted p-3",children:u.jsx(_e,{to:`/forum/thread/${Y.id}`,className:"font-medium text-accent hover:underline",children:Y.title})},Y.id))}),t&&u.jsxs("form",{onSubmit:J,className:"mt-4 space-y-2",children:[u.jsx("input",{type:"text",value:a,onChange:Y=>c(Y.target.value),placeholder:"New thread title",className:"w-full rounded-md border border-border bg-background p-2"}),u.jsx("textarea",{value:d,onChange:Y=>h(Y.target.value),placeholder:"Thread message",className:"w-full rounded-md border border-border bg-background p-2",rows:4}),u.jsx("button",{type:"submit",className:"rounded-md bg-accent px-4 py-2 text-slate-900",children:"Create Thread"})]})]}),u.jsxs("section",{className:"border border-border p-5 rounded-xl",children:[u.jsx("h2",{className:"text-xl font-semibold text-accent",children:"Sunday White Papers"}),e===null?u.jsx("p",{className:"text-text2 mt-2",children:"Loading"}):e.length===0?u.jsx("p",{className:"text-text2 mt-2",children:"No papers yet."}):u.jsx("ul",{className:"mt-4 space-y-2",children:e.map(Y=>u.jsxs("li",{className:"rounded-lg border border-border bg-muted p-3",children:[u.jsx("a",{href:Y.url,target:"_blank",rel:"noopener noreferrer",className:"font-medium text-accent hover:underline",children:Y.title}),Y.note&&u.jsx("p",{className:"text-sm text-text2 mt-1",children:Y.note}),p&&u.jsx("button",{onClick:()=>K(Y.id),className:"ml-2 text-xs text-red-500 hover:underline",children:"Delete"})]},Y.id))}),p&&u.jsxs("form",{onSubmit:F,className:"mt-4 space-y-2",children:[u.jsx("input",{type:"text",value:y,onChange:Y=>T(Y.target.value),placeholder:"Title",className:"w-full rounded-md border border-border bg-background p-2"}),u.jsx("input",{type:"url",value:b,onChange:Y=>I(Y.target.value),placeholder:"URL",className:"w-full rounded-md border border-border bg-background p-2"}),u.jsx("input",{type:"text",value:v,onChange:Y=>w(Y.target.value),placeholder:"Note (optional)",className:"w-full rounded-md border border-border bg-background p-2"}),u.jsx("button",{type:"submit",className:"rounded-md bg-slate-900 px-4 py-2 text-white",children:"Add paper"})]})]}),u.jsxs("section",{className:"border border-border p-5 rounded-xl",children:[u.jsx("h2",{className:"text-xl font-semibold text-accent",children:"Recommended Resources"}),r===null?u.jsx("p",{className:"text-text2 mt-2",children:"Loading"}):r.length===0?u.jsx("p",{className:"text-text2 mt-2",children:"No resources yet."}):u.jsx("ul",{className:"mt-4 space-y-2",children:r.map(Y=>u.jsxs("li",{className:"rounded-lg border border-border bg-muted p-3",children:[u.jsx("a",{href:Y.url,target:"_blank",rel:"noopener noreferrer",className:"font-medium text-accent hover:underline",children:Y.title}),Y.note&&u.jsx("p",{className:"text-sm text-text2 mt-1",children:Y.note}),p&&u.jsx("button",{onClick:()=>ge(Y.id),className:"ml-2 text-xs text-red-500 hover:underline",children:"Delete"})]},Y.id))}),p&&u.jsxs("form",{onSubmit:ne,className:"mt-4 space-y-2",children:[u.jsx("input",{type:"text",value:_,onChange:Y=>E(Y.target.value),placeholder:"Title",className:"w-full rounded-md border border-border bg-background p-2"}),u.jsx("input",{type:"url",value:j,onChange:Y=>O(Y.target.value),placeholder:"URL",className:"w-full rounded-md border border-border bg-background p-2"}),u.jsx("input",{type:"text",value:S,onChange:Y=>x(Y.target.value),placeholder:"Note (optional)",className:"w-full rounded-md border border-border bg-background p-2"}),u.jsx("button",{type:"submit",className:"rounded-md bg-slate-900 px-4 py-2 text-white",children:"Add resource"})]})]})]})})]})}function JM({threadId:t,post:e}){const{user:n}=Ti(),[r,s]=R.useState(!1),[i,o]=R.useState(""),[a,c]=R.useState(!1);R.useEffect(()=>{if(!(n!=null&&n.uid)){c(!1);return}const p=q(dt,"users",n.uid),m=Te(p,y=>{var T;return c(((T=y.data())==null?void 0:T.isSuperAdmin)===!0)});return()=>m()},[n==null?void 0:n.uid]);const d=async p=>{p.preventDefault();const m=i.trim();if(!m||!n)return;const y=e.content.split(/\r?\n/).slice(0,3).join(`
`);await An(ie(dt,"forumThreads",t,"posts"),{author:n.displayName||n.email||"Anonymous",content:m,quote:y,uid:n.uid,createdAt:Ce()}),o(""),s(!1)},h=async()=>{n&&await mt(q(dt,"forumThreads",t,"posts",e.id))};return u.jsxs("div",{className:"rounded-lg border border-border bg-muted p-3",children:[u.jsx("p",{className:"font-medium text-accent",children:e.author}),e.quote&&u.jsx("blockquote",{className:"mt-1 border-l-2 border-border pl-2 text-sm text-text2 whitespace-pre-line",children:e.quote}),u.jsx("p",{className:"text-text2 mt-1 whitespace-pre-line",children:e.content}),n&&u.jsxs(u.Fragment,{children:[u.jsxs("div",{className:"mt-2 flex items-center gap-4 text-sm",children:[u.jsx("button",{onClick:()=>s(p=>!p),className:"text-accent hover:underline",children:"Reply"}),(a||n.uid===e.uid)&&u.jsx("button",{onClick:h,className:"text-red-500 hover:underline",children:"Delete"})]}),r&&u.jsxs("form",{onSubmit:d,className:"mt-2 space-y-2",children:[u.jsx("textarea",{value:i,onChange:p=>o(p.target.value),placeholder:"Write a reply...",className:"w-full rounded-md border border-border bg-background p-2 text-sm",rows:3}),u.jsx("button",{type:"submit",className:"rounded-md bg-accent px-3 py-1 text-sm text-bg",children:"Post Reply"})]})]})]})}function ZM(){const{id:t}=Ds(),[e,n]=R.useState(void 0),[r,s]=R.useState(null);return R.useEffect(()=>{if(!t)return;const i=Te(q(dt,"forumThreads",t),c=>{c.exists()?n(c.data().title):n(null)}),o=we(ie(dt,"forumThreads",t,"posts"),It("createdAt","asc")),a=Te(o,c=>{const d=c.docs.map(h=>({id:h.id,...h.data()}));s(d)});return()=>{i(),a()}},[t]),e===void 0?u.jsx("div",{className:"container py-8 md:py-12",children:u.jsx("div",{className:"max-w-4xl mx-auto",children:u.jsx("p",{className:"text-text2",children:"Loading"})})}):e===null?u.jsx("div",{className:"container py-8 md:py-12",children:u.jsx("div",{className:"max-w-4xl mx-auto",children:u.jsx("p",{className:"text-text2",children:"Thread not found."})})}):u.jsx("div",{className:"container py-8 md:py-12",children:u.jsxs("div",{className:"max-w-4xl mx-auto space-y-6",children:[u.jsxs("section",{children:[u.jsx(_e,{to:"/forum",className:"text-accent hover:underline",children:" Back to forum"}),u.jsx("h1",{className:"mt-4 text-2xl font-semibold text-accent",children:e})]}),u.jsx("section",{className:"space-y-4",children:r===null?u.jsx("p",{className:"text-text2",children:"Loading"}):r.length===0?u.jsx("p",{className:"text-text2",children:"No posts yet."}):r.map(i=>u.jsx(JM,{threadId:t,post:i},i.id))})]})})}const Ow="N86oGmSc8oVnHHeHm2Nlxi2L8Wb2";function e4(){const{user:t}=Ti(),[e,n]=R.useState(null);return R.useEffect(()=>{if(!t||t.uid!==Ow)return;const r=we(ie(dt,"pastorQuestions"),Fe("to","==",t.uid),It("createdAt","desc")),s=Te(r,i=>{const o=i.docs.map(a=>({id:a.id,...a.data()}));n(o)});return()=>s()},[t]),!t||t.uid!==Ow?u.jsx("div",{className:"container py-8 md:py-12",children:u.jsx("div",{className:"max-w-3xl mx-auto",children:u.jsx("p",{children:"You are not authorized to view this page."})})}):u.jsx("div",{className:"container py-8 md:py-12",children:u.jsxs("div",{className:"max-w-3xl mx-auto",children:[u.jsx("h1",{className:"mb-4 text-2xl font-semibold",children:"Questions"}),e===null?u.jsx("p",{children:"Loading"}):e.length===0?u.jsx("p",{children:"No questions yet."}):u.jsx("ul",{className:"space-y-4",children:e.map(r=>u.jsxs("li",{className:"rounded-md border border-border bg-muted p-4",children:[u.jsx("p",{className:"font-medium",children:r.displayName||"Anonymous"}),u.jsx("p",{className:"mt-1 whitespace-pre-wrap",children:r.text})]},r.id))})]})})}function t4(){var r;const t=(r=vo.currentUser)==null?void 0:r.uid,[e,n]=R.useState([]);return R.useEffect(()=>{if(!t)return;const s=we(ie(dt,`users/${t}/activity`),It("createdAt","desc"));return Te(s,o=>{n(o.docs.map(a=>({id:a.id,...a.data()})))})},[t]),t?u.jsxs("div",{className:"container py-10",children:[u.jsx("h1",{className:"text-2xl font-semibold text-accent",children:"Your Activity"}),u.jsxs("ul",{className:"mt-4 divide-y divide-slate-200 rounded-2xl border border-slate-200 bg-white/70",children:[e.map(s=>{var i;return u.jsxs("li",{className:"p-4 text-sm",children:[s.type==="resource_access"?u.jsxs("span",{children:["Opened resource ",s.title?u.jsx("strong",{children:s.title}):u.jsx("code",{children:s.resourcePath})]}):u.jsx("span",{children:s.type}),((i=s.createdAt)==null?void 0:i.toDate)&&u.jsx("span",{className:"block text-xs text-slate-500 mt-1",children:s.createdAt.toDate().toLocaleString()})]},s.id)}),e.length===0&&u.jsx("li",{className:"p-4 text-sm text-slate-600",children:"No activity logged."})]})]}):u.jsx("div",{className:"container py-10",children:u.jsx("p",{className:"text-text2",children:"You must be signed in to view activity."})})}function n4(){const t=R.useMemo(()=>Ue(te),[]),e=R.useMemo(()=>Me(te),[]),[n,r]=R.useState(!1),[s,i]=R.useState(!1),[o,a]=R.useState(!1),[c,d]=R.useState(!1);R.useEffect(()=>{const p=t.currentUser;if(!p)return;const m=p.uid;let y=!1;const T=[],b=new Map,I=new Map;async function v(){var j;let w=!1;try{w=((j=(await xe(q(e,"users",m))).data())==null?void 0:j.isSuperAdmin)===!0}catch{w=!1}if(w){const O=we(jn(e,"membershipRequests"),Fe("status","==","pending"));T.push(Te(O,P=>!y&&r(P.size>0),()=>!y&&r(!1)));let S=0,x=0,N=0;const k=()=>{y||i(S+x+N>0)};T.push(Te(we(ie(e,"users"),Fe("status","==","pending")),P=>{S=P.size,k()},()=>{S=0,k()})),T.push(Te(we(ie(e,"users"),Fe("reviewed","==",!1)),P=>{x=P.size,k()},()=>{x=0,k()})),T.push(Te(we(ie(e,"users"),Fe("needsReview","==",!0)),P=>{N=P.size,k()},()=>{N=0,k()}))}else{const O=we(jn(e,"groupAdmins"),Fe("uid","==",m));T.push(Te(O,S=>{const x=new Set;S.forEach(N=>{var P;const k=(P=N.ref.parent.parent)==null?void 0:P.id;k&&x.add(k)});for(const[N,k]of b.entries())if(!x.has(N)){try{k()}catch{}b.delete(N),I.delete(N)}x.forEach(N=>{if(b.has(N))return;const k=we(ie(e,`groups/${N}/membershipRequests`),Fe("status","==","pending")),P=Te(k,D=>{I.set(N,D.size);let C=!1;for(const pe of I.values())if(pe>0){C=!0;break}y||r(C)},()=>{I.set(N,0);let D=!1;for(const C of I.values())if(C>0){D=!0;break}y||r(D)});b.set(N,P)})})),i(!1)}const _=we(ie(e,"pastorQuestions"),Fe("to","==",m));T.push(Te(_,O=>!y&&a(O.size>0),()=>!y&&a(!1)));const E=ie(e,`users/${m}/activity`);T.push(Te(E,O=>!y&&d(O.size>0),()=>!y&&d(!1)))}return v(),()=>{y=!0,T.forEach(w=>{try{w()}catch{}}),b.forEach(w=>{try{w()}catch{}})}},[t,e]);const h=p=>`block rounded-xl border border-border p-6 text-center text-lg font-semibold transition-colors ${p?"bg-slate-200 text-slate-900":"bg-card text-accent hover:bg-muted"}`;return u.jsx("div",{className:"container py-8 md:py-12",children:u.jsxs("div",{className:"max-w-5xl mx-auto",children:[u.jsx("h1",{className:"text-2xl font-semibold text-accent mb-4",children:"Admin Console"}),u.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[u.jsx(_e,{to:"/admin/groups",className:h(n),children:"Groups"}),u.jsx(_e,{to:"/admin/users",className:h(s),children:"Users"}),u.jsx(_e,{to:"/pastor/questions",className:h(o),children:"Questions"}),u.jsx(_e,{to:"/activity",className:h(c),children:"Activity"})]})]})})}const yu=14;function Lw(t){try{return t?t.toDate?t.toDate():t instanceof Date?t:null:null}catch{return null}}function Vw(t,e){if(!t)return!1;const n=e*24*60*60*1e3;return Date.now()-t.getTime()<=n}function r4(){const t=R.useMemo(()=>Me(te),[]),e=Ue(te),[n,r]=R.useState(!0),[s,i]=R.useState(!1),[o,a]=R.useState([]),[c,d]=R.useState(!1),[h,p]=R.useState([]);return R.useEffect(()=>{let m=!1;async function y(){var T,b;try{r(!0);const I=e.currentUser;if(!I){m||(i(!1),a([]));return}const v=I.uid,_=((T=(await xe(q(t,"users",v))).data())==null?void 0:T.isSuperAdmin)===!0;m||i(_);let E=[];if(_)E=(await Ge(we(ie(t,"groups"),It("name")))).docs.map(S=>S.id);else{const S=(await Ge(we(jn(t,"groupAdmins"),Fe("uid","==",v)))).docs.map(x=>{var N;return((N=x.ref.parent.parent)==null?void 0:N.id)||""}).filter(Boolean);S.length?E=S:E=(await Ge(we(jn(t,"groupAdmins"),Fe("uid","==",v)))).docs.map(N=>{var k;return((k=N.ref.parent.parent)==null?void 0:k.id)||""}).filter(Boolean)}const j=[];for(const O of E)try{const x=(await xe(q(t,"groups",O))).data()||{};let N=0;try{const k=await $S(ie(t,`groups/${O}/membershipRequests`));N=Number(((b=k.data())==null?void 0:b.count)||0)}catch{}j.push({id:O,name:x.name||O,parent:x.parent||null,pendingRequests:N})}catch{}m||a(j)}finally{m||r(!1)}}return y(),()=>{m=!0}},[t,e.currentUser]),R.useEffect(()=>{let m=!1;async function y(){try{d(!0);const T={};for(const I of o){try{(await Ge(ie(t,`groups/${I.id}/members`))).forEach(w=>{const _=w.data(),E=w.id;T[E]||(T[E]={uid:E,name:_==null?void 0:_.displayName,email:_==null?void 0:_.email,groups:[],latestJoinAt:null}),T[E].groups.push({id:I.id,name:I.name||I.id});const j=Lw(_==null?void 0:_.joinedAt);if(j){const O=T[E].latestJoinAt;(!O||j>O)&&(T[E].latestJoinAt=j)}})}catch{}if(m)return}let b=Object.values(T).sort((I,v)=>(I.name||I.uid).localeCompare(v.name||v.uid));if(s){const I=[];for(const v of b){try{const _=(await xe(q(t,"users",v.uid))).data()||{},E=!!(_!=null&&_.isCommunityApproved),j=Lw(_==null?void 0:_.createdAt),O=Vw(j,yu);(!E||O)&&I.push(v)}catch{}if(m)return}b=I}else b=b.filter(I=>Vw(I.latestJoinAt||null,yu));m||p(b)}finally{m||d(!1)}}return o.length?y():p([]),()=>{m=!0}},[t,o,s]),n?u.jsx("div",{className:"max-w-5xl mx-auto p-6",children:u.jsx(pr,{label:"Loading admin groups"})}):u.jsxs("div",{className:"max-w-5xl mx-auto p-6",children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{children:[u.jsx("h1",{className:"text-2xl font-semibold text-slate-900",children:s?"All Groups":"Your Groups"}),u.jsx("p",{className:"text-slate-600 mt-2",children:s?"You are a super admin.":"You are a group admin."})]}),u.jsxs("div",{className:"flex items-center gap-3",children:[s&&u.jsx(_e,{to:"/admin/groups/new",className:"text-sm px-3 py-2 rounded-lg bg-slate-900 text-white hover:bg-slate-800",title:"Create a new group",children:"New Group"}),u.jsx(_e,{to:"/admin/users",className:"text-sm text-slate-700 underline",children:"Users"})]})]}),o.length===0?u.jsx("p",{className:"text-slate-600 mt-4",children:"No groups to manage."}):u.jsx("ul",{className:"mt-4 divide-y divide-slate-200 rounded-xl border border-slate-200 bg-white/70",children:o.map(m=>{const y=m.pendingRequests||0,T="text-sm px-3 py-1.5 rounded-lg text-center leading-tight min-w-[9rem] whitespace-normal md:whitespace-nowrap",b=y>0?`${T} bg-amber-100 text-amber-900 border border-amber-300 hover:bg-amber-200`:`${T} bg-slate-100 text-slate-900 hover:bg-slate-200`;return u.jsxs("li",{className:"p-4 flex items-center justify-between",children:[u.jsxs("div",{className:"min-w-0",children:[u.jsx("div",{className:"font-medium text-slate-900 truncate",children:m.name||m.id}),m.parent&&u.jsxs("div",{className:"text-xs text-slate-500 truncate",children:["Parent: ",m.parent]})]}),u.jsxs("div",{className:"flex gap-2 shrink-0",children:[u.jsx(_e,{to:`/admin/groups/${m.id}/requests`,className:b,title:y>0?`${y} pending`:void 0,children:y>0?`View Requests (${y})`:"View Requests"}),u.jsx(_e,{to:`/admin/groups/${m.id}/members`,className:"text-sm px-3 py-1.5 rounded-lg bg-slate-100 text-slate-900 hover:bg-slate-200 whitespace-normal md:whitespace-nowrap leading-tight min-w-[8rem]",children:"Members"}),u.jsx(_e,{to:`/groups/${m.id}`,className:"text-sm px-3 py-1.5 rounded-lg bg-slate-100 text-slate-900 hover:bg-slate-200 whitespace-normal md:whitespace-nowrap leading-tight min-w-[8rem]",children:"Open Group"})]})]},m.id)})}),u.jsxs("section",{className:"mt-8 rounded-xl border border-slate-200 bg-white/70 p-5",children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsx("h2",{className:"text-lg font-semibold text-slate-900",children:"Users"}),u.jsx(_e,{to:"/admin/users",className:"text-sm text-slate-700 underline",children:"Open full users page"})]}),c?u.jsx("p",{className:"text-sm text-slate-600 mt-3",children:"Loading users"}):h.length===0?u.jsx("p",{className:"text-sm text-slate-600 mt-3",children:s?`No new or unapproved users in the last ${yu} days.`:`No recently joined users (last ${yu} days) in your groups.`}):u.jsx("ul",{className:"mt-3 divide-y divide-slate-200",children:h.map(m=>u.jsx("li",{className:"py-3",children:u.jsxs("div",{className:"flex items-start justify-between gap-3",children:[u.jsxs("div",{className:"min-w-0",children:[u.jsx("div",{className:"text-sm font-medium text-slate-900 break-all",children:m.name||m.uid}),m.email&&u.jsx("div",{className:"text-xs text-slate-600 break-all",children:m.email}),u.jsx("div",{className:"mt-1 flex flex-wrap gap-1",children:m.groups.map(y=>u.jsx(_e,{to:`/admin/groups/${y.id}/members`,className:"text-xs rounded-full bg-slate-100 px-2 py-0.5 text-slate-800 hover:bg-slate-200",title:"Manage members",children:y.name},y.id))})]}),u.jsx(_e,{to:`/admin/users?uid=${encodeURIComponent(m.uid)}`,className:"text-xs rounded-lg border border-slate-300 px-2 py-1 hover:bg-slate-100 shrink-0",children:"View"})]})},m.uid))})]})]})}const zI=Rd(te,"us-central1");async function Mw(t,e,n){const s=await Al(zI,"setUserDisabled")({targetUid:t,disabled:e,reason:n});return(s==null?void 0:s.data)??null}async function s4(t,e=!1){const r=await Al(zI,"deleteUserAccount")({targetUid:t,hardDelete:e});return(r==null?void 0:r.data)??null}function i4(){const t=R.useMemo(()=>Me(te),[]),e=Ue(te),[n,r]=R.useState(!0),[s,i]=R.useState(!1),[o,a]=R.useState([]),[c,d]=R.useState(""),[h,p]=R.useState(""),{search:m}=On();R.useEffect(()=>{const j=new URLSearchParams(m).get("uid")||"";j&&d(j)},[m]),R.useEffect(()=>{let E=!1;async function j(){var O;try{r(!0);const S=e.currentUser;if(!S){E||(a([]),i(!1));return}const N=((O=(await xe(q(t,"users",S.uid))).data())==null?void 0:O.isSuperAdmin)===!0;E||i(N);const P=(await Ge(ie(t,"users"))).docs.map(D=>{const C=D.data();return{uid:D.id,displayName:(C==null?void 0:C.displayName)||(C==null?void 0:C.name)||"",email:(C==null?void 0:C.email)||"",status:(C==null?void 0:C.status)||"active",isCommunityApproved:!!(C!=null&&C.isCommunityApproved),reviewed:!!(C!=null&&C.reviewed),isSuperAdmin:!!(C!=null&&C.isSuperAdmin),groups:[]}});for(const D of P){try{const C=await Ge(ie(t,`users/${D.uid}/memberships`)),pe=[];for(const Ae of C.docs){const Ee=Ae.id;try{const F=(await xe(q(t,"groups",Ee))).data()||{};pe.push({id:Ee,name:(F==null?void 0:F.name)||Ee})}catch{pe.push({id:Ee,name:Ee})}}D.groups=pe.sort((Ae,Ee)=>Ae.name.localeCompare(Ee.name))}catch{D.groups=[]}if(E)return}P.sort((D,C)=>(D.displayName||D.email||D.uid).localeCompare(C.displayName||C.email||C.uid)),E||a(P)}finally{E||r(!1)}}return j(),()=>{E=!0}},[t,e.currentUser]);const y=o.filter(E=>{const j=c.trim().toLowerCase();return j?E.uid.toLowerCase().includes(j)||(E.displayName||"").toLowerCase().includes(j)||(E.email||"").toLowerCase().includes(j)||E.groups.some(O=>O.name.toLowerCase().includes(j)||O.id.toLowerCase().includes(j)):!0});async function T(E){if(!s)return;const j=window.prompt("Reason for inactivation? (optional)")||void 0;p(`disable:${E}`);try{await Mw(E,!0,j),a(O=>O.map(S=>S.uid===E?{...S,status:"inactive"}:S))}catch{alert("Failed to inactivate user.")}finally{p("")}}async function b(E){if(s&&window.confirm("Reactivate this user?")){p(`enable:${E}`);try{await Mw(E,!1),a(j=>j.map(O=>O.uid===E?{...O,status:"active"}:O))}catch{alert("Failed to reactivate user.")}finally{p("")}}}async function I(E){if(!(!s||!window.confirm("Delete this user? This will remove their authentication account and related data.")||!(window.prompt('Type "DELETE" to confirm.')==="DELETE"))){p(`delete:${E}`);try{await s4(E,!1),a(S=>S.filter(x=>x.uid!==E))}catch{alert("Failed to delete user.")}finally{p("")}}}async function v(E,j){if(s){p(`super:${E}`);try{await ze(q(t,"users",E),{isSuperAdmin:j},{merge:!0}),a(O=>O.map(S=>S.uid===E?{...S,isSuperAdmin:j}:S))}catch{alert("Failed to update super admin status.")}finally{p("")}}}async function w(E,j){var O;if(s){p(`approve:${E}`);try{const S=((O=e.currentUser)==null?void 0:O.uid)||"",x=j?{isCommunityApproved:!0,dmApprovedAt:Ce(),dmApprovedBy:S}:{isCommunityApproved:!1,dmApprovedAt:rl(),dmApprovedBy:rl()};await ze(q(t,"users",E),x,{merge:!0}),a(N=>N.map(k=>k.uid===E?{...k,isCommunityApproved:j}:k))}catch{alert("Failed to update approval.")}finally{p("")}}}async function _(E){var j;if(s){p(`review:${E}`);try{await ze(q(t,"users",E),{reviewed:!0,needsReview:!1},{merge:!0});const O=(j=e.currentUser)==null?void 0:j.uid;if(O)try{const S=await Ge(we(ie(t,`users/${O}/notifications`),Fe("type","==","new-user"),Fe("uid","==",E)));for(const x of S.docs)await Nl(x.ref,{read:!0,readAt:Ce()}).catch(()=>{})}catch{}a(S=>S.map(x=>x.uid===E?{...x,reviewed:!0}:x))}catch{alert("Failed to mark reviewed.")}finally{p("")}}}return n?u.jsx("div",{className:"max-w-5xl mx-auto p-6",children:u.jsx(pr,{label:"Loading users"})}):u.jsxs("div",{className:"max-w-5xl mx-auto p-6",children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsx("h1",{className:"text-2xl font-semibold text-slate-900",children:"Users"}),u.jsx("input",{value:c,onChange:E=>d(E.target.value),placeholder:"Search users",className:"rounded-lg border border-slate-300 bg-white/80 px-3 py-2 text-sm outline-none w-56","aria-label":"Search users"})]}),u.jsxs("div",{className:"mt-4 rounded-xl border border-slate-200 bg-white/70 overflow-hidden",children:[u.jsxs("div",{className:"grid grid-cols-12 gap-2 px-4 py-2 text-xs font-medium text-slate-600",children:[u.jsx("div",{className:"col-span-4",children:"Name"}),u.jsx("div",{className:"col-span-3",children:"Email"}),u.jsx("div",{className:"col-span-3",children:"Groups"}),u.jsx("div",{className:"col-span-2 text-right",children:"Actions"})]}),u.jsx("div",{className:"divide-y divide-slate-200",children:y.length===0?u.jsx("div",{className:"px-4 py-4 text-sm text-slate-600",children:"No users found."}):y.map(E=>u.jsxs("div",{className:"grid grid-cols-12 gap-2 px-4 py-3 items-start",children:[u.jsxs("div",{className:"col-span-4 min-w-0",children:[u.jsx("div",{className:"text-sm text-slate-900 truncate",children:E.displayName||E.uid}),E.email&&u.jsx("div",{className:"text-xs text-slate-600 truncate",children:E.email}),u.jsxs("div",{className:"text-[11px] text-slate-500 mt-0.5",children:["Status: ",E.status||"active"]}),u.jsxs("div",{className:"text-[11px] text-slate-500 mt-0.5",children:["DM access: ",u.jsx("b",{children:E.isCommunityApproved?"Approved":"Not approved"})]})]}),u.jsx("div",{className:"col-span-3 min-w-0",children:u.jsxs("div",{className:"flex flex-wrap gap-1",children:[E.groups.map(j=>u.jsx(_e,{to:`/admin/groups/${j.id}/members`,className:"text-xs rounded-full bg-slate-100 px-2 py-0.5 text-slate-800 hover:bg-slate-200",title:"Manage members",children:j.name},j.id)),E.groups.length===0&&u.jsx("span",{className:"text-xs text-slate-600",children:""})]})}),u.jsx("div",{className:"col-span-3 min-w-0",children:u.jsx("span",{className:"text-xs break-all",children:E.uid})}),u.jsx("div",{className:"col-span-2 text-right",children:u.jsxs("div",{className:"inline-flex flex-col gap-1 items-end",children:[u.jsxs("label",{className:"inline-flex items-center gap-2 text-xs select-none",children:[u.jsx("input",{type:"checkbox",checked:!!E.isSuperAdmin,onChange:j=>void v(E.uid,j.target.checked),disabled:!s||!!h}),u.jsx("span",{children:"Super Admin"})]}),u.jsxs("label",{className:"inline-flex items-center gap-2 text-xs select-none",children:[u.jsx("input",{type:"checkbox",checked:!!E.isCommunityApproved,onChange:j=>void w(E.uid,j.target.checked),disabled:!s||!!h}),u.jsx("span",{children:"Approved for DMs"})]}),u.jsx(_e,{to:`/admin/users?uid=${encodeURIComponent(E.uid)}`,className:"text-xs rounded-lg border border-slate-300 px-2 py-1 hover:bg-slate-100",children:"View"}),!E.reviewed&&u.jsx("button",{onClick:()=>_(E.uid),disabled:!s||!!h,className:"text-xs rounded-lg px-2 py-1 bg-emerald-100 text-emerald-800 hover:bg-emerald-200",style:{opacity:h?.6:1},children:h===`review:${E.uid}`?"Saving":"Mark reviewed"}),s&&u.jsxs("div",{className:"flex flex-wrap gap-1 justify-end",children:[E.status==="inactive"?u.jsx("button",{onClick:()=>b(E.uid),disabled:!!h,className:"text-xs rounded-lg px-2 py-1 text-white",style:{backgroundColor:"#919FAA",opacity:h?.6:1},children:h===`enable:${E.uid}`?"Working":"Reactivate"}):u.jsx("button",{onClick:()=>T(E.uid),disabled:!!h,className:"text-xs rounded-lg px-2 py-1 text-white",style:{backgroundColor:"#919FAA",opacity:h?.6:1},children:h===`disable:${E.uid}`?"Working":"Inactivate"}),u.jsx("button",{onClick:()=>I(E.uid),disabled:!!h,className:"text-xs rounded-lg px-2 py-1 bg-rose-100 text-rose-800 hover:bg-rose-200",style:{opacity:h?.6:1},title:"Soft delete (Auth account removed; user doc marked deleted)",children:h===`delete:${E.uid}`?"Deleting":"Delete"})]})]})})]},E.uid))})]})]})}function o4(){const{slug:t}=Ds(),e=Me(te),[n,r]=R.useState(""),[s,i]=R.useState([]),[o,a]=R.useState(!0),[c,d]=R.useState(""),[h,p]=R.useState({}),m=t;R.useEffect(()=>{let b=!0;async function I(){if(m){a(!0);try{const v=q(e,"groups",m),w=await xe(v);r(w.exists()&&w.data().name||a4(m));const _=ie(e,`groups/${m}/membershipRequests`),E=await Ge(_);if(!b)return;const j=[];E.forEach(O=>j.push({uid:O.id,...O.data()})),i(j)}finally{a(!1)}}}return I(),()=>{b=!1}},[e,m]);async function y(b){var I,v;d(b.uid);try{await ze(q(e,`users/${b.uid}/memberships/${m}`),{groupId:m,approvedAt:Ce(),approvedBy:"admin"},{merge:!0});const w=await xe(q(e,"users",b.uid)),_=((I=w.data())==null?void 0:I.displayName)||((v=w.data())==null?void 0:v.name);await ze(q(e,`groups/${m}/members/${b.uid}`),{uid:b.uid,displayName:b.displayName||_||"Member",joinedAt:Ce()},{merge:!0}),await Promise.all([mt(q(e,`groups/${m}/membershipRequests/${b.uid}`)),mt(q(e,`users/${b.uid}/membershipRequests/${m}`))]),p(E=>({...E,[b.uid]:!0})),setTimeout(()=>{i(E=>E.filter(j=>j.uid!==b.uid))},1500)}finally{d("")}}async function T(b){d(b.uid);try{await Promise.all([mt(q(e,`groups/${m}/membershipRequests/${b.uid}`)),mt(q(e,`users/${b.uid}/membershipRequests/${m}`))]),i(I=>I.filter(v=>v.uid!==b.uid))}finally{d("")}}return m?u.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[u.jsx("div",{className:"mb-4",children:u.jsxs(_e,{to:"/admin",className:"inline-flex items-center gap-2 rounded-lg border border-border px-3 py-1.5 text-sm hover:bg-muted",children:[u.jsx("span",{"aria-hidden":!0,children:""}),u.jsx("span",{children:"Return to Admin Console"})]})}),u.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[u.jsxs("div",{children:[u.jsx("h1",{className:"text-2xl font-semibold text-slate-900",children:"Pending Requests"}),u.jsxs("p",{className:"text-slate-600",children:["Group: ",n]})]}),u.jsx(_e,{to:`/groups/${m}`,className:"text-sm text-slate-700 underline",children:"Back to group"})]}),o?u.jsx("p",{className:"text-slate-600",children:"Loading"}):s.length===0?u.jsx("p",{className:"text-slate-600",children:"No pending requests."}):u.jsx("ul",{className:"divide-y divide-slate-200 rounded-xl border border-slate-200 bg-white/70",children:s.map(b=>u.jsxs("li",{className:"p-4 flex items-center justify-between",children:[u.jsxs("div",{children:[u.jsx("div",{className:"font-medium text-slate-900",children:b.displayName||b.uid}),u.jsx("div",{className:"text-xs text-slate-500 truncate",children:b.uid})]}),u.jsxs("div",{className:"flex gap-2",children:[u.jsx("button",{onClick:()=>y(b),disabled:!!c||h[b.uid],className:h[b.uid]?"text-xs px-3 py-1.5 rounded-lg bg-slate-100 text-slate-900":"text-xs px-3 py-1.5 rounded-lg bg-green-600 text-white hover:bg-green-700 disabled:opacity-60",children:c===b.uid?"Working":h[b.uid]?"Approved":"Approve"}),u.jsx("button",{onClick:()=>T(b),disabled:!!c||h[b.uid],className:"text-xs px-3 py-1.5 rounded-lg bg-rose-100 text-rose-800 hover:bg-rose-200 disabled:opacity-60",children:"Deny"})]})]},b.uid))})]}):u.jsx("div",{className:"p-6",children:"Missing group slug."})}function a4(t){return t.replace(/[-_]/g," ").replace(/\b\w/g,e=>e.toUpperCase())}function l4(){const{slug:t}=Ds(),e=R.useMemo(()=>Me(te),[]),n=Ue(te),[r,s]=R.useState(""),[i,o]=R.useState([]),[a,c]=R.useState({}),[d,h]=R.useState(!0),[p,m]=R.useState(""),[y,T]=R.useState(""),[b,I]=R.useState(!1),[v,w]=R.useState(""),[_,E]=R.useState([]),[j,O]=R.useState(""),[S,x]=R.useState(""),N=(t||"").trim();R.useEffect(()=>{let J=!0;async function F(){var ne;if(N){h(!0),T("");try{const ge=q(e,"groups",N),me=await xe(ge);s(me.exists()&&me.data().name||u4(N));const ue=n.currentUser;if(ue){const he=ue.uid;if(((ne=(await xe(q(e,"users",he))).data())==null?void 0:ne.isSuperAdmin)===!0)I(!0);else{const $=await xe(q(e,`groups/${N}/groupAdmins/${he}`));I($.exists())}}else I(!1);const Y=await Ge(ie(e,`groups/${N}/members`));if(!J)return;const M=[],z=await Ge(ie(e,`groups/${N}/groupAdmins`)),Z={};z.forEach(he=>{Z[he.id]=!0}),c(Z),Y.forEach(he=>M.push({uid:he.id,...he.data()})),M.sort((he,ae)=>(he.displayName||he.uid).localeCompare(ae.displayName||ae.uid)),o(M)}catch(ge){T((ge==null?void 0:ge.message)||"Failed to load members.")}finally{h(!1)}}}F();async function K(){try{const ge=(await Ge(ie(e,"users"))).docs.map(me=>{const ue=me.data();return{uid:me.id,displayName:(ue==null?void 0:ue.displayName)||(ue==null?void 0:ue.name)||"",email:(ue==null?void 0:ue.email)||""}});ge.sort((me,ue)=>(me.displayName||me.email||me.uid).localeCompare(ue.displayName||ue.email||ue.uid)),E(ge)}catch{E([])}}return K(),()=>{J=!1}},[e,N]);async function k(J,F,K){var ge,me;const ne=J.trim();if(ne){T(""),m("add");try{const ue=qS(e),Y=q(e,`groups/${N}/members/${ne}`);{const z={uid:ne,displayName:F||ne,role:"member",joinedAt:Ce(),addedBy:((ge=n.currentUser)==null?void 0:ge.uid)||"unknown"};K&&(z.email=K),ue.set(Y,z,{merge:!0})}const M=q(e,`users/${ne}/memberships/${N}`);ue.set(M,{groupId:N,approvedAt:Ce(),approvedBy:((me=n.currentUser)==null?void 0:me.uid)||"admin"},{merge:!0}),await ue.commit(),o(z=>{const Z=[...z.filter(he=>he.uid!==ne),{uid:ne,displayName:F||ne,email:K}];return Z.sort((he,ae)=>(he.displayName||he.uid).localeCompare(ae.displayName||ae.uid)),Z}),w(""),x("")}catch(ue){T((ue==null?void 0:ue.message)||"Failed to add member. Check Firestore rules.")}finally{m("")}}}async function P(){await k(v)}async function D(J){if(J.preventDefault(),!S)return;const F=_.find(K=>K.uid===S);await k(S,F==null?void 0:F.displayName,F==null?void 0:F.email)}async function C(J){var F;m(`admin:${J}`),T("");try{await ze(q(e,`groups/${N}/groupAdmins/${J}`),{uid:J,grantedBy:((F=n.currentUser)==null?void 0:F.uid)||"unknown",createdAt:Ce()},{merge:!0}),c(K=>({...K,[J]:!0}))}catch(K){T((K==null?void 0:K.message)||"Failed to grant admin.")}finally{m("")}}async function pe(J){m(`admin:${J}`),T("");try{await mt(q(e,`groups/${N}/groupAdmins/${J}`)),c(F=>{const K={...F};return delete K[J],K})}catch(F){T((F==null?void 0:F.message)||"Failed to remove admin.")}finally{m("")}}async function Ae(J){m(J),T("");try{await mt(q(e,`groups/${N}/members/${J}`)),await mt(q(e,`users/${J}/memberships/${N}`)),o(F=>F.filter(K=>K.uid!==J))}catch(F){T((F==null?void 0:F.message)||"Failed to remove member.")}finally{m("")}}if(!N)return u.jsx("div",{className:"p-6",children:"Missing group slug."});const Ee=R.useMemo(()=>{const J=j.trim().toLowerCase();return J?_.filter(F=>{const K=(F.displayName||"").toLowerCase(),ne=(F.email||"").toLowerCase();return K.includes(J)||ne.includes(J)||F.uid.toLowerCase().includes(J)}):_},[_,j]);return u.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[u.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[u.jsxs("div",{children:[u.jsx("h1",{className:"text-2xl font-semibold text-slate-900",children:"Group Members"}),u.jsxs("p",{className:"text-slate-600",children:["Group: ",r]})]}),u.jsx(_e,{to:"/admin/groups",className:"text-sm text-slate-700 underline",children:"Back to groups"})]}),y&&u.jsx("div",{className:"mb-3 rounded-lg border border-rose-200 bg-rose-50 px-3 py-2 text-sm text-rose-800",children:y}),u.jsxs("div",{className:"rounded-xl border border-slate-200 bg-white/70 p-4 mb-6",children:[u.jsx("h2",{className:"font-medium text-slate-900",children:"Add Member (by Name)"}),u.jsxs("form",{onSubmit:D,className:"mt-2 grid gap-2 sm:grid-cols-6",children:[u.jsx("input",{value:j,onChange:J=>O(J.target.value),placeholder:"Search users by name, email, or UID",className:"sm:col-span-2 rounded-lg border border-slate-300 px-3 py-2 text-sm","aria-label":"Filter users",disabled:!b}),u.jsxs("select",{className:"sm:col-span-3 rounded-lg border border-slate-300 px-2 py-2 text-sm",value:S,onChange:J=>x(J.target.value),"aria-label":"Select user to add",disabled:!b,children:[u.jsx("option",{value:"",children:"Select a user"}),Ee.map(J=>u.jsx("option",{value:J.uid,children:(J.displayName||"Unnamed")+(J.email?`  ${J.email}`:"")},J.uid))]}),u.jsx("div",{className:"sm:col-span-1",children:u.jsx("button",{type:"submit",disabled:!S||!!p||!b,className:"rounded-lg bg-slate-900 text-white px-4 py-2 text-sm hover:bg-slate-800 disabled:opacity-60",children:p==="add"?"Adding":"Add to group"})})]}),u.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Admins: choose a user to add them to this group."})]}),u.jsxs("div",{className:"rounded-xl border border-slate-200 bg-white/70 p-4 mb-6",children:[u.jsx("h2",{className:"font-medium text-slate-900",children:"Add Member (by UID)"}),u.jsxs("div",{className:"mt-2 flex gap-2",children:[u.jsx("input",{value:v,onChange:J=>w(J.target.value),placeholder:"Paste a user's UID",className:"flex-1 rounded-lg border border-slate-300 px-3 py-2 text-sm",disabled:!b}),u.jsx("button",{onClick:P,disabled:!v.trim()||!!p||!b,className:"text-sm px-3 py-2 rounded-lg bg-slate-900 text-white hover:bg-slate-800 disabled:opacity-60",children:p==="add"?"Adding":"Add"})]}),u.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Tip: you can find a user's UID in Firebase  Authentication."})]}),d?u.jsx("p",{className:"text-slate-600",children:"Loading"}):i.length===0?u.jsx("p",{className:"text-slate-600",children:"No members yet."}):u.jsx("ul",{className:"divide-y divide-slate-200 rounded-xl border border-slate-200 bg-white/70",children:i.map(J=>u.jsxs("li",{className:"p-4 flex items-center justify-between",children:[u.jsxs("div",{children:[u.jsx("div",{className:"font-medium text-slate-900",children:J.displayName||J.uid}),u.jsx("div",{className:"text-xs text-slate-500 truncate",children:J.uid})]}),u.jsxs("div",{className:"flex items-center gap-2",children:[a[J.uid]?u.jsx("button",{onClick:()=>pe(J.uid),disabled:!!p||!b,className:"text-xs px-3 py-1.5 rounded-lg bg-amber-100 text-amber-800 hover:bg-amber-200 disabled:opacity-60",children:p===`admin:${J.uid}`?"Updating":"Remove admin"}):u.jsx("button",{onClick:()=>C(J.uid),disabled:!!p||!b,className:"text-xs px-3 py-1.5 rounded-lg bg-slate-900 text-white hover:bg-slate-800 disabled:opacity-60",children:p===`admin:${J.uid}`?"Updating":"Make admin"}),u.jsx("button",{onClick:()=>Ae(J.uid),disabled:!!p||!b,className:"text-xs px-3 py-1.5 rounded-lg bg-rose-100 text-rose-800 hover:bg-rose-200 disabled:opacity-60",children:p===J.uid?"Removing":"Remove"})]})]},J.uid))})]})}function u4(t){return t.replace(/[-_]/g," ").replace(/\b\w/g,e=>e.toUpperCase())}function c4(){const{slug:t}=Ds(),e=Me(te),n=t,[r,s]=R.useState([]),[i,o]=R.useState(!0);return R.useEffect(()=>{let a=!0;async function c(){if(n){o(!0);try{const d=ie(e,`groups/${n}/groupEvents`),h=we(d,It("at","desc")),p=await Ge(h);if(!a)return;const m=[];p.forEach(y=>m.push({id:y.id,...y.data()})),s(m)}finally{o(!1)}}}return c(),()=>{a=!1}},[e,n]),u.jsxs("div",{className:"max-w-4xl mx-auto p-6",children:[u.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[u.jsxs("div",{children:[u.jsx("h1",{className:"text-2xl font-semibold text-slate-900",children:"Audit Log"}),u.jsx("p",{className:"text-slate-600",children:"Recent events for this group."})]}),u.jsx(_e,{to:"/admin/groups",className:"text-sm text-slate-700 underline",children:"Back to groups"})]}),i?u.jsx("p",{className:"text-slate-600",children:"Loading"}):r.length===0?u.jsx("p",{className:"text-slate-600",children:"No events yet."}):u.jsx("ul",{className:"divide-y divide-slate-200 rounded-xl border border-slate-200 bg-white/70",children:r.map(a=>{var c;return u.jsxs("li",{className:"p-4",children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsx("div",{className:"font-medium text-slate-900",children:a.type.replace(/_/g," ")}),u.jsx("div",{className:"text-xs text-slate-500",children:(c=a.at)!=null&&c.toDate?a.at.toDate().toLocaleString():""})]}),u.jsx("div",{className:"text-xs text-slate-600 mt-1",children:a.uid&&u.jsxs(u.Fragment,{children:["User: ",u.jsx("code",{children:a.uid})]})}),a.payload&&u.jsx("pre",{className:"mt-2 text-xs bg-slate-50 rounded-lg p-2 overflow-auto",children:JSON.stringify(a.payload,null,2)})]},a.id)})})]})}function d4(){const t=Rd(te),e=Me(te),[n,r]=R.useState(""),[s,i]=R.useState(""),[o,a]=R.useState([]),[c,d]=R.useState(!1),[h,p]=R.useState(null);R.useEffect(()=>{async function y(){const T=await Ge(ie(e,"groups")),b=[];T.forEach(I=>b.push({id:I.id,...I.data()})),b.sort((I,v)=>(I.name||I.id).localeCompare(v.name||v.id)),a(b)}y()},[e]);async function m(){d(!0),p(null);try{const T=await Al(t,"grantGroupAdminByEmail")({email:n,groupId:s});p(` Granted admin to ${n} (uid=${T.data.uid})`),r("")}catch(y){p(` ${(y==null?void 0:y.message)||"Failed"}`)}finally{d(!1)}}return u.jsxs("div",{className:"max-w-xl mx-auto p-6",children:[u.jsx("h1",{className:"text-2xl font-semibold text-slate-900",children:"Grant Group Admin (by email)"}),u.jsxs("div",{className:"mt-4 grid gap-3 rounded-2xl border border-slate-200 bg-white/70 p-4",children:[u.jsxs("label",{className:"block text-sm",children:[u.jsx("span",{className:"font-medium text-slate-700",children:"User email"}),u.jsx("input",{value:n,onChange:y=>r(y.target.value),placeholder:"user@example.com",className:"mt-1 w-full rounded-lg border border-slate-300 px-3 py-2 text-sm"})]}),u.jsxs("label",{className:"block text-sm",children:[u.jsx("span",{className:"font-medium text-slate-700",children:"Group"}),u.jsxs("select",{value:s,onChange:y=>i(y.target.value),className:"mt-1 w-full rounded-lg border border-slate-300 bg-white/70 px-3 py-2 text-sm",children:[u.jsx("option",{value:"",children:"Select a group"}),o.map(y=>u.jsx("option",{value:y.id,children:y.name||y.id},y.id))]})]}),u.jsxs("div",{className:"flex gap-3 items-center",children:[u.jsx("button",{onClick:m,disabled:!n||!s||c,className:"px-4 py-2 rounded-lg bg-slate-900 text-white hover:bg-slate-800 disabled:opacity-60",children:c?"Working":"Grant admin"}),h&&u.jsx("p",{className:"text-sm text-slate-700",children:h})]})]})]})}function h4(t){return t.toLowerCase().trim().replace(/[^a-z0-9]+/g,"-").replace(/(^-|-$)+/g,"")}function Uw(){const t=Me(te),e=Ue(te),n=Br(),[r,s]=R.useState(""),[i,o]=R.useState(""),[a,c]=R.useState(""),[d,h]=R.useState(""),[p,m]=R.useState(""),[y,T]=R.useState(""),[b,I]=R.useState(""),[v,w]=R.useState(""),[_,E]=R.useState(""),[j,O]=R.useState(!1),[S,x]=R.useState(null),[N,k]=R.useState(null),P=R.useMemo(()=>i||h4(r),[i,r]);R.useEffect(()=>{async function C(){var Ee,J;const pe=(Ee=e.currentUser)==null?void 0:Ee.uid;if(!pe){k(!1);return}const Ae=await xe(q(t,"users",pe));k(((J=Ae.data())==null?void 0:J.isSuperAdmin)===!0)}C()},[e.currentUser,t]);async function D(){if(!N){x(" Not authorized.");return}const C=P.trim();if(!r.trim()||!C){x(" Name and slug are required.");return}O(!0),x(null);try{const pe=q(t,"groups",C);if((await xe(pe)).exists()){x(" A group with that slug already exists."),O(!1);return}await ze(pe,{id:C,name:r.trim(),slug:C,description:a.trim()||null,parent:d||null,campus:p||null,meetingDay:y||null,meetingTime:b||null,imageUrl:v||null,calendarIds:_.split(",").map(Ee=>Ee.trim()).filter(Boolean),createdAt:Ce(),updatedAt:Ce()}),n(`/admin/groups/${C}/edit`,{replace:!0})}catch(pe){x(" "+((pe==null?void 0:pe.message)||"Failed to create group."))}finally{O(!1)}}return N===null?u.jsx("div",{className:"max-w-3xl mx-auto p-6",children:"Loading"}):N?u.jsxs("div",{className:"max-w-3xl mx-auto p-6",children:[u.jsx("h1",{className:"text-2xl font-semibold text-slate-900",children:"Create Group"}),u.jsxs("div",{className:"mt-4 grid gap-3",children:[u.jsxs(yr,{label:"Name",children:[u.jsx("input",{value:r,onChange:C=>s(C.target.value),className:"w-full rounded-lg border border-slate-300 px-3 py-2 text-sm"}),u.jsxs("p",{className:"mt-1 text-xs text-slate-500",children:["Slug preview: ",u.jsx("code",{children:P||""})]})]}),u.jsx(yr,{label:"Slug (optional)",children:u.jsx("input",{value:i,onChange:C=>o(C.target.value),className:"w-full rounded-lg border border-slate-300 px-3 py-2 text-sm",placeholder:"auto from name if blank"})}),u.jsx(yr,{label:"Description",children:u.jsx("textarea",{value:a,onChange:C=>c(C.target.value),rows:4,className:"w-full rounded-lg border border-slate-300 px-3 py-2 text-sm"})}),u.jsxs("div",{className:"grid sm:grid-cols-2 gap-3",children:[u.jsx(yr,{label:"Parent ministry (optional)",children:u.jsx("input",{value:d,onChange:C=>h(C.target.value),className:"w-full rounded-lg border border-slate-300 px-3 py-2 text-sm"})}),u.jsx(yr,{label:"Campus (optional)",children:u.jsx("input",{value:p,onChange:C=>m(C.target.value),className:"w-full rounded-lg border border-slate-300 px-3 py-2 text-sm"})})]}),u.jsxs("div",{className:"grid sm:grid-cols-2 gap-3",children:[u.jsx(yr,{label:"Meeting day (optional)",children:u.jsxs("select",{value:y,onChange:C=>T(C.target.value),className:"w-full rounded-lg border border-slate-300 px-3 py-2 text-sm bg-white/70",children:[u.jsx("option",{value:"",children:""}),["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"].map(C=>u.jsx("option",{value:C,children:C},C))]})}),u.jsx(yr,{label:"Meeting time (optional)",children:u.jsx("input",{value:b,onChange:C=>I(C.target.value),className:"w-full rounded-lg border border-slate-300 px-3 py-2 text-sm",placeholder:"e.g., 7:00pm"})})]}),u.jsx(yr,{label:"Image URL (optional)",children:u.jsx("input",{value:v,onChange:C=>w(C.target.value),className:"w-full rounded-lg border border-slate-300 px-3 py-2 text-sm",placeholder:"https://"})}),u.jsx(yr,{label:"Google Calendar IDs (comma-separated)",children:u.jsx("input",{value:_,onChange:C=>E(C.target.value),className:"w-full rounded-lg border border-slate-300 px-3 py-2 text-sm",placeholder:"id1@group.calendar.google.com,id2@group.calendar.google.com"})}),S&&u.jsx("p",{className:"text-sm text-slate-700",children:S}),u.jsx("div",{className:"flex gap-3",children:u.jsx("button",{onClick:D,disabled:j,className:"px-4 py-2 rounded-lg bg-slate-900 text-white hover:bg-slate-800 disabled:opacity-60",children:j?"Creating":"Create group"})})]})]}):u.jsx("div",{className:"max-w-3xl mx-auto p-6",children:"Not authorized."})}function yr({label:t,children:e}){return u.jsxs("label",{className:"block",children:[u.jsx("div",{className:"text-sm font-medium text-slate-700",children:t}),u.jsx("div",{className:"mt-1",children:e})]})}function f4(){var I;const{slug:t}=Ds(),e=Me(te),n=Ue(te),r=Br(),[s,i]=R.useState(null),[o,a]=R.useState(!0),[c,d]=R.useState(!1),[h,p]=R.useState(null),[m,y]=R.useState(!1);R.useEffect(()=>{let v=!0;async function w(){var O,S;if(!t)return;a(!0);const _=await xe(q(e,"groups",t));if(!v)return;const E=_.exists()?_.data():{};i({name:(E==null?void 0:E.name)||"",description:(E==null?void 0:E.description)??"",parent:(E==null?void 0:E.parent)??"",campus:(E==null?void 0:E.campus)??"",meetingDay:(E==null?void 0:E.meetingDay)??"",meetingTime:(E==null?void 0:E.meetingTime)??"",meetingFrequency:(E==null?void 0:E.meetingFrequency)??"",imageUrl:(E==null?void 0:E.imageUrl)??"",calendarIds:Array.isArray(E==null?void 0:E.calendarIds)?E.calendarIds:[]});const j=(O=n.currentUser)==null?void 0:O.uid;if(j){const x=await xe(q(e,"users",j));v&&y(((S=x.data())==null?void 0:S.isSuperAdmin)===!0)}else v&&y(!1);a(!1)}return w(),()=>{v=!1}},[e,t,n.currentUser]);async function T(){var v,w,_,E,j,O;if(!(!t||!s)){d(!0),p(null);try{const S={...s,name:String((s==null?void 0:s.name)||"").trim(),description:((v=(s==null?void 0:s.description)||"")==null?void 0:v.trim())||null,parent:((w=(s==null?void 0:s.parent)||"")==null?void 0:w.trim())||null,campus:((_=(s==null?void 0:s.campus)||"")==null?void 0:_.trim())||null,meetingDay:((E=(s==null?void 0:s.meetingDay)||"")==null?void 0:E.trim())||null,meetingTime:((j=(s==null?void 0:s.meetingTime)||"")==null?void 0:j.trim())||null,meetingFrequency:(s==null?void 0:s.meetingFrequency)||"",imageUrl:((O=(s==null?void 0:s.imageUrl)||"")==null?void 0:O.trim())||null,updatedAt:Ce()};m?S.calendarIds=((s==null?void 0:s.calendarIds)||[]).map(x=>x.trim()).filter(Boolean):delete S.calendarIds,await ze(q(e,"groups",t),S,{merge:!0}),p(" Saved")}catch(S){const x=(S==null?void 0:S.message)||"Failed to save.";p(x)}finally{d(!1)}}}async function b(){if(t&&confirm("Delete this group? This cannot be undone."))try{await mt(q(e,"groups",t)),r("/admin/groups",{replace:!0})}catch(v){const w=(v==null?void 0:v.message)||"Failed to delete.";p(w)}}return o?u.jsx("div",{className:"max-w-3xl mx-auto p-6",children:"Loading"}):s?u.jsxs("div",{className:"max-w-3xl mx-auto p-6",children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsx("h1",{className:"text-2xl font-semibold text-slate-900",children:"Edit Group"}),u.jsx(_e,{to:"/admin/groups",className:"text-sm text-slate-700 underline",children:"Back to groups"})]}),u.jsxs("div",{className:"mt-4 grid gap-3",children:[u.jsx(vr,{label:"Name",children:u.jsx("input",{value:(s==null?void 0:s.name)||"",onChange:v=>i(w=>({...w,name:v.target.value})),className:"w-full rounded-lg border border-slate-300 px-3 py-2 text-sm"})}),u.jsx(vr,{label:"Description",children:u.jsx("textarea",{value:(s==null?void 0:s.description)||"",onChange:v=>i(w=>({...w,description:v.target.value})),rows:4,className:"w-full rounded-lg border border-slate-300 px-3 py-2 text-sm"})}),u.jsxs("div",{className:"grid sm:grid-cols-2 gap-3",children:[u.jsx(vr,{label:"Parent ministry",children:u.jsx("input",{value:(s==null?void 0:s.parent)||"",onChange:v=>i(w=>({...w,parent:v.target.value})),className:"w-full rounded-lg border border-slate-300 px-3 py-2 text-sm"})}),u.jsx(vr,{label:"Campus",children:u.jsx("input",{value:(s==null?void 0:s.campus)||"",onChange:v=>i(w=>({...w,campus:v.target.value})),className:"w-full rounded-lg border border-slate-300 px-3 py-2 text-sm"})})]}),u.jsxs("div",{className:"grid sm:grid-cols-3 gap-3",children:[u.jsx(vr,{label:"Meeting day",children:u.jsxs("select",{value:(s==null?void 0:s.meetingDay)||"",onChange:v=>i(w=>({...w,meetingDay:v.target.value})),className:"w-full rounded-lg border border-slate-300 px-3 py-2 text-sm bg-white/70",children:[u.jsx("option",{value:"",children:""}),["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"].map(v=>u.jsx("option",{value:v,children:v},v))]})}),u.jsx(vr,{label:"Meeting time",children:u.jsx("input",{value:(s==null?void 0:s.meetingTime)||"",onChange:v=>i(w=>({...w,meetingTime:v.target.value})),className:"w-full rounded-lg border border-slate-300 px-3 py-2 text-sm",placeholder:"e.g., 7:00pm"})}),u.jsx(vr,{label:"Meeting frequency",children:u.jsxs("select",{value:(s==null?void 0:s.meetingFrequency)||"",onChange:v=>i(w=>({...w,meetingFrequency:v.target.value})),className:"w-full rounded-lg border border-slate-300 px-3 py-2 text-sm bg-white/70",children:[u.jsx("option",{value:"",children:""}),u.jsx("option",{value:"weekly",children:"Weekly"}),u.jsx("option",{value:"biweekly",children:"Biweekly"}),u.jsx("option",{value:"monthly",children:"Monthly"})]})})]}),u.jsx(vr,{label:"Image URL",children:u.jsx("input",{value:(s==null?void 0:s.imageUrl)||"",onChange:v=>i(w=>({...w,imageUrl:v.target.value})),className:"w-full rounded-lg border border-slate-300 px-3 py-2 text-sm",placeholder:"https://"})}),m&&u.jsx(vr,{label:"Google Calendar IDs (comma-separated)",children:u.jsx("input",{value:((I=s==null?void 0:s.calendarIds)==null?void 0:I.join(", "))||"",onChange:v=>i(w=>({...w,calendarIds:v.target.value.split(",").map(_=>_.trim()).filter(Boolean)})),className:"w-full rounded-lg border border-slate-300 px-3 py-2 text-sm",placeholder:"id1@group.calendar.google.com,id2@group.calendar.google.com"})}),h&&u.jsx("p",{className:"text-sm text-slate-700",children:h}),u.jsxs("div",{className:"flex gap-3",children:[u.jsx("button",{onClick:T,disabled:c,className:"px-4 py-2 rounded-lg bg-slate-900 text-white hover:bg-slate-800 disabled:opacity-60",children:c?"Saving":"Save changes"}),u.jsx("button",{onClick:b,className:"px-4 py-2 rounded-lg bg-rose-100 text-rose-800 hover:bg-rose-200",children:"Delete group"})]})]})]}):u.jsx("div",{className:"max-w-3xl mx-auto p-6",children:"Not found."})}function vr({label:t,children:e}){return u.jsxs("label",{className:"block",children:[u.jsx("div",{className:"text-sm font-medium text-slate-700",children:t}),u.jsx("div",{className:"mt-1",children:e})]})}function p4(){const t=Me(te),e=Ue(te),[n,r]=R.useState([]),[s,i]=R.useState(!0),[o,a]=R.useState(""),[c,d]=R.useState("");async function h(){i(!0);const y=await Ge(we(ie(t,"users"),Fe("isSuperAdmin","==",!0))),T=[];y.forEach(b=>T.push({uid:b.id,...b.data()})),T.sort((b,I)=>b.uid.localeCompare(I.uid)),r(T),i(!1)}R.useEffect(()=>{h()},[]);async function p(){var T;const y=c.trim();if(y){a("add");try{await ze(q(t,"users",y),{isSuperAdmin:!0,superAdminAddedAt:Ce(),superAdminAddedBy:((T=e.currentUser)==null?void 0:T.uid)||"unknown"},{merge:!0}),d(""),await h()}finally{a("")}}}async function m(y){a(y);try{await ze(q(t,"users",y),{isSuperAdmin:!1,superAdminAddedAt:rl(),superAdminAddedBy:rl()},{merge:!0}),await h()}finally{a("")}}return u.jsxs("div",{className:"max-w-3xl mx-auto p-6",children:[u.jsx("h1",{className:"text-2xl font-semibold text-slate-900",children:"Super Admins"}),u.jsx("p",{className:"text-slate-600 mt-1",children:"Add or remove super admins by UID."}),u.jsxs("div",{className:"mt-4 rounded-2xl border border-slate-200 bg-white/70 p-4",children:[u.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"Add by UID"}),u.jsxs("div",{className:"mt-2 flex gap-2",children:[u.jsx("input",{value:c,onChange:y=>d(y.target.value),placeholder:"Paste UID from Firebase Authentication  Users",className:"flex-1 rounded-lg border border-slate-300 px-3 py-2 text-sm"}),u.jsx("button",{onClick:p,disabled:!c.trim()||!!o,className:"px-3 py-2 rounded-lg text-sm bg-slate-900 text-white hover:bg-slate-800 disabled:opacity-60",children:o==="add"?"Adding":"Add"})]})]}),u.jsx("div",{className:"mt-4 rounded-2xl border border-slate-200 bg-white/70",children:s?u.jsx("div",{className:"p-4 text-slate-600",children:"Loading"}):n.length===0?u.jsx("div",{className:"p-4 text-slate-600",children:"No super admins yet."}):u.jsx("ul",{className:"divide-y divide-slate-200",children:n.map(y=>u.jsxs("li",{className:"p-4 flex items-center justify-between",children:[u.jsxs("div",{children:[u.jsx("div",{className:"font-medium text-slate-900",children:y.uid}),u.jsxs("div",{className:"text-xs text-slate-500",children:["Added by: ",y.superAdminAddedBy||""]})]}),u.jsx("button",{onClick:()=>m(y.uid),disabled:!!o,className:"text-xs px-3 py-1.5 rounded-lg bg-rose-100 text-rose-800 hover:bg-rose-200 disabled:opacity-60",children:o===y.uid?"Removing":"Remove"})]},y.uid))})})]})}function m4({children:t}){const e=Ue(te),n=Me(te),[r,s]=H.useState(!1),[i,o]=H.useState(null),[a,c]=H.useState(null),[d,h]=H.useState(null);return H.useEffect(()=>{const p=Vn(e,async m=>{var y;if(s(!0),!m){o(null),c(!1);return}o(m.uid);try{const T=await xe(q(n,"users",m.uid));c(((y=T.data())==null?void 0:y.isSuperAdmin)===!0)}catch(T){h((T==null?void 0:T.message)||String(T)),c(!1)}});return()=>p()},[e,n]),!r||a===null?u.jsx("div",{className:"max-w-xl mx-auto p-6",children:"Checking"}):a?u.jsx(u.Fragment,{children:t}):u.jsxs("div",{className:"max-w-xl mx-auto p-6 rounded-2xl border border-slate-200 bg-white/70",children:[u.jsx("h2",{className:"text-lg font-semibold text-slate-900",children:"AdminRouteDebug"}),u.jsxs("p",{className:"text-sm text-slate-700 mt-2",children:["UID: ",u.jsx("code",{children:i||""})]}),u.jsxs("p",{className:"text-sm text-slate-700",children:["users/UID.isSuperAdmin? ",u.jsx("strong",{children:a?"YES":"NO"})]}),!i&&u.jsx("p",{className:"mt-3 text-sm text-rose-700",children:"You are not signed in."}),i&&!a&&u.jsxs("p",{className:"mt-3 text-sm text-amber-700",children:["Signed in, but your user document does not have ",u.jsx("code",{children:"isSuperAdmin"})," set."]}),d&&u.jsxs("p",{className:"mt-3 text-sm text-rose-700",children:["Error reading ",u.jsxs("code",{children:["users/","{uid}"]}),": ",d]})]})}function g4(t,e){return[t,e].sort().join("_")}function y4(){var Y;const t=H.useMemo(()=>Me(te),[]),e=H.useMemo(()=>Ue(te),[]),[n,r]=H.useState(((Y=e.currentUser)==null?void 0:Y.uid)??null),[s,i]=H.useState(!1),[o,a]=H.useState(!1);H.useEffect(()=>{const M=Vn(e,async z=>{var Z,he;if(r((z==null?void 0:z.uid)??null),z!=null&&z.uid){try{const ae=await xe(q(t,"users",z.uid));i(!!((Z=ae.data())!=null&&Z.isCommunityApproved))}catch{i(!1)}try{const ae=await xe(q(t,"users",z.uid));a(((he=ae.data())==null?void 0:he.isSuperAdmin)===!0)}catch{a(!1)}}else i(!1),a(!1)});return()=>M()},[e,t]);const[c,d]=H.useState(!1),[h,p]=H.useState("list"),[m,y]=H.useState([]),[T,b]=H.useState(null),[I,v]=H.useState([]),[w,_]=H.useState(""),E=H.useRef(null),[j,O]=H.useState([]),[S,x]=H.useState({}),[N,k]=H.useState(""),[P,D]=H.useState(!1),[C,pe]=H.useState(""),Ae=H.useRef({});async function Ee(M,z){var he,ae,$;if(Ae.current[M])return Ae.current[M];const Z=(he=j.find(G=>G.uid===M))==null?void 0:he.displayName;if(Z){if(Ae.current[M]=Z,z)try{await ze(q(t,"dmThreads",z),{[`userNames.${M}`]:Z},{merge:!0})}catch{}return Z}try{const G=await xe(q(t,"users",M)),se=((ae=G.data())==null?void 0:ae.displayName)||(($=G.data())==null?void 0:$.name);if(se){if(Ae.current[M]=se,z)try{await ze(q(t,"dmThreads",z),{[`userNames.${M}`]:se},{merge:!0})}catch{}return se}return M}catch{return M}}async function J(M){try{const z=we(jn(t,"messages"),Fe("from","==",M)),Z=we(jn(t,"messages"),Fe("to","==",M)),[he,ae]=await Promise.all([Ge(z),Ge(Z)]),$=[...he.docs,...ae.docs],G=[];for(const se of $){const ce=se.ref.path.split("/");if(ce.length<4||ce[0]!=="dmMessages")continue;const oe=ce[1],De=se.data(),ke=De.from===M?De.to:De.from;if(!ke)continue;const Wt=[M,ke].sort(),nn=q(t,"dmThreads",oe),qr={users:Wt,lastText:De.text||"",lastAt:De.createdAt||Ce(),lastSender:De.from||M};G.push(ze(nn,qr,{merge:!0}))}await Promise.allSettled(G)}catch{}}H.useEffect(()=>{if(!n||!s){O([]);return}(async()=>{try{const M={},z=[],Z=we(ie(t,"users"),Fe("isCommunityApproved","==",!0));(await Ge(Z)).docs.forEach(ae=>{if(ae.id===n)return;M[ae.id]=!0;const $=ae.data(),G=($==null?void 0:$.displayName)||($==null?void 0:$.name)||void 0,se=($==null?void 0:$.email)||void 0,ce=[ae.id,...Object.values($).filter(oe=>typeof oe=="string")].join(" ").toLowerCase();z.push({uid:ae.id,displayName:G,email:se,search:ce})});try{(await Ge(we(ie(t,"users"),Fe("isSuperAdmin","==",!0)))).docs.forEach($=>{if($.id===n||M[$.id])return;const G=$.data(),se=(G==null?void 0:G.displayName)||(G==null?void 0:G.name)||void 0,ce=(G==null?void 0:G.email)||void 0,oe=[$.id,...Object.values(G).filter(De=>typeof De=="string")].join(" ").toLowerCase();z.push({uid:$.id,displayName:se,email:ce,search:oe})})}catch{}O(z)}catch{O([])}})()},[t,n,s]),H.useEffect(()=>{if(!n||!s)return;let M=null,z=!1;return(async()=>{try{try{const Z=we(ie(t,"dmThreads"),Fe("users","array-contains",n)),he=we(Z,It("lastAt","desc"));M=Te(he,ae=>{const $=[];ae.docs.forEach(G=>{var ke,Wt;const se=G.data(),ce=(se==null?void 0:se.users)||[],oe=ce.find(nn=>nn!==n)||"",De=(ke=j.find(nn=>nn.uid===oe))==null?void 0:ke.displayName;$.push({id:G.id,users:ce,lastText:(se==null?void 0:se.lastText)||"",lastAt:se==null?void 0:se.lastAt,otherUid:oe,otherName:((Wt=se==null?void 0:se.userNames)==null?void 0:Wt[oe])||De||Ae.current[oe]})}),z||y($),$.length===0&&J(n),$.forEach(G=>{G.otherUid&&!G.otherName&&Ee(G.otherUid,G.id).then(se=>{z||se===G.otherUid||y(ce=>ce.map(oe=>oe.id===G.id?{...oe,otherName:se}:oe))}).catch(()=>{})})},ae=>{ae&&ae.code==="failed-precondition"?M=Te(Z,G=>{const se=[];G.docs.forEach(ce=>{var nn,qr;const oe=ce.data(),De=(oe==null?void 0:oe.users)||[],ke=De.find(Wr=>Wr!==n)||"",Wt=(nn=j.find(Wr=>Wr.uid===ke))==null?void 0:nn.displayName;se.push({id:ce.id,users:De,lastText:(oe==null?void 0:oe.lastText)||"",lastAt:oe==null?void 0:oe.lastAt,otherUid:ke,otherName:((qr=oe==null?void 0:oe.userNames)==null?void 0:qr[ke])||Wt||Ae.current[ke]})}),se.sort((ce,oe)=>{var Wt,nn;const De=(Wt=ce.lastAt)!=null&&Wt.toMillis?ce.lastAt.toMillis():0;return((nn=oe.lastAt)!=null&&nn.toMillis?oe.lastAt.toMillis():0)-De}),z||y(se),se.length===0&&J(n),se.forEach(ce=>{ce.otherUid&&!ce.otherName&&Ee(ce.otherUid,ce.id).then(oe=>{z||oe===ce.otherUid||y(De=>De.map(ke=>ke.id===ce.id?{...ke,otherName:oe}:ke))}).catch(()=>{})})}):ae&&console.warn("DM thread listener error:",ae)})}catch{console.warn("DM thread listener attach failed")}}catch{}})(),()=>{M&&M()}},[t,n,s]),H.useEffect(()=>{y(M=>M.map(z=>{var he;if(z.otherName&&z.otherName!==z.otherUid)return z;const Z=(he=j.find(ae=>ae.uid===z.otherUid))==null?void 0:he.displayName;return Z?{...z,otherName:Z}:z}))},[j]),H.useEffect(()=>{if(!T||!n){E.current&&(E.current(),E.current=null),v([]);return}E.current&&(E.current(),E.current=null);const M=ie(t,"dmMessages",T.id,"messages"),z=we(M,It("createdAt","asc")),Z=Te(z,he=>{const ae=he.docs.map($=>{const G=$.data();return{id:$.id,text:(G==null?void 0:G.text)||"",from:(G==null?void 0:G.from)||"",to:(G==null?void 0:G.to)||"",displayName:(G==null?void 0:G.displayName)||"",createdAt:G==null?void 0:G.createdAt}});v(ae),ae.forEach($=>{$.displayName||Ee($.from,T.id).then(G=>{v(se=>se.map(ce=>ce.id===$.id?{...ce,displayName:G}:ce))})})});return E.current=Z,()=>{E.current&&(E.current(),E.current=null)}},[t,T==null?void 0:T.id,n]);async function F(M){if(!n)throw new Error("No user");const z=m.find(Z=>Z.otherUid===M);return z?{pid:z.id}:{pid:g4(n,M)}}async function K(){var Z;if(!T||!n)return;const M=w.trim();if(!M)return;const z=T.otherUid;try{const he=((Z=e.currentUser)==null?void 0:Z.displayName)||await Ee(n,T.id)||"Member",ae=T.otherName&&T.otherName!==z?T.otherName:await Ee(z,T.id),$=q(t,"dmThreads",T.id);await ze($,{users:[n,z].sort()},{merge:!0});const G=ie(t,"dmMessages",T.id,"messages");await An(G,{text:M,from:n,to:z,displayName:he,createdAt:Ce()});const se={lastText:M,lastAt:Ce(),lastSender:n};se[`userNames.${n}`]=he,ae&&ae!==z&&(se[`userNames.${z}`]=ae),await ze($,se,{merge:!0}),_("")}catch{alert("Could not send message.")}}async function ne(){var Z,he;if(!n)return;const M=Object.entries(S).filter(([,ae])=>ae).map(([ae])=>ae),z=N.trim();if(!(M.length===0||!z)){D(!0);try{for(const ae of M){const{pid:$}=await F(ae),G=((Z=e.currentUser)==null?void 0:Z.displayName)||await Ee(n,$)||"Member",se=(he=j.find(ke=>ke.uid===ae))==null?void 0:he.displayName,ce=se&&se!==ae?se:await Ee(ae,$),oe=q(t,"dmThreads",$);await ze(oe,{users:[n,ae].sort()},{merge:!0}),await An(ie(t,"dmMessages",$,"messages"),{text:z,from:n,to:ae,displayName:G,createdAt:Ce()});const De={lastText:z,lastAt:Ce(),lastSender:n};De[`userNames.${n}`]=G,ce&&ce!==ae&&(De[`userNames.${ae}`]=ce),await ze(oe,De,{merge:!0})}k(""),x({}),p("list")}catch{alert("Failed to send message(s).")}finally{D(!1)}}}async function ge(M){if(!T||!n)return;const z=I.find(Z=>Z.id===M);if(z&&(z.from===n||o))try{await mt(q(t,"dmMessages",T.id,"messages",M))}catch{alert("Failed to delete message (check rules).")}}function me(){x({}),pe(""),k(""),p("compose")}if(!n||!s)return null;const ue=j.filter(M=>{const z=C.trim().toLowerCase();return z?[M.uid,M.displayName,M.email,M.search].filter(Boolean).join(" ").toLowerCase().includes(z):!0});return u.jsxs(u.Fragment,{children:[u.jsx("button",{type:"button",onClick:()=>{d(M=>!M),c||p("list")},className:`fixed bottom-4 right-4 z-[1100] shadow-lg rounded-full px-4 py-2 text-bg text-sm md:text-[13px] bg-accent ${c?"hidden md:inline-flex":"inline-flex"}`,"aria-label":c?"Close direct messages":"Open direct messages",children:c?"Close DMs":"Open DMs"}),c&&u.jsxs("div",{className:`fixed z-[1000] bottom-0 inset-x-0 w-full h-[85vh] rounded-t-2xl
                     md:bottom-16 md:left-1/2 md:inset-x-auto md:w-full md:max-w-[780px] md:max-h-[480px] md:rounded-xl md:-translate-x-1/2 md:transform
                    border border-border bg-surface text-text shadow-xl overflow-hidden
                     flex md:flex-row flex-col`,style:{paddingBottom:"env(safe-area-inset-bottom)"},children:[u.jsxs("div",{className:"md:hidden flex items-center justify-between px-3 py-2 border-b border-border",children:[u.jsx("button",{type:"button",onClick:()=>d(!1),className:"text-xs rounded-md border border-border px-2 py-1","aria-label":"Close direct messages",children:"Close"}),u.jsx("div",{className:"text-sm font-semibold",children:"Direct Messages"}),h!=="compose"?u.jsx("button",{type:"button",onClick:me,className:"text-xs rounded-md border border-border px-2 py-1","aria-label":"New message",children:"New"}):u.jsx("button",{type:"button",onClick:()=>p("list"),className:"text-xs rounded-md border border-border px-2 py-1","aria-label":"Back to conversations",children:"Back"})]}),h==="list"&&u.jsxs("div",{className:"md:w-64 md:border-r md:border-border h-[40vh] md:h-full overflow-auto",children:[u.jsxs("div",{className:"hidden md:flex px-3 py-2 text-sm font-semibold items-center justify-between",children:[u.jsx("span",{children:"Conversations"}),u.jsx("button",{type:"button",onClick:me,className:"text-xs rounded-md border border-border px-2 py-1 hover:bg-surface",title:"New message",children:"New"})]}),m.length===0?u.jsx("div",{className:"px-3 py-2 text-sm text-text",children:"No conversations yet."}):u.jsx("ul",{children:m.map(M=>u.jsx("li",{children:u.jsxs("button",{type:"button",onClick:()=>{b(M),p("chat")},className:`w-full text-left px-3 py-2 text-sm hover:bg-surface ${T&&T.id===M.id?"bg-surface":""}`,children:[u.jsx("div",{className:"font-medium truncate",children:M.otherName||M.otherUid}),u.jsx("div",{className:"text-xs text-text truncate",children:M.lastText||""})]})},M.id))})]}),u.jsxs("div",{className:"flex-1 h-full flex flex-col",children:[h==="chat"&&T&&u.jsxs(u.Fragment,{children:[u.jsxs("div",{className:"px-3 py-2 border-b border-border flex items-center gap-2",children:[u.jsx("button",{type:"button",onClick:()=>{b(null),p("list")},className:"text-xs rounded-md border border-border px-2 py-1 hover:bg-surface","aria-label":"Back to conversations",children:" Back"}),u.jsx("div",{className:"text-sm font-semibold truncate",children:T.otherName||T.otherUid})]}),u.jsxs("div",{className:"flex-1 overflow-auto p-3 space-y-2",children:[I.map(M=>{const z=M.from===n;return u.jsxs("div",{className:`max-w-[85%] md:max-w-[80%] rounded-lg px-3 py-2 text-sm relative ${z?"ml-auto border border-border":"bg-surface"}`,children:[u.jsx("div",{className:"text-xs opacity-70 mb-0.5",children:M.displayName||M.from}),u.jsx("div",{children:M.text}),(z||o)&&u.jsx("button",{type:"button",onClick:()=>void ge(M.id),className:"absolute -top-2 -right-2 text-[10px] rounded-full border border-border bg-bg px-1.5 py-0.5 hover:bg-surface",title:"Delete message",children:""})]},M.id)}),I.length===0&&u.jsx("div",{className:"text-sm text-text",children:"No messages in this conversation yet."})]}),u.jsx("div",{className:"border-t border-border p-2",children:u.jsxs("div",{className:"relative flex",children:[u.jsx("textarea",{value:w,onChange:M=>_(M.target.value),placeholder:"Write a message",className:"flex-1 rounded-lg border border-border bg-surface px-3 py-2 text-base outline-none text-text placeholder:text-meta h-10 md:h-auto md:min-h-[40px] max-h-28 pr-10",onKeyDown:M=>{M.key==="Enter"&&!M.shiftKey&&(M.preventDefault(),K())},style:{fontSize:"16px"}}),u.jsx("button",{type:"button",onClick:()=>void K(),className:"absolute right-2 top-1/2 -translate-y-1/2 rounded-full w-8 h-8 flex items-center justify-center bg-accent text-bg text-lg hover:opacity-90 disabled:opacity-50",disabled:!w.trim(),children:""})]})})]}),h==="compose"&&u.jsxs(u.Fragment,{children:[u.jsxs("div",{className:"px-3 py-2 border-b border-border flex items-center gap-2",children:[u.jsx("button",{type:"button",onClick:()=>p("list"),className:"text-xs rounded-md border border-border px-2 py-1 hover:bg-surface",children:" Back"}),u.jsx("div",{className:"text-sm font-semibold",children:"New message"})]}),u.jsxs("div",{className:"flex-1 p-3 grid grid-cols-1 md:grid-cols-5 gap-3 overflow-auto",children:[u.jsxs("div",{className:"md:col-span-2",children:[u.jsx("label",{className:"text-xs text-text",children:"Recipients"}),u.jsx("input",{value:C,onChange:M=>pe(M.target.value),placeholder:"Search users",className:"mt-1 w-full rounded-lg border border-border bg-surface px-2 py-1.5 text-sm outline-none"}),u.jsx("div",{className:"mt-2 h-56 md:h-48 overflow-auto rounded-lg border border-border",children:ue.length===0?u.jsx("div",{className:"px-2 py-2 text-xs text-meta",children:"No matching users."}):u.jsx("ul",{className:"p-2 space-y-1",children:ue.map(M=>u.jsxs("li",{className:"flex items-center gap-2",children:[u.jsx("input",{id:`sel-${M.uid}`,type:"checkbox",className:"h-4 w-4 accent-accent",checked:!!S[M.uid],onChange:z=>x(Z=>({...Z,[M.uid]:z.target.checked}))}),u.jsxs("label",{htmlFor:`sel-${M.uid}`,className:"text-sm truncate",children:[M.displayName||"(unknown user)",M.email?`  ${M.email}`:""]})]},M.uid))})})]}),u.jsxs("div",{className:"md:col-span-3 flex flex-col",children:[u.jsx("label",{className:"text-xs text-text",children:"Message"}),u.jsx("textarea",{value:N,onChange:M=>k(M.target.value),placeholder:"Write your message",className:"mt-1 flex-1 rounded-lg border border-border bg-surface px-3 py-2 text-sm outline-none h-40 md:h-auto"})]})]}),u.jsxs("div",{className:"border-t border-border p-2 flex items-center justify-end gap-2",children:[u.jsx("button",{type:"button",onClick:()=>p("list"),className:"rounded-lg border border-border px-3 py-2 text-sm hover:bg-surface",children:"Cancel"}),u.jsx("button",{type:"button",onClick:()=>void ne(),disabled:P||!N.trim()||!Object.values(S).some(Boolean),className:"rounded-lg px-3 py-2 bg-accent text-bg text-sm hover:opacity-90 disabled:opacity-60",children:P?"Sending":"Send"})]})]}),h==="list"&&!T&&u.jsxs("div",{className:"hidden md:grid place-items-center flex-1 text-sm text-text",children:["Select a conversation or click ",u.jsx("b",{className:"mx-1",children:"New"})," to start one."]})]})]})]})}function v4(){var d,h,p;const t=Ue(te),[e,n]=R.useState(!1),[r,s]=R.useState(((d=t.currentUser)==null?void 0:d.uid)||null),[i,o]=R.useState(((h=t.currentUser)==null?void 0:h.email)||null);R.useEffect(()=>{const m=Vn(t,y=>{s((y==null?void 0:y.uid)||null),o((y==null?void 0:y.email)||null),n(!0)});return()=>m()},[t]);const a=(p=te.options)==null?void 0:p.projectId;return u.jsxs("div",{className:"max-w-xl mx-auto p-6 rounded-2xl border border-slate-200 bg-white/70",children:[u.jsx("h1",{className:"text-lg font-semibold text-slate-900",children:"Auth Debug: WhoAmI"}),u.jsxs("div",{className:"mt-2 text-sm text-slate-700",children:[u.jsxs("div",{children:[u.jsx("span",{className:"font-medium",children:"ready:"})," ",String(e)]}),u.jsxs("div",{children:[u.jsx("span",{className:"font-medium",children:"email:"})," ",i||""]}),u.jsxs("div",{children:[u.jsx("span",{className:"font-medium",children:"uid:"})," ",u.jsx("code",{children:r||""})]}),u.jsxs("div",{className:"mt-2",children:[u.jsx("span",{className:"font-medium",children:"SDK projectId:"})," ",u.jsx("code",{children:a||""})]}),u.jsxs("div",{children:[u.jsx("span",{className:"font-medium",children:"ENV projectId:"})," ",u.jsx("code",{children:String("immanuel-app")})]})]})]})}function _4({children:t}){const e=On(),n=e.pathname==="/login"||e.pathname==="/signup"||e.pathname==="/forgot"||e.pathname==="/reset";return u.jsxs(u.Fragment,{children:[n?u.jsx(eM,{}):u.jsx(nM,{}),!n&&u.jsx(y4,{}),t]})}function w4(){return u.jsx(BC,{children:u.jsx(kL,{children:u.jsx(_4,{children:u.jsxs(jC,{children:[u.jsx(je,{path:"/",element:u.jsx(Nr,{to:"/login",replace:!0})}),u.jsx(je,{path:"/login",element:u.jsx(rM,{})}),u.jsx(je,{path:"/signup",element:u.jsx(iM,{})}),u.jsx(je,{path:"/forgot",element:u.jsx(FM,{})}),u.jsx(je,{path:"/reset",element:u.jsx($M,{})}),u.jsx(je,{path:"/welcome",element:u.jsx(Kt,{children:u.jsx(qM,{})})}),u.jsx(je,{path:"/dashboard",element:u.jsx(Kt,{children:u.jsx(gt,{children:u.jsx(uM,{})})})}),u.jsx(je,{path:"/groups",element:u.jsx(Kt,{children:u.jsx(gt,{children:u.jsx(cM,{})})})}),u.jsx(je,{path:"/resources",element:u.jsx(Kt,{children:u.jsx(gt,{children:u.jsx(hM,{})})})}),u.jsx(je,{path:"/events",element:u.jsx(Kt,{children:u.jsx(gt,{children:u.jsx(fM,{})})})}),u.jsx(je,{path:"/profile",element:u.jsx(Kt,{children:u.jsx(gt,{children:u.jsx(MM,{})})})}),u.jsx(je,{path:"/settings",element:u.jsx(Kt,{children:u.jsx(gt,{children:u.jsx(UM,{})})})}),u.jsx(je,{path:"/forum",element:u.jsx(Kt,{children:u.jsx(gt,{children:u.jsx(XM,{})})})}),u.jsx(je,{path:"/forum/thread/:id",element:u.jsx(Kt,{children:u.jsx(gt,{children:u.jsx(ZM,{})})})}),u.jsx(je,{path:"/sunday-resources",element:u.jsx(Kt,{children:u.jsx(gt,{children:u.jsx(KM,{})})})}),u.jsx(je,{path:"/pastor/questions",element:u.jsx(Kt,{children:u.jsx(gt,{children:u.jsx(e4,{})})})}),u.jsx(je,{path:"/activity",element:u.jsx(Kt,{children:u.jsx(gt,{children:u.jsx(t4,{})})})}),u.jsx(je,{path:"/groups/explore",element:u.jsx(Kt,{children:u.jsx(gt,{children:u.jsx(VL,{})})})}),u.jsx(je,{path:"/groups/:slug",element:u.jsx(Kt,{children:u.jsx(gt,{children:u.jsx(XV,{})})})}),u.jsx(je,{path:"/groups/:slug/polls",element:u.jsx(Kt,{children:u.jsx(gt,{children:u.jsx(JV,{})})})}),u.jsx(je,{path:"/admin",element:u.jsx(Bs,{children:u.jsx(gt,{children:u.jsx(n4,{})})})}),u.jsx(je,{path:"/admin/groups",element:u.jsx(Bs,{children:u.jsx(gt,{children:u.jsx(r4,{})})})}),u.jsx(je,{path:"/admin/groups/:slug/requests",element:u.jsx($h,{children:u.jsx(gt,{children:u.jsx(o4,{})})})}),u.jsx(je,{path:"/admin/groups/:slug/members",element:u.jsx($h,{children:u.jsx(gt,{children:u.jsx(l4,{})})})}),u.jsx(je,{path:"/admin/groups/:slug/events",element:u.jsx($h,{children:u.jsx(gt,{children:u.jsx(c4,{})})})}),u.jsx(je,{path:"/admin/super-admins",element:u.jsx(Bs,{children:u.jsx(p4,{})})}),u.jsx(je,{path:"/admin/group-admins/by-email",element:u.jsx(Bs,{children:u.jsx(d4,{})})}),u.jsx(je,{path:"/admin/users",element:u.jsx(Bs,{children:u.jsx(i4,{})})}),u.jsx(je,{path:"/admin/groups/new",element:u.jsx(Bs,{children:u.jsx(Uw,{})})}),u.jsx(je,{path:"/admin/groups/:slug/edit",element:u.jsx(Bs,{children:u.jsx(f4,{})})}),u.jsx(je,{path:"/__whoami",element:u.jsx(v4,{})}),u.jsx(je,{path:"/__admin/new",element:u.jsx(m4,{children:u.jsx(Uw,{})})}),u.jsx(je,{path:"*",element:u.jsx(Nr,{to:"/dashboard",replace:!0})})]})})})})}"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/sw.js").catch(t=>{console.error("SW registration failed",t)})});qh.createRoot(document.getElementById("root")).render(u.jsx(H.StrictMode,{children:u.jsx(w4,{})}));
